---
uid: web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12
title: 使用 SQL Server Compact 使用 Visual Studio 或 Visual Web Developer 将 ASP.NET Web 应用程序部署：部署到生产环境-7 / 12 |Microsoft Docs
author: tdykstra
description: 本系列教程演示如何将部署 （发布） ASP.NET web 应用程序项目的 SQL Server Compact 数据库使用包含的 Visual Stu...
ms.author: riande
ms.date: 11/17/2011
ms.assetid: b83ab819-2b05-4776-b7b4-79ef78d457a5
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deployment-to-a-hosting-provider/deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12
msc.type: authoredcontent
ms.openlocfilehash: ce49baeca3fd5fe13476ea538e88f3e19dbb6c7b
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/17/2019
ms.locfileid: "59382558"
---
# <a name="deploying-an-aspnet-web-application-with-sql-server-compact-using-visual-studio-or-visual-web-developer-deploying-to-the-production-environment---7-of-12"></a><span data-ttu-id="6d434-103">使用 SQL Server Compact 使用 Visual Studio 或 Visual Web Developer 将 ASP.NET Web 应用程序部署：部署到生产环境-7 / 12</span><span class="sxs-lookup"><span data-stu-id="6d434-103">Deploying an ASP.NET Web Application with SQL Server Compact using Visual Studio or Visual Web Developer: Deploying to the Production Environment - 7 of 12</span></span>

<span data-ttu-id="6d434-104">通过[Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="6d434-104">by [Tom Dykstra](https://github.com/tdykstra)</span></span>

[<span data-ttu-id="6d434-105">下载初学者项目</span><span class="sxs-lookup"><span data-stu-id="6d434-105">Download Starter Project</span></span>](http://code.msdn.microsoft.com/Deploying-an-ASPNET-Web-4e31366b)

> <span data-ttu-id="6d434-106">本系列教程演示如何将部署 （发布） ASP.NET web 应用程序项目的情况下使用 Visual Studio 2012 RC 或 Visual Studio Express 2012 RC for Web 包含 SQL Server Compact 数据库。</span><span class="sxs-lookup"><span data-stu-id="6d434-106">This series of tutorials shows you how to deploy (publish) an ASP.NET web application project that includes a SQL Server Compact database by using Visual Studio 2012 RC or Visual Studio Express 2012 RC for Web.</span></span> <span data-ttu-id="6d434-107">如果在安装 Web 发布更新，还可以使用 Visual Studio 2010。</span><span class="sxs-lookup"><span data-stu-id="6d434-107">You can also use Visual Studio 2010 if you install the Web Publish Update.</span></span> <span data-ttu-id="6d434-108">该系列的简介，请参阅[系列中的第一个教程](deployment-to-a-hosting-provider-introduction-1-of-12.md)。</span><span class="sxs-lookup"><span data-stu-id="6d434-108">For an introduction to the series, see [the first tutorial in the series](deployment-to-a-hosting-provider-introduction-1-of-12.md).</span></span>
> 
> <span data-ttu-id="6d434-109">显示了 Visual Studio 2012 RC 版后引入的部署功能，演示如何部署 SQL Server Compact 以外的 SQL Server 版本并显示了如何将部署到 Azure 应用服务 Web 应用的教程，请参阅[ASP.NET Web 部署使用 Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md)。</span><span class="sxs-lookup"><span data-stu-id="6d434-109">For a tutorial that shows deployment features introduced after the RC release of Visual Studio 2012, shows how to deploy SQL Server editions other than SQL Server Compact, and shows how to deploy to Azure App Service Web Apps, see [ASP.NET Web Deployment using Visual Studio](../../deployment/visual-studio-web-deployment/introduction.md).</span></span>


## <a name="overview"></a><span data-ttu-id="6d434-110">概述</span><span class="sxs-lookup"><span data-stu-id="6d434-110">Overview</span></span>

<span data-ttu-id="6d434-111">在本教程中，将设置与宿主提供程序帐户和部署您的 ASP.NET web 应用程序到生产环境中使用 Visual Studio 一键式发布功能。</span><span class="sxs-lookup"><span data-stu-id="6d434-111">In this tutorial, you set up an account with a hosting provider and deploy your ASP.NET web application to the production environment by using the Visual Studio one-click publish feature.</span></span>

<span data-ttu-id="6d434-112">提醒：如果收到错误消息或某些操作无法按完成以下教程，请务必检查[故障排除页](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md)。</span><span class="sxs-lookup"><span data-stu-id="6d434-112">Reminder: If you get an error message or something doesn't work as you go through the tutorial, be sure to check the [troubleshooting page](deployment-to-a-hosting-provider-creating-and-installing-deployment-packages-12-of-12.md).</span></span>

## <a name="selecting-a-hosting-provider"></a><span data-ttu-id="6d434-113">选择托管提供商</span><span class="sxs-lookup"><span data-stu-id="6d434-113">Selecting a Hosting Provider</span></span>

<span data-ttu-id="6d434-114">对于 Contoso 大学应用程序和本系列教程，您需要 ASP.NET 4 和 Web 部署支持的提供程序。</span><span class="sxs-lookup"><span data-stu-id="6d434-114">For the Contoso University application and this tutorial series, you need a provider that supports ASP.NET 4 and Web Deploy.</span></span> <span data-ttu-id="6d434-115">特定的托管公司选择是为了让这些教程无法说明部署到实时网站的完整的体验。</span><span class="sxs-lookup"><span data-stu-id="6d434-115">A specific hosting company was chosen so that the tutorials could illustrate the complete experience of deploying to a live website.</span></span> <span data-ttu-id="6d434-116">每个托管公司提供不同的功能，并将部署到他们的服务器的体验上略有不同。</span><span class="sxs-lookup"><span data-stu-id="6d434-116">Each hosting company provides different features, and the experience of deploying to their servers varies somewhat.</span></span> <span data-ttu-id="6d434-117">但是，在本教程中所述的过程是典型的整个过程。</span><span class="sxs-lookup"><span data-stu-id="6d434-117">However, the process described in this tutorial is typical for the overall process.</span></span> <span data-ttu-id="6d434-118">用于本教程中，Cytanium.com，宿主提供程序是一个许多可用，并在本教程中的使用它不构成认可或推荐。</span><span class="sxs-lookup"><span data-stu-id="6d434-118">The hosting provider used for this tutorial, Cytanium.com, is one of many that are available, and its use in this tutorial does not constitute an endorsement or recommendation.</span></span>

<span data-ttu-id="6d434-119">若要选择托管提供商准备就绪后，您可以比较功能和中的价格[提供程序库](https://www.microsoft.com/web/hosting)Microsoft.com/web 站点上。</span><span class="sxs-lookup"><span data-stu-id="6d434-119">When you are ready to select your own hosting provider, you can compare features and prices in the [gallery of providers](https://www.microsoft.com/web/hosting) on the Microsoft.com/web site.</span></span>

## <a name="creating-an-account"></a><span data-ttu-id="6d434-120">创建帐户</span><span class="sxs-lookup"><span data-stu-id="6d434-120">Creating an Account</span></span>

<span data-ttu-id="6d434-121">在你所选的提供程序上创建一个帐户。</span><span class="sxs-lookup"><span data-stu-id="6d434-121">Create an account at your selected provider.</span></span> <span data-ttu-id="6d434-122">如果支持完整的 SQL Server 数据库添加了额外，不需要为本教程中，选择它，但您将需要它[迁移到 SQL Server](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12.md)本系列后面的教程。</span><span class="sxs-lookup"><span data-stu-id="6d434-122">If support for a full SQL Server database is an added extra, you do not need to select it for this tutorial, but you'll need it for the [Migrating to SQL Server](deployment-to-a-hosting-provider-migrating-to-sql-server-10-of-12.md) tutorial later in this series.</span></span>

<span data-ttu-id="6d434-123">对于这些教程，您无需注册一个新的域名。</span><span class="sxs-lookup"><span data-stu-id="6d434-123">For these tutorials, you don't have to register a new domain name.</span></span> <span data-ttu-id="6d434-124">您可以进行测试以使用提供程序分配给站点的临时 URL 来验证成功的部署。</span><span class="sxs-lookup"><span data-stu-id="6d434-124">You can test to verify successful deployment by using the temporary URL assigned to the site by the provider.</span></span>

<span data-ttu-id="6d434-125">创建帐户后，您通常收到欢迎电子邮件，其中包含为部署和管理你的网站所需的所有信息。</span><span class="sxs-lookup"><span data-stu-id="6d434-125">After the account has been created, you typically receive a welcome email that contains all the information you need in order to deploy and manage your site.</span></span> <span data-ttu-id="6d434-126">托管提供商向你发送的信息将类似于此处显示的内容。</span><span class="sxs-lookup"><span data-stu-id="6d434-126">The information that your hosting provider sends you will be similar to what is shown here.</span></span> <span data-ttu-id="6d434-127">将发送到新帐户所有者的 Cytanium 欢迎电子邮件包括以下信息：</span><span class="sxs-lookup"><span data-stu-id="6d434-127">The Cytanium welcome email that's sent to new account owners includes the following information:</span></span>

- <span data-ttu-id="6d434-128">提供程序的控件面板站点，您可以为您的网站管理设置的 URL。</span><span class="sxs-lookup"><span data-stu-id="6d434-128">The URL to the provider's control panel site, where you can manage settings for your site.</span></span> <span data-ttu-id="6d434-129">在欢迎电子邮件，以方便参考的此部分包含 ID 和你指定的密码。</span><span class="sxs-lookup"><span data-stu-id="6d434-129">The ID and password you specified are included in this part of the welcome email for easy reference.</span></span> <span data-ttu-id="6d434-130">（同时具有已更改为下图演示值。）</span><span class="sxs-lookup"><span data-stu-id="6d434-130">(Both have been changed to a demo value for this illustration.)</span></span>

    <span data-ttu-id="6d434-131">[![Welcome_Email_Control_Panel_URL](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image2.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-131">[![Welcome_Email_Control_Panel_URL](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image2.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image1.png)</span></span>
- <span data-ttu-id="6d434-132">默认.NET Framework 版本和有关如何对其进行更改的信息。</span><span class="sxs-lookup"><span data-stu-id="6d434-132">The default .NET Framework version and information about how to change it.</span></span> <span data-ttu-id="6d434-133">许多托管站点默认值为 2.0，适用于 ASP.NET 应用程序面向.NET Framework 2.0、 3.0 或 3.5。</span><span class="sxs-lookup"><span data-stu-id="6d434-133">Many hosting sites default to 2.0, which works with ASP.NET applications that target the .NET Framework 2.0, 3.0, or 3.5.</span></span> <span data-ttu-id="6d434-134">但是 Contoso University 是.NET Framework 4 的应用程序，因此需要更改此设置。</span><span class="sxs-lookup"><span data-stu-id="6d434-134">However Contoso University is a .NET Framework 4 application, so you have to change this setting.</span></span> <span data-ttu-id="6d434-135">（为 ASP.NET 4.5 应用程序将使用.NET 4.0 设置。）</span><span class="sxs-lookup"><span data-stu-id="6d434-135">(For an ASP.NET 4.5 application you would use the .NET 4.0 setting.)</span></span>

    <span data-ttu-id="6d434-136">[![Welcome_Email_Framework_Version](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image4.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-136">[![Welcome_Email_Framework_Version](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image4.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image3.png)</span></span>
- <span data-ttu-id="6d434-137">临时 URL 可用于访问你的网站。</span><span class="sxs-lookup"><span data-stu-id="6d434-137">The temporary URL that you can use to access your web site.</span></span> <span data-ttu-id="6d434-138">在创建此帐户后，"contosouniversity.com"输入与现有域的名称。</span><span class="sxs-lookup"><span data-stu-id="6d434-138">When this account was created, "contosouniversity.com" was entered as the existing domain name.</span></span> <span data-ttu-id="6d434-139">因此临时 URL 是`http://contosouniversity.com.vserver01.cytanium.com`。</span><span class="sxs-lookup"><span data-stu-id="6d434-139">Therefore the temporary URL is `http://contosouniversity.com.vserver01.cytanium.com`.</span></span>

    <span data-ttu-id="6d434-140">[![Welcome_Email_Temporary_URL](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image6.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-140">[![Welcome_Email_Temporary_URL](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image6.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image5.png)</span></span>
- <span data-ttu-id="6d434-141">若要了解如何设置数据库，并对其进行访问所需的连接字符串：</span><span class="sxs-lookup"><span data-stu-id="6d434-141">Information about how to set up databases, and the connection strings that you need in order to access them:</span></span>

    <span data-ttu-id="6d434-142">[![Welcome_Email_Database_Info](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image8.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-142">[![Welcome_Email_Database_Info](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image8.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image7.png)</span></span>
- <span data-ttu-id="6d434-143">有关工具和部署你的网站的设置的信息。</span><span class="sxs-lookup"><span data-stu-id="6d434-143">Information about tools and settings for deploying your site.</span></span> <span data-ttu-id="6d434-144">（从 Cytanium 电子邮件还提到 WebMatrix，此处省略了。）</span><span class="sxs-lookup"><span data-stu-id="6d434-144">(The email from Cytanium also mentions WebMatrix, which is omitted here.)</span></span>

    <span data-ttu-id="6d434-145">[![Welcome_Email_Deploy_info](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image10.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-145">[![Welcome_Email_Deploy_info](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image10.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image9.png)</span></span>

## <a name="setting-the-net-framework-version"></a><span data-ttu-id="6d434-146">设置.NET Framework 版本</span><span class="sxs-lookup"><span data-stu-id="6d434-146">Setting the .NET Framework Version</span></span>

<span data-ttu-id="6d434-147">Cytanium 欢迎电子邮件包含指向说明如何更改.NET Framework 的版本。</span><span class="sxs-lookup"><span data-stu-id="6d434-147">The Cytanium welcome email includes a link to instructions on how to change the version of the .NET Framework.</span></span> <span data-ttu-id="6d434-148">这些说明解释了，这可以通过 Cytanium 控制面板。</span><span class="sxs-lookup"><span data-stu-id="6d434-148">These instructions explain that this can be done through the Cytanium control panel.</span></span> <span data-ttu-id="6d434-149">其他提供商拥有控件面板站点看起来相同，或者它们可能指示您要执行此操作以不同方式。</span><span class="sxs-lookup"><span data-stu-id="6d434-149">Other providers have control panel sites that look different, or they may instruct you to do this in a different way.</span></span>

<span data-ttu-id="6d434-150">请转到控制面板 URL。</span><span class="sxs-lookup"><span data-stu-id="6d434-150">Go to the control panel URL.</span></span> <span data-ttu-id="6d434-151">登录后你的用户名和密码，您将看到控制面板。</span><span class="sxs-lookup"><span data-stu-id="6d434-151">After logging in with your user name and password, you see the control panel.</span></span>

<span data-ttu-id="6d434-152">[![Cytanium_Control_Panel](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image12.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-152">[![Cytanium_Control_Panel](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image12.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image11.png)</span></span>

<span data-ttu-id="6d434-153">在中**承载空格**，将指针拖过 Web 图标，并选择**网站**菜单中。</span><span class="sxs-lookup"><span data-stu-id="6d434-153">In the **Hosting Spaces** box, hold the pointer over the Web icon and select **Web Sites** from the menu.</span></span>

<span data-ttu-id="6d434-154">[![Cytanium_Control_Panel_selecting_Web_Sites](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image14.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-154">[![Cytanium_Control_Panel_selecting_Web_Sites](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image14.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image13.png)</span></span>

<span data-ttu-id="6d434-155">在中**网站**框中，单击**contosouniversity.com** （在创建帐户时使用的站点名称）。</span><span class="sxs-lookup"><span data-stu-id="6d434-155">In the **Web Sites** box, click **contosouniversity.com** (the name of the site that you used when you created the account).</span></span>

<span data-ttu-id="6d434-156">[![Cytanium_Control_Panel_selecting_contosouniversity](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image16.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-156">[![Cytanium_Control_Panel_selecting_contosouniversity](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image16.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image15.png)</span></span>

<span data-ttu-id="6d434-157">在中**的 Web 站点属性**框中，选择**扩展**选项卡。</span><span class="sxs-lookup"><span data-stu-id="6d434-157">In the **Web Site Properties** box, select the **Extensions** tab.</span></span>

<span data-ttu-id="6d434-158">[![Cytanium_Control_Panel_Extensions_tab](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image18.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-158">[![Cytanium_Control_Panel_Extensions_tab](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image18.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image17.png)</span></span>

<span data-ttu-id="6d434-159">更改从 ASP.NET **2.0 集成的管道**到**4.0 （集成管道）**，然后单击**更新**。</span><span class="sxs-lookup"><span data-stu-id="6d434-159">Change ASP.NET from **2.0 Integrated Pipeline** to **4.0 (Integrated Pipeline)**, and then click **Update**.</span></span>

## <a name="publishing-to-the-hosting-provider"></a><span data-ttu-id="6d434-160">发布到宿主提供程序</span><span class="sxs-lookup"><span data-stu-id="6d434-160">Publishing to the Hosting Provider</span></span>

<span data-ttu-id="6d434-161">从宿主提供程序的欢迎电子邮件包括所有所需发布该项目的设置和您可以手动输入该信息到发布配置文件。</span><span class="sxs-lookup"><span data-stu-id="6d434-161">The welcome email from the hosting provider includes all of the settings you need in order to publish the project, and you can enter that information manually into a publish profile.</span></span> <span data-ttu-id="6d434-162">但将使用一种更简单和更少出错的方法来配置部署到提供程序： 你将下载 *.publishsettings*文件，并将其导入发布配置文件。</span><span class="sxs-lookup"><span data-stu-id="6d434-162">But you'll use an easier and less error-prone method to configure deployment to the provider: you'll download a *.publishsettings* file and import it into a publish profile.</span></span>

<span data-ttu-id="6d434-163">在浏览器中，转到 Cytanium 控制面板并选择**Web** ，然后选择**Web 站点。**</span><span class="sxs-lookup"><span data-stu-id="6d434-163">In your browser, go to the Cytanium control panel and select **Web** and then select **Web Sites.**</span></span>

![选择网站的控制面板](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image19.png)

<span data-ttu-id="6d434-165">选择**contosouniversity.com** web 站点。</span><span class="sxs-lookup"><span data-stu-id="6d434-165">Select the **contosouniversity.com** web site.</span></span>

![选择 contosouniversity.com 控制面板](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image20.png)

<span data-ttu-id="6d434-167">选择**Web 发布**选项卡。</span><span class="sxs-lookup"><span data-stu-id="6d434-167">Select the **Web Publishing** tab.</span></span>

![控件面板 Web 发布选项卡](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image21.png)

<span data-ttu-id="6d434-169">创建要用于 web 发布通过输入用户名和密码凭据。</span><span class="sxs-lookup"><span data-stu-id="6d434-169">Create credentials to use for web publishing by entering a user name and password.</span></span> <span data-ttu-id="6d434-170">您可以输入用于登录到控制面板上的相同凭据。</span><span class="sxs-lookup"><span data-stu-id="6d434-170">You can enter the same credentials that you use to log on to the control panel.</span></span> <span data-ttu-id="6d434-171">然后单击**启用**。</span><span class="sxs-lookup"><span data-stu-id="6d434-171">Then click **Enable**.</span></span>

![控制面板创建发布凭据](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image22.png)

<span data-ttu-id="6d434-173">单击**下载发布配置文件添加为此网站**。</span><span class="sxs-lookup"><span data-stu-id="6d434-173">Click **Download Publishing Profile for this web site**.</span></span>

![控件面板下载发布配置文件](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image23.png)

<span data-ttu-id="6d434-175">当系统提示打开或保存该文件时，请将其保存。</span><span class="sxs-lookup"><span data-stu-id="6d434-175">When you are prompted to open or save the file, save it.</span></span>

![保存发布配置文件](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image24.png)

<span data-ttu-id="6d434-177">在中**解决方案资源管理器**在 Visual Studio 中，右键单击 ContosoUniversity 项目，然后选择**发布**。</span><span class="sxs-lookup"><span data-stu-id="6d434-177">In **Solution Explorer** in Visual Studio, right-click the ContosoUniversity project and select **Publish**.</span></span> <span data-ttu-id="6d434-178">**发布 Web**上打开对话框**预览**选项卡具有**测试**选择，因为这是你使用的最后一个配置文件的配置文件。</span><span class="sxs-lookup"><span data-stu-id="6d434-178">The **Publish Web** dialog box opens on the **Preview** tab with the **Test** profile selected because that is the last profile you used.</span></span>

<span data-ttu-id="6d434-179">选择**配置文件**选项卡，然后单击**导入**。</span><span class="sxs-lookup"><span data-stu-id="6d434-179">Select the **Profile** tab and then Click **Import**.</span></span>

![发布 Web 向导导入按钮](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image25.png)

<span data-ttu-id="6d434-181">在中**导入发布设置**对话框中，选择 *.publishsettings*文件，下载，然后单击**打开**。</span><span class="sxs-lookup"><span data-stu-id="6d434-181">In the **Import Publish Settings** dialog box, select the *.publishsettings* file that you downloaded, and click **Open**.</span></span> <span data-ttu-id="6d434-182">向导将转到连接选项卡使用的所有字段填充。</span><span class="sxs-lookup"><span data-stu-id="6d434-182">The wizard advances to the Connection tab with all of the fields filled in.</span></span>

![发布 Web 向导连接选项卡](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image26.png)

<span data-ttu-id="6d434-184">.Publishsettings 文件会将该站点的计划内永久 URL 放在目标 URL 框中，但如果未尚未购买的域，将值替换为临时的 URL。</span><span class="sxs-lookup"><span data-stu-id="6d434-184">The .publishsettings file puts the planned permanent URL for the site in the Destination URL box, but if you haven't purchased that domain yet, replace the value with the temporary URL.</span></span> <span data-ttu-id="6d434-185">对于此示例中，URL 是 *[ http://contosouniversity.com.vserver01.cytanium.com ](http://contosouniversity.com.vserver01.cytanium.com)。*</span><span class="sxs-lookup"><span data-stu-id="6d434-185">For this example, the URL is *[http://contosouniversity.com.vserver01.cytanium.com](http://contosouniversity.com.vserver01.cytanium.com).*</span></span> <span data-ttu-id="6d434-186">此框的唯一用途是指定的 URL，浏览器将打开到自动后已成功部署后。</span><span class="sxs-lookup"><span data-stu-id="6d434-186">The only purpose of this box is to specify what URL the browser will open to automatically after successfully after deployment.</span></span> <span data-ttu-id="6d434-187">如果将其留空，唯一后果是在浏览器不会自动启动部署后。</span><span class="sxs-lookup"><span data-stu-id="6d434-187">If you leave it blank, the only consequence is that the browser won't start automatically after deployment.</span></span>

<span data-ttu-id="6d434-188">单击**验证连接**以验证是否设置正确无误，并可以连接到服务器。</span><span class="sxs-lookup"><span data-stu-id="6d434-188">Click **Validate Connection** to verify that the settings are correct and you can connect to the server.</span></span> <span data-ttu-id="6d434-189">如上文所，绿色复选标记验证连接成功。</span><span class="sxs-lookup"><span data-stu-id="6d434-189">As you saw earlier, a green check mark verifies that the connection is successful.</span></span>

<span data-ttu-id="6d434-190">当你单击验证连接时，可能会看到**证书错误**对话框。</span><span class="sxs-lookup"><span data-stu-id="6d434-190">When you click Validate Connection, you might see a **Certificate Error** dialog box.</span></span> <span data-ttu-id="6d434-191">如果这样做，请验证服务器名称是你期望的内容。</span><span class="sxs-lookup"><span data-stu-id="6d434-191">If you do, verify that the server name is what you expect.</span></span> <span data-ttu-id="6d434-192">如果是，则选择**Visual Studio 的将来会话保存此证书**然后单击**接受**。</span><span class="sxs-lookup"><span data-stu-id="6d434-192">If it is, select **Save this certificate for future sessions of Visual Studio** and click **Accept**.</span></span> <span data-ttu-id="6d434-193">（此错误表示宿主提供程序已选择以避免购买 SSL 证书部署到的 url 的费用。</span><span class="sxs-lookup"><span data-stu-id="6d434-193">(This error means that the hosting provider has chosen to avoid the expense of purchasing an SSL certificate for the URL that you are deploying to.</span></span> <span data-ttu-id="6d434-194">如果想要通过使用有效的证书建立安全连接，请联系你托管提供商。）</span><span class="sxs-lookup"><span data-stu-id="6d434-194">If you prefer to establish a secure connection by using a valid certificate, contact your hosting provider.)</span></span>

![证书错误](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image27.png)

<span data-ttu-id="6d434-196">单击 **“下一步”**。</span><span class="sxs-lookup"><span data-stu-id="6d434-196">Click **Next**.</span></span>

<span data-ttu-id="6d434-197">在中**数据库**一部分**设置**选项卡上，输入相同的测试输入值，发布配置文件。</span><span class="sxs-lookup"><span data-stu-id="6d434-197">In the **Databases** section of the **Settings** tab, enter the same values that you entered for the Test publish profile.</span></span> <span data-ttu-id="6d434-198">在下拉列表中，您会发现所需的连接字符串。</span><span class="sxs-lookup"><span data-stu-id="6d434-198">You'll find the connection strings you need in the drop-down lists.</span></span>

- <span data-ttu-id="6d434-199">在连接字符串中的**SchoolContext，** 选择 `Data Source=|DataDirectory|School-Prod.sdf`</span><span class="sxs-lookup"><span data-stu-id="6d434-199">In the connection string box for **SchoolContext,** select `Data Source=|DataDirectory|School-Prod.sdf`</span></span>
- <span data-ttu-id="6d434-200">下**SchoolContext**，选择**应用 Code First 迁移**。</span><span class="sxs-lookup"><span data-stu-id="6d434-200">Under **SchoolContext**, select **Apply Code First Migrations**.</span></span>
- <span data-ttu-id="6d434-201">在连接字符串中的**DefaultConnection**，选择 `Data Source=|DataDirectory|aspnet-Prod.sdf`</span><span class="sxs-lookup"><span data-stu-id="6d434-201">In the connection string box for **DefaultConnection**, select `Data Source=|DataDirectory|aspnet-Prod.sdf`</span></span>
- <span data-ttu-id="6d434-202">下**DefaultConnection**，将保留**更新数据库**清除。</span><span class="sxs-lookup"><span data-stu-id="6d434-202">Under **DefaultConnection**, leave **Update database** cleared.</span></span>

![发布 Web 向导设置选项卡](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image28.png)

<span data-ttu-id="6d434-204">单击 **“下一步”**。</span><span class="sxs-lookup"><span data-stu-id="6d434-204">Click **Next**.</span></span>

<span data-ttu-id="6d434-205">在中**预览版**选项卡上，单击**开始预览**以查看将复制的文件的列表。</span><span class="sxs-lookup"><span data-stu-id="6d434-205">In the **Preview** tab, click **Start Preview** to see a list of the files that will be copied.</span></span> <span data-ttu-id="6d434-206">请参阅上文时在本地计算机上部署到 IIS 的同一列表。</span><span class="sxs-lookup"><span data-stu-id="6d434-206">You see the same list that you saw earlier when you deployed to IIS on the local computer.</span></span>

<span data-ttu-id="6d434-207">在发布之前，更改配置文件的名称，以便将应用你 Web.Production.config 转换文件。</span><span class="sxs-lookup"><span data-stu-id="6d434-207">Before you publish, change the name of the profile so that your Web.Production.config transformation file will be applied.</span></span> <span data-ttu-id="6d434-208">选择**配置文件**选项卡，单击**管理配置文件**。</span><span class="sxs-lookup"><span data-stu-id="6d434-208">Select the **Profile** tab and click **Manage Profiles**.</span></span>

![发布 Web 向导管理配置文件](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image29.png)

<span data-ttu-id="6d434-210">在中**编辑 Web 发布配置文件**对话框框中，选择生产配置文件，单击**重命名**，并将配置文件名称更改为生产环境。</span><span class="sxs-lookup"><span data-stu-id="6d434-210">In the **Edit Web Publish Profiles** dialog box, select the production profile, click **Rename**, and change the profile name to Production.</span></span> <span data-ttu-id="6d434-211">然后单击**关闭**。</span><span class="sxs-lookup"><span data-stu-id="6d434-211">Then click **Close**.</span></span>

![Web 发布配置文件编辑对话框](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image30.png)

<span data-ttu-id="6d434-213">单击“发布” 。</span><span class="sxs-lookup"><span data-stu-id="6d434-213">Click **Publish**.</span></span>

<span data-ttu-id="6d434-214">应用程序发布到宿主提供程序。</span><span class="sxs-lookup"><span data-stu-id="6d434-214">The application is published to the hosting provider.</span></span> <span data-ttu-id="6d434-215">结果显示在**输出**窗口。</span><span class="sxs-lookup"><span data-stu-id="6d434-215">The result shows in the **Output** window.</span></span>

![部署后的输出窗口](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image31.png)

<span data-ttu-id="6d434-217">在浏览器会自动打开指向中输入的 URL**目标 URL**框**连接**选项卡**发布 Web**向导。</span><span class="sxs-lookup"><span data-stu-id="6d434-217">The browser automatically opens to the URL that you entered in **Destination URL** box on the **Connection** tab of the **Publish Web** wizard.</span></span> <span data-ttu-id="6d434-218">你看到相同的主页上为 Visual Studio 中运行站点但现在没有"（测试）"或"（开发）"的标题栏中的环境指示器。</span><span class="sxs-lookup"><span data-stu-id="6d434-218">You see the same home page as when you run the site in Visual Studio, except now there is no "(Test)" or "(Dev)" environment indicator in the title bar.</span></span> <span data-ttu-id="6d434-219">这表示环境指示器*Web.config*转换工作正常。</span><span class="sxs-lookup"><span data-stu-id="6d434-219">This indicates that the environment indicator *Web.config* transformation worked correctly.</span></span>

> [!NOTE]
> <span data-ttu-id="6d434-220">如果你仍看到标题中的"（测试）"，删除*obj*文件夹从 ContosoUniversity 项目并重新部署。</span><span class="sxs-lookup"><span data-stu-id="6d434-220">If you still see "(Test)" in the heading, delete the *obj* folder from the ContosoUniversity project and redeploy.</span></span> <span data-ttu-id="6d434-221">在软件的预发布版本，以前应用的转换文件 (Web.Test.config) 可能会获得应用再次尽管你使用的生产配置文件。</span><span class="sxs-lookup"><span data-stu-id="6d434-221">In pre-release versions of the software, the previously applied transformation file (Web.Test.config) might get applied again although you are using the Production profile.</span></span>


<span data-ttu-id="6d434-222">[![Home_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image33.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-222">[![Home_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image33.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image32.png)</span></span>

<span data-ttu-id="6d434-223">在运行将导致数据库访问的页面之前，请确保 Elmah 能够记录出现的任何错误。</span><span class="sxs-lookup"><span data-stu-id="6d434-223">Before you run a page that causes database access, make sure that Elmah will be able to log any errors that occur.</span></span>

## <a name="setting-folder-permissions-for-elmah"></a><span data-ttu-id="6d434-224">Elmah 的设置文件夹权限</span><span class="sxs-lookup"><span data-stu-id="6d434-224">Setting Folder Permissions for Elmah</span></span>

<span data-ttu-id="6d434-225">本系列教程以前一教程，您还记得，您必须确保应用程序在应用程序中 Elmah 存储错误日志文件的文件夹的写入权限。</span><span class="sxs-lookup"><span data-stu-id="6d434-225">As you remember from the previous tutorial in this series, you must make sure that the application has Write permissions for the folder in your application where Elmah stores error log files.</span></span> <span data-ttu-id="6d434-226">当您部署到 IIS 本地计算机上时，手动设置这些权限。</span><span class="sxs-lookup"><span data-stu-id="6d434-226">When you deployed to IIS locally on your computer, you set those permissions manually.</span></span> <span data-ttu-id="6d434-227">在本部分中，将了解如何以在 Cytanium 设置权限。</span><span class="sxs-lookup"><span data-stu-id="6d434-227">In this section, you'll see how to set permissions at Cytanium.</span></span> <span data-ttu-id="6d434-228">（某些宿主提供程序，则可能无法为此，他们可能会提供一个或多个预定义的文件夹具有写权限。</span><span class="sxs-lookup"><span data-stu-id="6d434-228">(Some hosting providers may not enable you to do this; they may offer one or more predefined folders with Write permissions.</span></span> <span data-ttu-id="6d434-229">在这种情况下你将需要修改应用程序以使用指定的文件夹。）</span><span class="sxs-lookup"><span data-stu-id="6d434-229">In that case you would have to modify your application to use the specified folders.)</span></span>

<span data-ttu-id="6d434-230">Cytanium 控制面板中，可以设置文件夹权限。</span><span class="sxs-lookup"><span data-stu-id="6d434-230">You can set folder permissions in the Cytanium control panel.</span></span> <span data-ttu-id="6d434-231">请转到该控件面板 URL 并选择**文件管理器**。</span><span class="sxs-lookup"><span data-stu-id="6d434-231">Go to the control panel URL and select **File Manager**.</span></span>

<span data-ttu-id="6d434-232">[![Cytanium_Control_Panel_with_File_Manager_selected](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image35.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-232">[![Cytanium_Control_Panel_with_File_Manager_selected](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image35.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image34.png)</span></span>

<span data-ttu-id="6d434-233">在中**文件管理器**框中，选择**contosouniversity.com** ，然后**wwwroot**若要查看应用程序的根文件夹。</span><span class="sxs-lookup"><span data-stu-id="6d434-233">In the **File Manager** box, select **contosouniversity.com** and then **wwwroot** to see the application's root folder.</span></span> <span data-ttu-id="6d434-234">单击挂锁图标旁边**Elmah**。</span><span class="sxs-lookup"><span data-stu-id="6d434-234">Click the padlock icon next to **Elmah**.</span></span>

<span data-ttu-id="6d434-235">[![Cytanium_Control_Panel_File_Manager_at_root_folder](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image37.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-235">[![Cytanium_Control_Panel_File_Manager_at_root_folder](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image37.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image36.png)</span></span>

<span data-ttu-id="6d434-236">在中**文件**/**文件夹权限**窗口中，选择**读取**并**编写**对应的复选框**contosouniversity.com**然后单击**设置的权限**。</span><span class="sxs-lookup"><span data-stu-id="6d434-236">In the **File**/**Folder Permissions** window, select the **Read** and **Write** checkboxes for **contosouniversity.com** and click **Set Permissions**.</span></span>

<span data-ttu-id="6d434-237">[![Cytanium_Control_Panel_File_Folder_Permissions_Elmah](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image39.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-237">[![Cytanium_Control_Panel_File_Folder_Permissions_Elmah](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image39.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image38.png)</span></span>

<span data-ttu-id="6d434-238">请确保 Elmah 具有写入访问权限*Elmah*从而导致错误，然后显示 Elmah 错误报告的文件夹。</span><span class="sxs-lookup"><span data-stu-id="6d434-238">Make sure that Elmah has write access to the *Elmah* folder by causing an error and then displaying the Elmah error report.</span></span> <span data-ttu-id="6d434-239">请求无效的 URL，如*Studentsxxx.aspx*。</span><span class="sxs-lookup"><span data-stu-id="6d434-239">Request an invalid URL like *Studentsxxx.aspx*.</span></span> <span data-ttu-id="6d434-240">正如之前一样，您看到*GenericErrorPage.aspx*页。</span><span class="sxs-lookup"><span data-stu-id="6d434-240">As before, you see the *GenericErrorPage.aspx* page.</span></span> <span data-ttu-id="6d434-241">单击**注销**链接，然后再运行*Elmah.axd*。</span><span class="sxs-lookup"><span data-stu-id="6d434-241">Click the **Log Out** link, and then run *Elmah.axd*.</span></span> <span data-ttu-id="6d434-242">您获得**日志中**首先，页验证*Web.config*转换已成功添加 Elmah 授权。</span><span class="sxs-lookup"><span data-stu-id="6d434-242">You get the **Log In** page first, which validates that the *Web.config* transform successfully added Elmah authorization.</span></span> <span data-ttu-id="6d434-243">在你登录后，您将看到显示只是导致该错误的报表。</span><span class="sxs-lookup"><span data-stu-id="6d434-243">After you log in, you see the report that shows the error you just caused.</span></span>

<span data-ttu-id="6d434-244">[![Elmah.axd_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image41.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-244">[![Elmah.axd_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image41.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image40.png)</span></span>

## <a name="testing-in-the-production-environment"></a><span data-ttu-id="6d434-245">在生产环境中测试</span><span class="sxs-lookup"><span data-stu-id="6d434-245">Testing in the Production Environment</span></span>

<span data-ttu-id="6d434-246">运行**学生**页。</span><span class="sxs-lookup"><span data-stu-id="6d434-246">Run the **Students** page.</span></span> <span data-ttu-id="6d434-247">应用程序尝试访问 School 数据库第一次，这会触发代码优先迁移来创建数据库。</span><span class="sxs-lookup"><span data-stu-id="6d434-247">The application tries to access the School database for the first time, which triggers Code First Migrations to create the database.</span></span> <span data-ttu-id="6d434-248">在该页面将显示一段时间延迟后，可看到没有任何学生。</span><span class="sxs-lookup"><span data-stu-id="6d434-248">When the page displays after a moment's delay, it shows that there are no students.</span></span>

<span data-ttu-id="6d434-249">[![Students_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image43.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-249">[![Students_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image43.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image42.png)</span></span>

<span data-ttu-id="6d434-250">运行**讲师**页以验证种子数据已成功在数据库中插入讲师数据。</span><span class="sxs-lookup"><span data-stu-id="6d434-250">Run the **Instructors** page to verify that the Seed data successfully inserted instructor data in the database.</span></span>

<span data-ttu-id="6d434-251">[![Instructors_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image45.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-251">[![Instructors_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image45.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image44.png)</span></span>

<span data-ttu-id="6d434-252">与你在测试环境中，你想要验证数据库更新在生产环境中工作，但你通常不希望插入您的生产数据库输入测试数据。</span><span class="sxs-lookup"><span data-stu-id="6d434-252">As you did in the test environment, you want to verify that database updates work in the production environment, but you typically do not want to enter test data into your production database.</span></span> <span data-ttu-id="6d434-253">对于本教程，将使用相同的方法在测试中一样。</span><span class="sxs-lookup"><span data-stu-id="6d434-253">For this tutorial, you'll use the same method you did in test.</span></span> <span data-ttu-id="6d434-254">但在实际的应用程序可能想要查找的方法，用于验证该数据库的更新，以成功而不会引入到生产数据库的测试数据。</span><span class="sxs-lookup"><span data-stu-id="6d434-254">But in a real application you might want to find a method that validates that database updates are successful without introducing test data into the production database.</span></span> <span data-ttu-id="6d434-255">在某些应用程序，可能会不切实际中添加了内容并将其删除。</span><span class="sxs-lookup"><span data-stu-id="6d434-255">In some applications, it might be practical to add something and then delete it.</span></span>

<span data-ttu-id="6d434-256">添加一名学生，然后查看输入中的数据**学生**页后，可以验证是否可以更新数据库中的数据。</span><span class="sxs-lookup"><span data-stu-id="6d434-256">Add a student and then view the data you entered in the **Students** page to verify that you can update data in the database.</span></span>

<span data-ttu-id="6d434-257">[![Add_Students_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image47.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-257">[![Add_Students_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image47.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image46.png)</span></span>

<span data-ttu-id="6d434-258">[![Students_page_with_new_student_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image49.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-258">[![Students_page_with_new_student_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image49.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image48.png)</span></span>

<span data-ttu-id="6d434-259">验证授权规则正常工作，可以通过选择**更新信用额度**从**课程**菜单。</span><span class="sxs-lookup"><span data-stu-id="6d434-259">Validate that authorization rules are working correctly by selecting **Update Credits** from the **Courses** menu.</span></span> <span data-ttu-id="6d434-260">**日志中**显示页。</span><span class="sxs-lookup"><span data-stu-id="6d434-260">The **Log In** page is displayed.</span></span> <span data-ttu-id="6d434-261">输入你的管理员帐户凭据，请单击**日志中**，并**更新信用额度**显示页。</span><span class="sxs-lookup"><span data-stu-id="6d434-261">Enter your administrator account credentials, click **Log In**, and the **Update Credits** page is displayed.</span></span>

<span data-ttu-id="6d434-262">[![Log_In_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image51.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-262">[![Log_In_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image51.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image50.png)</span></span>

<span data-ttu-id="6d434-263">如果登录成功，**更新信用额度**显示页。</span><span class="sxs-lookup"><span data-stu-id="6d434-263">If login is successful, the **Update Credits** page is displayed.</span></span> <span data-ttu-id="6d434-264">这表示已成功部署 ASP.NET 成员资格数据库 （使用单一的管理员帐户）。</span><span class="sxs-lookup"><span data-stu-id="6d434-264">This indicates that the ASP.NET membership database (with the single administrator account) was successfully deployed.</span></span>

<span data-ttu-id="6d434-265">[![Update_Credits_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image53.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="6d434-265">[![Update_Credits_page_Prod](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image53.png)](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/_static/image52.png)</span></span>

<span data-ttu-id="6d434-266">你现在已成功部署和测试你的站点，它可公开通过 Internet。</span><span class="sxs-lookup"><span data-stu-id="6d434-266">You have now successfully deployed and tested your site and it is available publicly over the Internet.</span></span>

## <a name="creating-a-more-reliable-test-environment"></a><span data-ttu-id="6d434-267">创建更可靠的测试环境</span><span class="sxs-lookup"><span data-stu-id="6d434-267">Creating a More Reliable Test Environment</span></span>

<span data-ttu-id="6d434-268">中所述[部署到测试环境](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12.md)教程中，最可靠的测试环境是在只需像生产帐户托管提供商的第二个帐户。</span><span class="sxs-lookup"><span data-stu-id="6d434-268">As explained in the [Deploying to the Test Environment](deployment-to-a-hosting-provider-deploying-to-iis-as-a-test-environment-5-of-12.md) tutorial, the most reliable test environment would be a second account at the hosting provider that's just like the production account.</span></span> <span data-ttu-id="6d434-269">这将是比作为测试环境中，使用本地 IIS，因为您将不得不注册第二个托管帐户开销更大。</span><span class="sxs-lookup"><span data-stu-id="6d434-269">This would be more expensive than using local IIS as your test environment, since you would have to sign up for a second hosting account.</span></span> <span data-ttu-id="6d434-270">但如果它会阻止生产站点错误或服务中断，可能会决定，因此有必要的成本。</span><span class="sxs-lookup"><span data-stu-id="6d434-270">But if it prevents production site errors or outages, you might decide that it's worth the cost.</span></span>

<span data-ttu-id="6d434-271">用于创建和部署到测试帐户过程中的大部分是类似于什么已经设置部署到生产环境：</span><span class="sxs-lookup"><span data-stu-id="6d434-271">Most of the process for creating and deploying to a test account is similar to what you've already done to deploy to production:</span></span>

- <span data-ttu-id="6d434-272">创建*Web.config*转换文件。</span><span class="sxs-lookup"><span data-stu-id="6d434-272">Create a *Web.config* transformation file.</span></span>
- <span data-ttu-id="6d434-273">在托管提供商创建一个帐户。</span><span class="sxs-lookup"><span data-stu-id="6d434-273">Create an account at the hosting provider.</span></span>
- <span data-ttu-id="6d434-274">创建新的发布配置文件并将部署到测试帐户。</span><span class="sxs-lookup"><span data-stu-id="6d434-274">Create a new publish profile and deploy to the test account.</span></span>

### <a name="preventing-public-access-to-the-test-site"></a><span data-ttu-id="6d434-275">测试站点中阻止公共访问权限</span><span class="sxs-lookup"><span data-stu-id="6d434-275">Preventing Public Access to the Test Site</span></span>

<span data-ttu-id="6d434-276">测试帐户的重要考虑事项是它将实时 Internet 上，但你不希望使用它的公共。</span><span class="sxs-lookup"><span data-stu-id="6d434-276">An important consideration for the test account is that it will be live on the Internet, but you don't want the public to use it.</span></span> <span data-ttu-id="6d434-277">若要保持专用站点可以使用一个或多个以下方法：</span><span class="sxs-lookup"><span data-stu-id="6d434-277">To keep the site private you can use one or more of the following methods:</span></span>

- <span data-ttu-id="6d434-278">请联系托管提供商设置仅允许访问到测试的站点将用于测试的 IP 地址的防火墙规则。</span><span class="sxs-lookup"><span data-stu-id="6d434-278">Contact the hosting provider to set firewall rules that allow access to the testing site only from IP addresses that you use for testing.</span></span>
- <span data-ttu-id="6d434-279">伪装 URL，以便它不是类似于公共站点的 URL。</span><span class="sxs-lookup"><span data-stu-id="6d434-279">Disguise the URL so that it is not similar to the public site's URL.</span></span>
- <span data-ttu-id="6d434-280">使用*robots.txt*文件以确保，搜索引擎不会爬网测试站点和报表链接到它在搜索结果中。</span><span class="sxs-lookup"><span data-stu-id="6d434-280">Use a *robots.txt* file to ensure that search engines will not crawl the test site and report links to it in search results.</span></span>

<span data-ttu-id="6d434-281">第一种方法是显然最安全的但为此，该过程是特定于每个宿主提供程序并不将在本教程中介绍。</span><span class="sxs-lookup"><span data-stu-id="6d434-281">The first of these methods is obviously the most secure, but the procedure for that is specific to each hosting provider and will not be covered in this tutorial.</span></span> <span data-ttu-id="6d434-282">如果执行排列通过托管提供商以允许仅你的 IP 地址浏览到测试帐户 URL，您从理论上无需担心如何搜索引擎对其进行爬网。</span><span class="sxs-lookup"><span data-stu-id="6d434-282">If you do arrange with your hosting provider to allow only your IP address to browse to the test account URL, you theoretically don't have to worry about search engines crawling it.</span></span> <span data-ttu-id="6d434-283">但即使在这种情况下，部署*robots.txt*文件作为备份是一个好主意，以防意外关闭的防火墙规则。</span><span class="sxs-lookup"><span data-stu-id="6d434-283">But even in that case, deploying a *robots.txt* file is a good idea as a backup in case that firewall rule is ever accidentally turned off.</span></span>

<span data-ttu-id="6d434-284">*Robots.txt*文件出现在项目文件夹中，应在其中具有以下文本：</span><span class="sxs-lookup"><span data-stu-id="6d434-284">The *robots.txt* file goes in your project folder and should have the following text in it:</span></span>

[!code-console[Main](deployment-to-a-hosting-provider-deploying-to-the-production-environment-7-of-12/samples/sample1.cmd)]

<span data-ttu-id="6d434-285">`User-agent`一行告诉文件中的规则适用于所有搜索引擎 web 爬网程序 （机器人） 的搜索引擎和`Disallow`行指定应在站点上的任何页已爬网。</span><span class="sxs-lookup"><span data-stu-id="6d434-285">The `User-agent` line tells search engines that the rules in the file apply to all search engine web crawlers (robots), and the `Disallow` line specifies that no pages on the site should be crawled.</span></span>

<span data-ttu-id="6d434-286">您可能希望搜索引擎目录生产站点，因此您需要从生产部署中排除此文件。</span><span class="sxs-lookup"><span data-stu-id="6d434-286">You probably do want search engines to catalog your production site, so you need to exclude this file from production deployment.</span></span> <span data-ttu-id="6d434-287">若要执行此操作，请参阅**可以排除特定文件或文件夹从部署？** 中[ASP.NET Web 应用程序项目部署常见问题](https://msdn.microsoft.com/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment)。</span><span class="sxs-lookup"><span data-stu-id="6d434-287">To do that, see **Can I exclude specific files or folders from deployment?** in [ASP.NET Web Application Project Deployment FAQ](https://msdn.microsoft.com/library/ee942158.aspx#can_i_exclude_specific_files_or_folders_from_deployment).</span></span> <span data-ttu-id="6d434-288">请确保仅对生产发布配置文件指定排除。</span><span class="sxs-lookup"><span data-stu-id="6d434-288">Make sure that you specify the exclusion only for the Production publish profile.</span></span>

<span data-ttu-id="6d434-289">创建第二个托管帐户是一种方法使用的测试环境不是必需的但可能需要额外的费用。</span><span class="sxs-lookup"><span data-stu-id="6d434-289">Creating a second hosting account is an approach to working with a test environment that is not required but might be worth the added expense.</span></span> <span data-ttu-id="6d434-290">在以下教程中，您将继续为将 IIS 用作你的测试环境。</span><span class="sxs-lookup"><span data-stu-id="6d434-290">In the following tutorials, you'll continue to use IIS as your test environment.</span></span>

<span data-ttu-id="6d434-291">在下一步的教程中，将更新应用程序代码，并将所做的更改部署到测试和生产环境。</span><span class="sxs-lookup"><span data-stu-id="6d434-291">In the next tutorial, you'll update application code and deploy your change to the test and production environments.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="6d434-292">[上一页](deployment-to-a-hosting-provider-setting-folder-permissions-6-of-12.md)
> [下一页](deployment-to-a-hosting-provider-deploying-a-code-only-update-8-of-12.md)</span><span class="sxs-lookup"><span data-stu-id="6d434-292">[Previous](deployment-to-a-hosting-provider-setting-folder-permissions-6-of-12.md)
[Next](deployment-to-a-hosting-provider-deploying-a-code-only-update-8-of-12.md)</span></span>

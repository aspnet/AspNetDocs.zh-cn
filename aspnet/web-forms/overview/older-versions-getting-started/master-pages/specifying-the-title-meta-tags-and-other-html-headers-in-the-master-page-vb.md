---
uid: web-forms/overview/older-versions-getting-started/master-pages/specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb
title: 指定母版页中的标题、元标记和其他 HTML 标头（VB） |Microsoft Docs
author: rick-anderson
description: 查看用于在 "内容" 页中定义母版页中的 &lt;head&gt; 元素的不同技术。
ms.author: riande
ms.date: 05/21/2008
ms.assetid: ea8196f5-039d-43ec-8447-8997ad4d3900
msc.legacyurl: /web-forms/overview/older-versions-getting-started/master-pages/specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb
msc.type: authoredcontent
ms.openlocfilehash: 160af664cdf27f9ede1273aaf915da749a39ad48
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2019
ms.locfileid: "74637727"
---
# <a name="specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb"></a><span data-ttu-id="eed39-103">指定母版页中的标题、元标记和其他 HTML 标头 (VB)</span><span class="sxs-lookup"><span data-stu-id="eed39-103">Specifying the Title, Meta Tags, and Other HTML Headers in the Master Page (VB)</span></span>

<span data-ttu-id="eed39-104">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="eed39-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="eed39-105">[下载代码](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_03_VB.zip)或[下载 PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_03_VB.pdf)</span><span class="sxs-lookup"><span data-stu-id="eed39-105">[Download Code](https://download.microsoft.com/download/e/e/f/eef369f5-743a-4a52-908f-b6532c4ce0a4/ASPNET_MasterPages_Tutorial_03_VB.zip) or [Download PDF](https://download.microsoft.com/download/8/f/6/8f6349e4-6554-405a-bcd7-9b094ba5089a/ASPNET_MasterPages_Tutorial_03_VB.pdf)</span></span>

> <span data-ttu-id="eed39-106">查看用于在 "内容" 页中定义母版页中的 &lt;head&gt; 元素的不同技术。</span><span class="sxs-lookup"><span data-stu-id="eed39-106">Looks at different techniques for defining assorted &lt;head&gt; elements in the Master Page from the content page.</span></span>

## <a name="introduction"></a><span data-ttu-id="eed39-107">简介</span><span class="sxs-lookup"><span data-stu-id="eed39-107">Introduction</span></span>

<span data-ttu-id="eed39-108">默认情况下，在 Visual Studio 2008 中创建的新母版页具有两个 ContentPlaceHolder 控件：一个名为 `head`，位于 `<head>` 元素中;并在 Web 窗体中放置一个名为 `ContentPlaceHolder1`。</span><span class="sxs-lookup"><span data-stu-id="eed39-108">New master pages created in Visual Studio 2008 have, by default, two ContentPlaceHolder controls: one named `head`, and located in the `<head>` element; and one named `ContentPlaceHolder1`, placed within the Web Form.</span></span> <span data-ttu-id="eed39-109">`ContentPlaceHolder1` 的目的是在 Web 窗体中定义可以逐页自定义的区域。</span><span class="sxs-lookup"><span data-stu-id="eed39-109">The purpose of `ContentPlaceHolder1` is to define a region in the Web Form that can be customized on a page-by-page basis.</span></span> <span data-ttu-id="eed39-110">`head` ContentPlaceHolder 使页面能够将自定义内容添加到 `<head>` 部分。</span><span class="sxs-lookup"><span data-stu-id="eed39-110">The `head` ContentPlaceHolder enables pages to add custom content to the `<head>` section.</span></span> <span data-ttu-id="eed39-111">（当然，可以修改或删除这两个 Contentplaceholder，并且可能会向母版页添加其他 ContentPlaceHolder。</span><span class="sxs-lookup"><span data-stu-id="eed39-111">(Of course, these two ContentPlaceHolders can be modified or removed, and additional ContentPlaceHolder may be added to the master page.</span></span> <span data-ttu-id="eed39-112">母版页 `Site.master`当前有四个 ContentPlaceHolder 控件。）</span><span class="sxs-lookup"><span data-stu-id="eed39-112">Our master page, `Site.master`, currently has four ContentPlaceHolder controls.)</span></span>

<span data-ttu-id="eed39-113">HTML `<head>` 元素充当有关不属于文档本身的网页文档的信息的存储库。</span><span class="sxs-lookup"><span data-stu-id="eed39-113">The HTML `<head>` element serves as a repository for information about the web page document that is not part of the document itself.</span></span> <span data-ttu-id="eed39-114">其中包括网页标题、搜索引擎或内部爬网程序使用的元信息，以及指向外部资源（如 RSS 源、JavaScript 和 CSS 文件）的链接。</span><span class="sxs-lookup"><span data-stu-id="eed39-114">This includes information such as the web page's title, meta-information used by search engines or internal crawlers, and links to external resources, such as RSS feeds, JavaScript, and CSS files.</span></span> <span data-ttu-id="eed39-115">其中的某些信息可能与网站中的所有页面相关。</span><span class="sxs-lookup"><span data-stu-id="eed39-115">Some of this information may be pertinent to all pages in the website.</span></span> <span data-ttu-id="eed39-116">例如，你可能希望为每个 ASP.NET 页全局导入相同的 CSS 规则和 JavaScript 文件。</span><span class="sxs-lookup"><span data-stu-id="eed39-116">For example, you might want to globally import the same CSS rules and JavaScript files for every ASP.NET page.</span></span> <span data-ttu-id="eed39-117">但 `<head>` 元素的某些部分是页特定的。</span><span class="sxs-lookup"><span data-stu-id="eed39-117">However, there are portions of the `<head>` element that are page-specific.</span></span> <span data-ttu-id="eed39-118">页面标题是一个主要的示例。</span><span class="sxs-lookup"><span data-stu-id="eed39-118">The page title is a prime example.</span></span>

<span data-ttu-id="eed39-119">在本教程中，我们将检查如何在母版页及其内容页中定义全局和特定于页的 `<head>` 节标记。</span><span class="sxs-lookup"><span data-stu-id="eed39-119">In this tutorial we examine how to define global and page-specific `<head>` section markup in the master page and in its content pages.</span></span>

## <a name="examining-the-master-pagesheadsection"></a><span data-ttu-id="eed39-120">检查母版页的`<head>`部分</span><span class="sxs-lookup"><span data-stu-id="eed39-120">Examining the Master Page's`<head>`Section</span></span>

<span data-ttu-id="eed39-121">Visual Studio 2008 创建的默认母版页文件在其 `<head>` 部分中包含以下标记：</span><span class="sxs-lookup"><span data-stu-id="eed39-121">The default master page file created by Visual Studio 2008 contains the following markup in its `<head>` section:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample1.aspx)]

<span data-ttu-id="eed39-122">请注意，`<head>` 元素包含一个 `runat="server"` 属性，该属性指示它是服务器控件（而不是静态 HTML）。</span><span class="sxs-lookup"><span data-stu-id="eed39-122">Notice that the `<head>` element contains a `runat="server"` attribute, which indicates that it is a server control (rather than static HTML).</span></span> <span data-ttu-id="eed39-123">所有 ASP.NET 页派生自 `System.Web.UI` 命名空间中的[`Page` 类](https://msdn.microsoft.com/library/system.web.ui.page.aspx)。</span><span class="sxs-lookup"><span data-stu-id="eed39-123">All ASP.NET pages derive from the [`Page` class](https://msdn.microsoft.com/library/system.web.ui.page.aspx), which is located in the `System.Web.UI` namespace.</span></span> <span data-ttu-id="eed39-124">此类包含一个[`Header` 属性](https://msdn.microsoft.com/library/system.web.ui.page.header.aspx)，该属性提供对页面的 `<head>` 区域的访问权限。</span><span class="sxs-lookup"><span data-stu-id="eed39-124">This class contains a [`Header` property](https://msdn.microsoft.com/library/system.web.ui.page.header.aspx) that provides access to the page's `<head>` region.</span></span> <span data-ttu-id="eed39-125">使用 `Header` 属性，我们可以设置 ASP.NET 页面的标题或向呈现的 `<head>` 部分添加其他标记。</span><span class="sxs-lookup"><span data-stu-id="eed39-125">Using the `Header` property we can set an ASP.NET page's title or add additional markup to the rendered `<head>` section.</span></span> <span data-ttu-id="eed39-126">然后，可以通过在页面的 `Page_Load` 事件处理程序中编写一段代码，自定义内容页的 `<head>` 元素。</span><span class="sxs-lookup"><span data-stu-id="eed39-126">It is possible, then, to customize a content page's `<head>` element by writing a bit of code in the page's `Page_Load` event handler.</span></span> <span data-ttu-id="eed39-127">我们检查如何以编程方式在步骤1中设置页面的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-127">We examine how to programmatically set the page's title in Step 1.</span></span>

<span data-ttu-id="eed39-128">上面 `<head>` 元素中所示的标记还包括一个名为 `head`的 ContentPlaceHolder 控件。</span><span class="sxs-lookup"><span data-stu-id="eed39-128">The markup shown in the `<head>` element above also includes a ContentPlaceHolder control named `head`.</span></span> <span data-ttu-id="eed39-129">此 ContentPlaceHolder 控件不是必需的，因为内容页可以通过编程方式将自定义内容添加到 `<head>` 元素。</span><span class="sxs-lookup"><span data-stu-id="eed39-129">This ContentPlaceHolder control is not necessary, as content pages can add custom content to the `<head>` element programmatically.</span></span> <span data-ttu-id="eed39-130">但在内容页需要将静态标记添加到 `<head>` 元素的情况下很有用，因为可以通过声明方式将静态标记添加到相应的内容控件，而不是以编程方式添加。</span><span class="sxs-lookup"><span data-stu-id="eed39-130">It's useful, however, in situations where a content page needs to add static markup to the `<head>` element as the static markup can be added declaratively to the corresponding Content control rather than programmatically.</span></span>

<span data-ttu-id="eed39-131">除了 `<title>` 元素和 `head` ContentPlaceHolder，母版页的 `<head>` 元素应包含所有页面共有的所有 `<head>`级别的标记。</span><span class="sxs-lookup"><span data-stu-id="eed39-131">In addition to the `<title>` element and `head` ContentPlaceHolder, the master page's `<head>` element should contain any `<head>`-level markup that's common to all pages.</span></span> <span data-ttu-id="eed39-132">在我们的网站中，所有页面都使用 `Styles.css` 文件中定义的 CSS 规则。</span><span class="sxs-lookup"><span data-stu-id="eed39-132">In our website, all pages use the CSS rules defined in the `Styles.css` file.</span></span> <span data-ttu-id="eed39-133">因此，我们更新了 "[*使用母版页创建站点范围布局*](creating-a-site-wide-layout-using-master-pages-vb.md)" 教程中的 `<head>` 元素，以包含相应的 `<link>` 元素。</span><span class="sxs-lookup"><span data-stu-id="eed39-133">Consequently, we updated the `<head>` element in the [*Creating a Site-Wide Layout with Master Pages*](creating-a-site-wide-layout-using-master-pages-vb.md) tutorial to include a corresponding `<link>` element.</span></span> <span data-ttu-id="eed39-134">`Site.master` 母版页的当前 `<head>` 标记如下所示。</span><span class="sxs-lookup"><span data-stu-id="eed39-134">Our `Site.master` master page's current `<head>` markup is shown below.</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample2.aspx)]

## <a name="step-1-setting-a-content-pages-title"></a><span data-ttu-id="eed39-135">步骤1：设置内容页的标题</span><span class="sxs-lookup"><span data-stu-id="eed39-135">Step 1: Setting a Content Page's Title</span></span>

<span data-ttu-id="eed39-136">网页标题是通过 `<title>` 元素指定的。</span><span class="sxs-lookup"><span data-stu-id="eed39-136">The web page's title is specified via the `<title>` element.</span></span> <span data-ttu-id="eed39-137">必须将每个页面的标题设置为合适的值。</span><span class="sxs-lookup"><span data-stu-id="eed39-137">It is important to set each page's title to an appropriate value.</span></span> <span data-ttu-id="eed39-138">访问某个页面时，其标题将显示在浏览器的标题栏中。</span><span class="sxs-lookup"><span data-stu-id="eed39-138">When visiting a page, its title is displayed in the browser's Title bar.</span></span> <span data-ttu-id="eed39-139">此外，在为页面添加书签时，浏览器使用页面标题作为书签的建议名称。</span><span class="sxs-lookup"><span data-stu-id="eed39-139">Additionally, when bookmarking a page, browsers use the page's title as the suggested name for the bookmark.</span></span> <span data-ttu-id="eed39-140">另外，许多搜索引擎在显示搜索结果时显示页面的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-140">Also, many search engines show the page's title when displaying search results.</span></span>

> [!NOTE]
> <span data-ttu-id="eed39-141">默认情况下，Visual Studio 会将母版页中的 `<title>` 元素设置为 "无标题页"。</span><span class="sxs-lookup"><span data-stu-id="eed39-141">By default, Visual Studio sets the `<title>` element in the master page to "Untitled Page".</span></span> <span data-ttu-id="eed39-142">同样，新的 ASP.NET 页也将其 `<title>` 设置为 "无标题页"。</span><span class="sxs-lookup"><span data-stu-id="eed39-142">Similarly, new ASP.NET pages have their `<title>` set to "Untitled Page", too.</span></span> <span data-ttu-id="eed39-143">由于可能很容易忘记将页面的标题设置为适当的值，因此 Internet 上的多个页面的标题为 "无标题页"。</span><span class="sxs-lookup"><span data-stu-id="eed39-143">Because it can be easy to forget to set the page's title to an appropriate value, there are many pages on the Internet with the title "Untitled Page".</span></span> <span data-ttu-id="eed39-144">在 Google for 带有此标题的网页中，会返回大约2460000的结果。</span><span class="sxs-lookup"><span data-stu-id="eed39-144">Searching Google for web pages with this title returns roughly 2,460,000 results.</span></span> <span data-ttu-id="eed39-145">即使 Microsoft 也容易发布标题为 "无标题页" 的网页。</span><span class="sxs-lookup"><span data-stu-id="eed39-145">Even Microsoft is susceptible to publishing web pages with the title "Untitled Page".</span></span> <span data-ttu-id="eed39-146">撰写本文时，Google search 在 Microsoft.com 域中报告了236这样的网页。</span><span class="sxs-lookup"><span data-stu-id="eed39-146">At the time of this writing, a Google search reported 236 such web pages in the Microsoft.com domain.</span></span>

<span data-ttu-id="eed39-147">ASP.NET 页可通过以下方式之一指定其标题：</span><span class="sxs-lookup"><span data-stu-id="eed39-147">An ASP.NET page can specify its title in one of the following ways:</span></span>

- <span data-ttu-id="eed39-148">通过将值直接置于 `<title>` 元素中</span><span class="sxs-lookup"><span data-stu-id="eed39-148">By placing the value directly within the `<title>` element</span></span>
- <span data-ttu-id="eed39-149">在 `<%@ Page %>` 指令中使用 `Title` 特性</span><span class="sxs-lookup"><span data-stu-id="eed39-149">Using the `Title` attribute in the `<%@ Page %>` directive</span></span>
- <span data-ttu-id="eed39-150">使用 `Page.Title="title"` 或 `Page.Header.Title="title"`等代码以编程方式设置页面的 `Title` 属性。</span><span class="sxs-lookup"><span data-stu-id="eed39-150">Programmatically setting the page's `Title` property using code like `Page.Title="title"` or `Page.Header.Title="title"`.</span></span>

<span data-ttu-id="eed39-151">内容页没有 `<title>` 元素，因为它是在母版页中定义的。</span><span class="sxs-lookup"><span data-stu-id="eed39-151">Content pages don't have a `<title>` element, as it's defined in the master page.</span></span> <span data-ttu-id="eed39-152">因此，若要设置内容页的标题，可以使用 `<%@ Page %>` 指令的 `Title` 特性，也可以通过编程方式进行设置。</span><span class="sxs-lookup"><span data-stu-id="eed39-152">Therefore, to set a content page's title you can either use the `<%@ Page %>` directive's `Title` attribute or set it programmatically.</span></span>

### <a name="setting-the-pages-title-declaratively"></a><span data-ttu-id="eed39-153">以声明方式设置页面标题</span><span class="sxs-lookup"><span data-stu-id="eed39-153">Setting the Page's Title Declaratively</span></span>

<span data-ttu-id="eed39-154">内容页的标题可通过[`<%@ Page %>` 指令](https://msdn.microsoft.com/library/ydy4x04a.aspx)的 `Title` 属性以声明方式进行设置。</span><span class="sxs-lookup"><span data-stu-id="eed39-154">A content page's title can be set declaratively through the `Title` attribute of the [`<%@ Page %>` directive](https://msdn.microsoft.com/library/ydy4x04a.aspx).</span></span> <span data-ttu-id="eed39-155">可以通过直接修改 `<%@ Page %>` 指令或属性窗口来设置此属性。</span><span class="sxs-lookup"><span data-stu-id="eed39-155">This property can be set by directly modifying the `<%@ Page %>` directive or through the Properties window.</span></span> <span data-ttu-id="eed39-156">让我们看看这两种方法。</span><span class="sxs-lookup"><span data-stu-id="eed39-156">Let's look at both approaches.</span></span>

<span data-ttu-id="eed39-157">从 "源" 视图中，找到 `<%@ Page %>` 指令，该指令位于页面的声明性标记的顶部。</span><span class="sxs-lookup"><span data-stu-id="eed39-157">From the Source view, locate the `<%@ Page %>` directive, which is at the top of the page's declarative markup.</span></span> <span data-ttu-id="eed39-158">`Default.aspx` 的 `<%@ Page %>` 指令如下：</span><span class="sxs-lookup"><span data-stu-id="eed39-158">The `<%@ Page %>` directive for `Default.aspx` follows:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample3.aspx)]

<span data-ttu-id="eed39-159">`<%@ Page %>` 指令指定 ASP.NET 引擎在分析和编译页面时使用的特定于页的属性。</span><span class="sxs-lookup"><span data-stu-id="eed39-159">The `<%@ Page %>` directive specifies page-specific attributes used by the ASP.NET engine when parsing and compiling the page.</span></span> <span data-ttu-id="eed39-160">这包括其母版页文件、其代码文件的位置及其标题以及其他信息。</span><span class="sxs-lookup"><span data-stu-id="eed39-160">This includes its master page file, the location of its code file, and its title, among other information.</span></span>

<span data-ttu-id="eed39-161">默认情况下，在创建新的内容页时，Visual Studio 会将 `Title` 特性设置为 "无标题页"。</span><span class="sxs-lookup"><span data-stu-id="eed39-161">By default, when creating a new content page Visual Studio sets the `Title` attribute to "Untitled Page".</span></span> <span data-ttu-id="eed39-162">将 `Default.aspx`的 `Title` 属性从 "无标题页面" 更改为 "母版页教程"，然后通过浏览器查看页面。</span><span class="sxs-lookup"><span data-stu-id="eed39-162">Change `Default.aspx`'s `Title` attribute from "Untitled Page" to "Master Page Tutorials" and then view the page through a browser.</span></span> <span data-ttu-id="eed39-163">图1显示了浏览器的标题栏，其中反映了新的页面标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-163">Figure 1 shows the browser's Title bar, which reflects the new page title.</span></span>

![现在，浏览器的标题栏显示 &quot;母版页教程&quot;，而不是 &quot;无标题页&quot;](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image1.png)

<span data-ttu-id="eed39-165">**图 01**：浏览器的标题栏现在显示 "母版页教程" 而不是 "无标题页"</span><span class="sxs-lookup"><span data-stu-id="eed39-165">**Figure 01**: The Browser's Title Bar Now Shows "Master Page Tutorials" Instead of "Untitled Page"</span></span>

<span data-ttu-id="eed39-166">还可以从属性窗口设置页的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-166">The page's title may also be set from the Properties window.</span></span> <span data-ttu-id="eed39-167">从 "属性窗口中，从下拉列表中选择" 文档 "以加载页面级属性，其中包括" `Title` "属性。</span><span class="sxs-lookup"><span data-stu-id="eed39-167">From the Properties window, select DOCUMENT from the drop-down list to load the page-level properties, which includes the `Title` property.</span></span> <span data-ttu-id="eed39-168">图2显示了 `Title` 设置为 "母版页教程" 后的属性窗口。</span><span class="sxs-lookup"><span data-stu-id="eed39-168">Figure 2 shows the Properties window after `Title` has been set to "Master Page Tutorials".</span></span>

![你还可以从 "属性" 窗口配置标题。](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image2.png)

<span data-ttu-id="eed39-170">**图 02**：你也可以从 "属性" 窗口配置标题</span><span class="sxs-lookup"><span data-stu-id="eed39-170">**Figure 02**: You May Configure the Title from the Properties Window, Too</span></span>

### <a name="setting-the-pages-title-programmatically"></a><span data-ttu-id="eed39-171">以编程方式设置页面标题</span><span class="sxs-lookup"><span data-stu-id="eed39-171">Setting the Page's Title Programmatically</span></span>

<span data-ttu-id="eed39-172">ASP.NET 引擎呈现页面时，母版页的 `<head runat="server">` 标记将转换为[`HtmlHead` 的类](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.aspx)实例。</span><span class="sxs-lookup"><span data-stu-id="eed39-172">The master page's `<head runat="server">` markup is translated into an [`HtmlHead` class](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.aspx) instance when the page is rendered by the ASP.NET engine.</span></span> <span data-ttu-id="eed39-173">`HtmlHead` 类具有一个[`Title` 属性](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.title.aspx)，其值在呈现的 `<title>` 元素中反映出来。</span><span class="sxs-lookup"><span data-stu-id="eed39-173">The `HtmlHead` class has a [`Title` property](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlhead.title.aspx) whose value is reflected in the rendered `<title>` element.</span></span> <span data-ttu-id="eed39-174">可以通过 `Page.Header.Title`从 ASP.NET 页的代码隐藏类访问此属性;还可以通过 `Page.Title`访问此同一属性。</span><span class="sxs-lookup"><span data-stu-id="eed39-174">This property is accessible from an ASP.NET page's code-behind class via `Page.Header.Title`; this same property can also be accessed via `Page.Title`.</span></span>

<span data-ttu-id="eed39-175">若要以编程方式设置页面标题的设置，请导航到 `About.aspx` 页的代码隐藏类，并为该页的 `Load` 事件创建事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="eed39-175">To practice setting the page's title programmatically, navigate to the `About.aspx` page's code-behind class and create an event handler for the page's `Load` event.</span></span> <span data-ttu-id="eed39-176">接下来，将页面的标题设置为 "母版页教程：： About：： *date*"，其中*date*为当前日期。</span><span class="sxs-lookup"><span data-stu-id="eed39-176">Next, set the page's title to "Master Page Tutorials :: About :: *date*", where *date* is the current date.</span></span> <span data-ttu-id="eed39-177">添加此代码后，`Page_Load` 事件处理程序应类似于以下内容：</span><span class="sxs-lookup"><span data-stu-id="eed39-177">After adding this code your `Page_Load` event handler should look similar to the following:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample4.vb)]

<span data-ttu-id="eed39-178">图3显示了访问 `About.aspx` 页面时浏览器的标题栏。</span><span class="sxs-lookup"><span data-stu-id="eed39-178">Figure 3 shows the browser's title bar when visiting the `About.aspx` page.</span></span>

![页面标题以编程方式设置并包含当前日期](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image3.png)

<span data-ttu-id="eed39-180">**图 03**：页面标题以编程方式设置并包含当前日期</span><span class="sxs-lookup"><span data-stu-id="eed39-180">**Figure 03**: The Page's Title is Programmatically Set and Includes the Current Date</span></span>

## <a name="step-2-automatically-assigning-a-page-title"></a><span data-ttu-id="eed39-181">步骤2：自动分配页面标题</span><span class="sxs-lookup"><span data-stu-id="eed39-181">Step 2: Automatically Assigning a Page Title</span></span>

<span data-ttu-id="eed39-182">如我们在步骤1中所述，可以通过声明方式或编程方式设置页面的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-182">As we saw in Step 1, a page's title can be set declaratively or programmatically.</span></span> <span data-ttu-id="eed39-183">但是，如果您忘记将标题显式更改为更具描述性的内容，则页面将具有默认标题 "无标题页"。</span><span class="sxs-lookup"><span data-stu-id="eed39-183">If you forget to explicitly change the title to something more descriptive, however, your page will have the default title, "Untitled Page".</span></span> <span data-ttu-id="eed39-184">理想情况下，如果未显式指定其值，则会为我们自动设置页面的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-184">Ideally, the page's title would be set automatically for us in the event that we don't explicitly specify its value.</span></span> <span data-ttu-id="eed39-185">例如，如果在运行时页面的标题为 "无标题页"，我们可能希望将标题自动更新为与 ASP.NET 页的文件名相同。</span><span class="sxs-lookup"><span data-stu-id="eed39-185">For example, if at runtime the page's title is "Untitled Page", we might want to have the title automatically updated to be the same as the ASP.NET page's filename.</span></span> <span data-ttu-id="eed39-186">好消息是，有一点前期工作就可以自动分配标题了。</span><span class="sxs-lookup"><span data-stu-id="eed39-186">The good news is that with a little bit of upfront work it is possible to have the title automatically assigned.</span></span>

<span data-ttu-id="eed39-187">所有 ASP.NET 网页均派生自 System.web 命名空间中的 `Page` 类。</span><span class="sxs-lookup"><span data-stu-id="eed39-187">All ASP.NET web pages derive from the `Page` class in the System.Web.UI namespace.</span></span> <span data-ttu-id="eed39-188">`Page` 类定义 ASP.NET 页面所需的最少功能，并公开 `IsPostBack`、`IsValid`、`Request`和 `Response`等重要属性。</span><span class="sxs-lookup"><span data-stu-id="eed39-188">The `Page` class defines the minimal functionality needed by an ASP.NET page and exposes essential properties like `IsPostBack`, `IsValid`, `Request`, and `Response`, among many others.</span></span> <span data-ttu-id="eed39-189">通常，web 应用程序中的每个页面都需要其他特性或功能。</span><span class="sxs-lookup"><span data-stu-id="eed39-189">Oftentimes, every page in a web application requires additional features or functionality.</span></span> <span data-ttu-id="eed39-190">提供此方法的一种常用方法是创建一个自定义基本页类。</span><span class="sxs-lookup"><span data-stu-id="eed39-190">A common way of providing this is to create a custom base page class.</span></span> <span data-ttu-id="eed39-191">自定义基本页类是您创建的类，该类派生自 `Page` 类并包含附加功能。</span><span class="sxs-lookup"><span data-stu-id="eed39-191">A custom base page class is a class you create that derives from the `Page` class and includes additional functionality.</span></span> <span data-ttu-id="eed39-192">一旦创建了此基类，就可以让 ASP.NET 页面从其派生（而不是 `Page` 类），从而为 ASP.NET 页面提供扩展功能。</span><span class="sxs-lookup"><span data-stu-id="eed39-192">Once this base class has been created, you can have your ASP.NET pages derive from it (rather than the `Page` class), thereby offering the extended functionality to your ASP.NET pages.</span></span>

<span data-ttu-id="eed39-193">在此步骤中，我们将创建一个基本页，如果未显式设置标题，则会自动将该页面的标题设置为 ASP.NET 页的文件名。</span><span class="sxs-lookup"><span data-stu-id="eed39-193">In this step we create a base page that automatically sets the page's title to the ASP.NET page's filename if the title has not otherwise been explicitly set.</span></span> <span data-ttu-id="eed39-194">步骤3介绍了如何根据站点地图设置页面标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-194">Step 3 looks at setting the page's title based on the site map.</span></span>

> [!NOTE]
> <span data-ttu-id="eed39-195">创建和使用自定义基类类的彻底检查超出了本系列教程的范围。</span><span class="sxs-lookup"><span data-stu-id="eed39-195">A thorough examination of creating and using custom base page classes is beyond the scope of this tutorial series.</span></span> <span data-ttu-id="eed39-196">有关详细信息，请阅读将[自定义基类用于 ASP.NET 页面的代码隐藏类](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="eed39-196">For more information, read [Using a Custom Base Class for Your ASP.NET Pages' Code-Behind Classes](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx).</span></span>

### <a name="creating-the-base-page-class"></a><span data-ttu-id="eed39-197">创建基本页类</span><span class="sxs-lookup"><span data-stu-id="eed39-197">Creating the Base Page Class</span></span>

<span data-ttu-id="eed39-198">我们的第一个任务是创建基类类，该类是一个扩展 `Page` 类的类。</span><span class="sxs-lookup"><span data-stu-id="eed39-198">Our first task is to create a base page class, which is a class that extends the `Page` class.</span></span> <span data-ttu-id="eed39-199">首先，通过右键单击解决方案资源管理器中的项目名称，选择 "添加 ASP.NET" 文件夹，然后选择 "`App_Code`"，开始向项目添加 `App_Code` 文件夹。</span><span class="sxs-lookup"><span data-stu-id="eed39-199">Start by adding an `App_Code` folder to your project by right-clicking on the project name in the Solution Explorer, choosing Add ASP.NET Folder, and then selecting `App_Code`.</span></span> <span data-ttu-id="eed39-200">接下来，右键单击 "`App_Code`" 文件夹，并添加名为 "`BasePage.vb`" 的新类。</span><span class="sxs-lookup"><span data-stu-id="eed39-200">Next, right-click on the `App_Code` folder and add a new class named `BasePage.vb`.</span></span> <span data-ttu-id="eed39-201">图4显示了 `App_Code` 文件夹和 `BasePage.vb` 类添加后解决方案资源管理器。</span><span class="sxs-lookup"><span data-stu-id="eed39-201">Figure 4 shows the Solution Explorer after the `App_Code` folder and `BasePage.vb` class have been added.</span></span>

![添加 App_Code 文件夹和名为 BasePage 的类](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image4.png)

<span data-ttu-id="eed39-203">**图 04**：添加 `App_Code` 文件夹和名为 `BasePage` 的类</span><span class="sxs-lookup"><span data-stu-id="eed39-203">**Figure 04**: Add an `App_Code` Folder and a Class Named `BasePage`</span></span>

> [!NOTE]
> <span data-ttu-id="eed39-204">Visual Studio 支持以下两种模式的项目管理：网站项目和 Web 应用程序项目。</span><span class="sxs-lookup"><span data-stu-id="eed39-204">Visual Studio supports two modes of project management: Web Site Projects and Web Application Projects.</span></span> <span data-ttu-id="eed39-205">`App_Code` 文件夹设计为与网站项目模型一起使用。</span><span class="sxs-lookup"><span data-stu-id="eed39-205">The `App_Code` folder is designed to be used with the Web Site Project model.</span></span> <span data-ttu-id="eed39-206">如果使用的是 Web 应用程序项目模型，请将 `BasePage.vb` 类放置在一个名为 "`App_Code`以外的文件夹，如 `Classes`"。</span><span class="sxs-lookup"><span data-stu-id="eed39-206">If you are using the Web Application Project model, place the `BasePage.vb` class in a folder named something other than `App_Code`, such as `Classes`.</span></span> <span data-ttu-id="eed39-207">有关本主题的详细信息，请参阅将网站[项目迁移到 Web 应用程序项目](http://webproject.scottgu.com/VisualBasic/Migration2/Migration2.aspx)。</span><span class="sxs-lookup"><span data-stu-id="eed39-207">For more information on this topic, refer to [Migrating a Web Site Project to a Web Application Project](http://webproject.scottgu.com/VisualBasic/Migration2/Migration2.aspx).</span></span>

<span data-ttu-id="eed39-208">因为自定义基本页充当 ASP.NET 页的代码隐藏类的基类，所以它需要扩展 `Page` 类。</span><span class="sxs-lookup"><span data-stu-id="eed39-208">Because the custom base page serves as the base class for ASP.NET pages' code-behind classes, it needs to extend the `Page` class.</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample5.vb)]

<span data-ttu-id="eed39-209">每次请求 ASP.NET 页时，它都会经历一系列阶段，请求页中的 culminating 将呈现为 HTML。</span><span class="sxs-lookup"><span data-stu-id="eed39-209">Whenever an ASP.NET page is requested it proceeds through a series of stages, culminating in the requested page being rendered into HTML.</span></span> <span data-ttu-id="eed39-210">可以通过重写 `Page` 类的 `OnEvent` 方法来利用阶段。</span><span class="sxs-lookup"><span data-stu-id="eed39-210">We can tap into a stage by overriding the `Page` class's `OnEvent` method.</span></span> <span data-ttu-id="eed39-211">对于我们的基本页，如果未通过 `LoadComplete` 阶段显式指定标题，则会自动设置该标题（这在您可能已经猜到 `Load` 阶段后发生）。</span><span class="sxs-lookup"><span data-stu-id="eed39-211">For our base page let's automatically set the title if it has not been explicitly specified by the `LoadComplete` stage (which, as you might have guessed, occurs after the `Load` stage).</span></span>

<span data-ttu-id="eed39-212">若要实现此目的，请重写 `OnLoadComplete` 方法，并输入以下代码：</span><span class="sxs-lookup"><span data-stu-id="eed39-212">To accomplish this, override the `OnLoadComplete` method and enter the following code:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample6.vb)]

<span data-ttu-id="eed39-213">`OnLoadComplete` 方法首先确定 `Title` 属性是否尚未显式设置。</span><span class="sxs-lookup"><span data-stu-id="eed39-213">The `OnLoadComplete` method starts by determining if the `Title` property has not yet been explicitly set.</span></span> <span data-ttu-id="eed39-214">如果 `Title` 属性为 `Nothing`，则为空字符串，或具有值 "无标题页"，则会将其分配给请求的 ASP.NET 页的文件名。</span><span class="sxs-lookup"><span data-stu-id="eed39-214">If the `Title` property is `Nothing`, an empty string, or has the value "Untitled Page", it is assigned to the filename of the requested ASP.NET page.</span></span> <span data-ttu-id="eed39-215">例如，可以通过 `Request.PhysicalPath` 属性访问请求的 ASP.NET 页 `C:\MySites\Tutorial03\Login.aspx`的物理路径。</span><span class="sxs-lookup"><span data-stu-id="eed39-215">The physical path to the requested ASP.NET page - `C:\MySites\Tutorial03\Login.aspx`, for example - is accessible via the `Request.PhysicalPath` property.</span></span> <span data-ttu-id="eed39-216">`Path.GetFileNameWithoutExtension` 方法仅提取文件名部分，然后将此文件名分配给 `Page.Title` 属性。</span><span class="sxs-lookup"><span data-stu-id="eed39-216">The `Path.GetFileNameWithoutExtension` method is used to pull out just the filename portion, and this filename is then assigned to the `Page.Title` property.</span></span>

> [!NOTE]
> <span data-ttu-id="eed39-217">我邀请您增强这一逻辑，以改善标题的格式。</span><span class="sxs-lookup"><span data-stu-id="eed39-217">I invite you to enhance this logic to improve the format of the title.</span></span> <span data-ttu-id="eed39-218">例如，如果 `Company-Products.aspx`页面的文件名，则上述代码将生成标题 "Company-Products"，但理想情况下，破折号会替换为空格，如 "公司产品" 中所示。</span><span class="sxs-lookup"><span data-stu-id="eed39-218">For example, if the page's filename is `Company-Products.aspx`, the above code will produce the title "Company-Products", but ideally the dash would be replaced with a space, as in "Company Products".</span></span> <span data-ttu-id="eed39-219">另外，请考虑在出现大小写更改时添加一个空格。</span><span class="sxs-lookup"><span data-stu-id="eed39-219">Also, consider adding a space whenever there's a case change.</span></span> <span data-ttu-id="eed39-220">也就是说，请考虑添加代码，将文件名 `OurBusinessHours.aspx` 转换为 "我们的营业时间" 的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-220">That is, consider adding code that transforms the filename `OurBusinessHours.aspx` to a title of "Our Business Hours".</span></span>

### <a name="having-the-content-pages-inherit-the-base-page-class"></a><span data-ttu-id="eed39-221">使内容页继承基本页类</span><span class="sxs-lookup"><span data-stu-id="eed39-221">Having the Content Pages Inherit the Base Page Class</span></span>

<span data-ttu-id="eed39-222">现在，我们需要更新站点中的 ASP.NET 页面，使其从自定义基本页（`BasePage`）而不是 `Page` 类派生。</span><span class="sxs-lookup"><span data-stu-id="eed39-222">We now need to update the ASP.NET pages in our site to derive from the custom base page (`BasePage`) instead of the `Page` class.</span></span> <span data-ttu-id="eed39-223">若要完成此操作，请转到每个代码隐藏类，并从以下位置更改类声明：</span><span class="sxs-lookup"><span data-stu-id="eed39-223">To accomplish this go to each code-behind class and change the class declaration from:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample7.vb)]

<span data-ttu-id="eed39-224">结束时间：</span><span class="sxs-lookup"><span data-stu-id="eed39-224">To:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample8.vb)]

<span data-ttu-id="eed39-225">完成此操作后，通过浏览器访问站点。</span><span class="sxs-lookup"><span data-stu-id="eed39-225">After doing so, visit the site through a browser.</span></span> <span data-ttu-id="eed39-226">如果访问其标题被显式设置的页面（如 `Default.aspx` 或 `About.aspx`），则使用显式指定的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-226">If you visit a page whose title is explicitly set, such as `Default.aspx` or `About.aspx`, the explicitly specified title is used.</span></span> <span data-ttu-id="eed39-227">但是，如果您访问其标题尚未从默认值（"无标题页"）更改的页，则基本页类会将标题设置为该页的文件名。</span><span class="sxs-lookup"><span data-stu-id="eed39-227">If, however, you visit a page whose title has not been changed from the default ("Untitled Page"), the base page class sets the title to the page's filename.</span></span>

<span data-ttu-id="eed39-228">图5显示了通过浏览器查看 `MultipleContentPlaceHolders.aspx` 页面。</span><span class="sxs-lookup"><span data-stu-id="eed39-228">Figure 5 shows the `MultipleContentPlaceHolders.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="eed39-229">请注意，标题正好是页面的文件名（更少扩展名），"MultipleContentPlaceHolders"。</span><span class="sxs-lookup"><span data-stu-id="eed39-229">Note that the title is precisely the page's filename (less the extension), "MultipleContentPlaceHolders".</span></span>

<span data-ttu-id="eed39-230">[![如果未显式指定标题，则自动使用页面的文件名](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image6.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="eed39-230">[![If a Title is Not Explicitly Specified, the Page's Filename is Automatically Used](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image6.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image5.png)</span></span>

<span data-ttu-id="eed39-231">**图 05**：如果未显式指定标题，则自动使用页面的文件名（[单击以查看完全大小的图像](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image7.png)）</span><span class="sxs-lookup"><span data-stu-id="eed39-231">**Figure 05**: If a Title is Not Explicitly Specified, the Page's Filename is Automatically Used  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image7.png))</span></span>

## <a name="step-3-basing-the-page-title-on-the-site-map"></a><span data-ttu-id="eed39-232">步骤3：在站点图上基于页面标题</span><span class="sxs-lookup"><span data-stu-id="eed39-232">Step 3: Basing the Page Title on the Site Map</span></span>

<span data-ttu-id="eed39-233">ASP.NET 提供了一个强大的站点地图框架，使页面开发人员能够在外部资源（如 XML 文件或数据库表）中定义一个层次结构的站点地图，并提供 Web 控件以显示有关站点地图的信息（例如 SiteMapPath）。菜单和 TreeView 控件）。</span><span class="sxs-lookup"><span data-stu-id="eed39-233">ASP.NET offers a robust site map framework that enables page developers to define a hierarchical site map in an external resource (such as an XML file or database table) along with Web controls for displaying information about the site map (such as the SiteMapPath, Menu, and TreeView controls).</span></span>

<span data-ttu-id="eed39-234">还可以从 ASP.NET 页的代码隐藏类以编程方式访问站点地图结构。</span><span class="sxs-lookup"><span data-stu-id="eed39-234">The site map structure can also be accessed programmatically from an ASP.NET page's code-behind class.</span></span> <span data-ttu-id="eed39-235">通过这种方式，我们可以自动将页面标题设置为站点地图中其对应节点的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-235">In this manner we can automatically set a page's title to the title of its corresponding node in the site map.</span></span> <span data-ttu-id="eed39-236">让我们来增强在步骤2中创建的 `BasePage` 类，使其提供此功能。</span><span class="sxs-lookup"><span data-stu-id="eed39-236">Let's enhance the `BasePage` class created in Step 2 so that it offers this functionality.</span></span> <span data-ttu-id="eed39-237">但首先我们需要为站点创建一个站点图。</span><span class="sxs-lookup"><span data-stu-id="eed39-237">But first we need to create a site map for our site.</span></span>

> [!NOTE]
> <span data-ttu-id="eed39-238">本教程假定读者已经熟悉 ASP。净地图功能。</span><span class="sxs-lookup"><span data-stu-id="eed39-238">This tutorial assumes the reader already is familiar with ASP.NET's site map features.</span></span> <span data-ttu-id="eed39-239">有关使用站点地图的详细信息，请参阅我的多部分文章系列，[检查 ASP。网络导航](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="eed39-239">For more information on using the site map, consult my multi-part article series, [Examining ASP.NET's Site Navigation](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx).</span></span>

### <a name="creating-the-site-map"></a><span data-ttu-id="eed39-240">创建站点地图</span><span class="sxs-lookup"><span data-stu-id="eed39-240">Creating the Site Map</span></span>

<span data-ttu-id="eed39-241">站点地图系统是在[提供程序模型](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx)的上方构建的，后者将站点地图 API 与在内存和永久存储之间序列化站点地图信息的逻辑分离。</span><span class="sxs-lookup"><span data-stu-id="eed39-241">The site map system is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), which decouples the site map API from the logic that serializes site map information between memory and a persistent store.</span></span> <span data-ttu-id="eed39-242">.NET Framework 附带了[`XmlSiteMapProvider` 类](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx)，这是默认的站点地图提供程序。</span><span class="sxs-lookup"><span data-stu-id="eed39-242">The .NET Framework ships with the [`XmlSiteMapProvider` class](https://msdn.microsoft.com/library/system.web.xmlsitemapprovider.aspx), which is the default site map provider.</span></span> <span data-ttu-id="eed39-243">顾名思义，`XmlSiteMapProvider` 使用 XML 文件作为其站点地图存储区。</span><span class="sxs-lookup"><span data-stu-id="eed39-243">As its name implies, `XmlSiteMapProvider` uses an XML file as its site map store.</span></span> <span data-ttu-id="eed39-244">让我们使用此提供程序来定义我们的网站图。</span><span class="sxs-lookup"><span data-stu-id="eed39-244">Let's use this provider for defining our site map.</span></span>

<span data-ttu-id="eed39-245">首先在网站的根文件夹中创建一个名为 "`Web.sitemap`" 的站点映射文件。</span><span class="sxs-lookup"><span data-stu-id="eed39-245">Start by creating a site map file in the website's root folder named `Web.sitemap`.</span></span> <span data-ttu-id="eed39-246">若要实现此目的，请在解决方案资源管理器中右键单击网站名称，选择 "添加新项"，然后选择 "站点地图" 模板。</span><span class="sxs-lookup"><span data-stu-id="eed39-246">To accomplish this, right-click on the website name in Solution Explorer, choose Add New Item, and select the Site Map template.</span></span> <span data-ttu-id="eed39-247">确保该文件命名为 "`Web.sitemap`"，然后单击 "添加"。</span><span class="sxs-lookup"><span data-stu-id="eed39-247">Ensure that the file is named `Web.sitemap` and click Add.</span></span>

<span data-ttu-id="eed39-248">[![将名为 web.sitemap 的文件添加到网站的根文件夹中](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image9.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="eed39-248">[![Add a File Named Web.sitemap to the Website's Root Folder](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image9.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image8.png)</span></span>

<span data-ttu-id="eed39-249">**图 06**：将名为 `Web.sitemap` 的文件添加到网站的根文件夹（[单击查看完全大小的映像](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="eed39-249">**Figure 06**: Add a File Named `Web.sitemap` to the Website's Root Folder  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image10.png))</span></span>

<span data-ttu-id="eed39-250">将以下 XML 添加到 `Web.sitemap` 文件：</span><span class="sxs-lookup"><span data-stu-id="eed39-250">Add the following XML to the `Web.sitemap` file:</span></span>

[!code-xml[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample9.xml)]

<span data-ttu-id="eed39-251">此 XML 定义图7中所示的层次结构站点地图结构。</span><span class="sxs-lookup"><span data-stu-id="eed39-251">This XML defines the hierarchical site map structure shown in Figure 7.</span></span>

![站点地图当前由三个站点地图节点组成](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image11.png)

<span data-ttu-id="eed39-253">**图 07**：站点地图当前由三个站点地图节点组成</span><span class="sxs-lookup"><span data-stu-id="eed39-253">**Figure 07**: The Site Map is Currently Composed of Three Site Map Nodes</span></span>

<span data-ttu-id="eed39-254">我们将在将来的教程中更新站点地图结构，因为我们添加了新的示例。</span><span class="sxs-lookup"><span data-stu-id="eed39-254">We will update the site map structure in future tutorials as we add new examples.</span></span>

### <a name="updating-the-master-page-to-include-navigation-web-controls"></a><span data-ttu-id="eed39-255">更新母版页以包含导航 Web 控件</span><span class="sxs-lookup"><span data-stu-id="eed39-255">Updating the Master Page to Include Navigation Web Controls</span></span>

<span data-ttu-id="eed39-256">现在我们已定义了一个站点地图，接下来请更新母版页，使其包含导航 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="eed39-256">Now that we have a site map defined, let's update the master page to include navigation Web controls.</span></span> <span data-ttu-id="eed39-257">具体而言，让我们将 "ListView" 控件添加到 "课程" 部分中的左栏，该部分将呈现一个无序列表，其中包含站点地图中定义的每个节点的列表项。</span><span class="sxs-lookup"><span data-stu-id="eed39-257">Specifically, let's add a ListView control to the left column in the Lessons section that renders an unordered list with a list item for each node defined in the site map.</span></span>

> [!NOTE]
> <span data-ttu-id="eed39-258">ListView 控件是 ASP.NET 版本3.5 的新控件。</span><span class="sxs-lookup"><span data-stu-id="eed39-258">The ListView control is new to ASP.NET version 3.5.</span></span> <span data-ttu-id="eed39-259">如果使用的是早期版本的 ASP.NET，请改用 Repeater 控件。</span><span class="sxs-lookup"><span data-stu-id="eed39-259">If you are using a prior version of ASP.NET, use the Repeater control instead.</span></span> <span data-ttu-id="eed39-260">有关 ListView 控件的详细信息，请参阅[Using ASP.NET 3.5 的 ListView 和 DataPager 控件](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="eed39-260">For more information on the ListView control, see [Using ASP.NET 3.5's ListView and DataPager Controls](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx).</span></span>

<span data-ttu-id="eed39-261">首先从课程部分删除现有的无序列表标记。</span><span class="sxs-lookup"><span data-stu-id="eed39-261">Start by removing the existing unordered list markup from the Lessons section.</span></span> <span data-ttu-id="eed39-262">接下来，将 "ListView" 控件从 "工具箱" 拖放到课程标题的下方。</span><span class="sxs-lookup"><span data-stu-id="eed39-262">Next, drag a ListView control from the Toolbox and drop it beneath the Lessons heading.</span></span> <span data-ttu-id="eed39-263">ListView 位于工具箱的 "数据" 部分，另一个视图控件与其他视图控件相同： GridView、DetailsView 和 FormView。</span><span class="sxs-lookup"><span data-stu-id="eed39-263">The ListView is located in the Data section of the Toolbox, alongside the other view controls: the GridView, DetailsView, and FormView.</span></span> <span data-ttu-id="eed39-264">将 ListView 的 `ID` 属性设置为 "`LessonsList`"。</span><span class="sxs-lookup"><span data-stu-id="eed39-264">Set the ListView's `ID` property to `LessonsList`.</span></span>

<span data-ttu-id="eed39-265">从 "数据源配置向导" 中，选择将 ListView 绑定到名为 `LessonsDataSource`的新 SiteMapDataSource 控件。</span><span class="sxs-lookup"><span data-stu-id="eed39-265">From the Data Source Configuration Wizard choose to bind the ListView to a new SiteMapDataSource control named `LessonsDataSource`.</span></span> <span data-ttu-id="eed39-266">SiteMapDataSource 控件从站点地图系统返回层次结构。</span><span class="sxs-lookup"><span data-stu-id="eed39-266">The SiteMapDataSource control returns the hierarchical structure from the site map system.</span></span>

<span data-ttu-id="eed39-267">[![将 SiteMapDataSource 控件绑定到 LessonsList ListView 控件](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image13.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="eed39-267">[![Bind a SiteMapDataSource Control to the LessonsList ListView Control](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image13.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image12.png)</span></span>

<span data-ttu-id="eed39-268">**图 08**：将 SiteMapDataSource 控件绑定到 LessonsList ListView 控件（[单击以查看完全大小的图像](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image14.png)）</span><span class="sxs-lookup"><span data-stu-id="eed39-268">**Figure 08**: Bind a SiteMapDataSource Control to the LessonsList ListView Control  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image14.png))</span></span>

<span data-ttu-id="eed39-269">创建 SiteMapDataSource 控件后，需要定义 ListView 的模板，使其为 SiteMapDataSource 控件返回的每个节点呈现一个列表项。</span><span class="sxs-lookup"><span data-stu-id="eed39-269">After creating the SiteMapDataSource control, we need to define the ListView's templates so that it renders an unordered list with a list item for each node returned by the SiteMapDataSource control.</span></span> <span data-ttu-id="eed39-270">可使用以下模板标记完成此操作：</span><span class="sxs-lookup"><span data-stu-id="eed39-270">This can be accomplished using the following template markup:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample10.aspx)]

<span data-ttu-id="eed39-271">`LayoutTemplate` 为无序列表（`<ul>...</ul>`）生成标记，而 `ItemTemplate` 将 SiteMapDataSource 返回的每个项呈现为包含指向特定课程的链接的列表项（`<li>`）。</span><span class="sxs-lookup"><span data-stu-id="eed39-271">The `LayoutTemplate` generates the markup for an unordered list (`<ul>...</ul>`) while the `ItemTemplate` renders each item returned by the SiteMapDataSource as a list item (`<li>`) that contains a link to the particular lesson.</span></span>

<span data-ttu-id="eed39-272">配置 ListView 的模板后，请访问网站。</span><span class="sxs-lookup"><span data-stu-id="eed39-272">After configuring the ListView's templates, visit the website.</span></span> <span data-ttu-id="eed39-273">如图9所示，"课程" 部分包含一个项目符号项 Home。</span><span class="sxs-lookup"><span data-stu-id="eed39-273">As Figure 9 shows, the Lessons section contains a single bulleted item, Home.</span></span> <span data-ttu-id="eed39-274">在哪里可以使用多个 ContentPlaceHolder 控件课程？</span><span class="sxs-lookup"><span data-stu-id="eed39-274">Where are the About and Using Multiple ContentPlaceHolder Controls lessons?</span></span> <span data-ttu-id="eed39-275">SiteMapDataSource 旨在返回分层的数据集，但 ListView 控件只能显示层次结构的一个级别。</span><span class="sxs-lookup"><span data-stu-id="eed39-275">The SiteMapDataSource is designed to return a hierarchical set of data, but the ListView control can only display a single level of the hierarchy.</span></span> <span data-ttu-id="eed39-276">因此，只显示 SiteMapDataSource 返回的第一级站点地图节点。</span><span class="sxs-lookup"><span data-stu-id="eed39-276">Consequently, only the first level of site map nodes returned by the SiteMapDataSource is displayed.</span></span>

<span data-ttu-id="eed39-277">[![课程部分包含单个列表项](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image16.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="eed39-277">[![The Lessons Section Contains a Single List Item](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image16.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image15.png)</span></span>

<span data-ttu-id="eed39-278">**图 09**：课程部分包含单个列表项（[单击以查看完全大小的图像](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image17.png)）</span><span class="sxs-lookup"><span data-stu-id="eed39-278">**Figure 09**: The Lessons Section Contains a Single List Item  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image17.png))</span></span>

<span data-ttu-id="eed39-279">若要显示多个级别，可以在 `ItemTemplate`中嵌套多个 Listview。</span><span class="sxs-lookup"><span data-stu-id="eed39-279">To display multiple levels we could nest multiple ListViews within the `ItemTemplate`.</span></span> <span data-ttu-id="eed39-280">本技术在[*母版页和*](../../data-access/introduction/master-pages-and-site-navigation-vb.md)使用[数据教程系列](../../data-access/index.md)的站点导航教程中进行了检查。</span><span class="sxs-lookup"><span data-stu-id="eed39-280">This technique was examined in the [*Master Pages and Site Navigation* tutorial](../../data-access/introduction/master-pages-and-site-navigation-vb.md) of my [Working with Data tutorial series](../../data-access/index.md).</span></span> <span data-ttu-id="eed39-281">但是，在本教程系列中，我们的网站图只包含两个级别：主页（顶层）;并且每个课程都作为 Home 的子项。</span><span class="sxs-lookup"><span data-stu-id="eed39-281">However, for this tutorial series our site map will contain just a two levels: Home (the top level); and each lesson as a child of Home.</span></span> <span data-ttu-id="eed39-282">我们可以通过将 SiteMapDataSource[属性`ShowStartingNode`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx)设置为 `False`来指示不返回起始节点，而不是手工编写嵌套的 ListView。</span><span class="sxs-lookup"><span data-stu-id="eed39-282">Rather than crafting a nested ListView, we can instead instruct the SiteMapDataSource to not return the starting node by setting its [`ShowStartingNode` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.sitemapdatasource.showstartingnode.aspx) to `False`.</span></span> <span data-ttu-id="eed39-283">最终效果是，SiteMapDataSource 首先返回站点地图节点的第二层。</span><span class="sxs-lookup"><span data-stu-id="eed39-283">The net effect is that the SiteMapDataSource starts by returning the second tier of site map nodes.</span></span>

<span data-ttu-id="eed39-284">进行此更改后，ListView 将显示关于和使用多个 ContentPlaceHolder 控件课程的项目符号项，但省略 Home 的项目符号项。</span><span class="sxs-lookup"><span data-stu-id="eed39-284">With this change, the ListView displays bullet items for the About and Using Multiple ContentPlaceHolder Controls lessons, but omits a bullet item for Home.</span></span> <span data-ttu-id="eed39-285">若要解决此情况，可以在 `LayoutTemplate`中为 Home 显式添加项目符号项：</span><span class="sxs-lookup"><span data-stu-id="eed39-285">To remedy this, we can explicitly add a bullet item for Home in the `LayoutTemplate`:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample11.aspx)]

<span data-ttu-id="eed39-286">通过将 SiteMapDataSource 配置为省略开始节点并显式添加 Home 项目符号项，"课程" 部分现在会显示预期的输出。</span><span class="sxs-lookup"><span data-stu-id="eed39-286">By configuring the SiteMapDataSource to omit the starting node and explicitly adding a Home bullet item, the Lessons section now displays the intended output.</span></span>

<span data-ttu-id="eed39-287">[![课程部分包含 Home 和每个子节点的项目符号项](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image19.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="eed39-287">[![The Lessons Section Contains a Bullet Item for Home and Each Child Node](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image19.png)](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image18.png)</span></span>

<span data-ttu-id="eed39-288">**图 10**： "课程" 部分包含 "主页" 和每个子节点的项目符号项（[单击以查看完全大小的图像](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image20.png)）</span><span class="sxs-lookup"><span data-stu-id="eed39-288">**Figure 10**: The Lessons Section Contains a Bullet Item for Home and Each Child Node  ([Click to view full-size image](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image20.png))</span></span>

### <a name="setting-the-title-based-on-the-site-map"></a><span data-ttu-id="eed39-289">基于站点地图设置标题</span><span class="sxs-lookup"><span data-stu-id="eed39-289">Setting the Title Based on the Site Map</span></span>

<span data-ttu-id="eed39-290">站点映射到位后，可将 `BasePage` 类更新为使用在站点图中指定的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-290">With the site map in place, we can update our `BasePage` class to use the title specified in the site map.</span></span> <span data-ttu-id="eed39-291">正如我们在步骤2中所做的那样，如果页面的标题尚未由页面开发人员显式设置，则我们只希望使用 "站点地图" 节点的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-291">As we did in Step 2, we only want to use the site map node's title if the page's title has not been explicitly set by the page developer.</span></span> <span data-ttu-id="eed39-292">如果请求的页面没有显式设置的页面标题，并且在站点映射中找不到，则我们将回退到使用请求的页面的文件名（较少扩展名），就像我们在步骤2中所做的那样。</span><span class="sxs-lookup"><span data-stu-id="eed39-292">If the page being requested does not have an explicitly set page title and is not found in the site map, then we'll fall back to using the requested page's filename (less the extension), as we did in Step 2.</span></span> <span data-ttu-id="eed39-293">图11说明了此决策过程。</span><span class="sxs-lookup"><span data-stu-id="eed39-293">Figure 11 illustrates this decision process.</span></span>

![如果没有显式设置的页面标题，则使用相应的网站地图节点的标题](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image21.png)

<span data-ttu-id="eed39-295">**图 11**：在没有显式设置页面标题的情况下，将使用相应的网站地图节点的标题</span><span class="sxs-lookup"><span data-stu-id="eed39-295">**Figure 11**: In the Absence of an Explicitly Set Page Title, the Corresponding Site Map Node's Title is Used</span></span>

<span data-ttu-id="eed39-296">更新 `BasePage` 类的 `OnLoadComplete` 方法以包含以下代码：</span><span class="sxs-lookup"><span data-stu-id="eed39-296">Update the `BasePage` class's `OnLoadComplete` method to include the following code:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample12.vb)]

<span data-ttu-id="eed39-297">与之前一样，`OnLoadComplete` 方法首先确定是否已显式设置页面的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-297">As before, the `OnLoadComplete` method starts by determining whether the page's title has been explicitly set.</span></span> <span data-ttu-id="eed39-298">如果 `Page.Title` `Nothing`，则为空字符串，或者为其分配值 "无标题页"，则代码会自动将一个值分配给 `Page.Title`。</span><span class="sxs-lookup"><span data-stu-id="eed39-298">If `Page.Title` is `Nothing`, an empty string, or is assigned the value "Untitled Page" then the code automatically assigns a value to `Page.Title`.</span></span>

<span data-ttu-id="eed39-299">若要确定要使用的标题，代码首先引用[`SiteMap` 类](https://msdn.microsoft.com/library/system.web.sitemap.aspx)的[`CurrentNode` 属性](https://msdn.microsoft.com/library/system.web.sitemap.currentnode.aspx)。</span><span class="sxs-lookup"><span data-stu-id="eed39-299">To determine the title to use, the code starts by referencing the [`SiteMap` class](https://msdn.microsoft.com/library/system.web.sitemap.aspx)'s [`CurrentNode` property](https://msdn.microsoft.com/library/system.web.sitemap.currentnode.aspx).</span></span> <span data-ttu-id="eed39-300">`CurrentNode` 返回站点地图中对应于当前请求的页面的[`SiteMapNode`](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx)实例。</span><span class="sxs-lookup"><span data-stu-id="eed39-300">`CurrentNode` returns the [`SiteMapNode`](https://msdn.microsoft.com/library/system.web.sitemapnode.aspx) instance in the site map that corresponds to the currently requested page.</span></span> <span data-ttu-id="eed39-301">假设当前请求的页面在站点地图中找到，则 `SiteMapNode`的 `Title` 属性分配给页面的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-301">Assuming the currently requested page is found within the site map, the `SiteMapNode`'s `Title` property is assigned to the page's title.</span></span> <span data-ttu-id="eed39-302">如果当前请求的页不在站点地图中，`CurrentNode` 将返回 `Nothing`，并且将请求的页的文件名用作标题（如步骤2中所述）。</span><span class="sxs-lookup"><span data-stu-id="eed39-302">If the currently requested page is not in the site map, `CurrentNode` returns `Nothing` and the requested page's filename is used as the title (as was done in Step 2).</span></span>

<span data-ttu-id="eed39-303">图12显示了通过浏览器查看 `MultipleContentPlaceHolders.aspx` 页面。</span><span class="sxs-lookup"><span data-stu-id="eed39-303">Figure 12 shows the `MultipleContentPlaceHolders.aspx` page when viewed through a browser.</span></span> <span data-ttu-id="eed39-304">由于未显式设置此页面的标题，因此改用其对应的站点地图节点的标题。</span><span class="sxs-lookup"><span data-stu-id="eed39-304">Because this page's title is not explicitly set, its corresponding site map node's title is used instead.</span></span>

![从站点地图中提取 MultipleContentPlaceHolders 页的标题](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/_static/image22.png)

<span data-ttu-id="eed39-306">**图 12**：从站点地图中提取 MultipleContentPlaceHolders 页的标题</span><span class="sxs-lookup"><span data-stu-id="eed39-306">**Figure 12**: The MultipleContentPlaceHolders.aspx Page's Title is Pulled from the Site Map</span></span>

## <a name="step-4-adding-other-page-specific-markup-to-theheadsection"></a><span data-ttu-id="eed39-307">步骤4：将其他特定于页的标记添加到`<head>`节</span><span class="sxs-lookup"><span data-stu-id="eed39-307">Step 4: Adding Other Page-Specific Markup to the`<head>`Section</span></span>

<span data-ttu-id="eed39-308">步骤1、2和3查看逐页自定义 `<title>` 元素。</span><span class="sxs-lookup"><span data-stu-id="eed39-308">Steps 1, 2, and 3 looked at customizing the `<title>` element on a page-by-page basis.</span></span> <span data-ttu-id="eed39-309">除了 `<title>`之外，`<head>` 部分可能包含 `<meta>` 元素和 `<link>` 元素。</span><span class="sxs-lookup"><span data-stu-id="eed39-309">In addition to `<title>`, the `<head>` section may contain `<meta>` elements and `<link>` elements.</span></span> <span data-ttu-id="eed39-310">如本教程前面所述，`Site.master`的 `<head>` 部分包含要 `Styles.css`的 `<link>` 元素。</span><span class="sxs-lookup"><span data-stu-id="eed39-310">As noted earlier in this tutorial, `Site.master`'s `<head>` section includes a `<link>` element to `Styles.css`.</span></span> <span data-ttu-id="eed39-311">由于此 `<link>` 元素在母版页中定义，因此它包含在所有内容页的 `<head>` 部分中。</span><span class="sxs-lookup"><span data-stu-id="eed39-311">Because this `<link>` element is defined within the master page, it is included in the `<head>` section for all content pages.</span></span> <span data-ttu-id="eed39-312">但我们如何逐页地添加 `<meta>` 和 `<link>` 元素呢？</span><span class="sxs-lookup"><span data-stu-id="eed39-312">But how do we go about adding `<meta>` and `<link>` elements on a page-by-page basis?</span></span>

<span data-ttu-id="eed39-313">向 `<head>` 部分添加特定于页面的内容的最简单方法是在母版页中创建 ContentPlaceHolder 控件。</span><span class="sxs-lookup"><span data-stu-id="eed39-313">The easiest way to add page-specific content to the `<head>` section is by creating a ContentPlaceHolder control in the master page.</span></span> <span data-ttu-id="eed39-314">我们已经有了这样的 ContentPlaceHolder （名为 `head`）。</span><span class="sxs-lookup"><span data-stu-id="eed39-314">We already have such a ContentPlaceHolder (named `head`).</span></span> <span data-ttu-id="eed39-315">因此，若要添加自定义 `<head>` 标记，请在页面中创建相应的内容控件，并将标记放在此处。</span><span class="sxs-lookup"><span data-stu-id="eed39-315">Therefore, to add custom `<head>` markup, create a corresponding Content control in the page and place the markup there.</span></span>

<span data-ttu-id="eed39-316">为了说明如何向页面中添加自定义 `<head>` 标记，我们将向我们的当前内容页集提供 `<meta>` 的说明元素。</span><span class="sxs-lookup"><span data-stu-id="eed39-316">To illustrate adding custom `<head>` markup to a page, let's include a `<meta>` description element to our current set of content pages.</span></span> <span data-ttu-id="eed39-317">`<meta>` description 元素提供了有关网页的简要说明;大多数搜索引擎在显示搜索结果时将此信息以某种形式纳入。</span><span class="sxs-lookup"><span data-stu-id="eed39-317">The `<meta>` description element provides a brief description about the web page; most search engines incorporate this information in some form when displaying search results.</span></span>

<span data-ttu-id="eed39-318">`<meta>` description 元素具有以下格式：</span><span class="sxs-lookup"><span data-stu-id="eed39-318">A `<meta>` description element has the following form:</span></span>

[!code-html[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample13.html)]

<span data-ttu-id="eed39-319">若要将此标记添加到内容页，请将以上文本添加到将映射到母版页的 `head` ContentPlaceHolder 的内容控件。</span><span class="sxs-lookup"><span data-stu-id="eed39-319">To add this markup to a content page, add the above text to the Content control that maps to the master page's `head` ContentPlaceHolder.</span></span> <span data-ttu-id="eed39-320">例如，若要定义 `Default.aspx`的 `<meta>` description 元素，请添加以下标记：</span><span class="sxs-lookup"><span data-stu-id="eed39-320">For example, to define a `<meta>` description element for `Default.aspx`, add the following markup:</span></span>

[!code-aspx[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample14.aspx)]

<span data-ttu-id="eed39-321">由于 `head` ContentPlaceHolder 不在 HTML 页的正文中，因此添加到内容控件的标记将不会显示在设计视图中。</span><span class="sxs-lookup"><span data-stu-id="eed39-321">Because the `head` ContentPlaceHolder is not within the HTML page's body, the markup added to the Content control is not displayed in the Design view.</span></span> <span data-ttu-id="eed39-322">若要查看 `<meta>` description 元素，请通过浏览器 `Default.aspx` 访问。</span><span class="sxs-lookup"><span data-stu-id="eed39-322">To see the `<meta>` description element visit `Default.aspx` through a browser.</span></span> <span data-ttu-id="eed39-323">加载页面后，请查看源，并注意 "`<head>`" 部分包括内容控件中指定的标记。</span><span class="sxs-lookup"><span data-stu-id="eed39-323">After the page has been loaded, view the source and note that the `<head>` section includes the markup specified in the Content control.</span></span>

<span data-ttu-id="eed39-324">请花点时间将 `<meta>` 说明元素添加到 `About.aspx`、`MultipleContentPlaceHolders.aspx`和 `Login.aspx`。</span><span class="sxs-lookup"><span data-stu-id="eed39-324">Take a moment to add `<meta>` description elements to `About.aspx`, `MultipleContentPlaceHolders.aspx`, and `Login.aspx`.</span></span>

### <a name="programmatically-adding-markup-to-theheadregion"></a><span data-ttu-id="eed39-325">以编程方式将标记添加到`<head>`区域</span><span class="sxs-lookup"><span data-stu-id="eed39-325">Programmatically Adding Markup to the`<head>`Region</span></span>

<span data-ttu-id="eed39-326">`head` ContentPlaceHolder 允许我们以声明方式向母版页的 `<head>` 区域添加自定义标记。</span><span class="sxs-lookup"><span data-stu-id="eed39-326">The `head` ContentPlaceHolder allows us to declaratively add custom markup to the master page's `<head>` region.</span></span> <span data-ttu-id="eed39-327">还可以通过编程方式添加自定义标记。</span><span class="sxs-lookup"><span data-stu-id="eed39-327">Custom markup may also be added programmatically.</span></span> <span data-ttu-id="eed39-328">请记住，`Page` 类的 `Header` 属性返回在母版页中定义的 `HtmlHead` 实例（`<head runat="server">`）。</span><span class="sxs-lookup"><span data-stu-id="eed39-328">Recall that the `Page` class's `Header` property returns the `HtmlHead` instance defined in the master page (the `<head runat="server">`).</span></span>

<span data-ttu-id="eed39-329">当要添加的内容为动态时，能够以编程方式向 `<head>` 区域添加内容非常有用。</span><span class="sxs-lookup"><span data-stu-id="eed39-329">Being able to programmatically add content to the `<head>` region is useful when the content to add is dynamic.</span></span> <span data-ttu-id="eed39-330">它可能基于访问该页的用户，可能是从数据库中提取的。</span><span class="sxs-lookup"><span data-stu-id="eed39-330">Perhaps it's based on the user visiting the page; maybe it's being pulled from a database.</span></span> <span data-ttu-id="eed39-331">无论出于何种原因，你都可以通过将控件添加 `Controls` 到 `HtmlHead` 来向添加内容，如下所示：</span><span class="sxs-lookup"><span data-stu-id="eed39-331">Regardless of the reason, you can add content to the `HtmlHead` by adding controls to its `Controls` collection like so:</span></span>

[!code-vb[Main](specifying-the-title-meta-tags-and-other-html-headers-in-the-master-page-vb/samples/sample15.vb)]

<span data-ttu-id="eed39-332">上面的代码将 `<meta>` 关键字元素添加到 `<head>` 区域中，该区域提供了用逗号分隔的描述页面的关键字列表。</span><span class="sxs-lookup"><span data-stu-id="eed39-332">The above code adds the `<meta>` keywords element to the `<head>` region, which provides a comma-delimited list of keywords that describe the page.</span></span> <span data-ttu-id="eed39-333">请注意，若要添加 `<meta>` 标记，请创建[`HtmlMeta`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlmeta.aspx)实例，设置其 `Name` 和 `Content` 属性，然后将其添加到 `Header`的 `Controls` 集合中。</span><span class="sxs-lookup"><span data-stu-id="eed39-333">Note that to add a `<meta>` tag you create an [`HtmlMeta`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmlmeta.aspx) instance, set its `Name` and `Content` properties, and then add it to the `Header`'s `Controls` collection.</span></span> <span data-ttu-id="eed39-334">同样，若要以编程方式添加 `<link>` 元素，请创建[`HtmlLink`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmllink.aspx)对象，设置其属性，然后将其添加到 `Header`的 `Controls` 集合。</span><span class="sxs-lookup"><span data-stu-id="eed39-334">Similarly, to programmatically add a `<link>` element, create an [`HtmlLink`](https://msdn.microsoft.com/library/system.web.ui.htmlcontrols.htmllink.aspx) object, set its properties, and then add it to the `Header`'s `Controls` collection.</span></span>

> [!NOTE]
> <span data-ttu-id="eed39-335">若要添加任意标记，请创建[`LiteralControl`](https://msdn.microsoft.com/library/system.web.ui.literalcontrol.aspx)实例，设置其 `Text` 属性，然后将其添加到 `Header`的 `Controls` 集合。</span><span class="sxs-lookup"><span data-stu-id="eed39-335">To add arbitrary markup, create a [`LiteralControl`](https://msdn.microsoft.com/library/system.web.ui.literalcontrol.aspx) instance, set its `Text` property, and then add it to the `Header`'s `Controls` collection.</span></span>

## <a name="summary"></a><span data-ttu-id="eed39-336">总结</span><span class="sxs-lookup"><span data-stu-id="eed39-336">Summary</span></span>

<span data-ttu-id="eed39-337">在本教程中，我们将介绍多种方法来逐页添加 `<head>` 区域标记。</span><span class="sxs-lookup"><span data-stu-id="eed39-337">In this tutorial we looked at a variety of ways to add `<head>` region markup on a page-by-page basis.</span></span> <span data-ttu-id="eed39-338">母版页应该包含具有 ContentPlaceHolder 的 `HtmlHead` 实例（`<head runat="server">`）。</span><span class="sxs-lookup"><span data-stu-id="eed39-338">A master page should include an `HtmlHead` instance (`<head runat="server">`) with a ContentPlaceHolder.</span></span> <span data-ttu-id="eed39-339">`HtmlHead` 实例允许内容页以编程方式访问 `<head>` 区域，并以声明方式和编程方式设置页面的标题;ContentPlaceHolder 控件允许通过内容控件以声明方式将自定义标记添加到 `<head>` 部分。</span><span class="sxs-lookup"><span data-stu-id="eed39-339">The `HtmlHead` instance allows content pages to programmatically access the `<head>` region and to declaratively and programmatically set the page's title; the ContentPlaceHolder control enables custom markup to be added to the `<head>` section declaratively through a Content control.</span></span>

<span data-ttu-id="eed39-340">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="eed39-340">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="eed39-341">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="eed39-341">Further Reading</span></span>

<span data-ttu-id="eed39-342">有关本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="eed39-342">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="eed39-343">在 ASP.NET 中动态设置页面的标题</span><span class="sxs-lookup"><span data-stu-id="eed39-343">Dynamically Setting the Page's Title in ASP.NET</span></span>](http://aspnet.4guysfromrolla.com/articles/051006-1.aspx)
- [<span data-ttu-id="eed39-344">正在检查 ASP。网络站点导航</span><span class="sxs-lookup"><span data-stu-id="eed39-344">Examining ASP.NET's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="eed39-345">如何使用 HTML Meta 标记</span><span class="sxs-lookup"><span data-stu-id="eed39-345">How To Use HTML Meta Tags</span></span>](http://searchenginewatch.com/showPage.html?page=2167931)
- [<span data-ttu-id="eed39-346">ASP.NET 中的母版页</span><span class="sxs-lookup"><span data-stu-id="eed39-346">Master Pages in ASP.NET</span></span>](http://www.odetocode.com/articles/419.aspx)
- [<span data-ttu-id="eed39-347">使用 ASP.NET 3.5 的 ListView 和 DataPager 控件</span><span class="sxs-lookup"><span data-stu-id="eed39-347">Using ASP.NET 3.5's ListView and DataPager Controls</span></span>](http://aspnet.4guysfromrolla.com/articles/122607-1.aspx)
- [<span data-ttu-id="eed39-348">为 ASP.NET 页的代码隐藏类使用自定义基类</span><span class="sxs-lookup"><span data-stu-id="eed39-348">Using a Custom Base Class for Your ASP.NET Pages' Code-Behind Classes</span></span>](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="eed39-349">关于作者</span><span class="sxs-lookup"><span data-stu-id="eed39-349">About the Author</span></span>

<span data-ttu-id="eed39-350">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，创始人的多个 ASP/asp 和4GuysFromRolla.com 的作者已使用 Microsoft Web 技术，1998。</span><span class="sxs-lookup"><span data-stu-id="eed39-350">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="eed39-351">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="eed39-351">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="eed39-352">他的最新书籍是，[*在24小时内，sam ASP.NET 3.5*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="eed39-352">His latest book is [*Sams Teach Yourself ASP.NET 3.5 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="eed39-353">可以通过[http://ScottOnWriting.NET](http://scottonwriting.net/) [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)或通过他的博客访问 Scott。</span><span class="sxs-lookup"><span data-stu-id="eed39-353">Scott can be reached at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="eed39-354">特别感谢</span><span class="sxs-lookup"><span data-stu-id="eed39-354">Special Thanks To</span></span>

<span data-ttu-id="eed39-355">此教程系列由许多有用的审阅者查看。</span><span class="sxs-lookup"><span data-stu-id="eed39-355">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="eed39-356">本教程的领导评审者是 Zack 的 Suchi Banerjee。</span><span class="sxs-lookup"><span data-stu-id="eed39-356">Lead reviewers for this tutorial were Zack Jones and Suchi Banerjee.</span></span> <span data-ttu-id="eed39-357">想要查看我即将发布的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="eed39-357">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="eed39-358">如果是这样，请在[mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)放置一行。</span><span class="sxs-lookup"><span data-stu-id="eed39-358">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="eed39-359">[上一页](multiple-contentplaceholders-and-default-content-vb.md)
> [下一页](urls-in-master-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="eed39-359">[Previous](multiple-contentplaceholders-and-default-content-vb.md)
[Next](urls-in-master-pages-vb.md)</span></span>

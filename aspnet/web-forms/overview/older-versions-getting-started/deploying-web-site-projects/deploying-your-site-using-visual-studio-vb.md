---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
title: 使用 Visual Studio 部署站点（VB） |Microsoft Docs
author: rick-anderson
description: Visual Studio 包含用于部署网站的工具。 在本教程中了解有关这些工具的详细信息。
ms.author: riande
ms.date: 04/01/2009
ms.assetid: 977105f3-7987-4e50-8be7-afb53b4ca28a
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-your-site-using-visual-studio-vb
msc.type: authoredcontent
ms.openlocfilehash: 6c71e36a8a434947882cc767cd2f903ff6e8d422
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2019
ms.locfileid: "74582526"
---
# <a name="deploying-your-site-using-visual-studio-vb"></a><span data-ttu-id="a88b5-104">使用 Visual Studio 部署站点 (VB)</span><span class="sxs-lookup"><span data-stu-id="a88b5-104">Deploying Your Site Using Visual Studio (VB)</span></span>

<span data-ttu-id="a88b5-105">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a88b5-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a88b5-106">[下载代码](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_04_VB.zip)或[下载 PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial04_DeployingViaVS_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="a88b5-106">[Download Code](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_04_VB.zip) or [Download PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial04_DeployingViaVS_vb.pdf)</span></span>

> <span data-ttu-id="a88b5-107">Visual Studio 包含用于部署网站的工具。</span><span class="sxs-lookup"><span data-stu-id="a88b5-107">Visual Studio includes tools for deploying a website.</span></span> <span data-ttu-id="a88b5-108">在本教程中了解有关这些工具的详细信息。</span><span class="sxs-lookup"><span data-stu-id="a88b5-108">Learn more about these tools in this tutorial.</span></span>

## <a name="introduction"></a><span data-ttu-id="a88b5-109">简介</span><span class="sxs-lookup"><span data-stu-id="a88b5-109">Introduction</span></span>

<span data-ttu-id="a88b5-110">前面的教程介绍了如何将简单的 ASP.NET web 应用程序部署到 web 宿主提供程序。</span><span class="sxs-lookup"><span data-stu-id="a88b5-110">The preceding tutorial looked at how to deploy a simple ASP.NET web application to a web host provider.</span></span> <span data-ttu-id="a88b5-111">具体而言，本教程演示了如何使用 FTP 客户端（如 FileZilla）将所需的文件从开发环境传输到生产环境中。</span><span class="sxs-lookup"><span data-stu-id="a88b5-111">Specifically, the tutorial showed how to use an FTP client like FileZilla to transfer the necessary files from the development environment to the production environment.</span></span> <span data-ttu-id="a88b5-112">Visual Studio 还提供了一些内置工具，便于部署到 web 宿主提供程序。</span><span class="sxs-lookup"><span data-stu-id="a88b5-112">Visual Studio also offers built-in tools to facilitate deployment to a web host provider.</span></span> <span data-ttu-id="a88b5-113">本教程将探讨以下两个工具中的两个： "复制网站" 工具，你可以在其中使用 FTP 或 FrontPage 服务器扩展将文件移入和移出远程 Web 服务器。发布工具将整个网站复制到指定位置。</span><span class="sxs-lookup"><span data-stu-id="a88b5-113">This tutorial examines two of these tools: the Copy Web Site tool, where you can move files to and from a remote web server using FTP or FrontPage Server Extensions; and the Publish tool, which copies the entire website to a specified location.</span></span>

> [!NOTE]
> <span data-ttu-id="a88b5-114">Visual Studio 提供的其他与部署相关的工具包括[Web 安装项目](https://msdn.microsoft.com/library/wx3b589t.aspx)和[web 部署项目](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en)外接程序。</span><span class="sxs-lookup"><span data-stu-id="a88b5-114">Other deployment-related tools offered by Visual Studio include [Web Setup Projects](https://msdn.microsoft.com/library/wx3b589t.aspx) and [Web Deployment Projects](https://www.microsoft.com/downloads/details.aspx?FamilyId=0AA30AE8-C73B-4BDD-BB1B-FE697256C459&amp;displaylang=en) Add-In.</span></span> <span data-ttu-id="a88b5-115">Web 安装项目将网站的内容和配置信息打包到单个 MSI 文件中。</span><span class="sxs-lookup"><span data-stu-id="a88b5-115">Web Setup Projects package a website's contents and configuration information into a single MSI file.</span></span> <span data-ttu-id="a88b5-116">此选项最适用于在 intranet 中部署的网站或销售预打包 web 应用程序（客户在其自己的 web 服务器上安装）的公司。</span><span class="sxs-lookup"><span data-stu-id="a88b5-116">This option is most useful for websites that are deployed within an intranet or for companies that sell a pre-packaged web application that customers install on their own web servers.</span></span> <span data-ttu-id="a88b5-117">Web 部署项目外接程序是一个 Visual Studio 外接程序，它有助于指定开发环境和生产环境的生成之间的配置差异。</span><span class="sxs-lookup"><span data-stu-id="a88b5-117">The Web Deployment Projects Add-In is a Visual Studio Add-In that facilitates specifying configuration differences between builds for development environments and production environments.</span></span> <span data-ttu-id="a88b5-118">本系列教程不讨论 Web 安装项目;[*开发和生产教程之间的常见配置差异*](common-configuration-differences-between-development-and-production-vb.md)总结了 Web 部署项目。</span><span class="sxs-lookup"><span data-stu-id="a88b5-118">Web Setup Projects are not discussed in this tutorial series; Web Deployment Projects are summarized in the [*Common Configuration Differences Between Development and Production*](common-configuration-differences-between-development-and-production-vb.md) tutorial.</span></span>

## <a name="deploying-your-site-using-the-copy-web-site-tool"></a><span data-ttu-id="a88b5-119">使用 "复制网站" 工具部署网站</span><span class="sxs-lookup"><span data-stu-id="a88b5-119">Deploying Your Site Using the Copy Web Site Tool</span></span>

<span data-ttu-id="a88b5-120">Visual Studio 的 "复制网站" 工具在功能上类似于独立的 FTP 客户端。</span><span class="sxs-lookup"><span data-stu-id="a88b5-120">Visual Studio's Copy Web Site tool is similar in functionality to a stand-alone FTP client.</span></span> <span data-ttu-id="a88b5-121">简而言之，"复制网站" 工具允许通过 FTP 或 FrontPage 服务器扩展连接到远程网站。</span><span class="sxs-lookup"><span data-stu-id="a88b5-121">In a nutshell, the Copy Web Site tool allows you to connect to a remote web site through FTP or FrontPage Server Extensions.</span></span> <span data-ttu-id="a88b5-122">类似于 FileZilla 的用户界面，"复制网站" 用户界面由两个窗格组成：左窗格列出本地文件，而右窗格列出目标服务器上的文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-122">Similar to FileZilla's user interface, the Copy Web Site user interface consists of two panes: the left pane lists the local files while the right pane lists those files on the destination server.</span></span>

> [!NOTE]
> <span data-ttu-id="a88b5-123">"复制网站" 工具仅适用于网站项目。</span><span class="sxs-lookup"><span data-stu-id="a88b5-123">The Copy Web Site tool is only available for Web Site Projects.</span></span> <span data-ttu-id="a88b5-124">使用 Web 应用程序项目时，Visual Studio 会提供此工具。</span><span class="sxs-lookup"><span data-stu-id="a88b5-124">Visual Studio does offer this tool when you are working with a Web Application Project.</span></span>

<span data-ttu-id="a88b5-125">让我们看一下如何使用 "复制网站" 工具将书籍评审应用程序发布到生产环境。</span><span class="sxs-lookup"><span data-stu-id="a88b5-125">Let's take a look at using the Copy Web Site tool to publish the Book Review application to production.</span></span> <span data-ttu-id="a88b5-126">由于 "复制网站" 工具仅适用于使用网站项目模型的项目，因此我们只能通过 BookReviewsWSP 项目使用此工具进行检查。</span><span class="sxs-lookup"><span data-stu-id="a88b5-126">Because the Copy Web Site tool only works with projects that use the Web Site Project model we can only examine using this tool with the BookReviewsWSP project.</span></span> <span data-ttu-id="a88b5-127">打开该项目。</span><span class="sxs-lookup"><span data-stu-id="a88b5-127">Open that project.</span></span>

<span data-ttu-id="a88b5-128">通过单击解决方案资源管理器中的 "复制网站" 图标来启动 "复制网站" 工具项目（图1中的此图标为圆圈）;或者，您可以从 "网站" 菜单中选择 "复制网站" 选项。</span><span class="sxs-lookup"><span data-stu-id="a88b5-128">Launch the Copy Web Site tool project by clicking the Copy Web Site icon in the Solution Explorer (this icon is circled in Figure 1); alternatively, you can select the Copy Web Site option from the Website menu.</span></span> <span data-ttu-id="a88b5-129">这两种方法都可启动 "复制网站" 用户界面，如图1所示。仅填充图1中的左窗格，因为我们尚未连接到远程服务器。</span><span class="sxs-lookup"><span data-stu-id="a88b5-129">Either approach launches the Copy Web Site user interface shown in Figure 1; only the left pane in Figure 1 is populated because we have yet to connect to a remote server.</span></span>

<span data-ttu-id="a88b5-130">[!["复制网站" 工具的用户界面分为两个窗格](deploying-your-site-using-visual-studio-vb/_static/image2.png)](deploying-your-site-using-visual-studio-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a88b5-130">[![The Copy Web Site Tool's User Interface is Divided Into Two Panes](deploying-your-site-using-visual-studio-vb/_static/image2.png)](deploying-your-site-using-visual-studio-vb/_static/image1.png)</span></span>

<span data-ttu-id="a88b5-131">**图 1**： "复制网站" 工具的用户界面分为两个窗格（[单击以查看完全大小的图像](deploying-your-site-using-visual-studio-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="a88b5-131">**Figure 1**: The Copy Web Site Tool's User Interface is Divided Into Two Panes ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image3.png))</span></span>

<span data-ttu-id="a88b5-132">若要部署站点，需要先连接到 web 主机提供商。</span><span class="sxs-lookup"><span data-stu-id="a88b5-132">In order to deploy our site we need to first connect to the web host provider.</span></span> <span data-ttu-id="a88b5-133">单击 "复制网站" 用户界面顶部的 "连接" 按钮。</span><span class="sxs-lookup"><span data-stu-id="a88b5-133">Click the Connect button at the top of the Copy Web Site user interface.</span></span> <span data-ttu-id="a88b5-134">此时将显示图2所示的 "打开网站" 对话框。</span><span class="sxs-lookup"><span data-stu-id="a88b5-134">This displays the Open Web Site dialog box shown in Figure 2.</span></span>

<span data-ttu-id="a88b5-135">可以通过从左侧选择以下四个选项之一来连接到目标网站：</span><span class="sxs-lookup"><span data-stu-id="a88b5-135">You can connect to the destination website by selecting one of the four options from the left:</span></span>

- <span data-ttu-id="a88b5-136">**文件系统**-选择此项可将你的站点部署到可从你的计算机中访问的文件夹或网络共享。</span><span class="sxs-lookup"><span data-stu-id="a88b5-136">**File System** - select this to deploy your site to a folder or network share accessible from your computer.</span></span>
- <span data-ttu-id="a88b5-137">**本地 IIS** -使用此选项可将站点部署到计算机上安装的 IIS web 服务器。</span><span class="sxs-lookup"><span data-stu-id="a88b5-137">**Local IIS** - use this option to deploy the site to the IIS web server installed on your computer.</span></span>
- <span data-ttu-id="a88b5-138">**Ftp 站点**-使用 ftp 连接到远程网站。</span><span class="sxs-lookup"><span data-stu-id="a88b5-138">**FTP Site** - connect to a remote web site using FTP.</span></span>
- <span data-ttu-id="a88b5-139">**远程站点**-使用 FrontPage 服务器扩展连接到远程网站。</span><span class="sxs-lookup"><span data-stu-id="a88b5-139">**Remote Site** - connect to a remote website using FrontPage Server Extensions.</span></span>

<span data-ttu-id="a88b5-140">大多数 web 宿主提供程序都支持 FTP，但更少提供 FrontPage 服务器扩展支持。</span><span class="sxs-lookup"><span data-stu-id="a88b5-140">Most web host providers support FTP, but fewer offer FrontPage Server Extension support.</span></span> <span data-ttu-id="a88b5-141">出于此原因，我选择了 "FTP 站点" 选项，然后输入连接信息，如图2所示。</span><span class="sxs-lookup"><span data-stu-id="a88b5-141">For that reason, I've selected the FTP Site option and then entered the connection information as shown in Figure 2.</span></span>

<span data-ttu-id="a88b5-142">[![指定目标网站](deploying-your-site-using-visual-studio-vb/_static/image5.png)](deploying-your-site-using-visual-studio-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a88b5-142">[![Specify the Destination Website](deploying-your-site-using-visual-studio-vb/_static/image5.png)](deploying-your-site-using-visual-studio-vb/_static/image4.png)</span></span>

<span data-ttu-id="a88b5-143">**图 2**：指定目标网站（[单击查看完全大小的图像](deploying-your-site-using-visual-studio-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="a88b5-143">**Figure 2**: Specify the Destination Website ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image6.png))</span></span>

<span data-ttu-id="a88b5-144">连接后，"复制网站" 工具将在右窗格中的远程站点上加载文件，并指示每个文件的状态： "新建"、"已删除"、"已更改" 或 "未更改"。</span><span class="sxs-lookup"><span data-stu-id="a88b5-144">After you connect, the Copy Web Site tool loads the files at the remote site in the right pane and indicates the status of each file: New, Deleted, Changed, or Unchanged.</span></span> <span data-ttu-id="a88b5-145">您可以将文件从本地站点复制到远程站点，反之亦然。</span><span class="sxs-lookup"><span data-stu-id="a88b5-145">You can copy a file from the local site to the remote site, or vice-a-versa.</span></span>

<span data-ttu-id="a88b5-146">让我们向 BookReviewsWSP 项目添加一个新页面，然后将其部署，以便我们可以在操作中看到 "复制网站" 工具。</span><span class="sxs-lookup"><span data-stu-id="a88b5-146">Let's add a new page to the BookReviewsWSP project and then deploy it so that we can see the Copy Web Site tool in action.</span></span> <span data-ttu-id="a88b5-147">在名为 `Privacy.aspx`的根目录中的 Visual Studio 中创建新的 ASP.NET 页面。</span><span class="sxs-lookup"><span data-stu-id="a88b5-147">Create a new ASP.NET page in Visual Studio in the root directory named `Privacy.aspx`.</span></span> <span data-ttu-id="a88b5-148">让页面 `Site.master` 使用母版页，并将网站的隐私策略添加到此页。</span><span class="sxs-lookup"><span data-stu-id="a88b5-148">Have the page use the master page `Site.master` and add your site's privacy policy to this page.</span></span> <span data-ttu-id="a88b5-149">图3显示了此页创建后的 Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="a88b5-149">Figure 3 shows Visual Studio after this page has been created.</span></span>

<span data-ttu-id="a88b5-150">[![在网站的根文件夹中添加名为 &lt;code&gt;&gt;/code&lt;的新页面](deploying-your-site-using-visual-studio-vb/_static/image8.png)](deploying-your-site-using-visual-studio-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a88b5-150">[![Add a New Page Named &lt;code&gt;Privacy.aspx&lt;/code&gt; to the Website's Root Folder](deploying-your-site-using-visual-studio-vb/_static/image8.png)](deploying-your-site-using-visual-studio-vb/_static/image7.png)</span></span>

<span data-ttu-id="a88b5-151">**图 3**：将名为 `Privacy.aspx` 的新页添加到网站的根文件夹（[单击查看完全大小的图像](deploying-your-site-using-visual-studio-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="a88b5-151">**Figure 3**: Add a New Page Named `Privacy.aspx` to the Website's Root Folder ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image9.png))</span></span>

<span data-ttu-id="a88b5-152">接下来，返回到 "复制网站" 用户界面。</span><span class="sxs-lookup"><span data-stu-id="a88b5-152">Next, return to the Copy Web Site user interface.</span></span> <span data-ttu-id="a88b5-153">如图4所示，左窗格现在包含新的文件-`Policy.aspx` 和 `Policy.aspx.vb`。</span><span class="sxs-lookup"><span data-stu-id="a88b5-153">As Figure 4 shows, the left pane now includes the new files - `Policy.aspx` and `Policy.aspx.vb`.</span></span> <span data-ttu-id="a88b5-154">更多功能是，这些文件标记有一个箭头图标和一个状态为 "新建"，这表示它们存在于本地站点上，而不是在远程站点上。</span><span class="sxs-lookup"><span data-stu-id="a88b5-154">What's more, these files are marked with an arrow icon and a Status of New, indicating that they exist on the local site but not on the remote site.</span></span>

<span data-ttu-id="a88b5-155">[!["复制网站" 工具的左窗格中包含新的 &lt;代码&gt;default.aspx&lt;/code&gt; 页](deploying-your-site-using-visual-studio-vb/_static/image11.png)](deploying-your-site-using-visual-studio-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a88b5-155">[![The Copy Web Site Tool Includes the New &lt;code&gt;Privacy.aspx&lt;/code&gt; Page in its Left Pane](deploying-your-site-using-visual-studio-vb/_static/image11.png)](deploying-your-site-using-visual-studio-vb/_static/image10.png)</span></span>

<span data-ttu-id="a88b5-156">**图 4**： "复制网站" 工具在其左窗格中包含新的 `Privacy.aspx` 页面（[单击查看完全大小的图像](deploying-your-site-using-visual-studio-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="a88b5-156">**Figure 4**: The Copy Web Site Tool Includes the New `Privacy.aspx` Page in its Left Pane ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image12.png))</span></span>

<span data-ttu-id="a88b5-157">若要部署新文件，请选择它们，然后单击箭头图标将它们传输到远程站点。</span><span class="sxs-lookup"><span data-stu-id="a88b5-157">To deploy the new files select them and then click the arrow icon to transfer them to the remote site.</span></span> <span data-ttu-id="a88b5-158">传输完成后，会在本地和远程站点上同时存在状态为 "未更改" 的 `Policy.aspx` 和 `Policy.aspx.vb` 文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-158">After the transfer completes the `Policy.aspx` and `Policy.aspx.vb` files exist on both the local and remote sites with the status Unchanged.</span></span>

<span data-ttu-id="a88b5-159">除了列出新文件，"复制网站" 工具还会突出显示本地和远程站点之间的任何不同文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-159">Along with listing new files, the Copy Web Site tool highlights any files that differ between the local and remote sites.</span></span> <span data-ttu-id="a88b5-160">若要查看此操作，请返回 `Privacy.aspx` 页面，并向隐私策略添加几个单词。</span><span class="sxs-lookup"><span data-stu-id="a88b5-160">To see this in action, return to the `Privacy.aspx` page and add a few more words to the privacy policy.</span></span> <span data-ttu-id="a88b5-161">保存该页，然后返回到 "复制网站" 工具。</span><span class="sxs-lookup"><span data-stu-id="a88b5-161">Save the page and then return to the Copy Web Site tool.</span></span> <span data-ttu-id="a88b5-162">如图5所示，左窗格中的 "`Privacy.aspx`" 页的状态为 "已更改"，表示它与远程站点不同步。</span><span class="sxs-lookup"><span data-stu-id="a88b5-162">As Figure 5 shows, the `Privacy.aspx` page in the left pane has a status of Changed indicating that it is out of sync with the remote site.</span></span>

<span data-ttu-id="a88b5-163">[!["复制网站" 工具指示 &lt;代码&gt;的 ".aspx&lt;&gt;/code" 页已更改](deploying-your-site-using-visual-studio-vb/_static/image14.png)](deploying-your-site-using-visual-studio-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a88b5-163">[![The Copy Web Site Tool Indicates that the &lt;code&gt;Privacy.aspx&lt;/code&gt; Page has been Changed](deploying-your-site-using-visual-studio-vb/_static/image14.png)](deploying-your-site-using-visual-studio-vb/_static/image13.png)</span></span>

<span data-ttu-id="a88b5-164">**图 5**： "复制网站" 工具指示 `Privacy.aspx` 页已更改（[单击查看完全大小的图像](deploying-your-site-using-visual-studio-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="a88b5-164">**Figure 5**: The Copy Web Site Tool Indicates that the `Privacy.aspx` Page has been Changed ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image15.png))</span></span>

<span data-ttu-id="a88b5-165">"复制网站" 工具还表明自上次复制操作后是否已删除某个文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-165">The Copy Web Site tool also indicates if a file has been deleted since the last copy operation.</span></span> <span data-ttu-id="a88b5-166">从本地项目中删除 `Privacy.aspx`，然后刷新 "复制网站" 工具。</span><span class="sxs-lookup"><span data-stu-id="a88b5-166">Delete the `Privacy.aspx` from the local project and refresh the Copy Web Site tool.</span></span> <span data-ttu-id="a88b5-167">`Privacy.aspx` 和 `Privacy.aspx.vb` 文件仍将在左窗格中列出，但其状态为 "已删除"，表示自上次复制操作后已将其删除。</span><span class="sxs-lookup"><span data-stu-id="a88b5-167">The `Privacy.aspx` and `Privacy.aspx.vb` files remain listed in the left pane, but have a Deleted status indicating that they have been removed since the last copy operation.</span></span>

## <a name="publishing-a-web-application"></a><span data-ttu-id="a88b5-168">发布 Web 应用程序</span><span class="sxs-lookup"><span data-stu-id="a88b5-168">Publishing a Web Application</span></span>

<span data-ttu-id="a88b5-169">从 Visual Studio 中部署 web 应用程序的另一种方法是使用 "发布" 选项，该选项可通过 "生成" 菜单访问。</span><span class="sxs-lookup"><span data-stu-id="a88b5-169">Another way to deploy your web application from within Visual Studio is to use the Publish option, which is accessible via the Build menu.</span></span> <span data-ttu-id="a88b5-170">"发布" 选项显式编译应用程序，然后将所有必需的文件复制到指定的远程站点。</span><span class="sxs-lookup"><span data-stu-id="a88b5-170">The Publish option explicitly compiles the application and then copies all of the necessary files up to the specified remote site.</span></span> <span data-ttu-id="a88b5-171">我们很快就会看到，"发布" 选项比 "复制网站" 工具更为钝。</span><span class="sxs-lookup"><span data-stu-id="a88b5-171">As we'll see shortly, the Publish option is more blunt than the Copy Web Site tool.</span></span> <span data-ttu-id="a88b5-172">借助 "复制网站" 工具，你可以检查本地和远程站点上的文件，并允许你根据需要上载或下载单个文件，"发布" 选项将部署整个 Web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="a88b5-172">Whereas the Copy Web Site tool lets you examine the files on the local and remote sites and permits you to upload or download individual files as needed, the Publish option deploys the entire web application.</span></span>

<span data-ttu-id="a88b5-173">除了将所有所需文件复制到指定的远程站点外，"发布" 选项还会显式编译该应用程序。</span><span class="sxs-lookup"><span data-stu-id="a88b5-173">In addition to copying all of the needed files to the specified remote site, the Publish option also explicitly compiles the application.</span></span> <span data-ttu-id="a88b5-174">如果需要对 Web 应用程序项目进行显式编译，则发布选项对于 Web 应用程序项目是不可奇怪的。</span><span class="sxs-lookup"><span data-stu-id="a88b5-174">Given that Web Application Projects need to be explicitly compiled it should come as no surprise that the Publish option is available for Web Application Projects.</span></span> <span data-ttu-id="a88b5-175">可能有点令人吃惊的是，"发布" 选项也可用于网站项目。</span><span class="sxs-lookup"><span data-stu-id="a88b5-175">What may be a bit surprising is that the Publish option is also available for Web Site Projects.</span></span> <span data-ttu-id="a88b5-176">如[*确定需要部署的文件*](determining-what-files-need-to-be-deployed-vb.md)教程中所述，可以通过称为*预编译*的过程显式编译网站项目。</span><span class="sxs-lookup"><span data-stu-id="a88b5-176">As noted in the [*Determining What Files Need to Be Deployed*](determining-what-files-need-to-be-deployed-vb.md) tutorial, Web Site Projects can be explicitly compiled through a process referred to as *pre-compilation*.</span></span> <span data-ttu-id="a88b5-177">本教程重点介绍如何将发布选项用于 Web 应用程序项目。将来的教程将探讨预编译，此时我们将返回来了解如何将发布选项用于网站项目。</span><span class="sxs-lookup"><span data-stu-id="a88b5-177">This tutorial focuses on using the Publish option with Web Application Projects; a future tutorial will explore pre-compilation, at which point we'll return to look at using the Publish option with Web Site Projects.</span></span>

> [!NOTE]
> <span data-ttu-id="a88b5-178">尽管发布选项在 Visual Studio 中可用于网站项目和 Web 应用程序项目，但 Visual Web Developer 仅为 Web 应用程序项目提供发布选项。</span><span class="sxs-lookup"><span data-stu-id="a88b5-178">While the Publish option is available in Visual Studio for both Web Site Projects and Web Application Projects, Visual Web Developer only offers the Publish option for Web Application Projects.</span></span>

<span data-ttu-id="a88b5-179">让我们看一下如何使用 "发布" 选项部署书籍评论应用程序。</span><span class="sxs-lookup"><span data-stu-id="a88b5-179">Let's look at deploying the Book Reviews application using the Publish option.</span></span> <span data-ttu-id="a88b5-180">首先，在 Visual Studio 中打开 BookReviewsWAP （Web 应用程序项目）。</span><span class="sxs-lookup"><span data-stu-id="a88b5-180">Start by opening BookReviewsWAP (the Web Application Project) in Visual Studio.</span></span> <span data-ttu-id="a88b5-181">从 "发布" 菜单中选择 "生成 BookReviewsWAP" 项目。</span><span class="sxs-lookup"><span data-stu-id="a88b5-181">From the Publish menu choose the Build BookReviewsWAP project.</span></span> <span data-ttu-id="a88b5-182">此时将显示一个对话框，提示输入目标位置，以及其他配置选项（请参见图6）。</span><span class="sxs-lookup"><span data-stu-id="a88b5-182">This brings up a dialog box that prompts for the target location, among other configuration options (see Figure 6).</span></span> <span data-ttu-id="a88b5-183">与 "复制网站" 工具非常类似，你可以输入指向本地文件夹的位置、IIS 上的本地网站、支持 FrontPage 服务器扩展的远程网站或 FTP 服务器地址。</span><span class="sxs-lookup"><span data-stu-id="a88b5-183">Much like with the Copy Web Site tool you can enter a location that points to a local folder, a local website on IIS, a remote website that supports FrontPage Server Extensions, or an FTP server address.</span></span> <span data-ttu-id="a88b5-184">你可以选择是将远程 web 服务器上的文件替换为已部署的文件，还是在发布之前删除远程站点上的所有内容。</span><span class="sxs-lookup"><span data-stu-id="a88b5-184">You can choose whether to replace the files on the remote web server with the deployed files or to delete all of the content on the remote site before publishing.</span></span> <span data-ttu-id="a88b5-185">还可以指定是否复制：</span><span class="sxs-lookup"><span data-stu-id="a88b5-185">You can also specify whether to copy:</span></span>

- <span data-ttu-id="a88b5-186">仅运行应用程序所需的项目中的文件，该应用程序忽略不需要的源代码和与项目相关的文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-186">Only the files in the project needed to run the application, which omits the unneeded source code and project-related files.</span></span>
- <span data-ttu-id="a88b5-187">所有项目文件，包括源代码文件和 Visual Studio 项目文件（如解决方案文件）。</span><span class="sxs-lookup"><span data-stu-id="a88b5-187">All project files, which includes the source code files and Visual Studio project files like the Solution file.</span></span>
- <span data-ttu-id="a88b5-188">源项目文件夹中的所有文件，这些文件将复制源项目文件夹中的所有文件，而不考虑它们是否包含在项目中。</span><span class="sxs-lookup"><span data-stu-id="a88b5-188">All files in the source project folder, which copies all files in the source project folder regardless of whether they're included in the project.</span></span>

<span data-ttu-id="a88b5-189">还可以选择上传 `App_Data` 文件夹的内容。</span><span class="sxs-lookup"><span data-stu-id="a88b5-189">There's also an option to upload the contents of the `App_Data` folder.</span></span>

<span data-ttu-id="a88b5-190">[![指定目标网站](deploying-your-site-using-visual-studio-vb/_static/image17.png)](deploying-your-site-using-visual-studio-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a88b5-190">[![Specify the Destination Website](deploying-your-site-using-visual-studio-vb/_static/image17.png)](deploying-your-site-using-visual-studio-vb/_static/image16.png)</span></span>

<span data-ttu-id="a88b5-191">**图 6**：指定目标网站（[单击查看完全大小的图像](deploying-your-site-using-visual-studio-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="a88b5-191">**Figure 6**: Specify the Destination Website ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image18.png))</span></span>

<span data-ttu-id="a88b5-192">对于书籍评审应用程序，远程站点包含通过 "复制网站" 工具复制 BookReviewsWSP 项目时所部署的文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-192">For the Book Review application the remote site contains the files deployed when copying the BookReviewsWSP project via the Copy Web Site tool.</span></span> <span data-ttu-id="a88b5-193">因此，让我们通过删除所有现有内容开始发布选项。</span><span class="sxs-lookup"><span data-stu-id="a88b5-193">Therefore, let's have the Publish option start by deleting all existing content.</span></span> <span data-ttu-id="a88b5-194">另外，我们只是复制必要的文件，而不是将生产环境干扰到不需要的源代码和项目文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-194">Also, let's just copy the necessary files rather than cluttering the production environment with unneeded source code and project files.</span></span> <span data-ttu-id="a88b5-195">指定这些选项后，单击 "发布" 按钮。</span><span class="sxs-lookup"><span data-stu-id="a88b5-195">After specifying these options, click the Publish button.</span></span> <span data-ttu-id="a88b5-196">在接下来的几秒钟内，Visual Studio 会将所需的文件部署到目标站点，并在 "输出" 窗口中显示其进度。</span><span class="sxs-lookup"><span data-stu-id="a88b5-196">Over the next several seconds Visual Studio will deploy the necessary files to the destination site, displaying its progress in the Output window.</span></span>

<span data-ttu-id="a88b5-197">图7显示了发布操作完成后 FTP 站点上的文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-197">Figure 7 shows the files on the FTP site after the Publish operation has completed.</span></span> <span data-ttu-id="a88b5-198">请注意，仅上传了标记页和必要的服务器端和客户端支持文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-198">Note that only the markup pages and the necessary sever- and client-side support files have been uploaded.</span></span>

<span data-ttu-id="a88b5-199">[仅 ![将所需文件发布到生产环境](deploying-your-site-using-visual-studio-vb/_static/image20.png)](deploying-your-site-using-visual-studio-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a88b5-199">[![Only the Needed Files Were Published to the Production Environment](deploying-your-site-using-visual-studio-vb/_static/image20.png)](deploying-your-site-using-visual-studio-vb/_static/image19.png)</span></span>

<span data-ttu-id="a88b5-200">**图 7**：只将所需的文件发布到生产环境（[单击以查看完全大小的映像](deploying-your-site-using-visual-studio-vb/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="a88b5-200">**Figure 7**: Only the Needed Files Were Published to the Production Environment ([Click to view full-size image](deploying-your-site-using-visual-studio-vb/_static/image21.png))</span></span>

<span data-ttu-id="a88b5-201">"发布" 选项是一个比 "复制网站" 工具更少的微妙工具。</span><span class="sxs-lookup"><span data-stu-id="a88b5-201">The Publish option is a less nuanced tool than the Copy Web Site tool.</span></span> <span data-ttu-id="a88b5-202">通过 "复制网站" 工具，你可以检查本地和远程站点上的文件，并查看它们之间的差异，"发布" 选项不提供此类接口。</span><span class="sxs-lookup"><span data-stu-id="a88b5-202">Whereas the Copy Web Site tool allows you to inspect the files on the local and remote sites and see how they differ, the Publish option provides no such interface.</span></span> <span data-ttu-id="a88b5-203">此外，通过 "复制网站" 工具，您可以进行一次性更改，上载或删除单个文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-203">Moreover, the Copy Web Site tool enables you to make one-off changes, uploading or deleting individual files.</span></span> <span data-ttu-id="a88b5-204">"发布" 选项不允许这样的精细控制;而是发布*整个*应用程序。</span><span class="sxs-lookup"><span data-stu-id="a88b5-204">The Publish option does not allow such fine-grained control; instead, it publishes the *entire* application.</span></span> <span data-ttu-id="a88b5-205">此行为的优点和缺点。</span><span class="sxs-lookup"><span data-stu-id="a88b5-205">This behavior has its pros and cons.</span></span> <span data-ttu-id="a88b5-206">在这一方，您知道使用发布选项时，您不会忘记上传重要文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-206">On the plus side, you know when using the Publish option you won't be forgetting to upload an important file.</span></span> <span data-ttu-id="a88b5-207">但如果你对非常大的网站进行了少量更改，则请考虑使用 "发布" 选项不能更新已修改的页面，而是在 Visual Studio 部署整个站点时要等待的情况。</span><span class="sxs-lookup"><span data-stu-id="a88b5-207">But consider what happens if you have made a small change to a very large website - with the Publish option you cannot update that page or two that has been modified, but instead you must wait while Visual Studio deploys the entire site.</span></span>

<span data-ttu-id="a88b5-208">某些文件的内容在生产环境和开发环境之间有所不同，这并不少见。</span><span class="sxs-lookup"><span data-stu-id="a88b5-208">It's not uncommon for there to be certain files whose content differs between the production and development environments.</span></span> <span data-ttu-id="a88b5-209">例如，应用程序的配置文件 `Web.config`。</span><span class="sxs-lookup"><span data-stu-id="a88b5-209">A key example is the application's configuration file, `Web.config`.</span></span> <span data-ttu-id="a88b5-210">由于发布选项会盲目地复制 web 应用程序文件，因此它将用开发环境中的版本覆盖生产环境的自定义配置文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-210">Because the Publish option blindly copies the web application files it overwrites the production environment's customized configuration files with the version in the development environment.</span></span> <span data-ttu-id="a88b5-211">后续教程进一步探讨了此主题，并提供了在存在此类差异时部署 web 应用程序的提示。</span><span class="sxs-lookup"><span data-stu-id="a88b5-211">The subsequent tutorial explores this topic further and offers tips for deploying a web application when such differences exist.</span></span>

## <a name="summary"></a><span data-ttu-id="a88b5-212">总结</span><span class="sxs-lookup"><span data-stu-id="a88b5-212">Summary</span></span>

<span data-ttu-id="a88b5-213">部署网站需要将所需的文件从开发环境复制到生产环境。</span><span class="sxs-lookup"><span data-stu-id="a88b5-213">Deploying a website involves copying the necessary files from the development environment to the production environment.</span></span> <span data-ttu-id="a88b5-214">前面的教程介绍了如何使用 FileZilla 等 FTP 客户端传输文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-214">The previous tutorial showed how to transfer files using an FTP client like FileZilla.</span></span> <span data-ttu-id="a88b5-215">本教程在 Visual Studio 中检查了两种部署工具： "复制网站" 工具和 "发布" 选项。</span><span class="sxs-lookup"><span data-stu-id="a88b5-215">This tutorial examined two deployment tools in Visual Studio: the Copy Web Site tool and the Publish option.</span></span> <span data-ttu-id="a88b5-216">"复制网站" 工具类似于 FTP 客户端，因为它具有一个平移接口，该接口列出了本地计算机上的文件和指定的远程计算机，使您可以轻松地在这两台计算机之间上传或下载文件。</span><span class="sxs-lookup"><span data-stu-id="a88b5-216">The Copy Web Site tool is similar to an FTP client in that it has a two-paned interface listing the files on the local computer and a specified remote computer that makes it easy to upload or download files between the two computers.</span></span> <span data-ttu-id="a88b5-217">"发布" 选项是一个更为钝的工具，它显式编译项目，然后将整个应用程序部署到指定的目标。</span><span class="sxs-lookup"><span data-stu-id="a88b5-217">The Publish option is a more blunt tool that explicitly compiles the project and then deploys the entire application to the specified destination.</span></span>

<span data-ttu-id="a88b5-218">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="a88b5-218">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="a88b5-219">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="a88b5-219">Further Reading</span></span>

<span data-ttu-id="a88b5-220">有关本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="a88b5-220">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="a88b5-221">通过 "复制网站" 工具复制网站</span><span class="sxs-lookup"><span data-stu-id="a88b5-221">Copying Web Site with the Copy Web Site Tool</span></span>](https://msdn.microsoft.com/library/1cc82atw.aspx)
- <span data-ttu-id="a88b5-222">[如何实现：使用 "复制网站" 工具部署](../../../videos/how-do-i/how-do-i-deploy-a-web-site-using-the-copy-web-site-tool.md)网站（视频）</span><span class="sxs-lookup"><span data-stu-id="a88b5-222">[How Do I: Deploy a Web Site Using the Copy Web Site Tool](../../../videos/how-do-i/how-do-i-deploy-a-web-site-using-the-copy-web-site-tool.md) (Video)</span></span>
- [<span data-ttu-id="a88b5-223">如何：发布 Web 应用程序项目</span><span class="sxs-lookup"><span data-stu-id="a88b5-223">How To: Publish Web Application Projects</span></span>](https://msdn.microsoft.com/library/aa983453.aspx)
- [<span data-ttu-id="a88b5-224">如何：发布网站</span><span class="sxs-lookup"><span data-stu-id="a88b5-224">How To: Publish Web Sites</span></span>](https://msdn.microsoft.com/library/20yh9f1b.aspx)
- [<span data-ttu-id="a88b5-225">Visual Studio 中的安装和部署项目</span><span class="sxs-lookup"><span data-stu-id="a88b5-225">Setup and Deployment Projects in Visual Studio</span></span>](https://msdn.microsoft.com/library/wx3b589t.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="a88b5-226">[上一页](deploying-your-site-using-an-ftp-client-vb.md)
> [下一页](common-configuration-differences-between-development-and-production-vb.md)</span><span class="sxs-lookup"><span data-stu-id="a88b5-226">[Previous](deploying-your-site-using-an-ftp-client-vb.md)
[Next](common-configuration-differences-between-development-and-production-vb.md)</span></span>

---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-a-database-cs
title: 部署数据库（C#） |Microsoft Docs
author: rick-anderson
description: 部署 ASP.NET web 应用程序需要从开发环境到生产环境中获取必要的文件和资源。 对于 da 。
ms.author: riande
ms.date: 04/23/2009
ms.assetid: ff537a10-9f1f-43fe-9bcb-3dda161ba8f5
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/deploying-a-database-cs
msc.type: authoredcontent
ms.openlocfilehash: 83657be794e1ea31f6ad2f2b4adc274724d60cf2
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2019
ms.locfileid: "74579914"
---
# <a name="deploying-a-database-c"></a><span data-ttu-id="72c01-104">部署数据库 (C#)</span><span class="sxs-lookup"><span data-stu-id="72c01-104">Deploying a Database (C#)</span></span>

<span data-ttu-id="72c01-105">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="72c01-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="72c01-106">[下载代码](https://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_07_CS.zip)或[下载 PDF](https://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial07_DeployDB_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="72c01-106">[Download Code](https://download.microsoft.com/download/E/6/F/E6FE3A1F-EE3A-4119-989A-33D1A9F6F6DD/ASPNET_Hosting_Tutorial_07_CS.zip) or [Download PDF](https://download.microsoft.com/download/C/3/9/C391A649-B357-4A7B-BAA4-48C96871FEA6/aspnet_tutorial07_DeployDB_cs.pdf)</span></span>

> <span data-ttu-id="72c01-107">部署 ASP.NET web 应用程序需要从开发环境到生产环境中获取必要的文件和资源。</span><span class="sxs-lookup"><span data-stu-id="72c01-107">Deploying an ASP.NET web application entails getting the necessary files and resources from the development environment to the production environment.</span></span> <span data-ttu-id="72c01-108">对于数据驱动的 web 应用程序，这包括数据库架构和数据。</span><span class="sxs-lookup"><span data-stu-id="72c01-108">For data-driven web applications this includes the database schema and data.</span></span> <span data-ttu-id="72c01-109">本教程是一个系列教程中的第一个教程，其中介绍了成功将数据库从开发环境部署到生产环境所需的步骤。</span><span class="sxs-lookup"><span data-stu-id="72c01-109">This tutorial is the first in a series that explores the steps needed to successfully deploy the database from the development environment to production.</span></span>

## <a name="introduction"></a><span data-ttu-id="72c01-110">简介</span><span class="sxs-lookup"><span data-stu-id="72c01-110">Introduction</span></span>

<span data-ttu-id="72c01-111">部署 ASP.NET web 应用程序需要从开发环境到生产环境中获取必要的文件和资源。</span><span class="sxs-lookup"><span data-stu-id="72c01-111">Deploying an ASP.NET web application entails getting the necessary files and resources from the development environment to the production environment.</span></span> <span data-ttu-id="72c01-112">在过去六个教程中，我们介绍了如何部署简单的书籍评论 web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="72c01-112">Over the course of the past six tutorials we looked at deploying a simple Book Reviews web application.</span></span> <span data-ttu-id="72c01-113">此演示网站由多个服务器端资源（ASP.NET 页面、配置文件、`Web.sitemap` 文件等）以及客户端资源（如图像和 CSS 文件）组成。</span><span class="sxs-lookup"><span data-stu-id="72c01-113">This demo site was comprised of a number of server-side resources - ASP.NET pages, configuration files, a `Web.sitemap` file, and so forth - along with client-side resources, like images and CSS files.</span></span> <span data-ttu-id="72c01-114">但数据驱动的 web 应用程序呢？</span><span class="sxs-lookup"><span data-stu-id="72c01-114">But what about data-driven web applications?</span></span> <span data-ttu-id="72c01-115">部署使用数据库的 web 应用程序时必须采取哪些额外步骤？</span><span class="sxs-lookup"><span data-stu-id="72c01-115">What extra steps must be taken to deploy a web application that uses a database?</span></span>

<span data-ttu-id="72c01-116">在接下来的几个教程中，我们将介绍部署数据驱动的 web 应用程序所需的步骤。</span><span class="sxs-lookup"><span data-stu-id="72c01-116">Over the next several tutorials we will address the steps needed to deploy a data-driven web application.</span></span> <span data-ttu-id="72c01-117">本教程首先检查如何从开发环境将数据库的架构和内容获取到生产环境中，而后续教程将介绍所需的配置更改。</span><span class="sxs-lookup"><span data-stu-id="72c01-117">This tutorial starts by examining how to get a database s schema and contents from the development environment to the production environment, while the subsequent tutorial looks at the needed configuration changes.</span></span> <span data-ttu-id="72c01-118">接下来，我们将探讨部署使用应用程序服务（成员资格、角色、配置文件等）的数据库的挑战。</span><span class="sxs-lookup"><span data-stu-id="72c01-118">Following that we'll explore challenges of deploying a database that uses the Application Services (Membership, Roles, Profile, and so on).</span></span>

## <a name="examining-the-updated-book-reviews-web-application"></a><span data-ttu-id="72c01-119">检查更新的书籍评审 Web 应用程序</span><span class="sxs-lookup"><span data-stu-id="72c01-119">Examining the Updated Book Reviews Web Application</span></span>

<span data-ttu-id="72c01-120">为了演示如何部署数据驱动的 web 应用程序，我已将一项简单的静态网站中的 web 应用程序更新到数据驱动的 web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="72c01-120">In order to demonstrate deploying a data-driven web application, I ve updated the Book Reviews web application from a simple, static website to a data-driven one.</span></span> <span data-ttu-id="72c01-121">与之前一样，本教程中有两个版本的应用程序下载：一个使用 Web 应用程序项目模型，另一个使用网站项目模型。</span><span class="sxs-lookup"><span data-stu-id="72c01-121">As before, there are two versions of the application in this tutorial s download: one that uses the Web Application Project model and one that uses the Web Site Project model.</span></span>

<span data-ttu-id="72c01-122">更新的书籍检查 web 应用程序使用[SQL Server 2008 Express Edition](https://www.microsoft.com/express/sql/default.aspx)数据库，该数据库存储在站点 s `App_Data` 文件夹（`~/App_Data/Reviews.mdf`）中。</span><span class="sxs-lookup"><span data-stu-id="72c01-122">The updated Book Reviews web application uses a [SQL Server 2008 Express Edition](https://www.microsoft.com/express/sql/default.aspx) database, which is stored in the site s `App_Data` folder (`~/App_Data/Reviews.mdf`).</span></span> <span data-ttu-id="72c01-123">如果在计算机上安装了 SQL Server 2008，则演示应运行且不出错。</span><span class="sxs-lookup"><span data-stu-id="72c01-123">If you have SQL Server 2008 installed on your computer then the demo should run without error.</span></span> <span data-ttu-id="72c01-124">如果你使用的是较旧版本的 SQL Server 你可以安装免费的 SQL Server 2008 Express Edition，也可以使用本教程的下载中提供的数据库脚本自行创建数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-124">If you have an older version of SQL Server you can either install the free SQL Server 2008 Express Edition or you can use the database scripts available in this tutorial s download to create the database yourself.</span></span>

<span data-ttu-id="72c01-125">`Reviews.mdf` 数据库包含四个表：</span><span class="sxs-lookup"><span data-stu-id="72c01-125">The `Reviews.mdf` database contains four tables:</span></span>

- <span data-ttu-id="72c01-126">`Genres`-为每个流派包括一条记录，如技术、小说和商务。</span><span class="sxs-lookup"><span data-stu-id="72c01-126">`Genres` - includes a record for each genre, such as Technology, Fiction, and Business.</span></span>
- <span data-ttu-id="72c01-127">`Books`-对于每个评审都包含一条记录，其中的列如 `Title`、`GenreId`、`ReviewDate`和 `Review`等。</span><span class="sxs-lookup"><span data-stu-id="72c01-127">`Books` - includes a record for each review, with columns like `Title`, `GenreId`, `ReviewDate`, and `Review`, among others.</span></span>
- <span data-ttu-id="72c01-128">`Authors`-包含有关参与评审书籍的每个作者的信息。</span><span class="sxs-lookup"><span data-stu-id="72c01-128">`Authors` - includes information about each author who has contributed to a reviewed book.</span></span>
- <span data-ttu-id="72c01-129">`BooksAuthors`-多对多联接表，用于指定作者编写了哪些书籍。</span><span class="sxs-lookup"><span data-stu-id="72c01-129">`BooksAuthors` - a many-to-many join table that specifies what authors have written what books.</span></span>

<span data-ttu-id="72c01-130">图1显示了这四个表的 ER 关系图。</span><span class="sxs-lookup"><span data-stu-id="72c01-130">Figure 1 shows an ER diagram of these four tables.</span></span>

<span data-ttu-id="72c01-131">[![书籍审阅 Web 应用程序数据库由四个表组成](deploying-a-database-cs/_static/image2.jpg)](deploying-a-database-cs/_static/image1.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-131">[![The Book Reviews Web Application s Database is Comprised of Four Tables](deploying-a-database-cs/_static/image2.jpg)](deploying-a-database-cs/_static/image1.jpg)</span></span> 

<span data-ttu-id="72c01-132">**图 1**：书籍回顾 Web 应用程序数据库由四个表组成（[单击以查看完全大小的图像](deploying-a-database-cs/_static/image3.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-132">**Figure 1**: The Book Reviews Web Application s Database is Comprised of Four Tables ([Click to view full-size image](deploying-a-database-cs/_static/image3.jpg))</span></span>

<span data-ttu-id="72c01-133">前一版本的书籍评论网站为每本书提供了一个单独的 ASP.NET 页面。</span><span class="sxs-lookup"><span data-stu-id="72c01-133">The previous version of the Book Reviews website had a separate ASP.NET page for each book.</span></span> <span data-ttu-id="72c01-134">例如，存在一个名为 `~/Tech/TYASP35.aspx` 的页，其中包含用于*在24小时内讲授自己 ASP.NET 3.5*的评审。</span><span class="sxs-lookup"><span data-stu-id="72c01-134">For example, there was a page named `~/Tech/TYASP35.aspx` that contained the review for *Teach Yourself ASP.NET 3.5 in 24 Hours*.</span></span> <span data-ttu-id="72c01-135">该网站的这一新的数据驱动版本包含存储在数据库中的审阅，以及一个 ASP.NET？ ID =*bookId*，用于显示指定书的评审。</span><span class="sxs-lookup"><span data-stu-id="72c01-135">This new data-driven version of the website has the reviews stored in the database and a single ASP.NET page, Review.aspx?ID=*bookId*, which displays the review for the specified book.</span></span> <span data-ttu-id="72c01-136">同样，还会有一个 "*genreId* " 页，其中列出了指定流派中审阅的书籍。</span><span class="sxs-lookup"><span data-stu-id="72c01-136">Likewise, there is a Genre.aspx?ID=*genreId* page that lists the reviewed books in the specified genre.</span></span>

<span data-ttu-id="72c01-137">图2和3显示了操作中的 `Genre.aspx` 和 `Review.aspx` 页面。</span><span class="sxs-lookup"><span data-stu-id="72c01-137">Figures 2 and 3 show the `Genre.aspx` and `Review.aspx` pages in action.</span></span> <span data-ttu-id="72c01-138">请注意每个页面的地址栏中的 URL。</span><span class="sxs-lookup"><span data-stu-id="72c01-138">Note the URL in the Address bar for each page.</span></span> <span data-ttu-id="72c01-139">在图2中，它是 "85d164ba-1123-4c47-82a0-c8ec75de7e0e"。</span><span class="sxs-lookup"><span data-stu-id="72c01-139">In Figure 2 it s Genre.aspx?ID=85d164ba-1123-4c47-82a0-c8ec75de7e0e.</span></span> <span data-ttu-id="72c01-140">由于85d164ba-1123-4c47-82a0-c8ec75de7e0e 是技术流派的 `GenreId` 值，因此页面的标题将显示 "技术审阅"，而项目符号列表则会在此流派下的站点上枚举这些评审。</span><span class="sxs-lookup"><span data-stu-id="72c01-140">Because 85d164ba-1123-4c47-82a0-c8ec75de7e0e is the `GenreId` value for the Technology genre, the page s heading reads "Technology Reviews" and the bulleted list enumerates those reviews on the site that fall under this genre.</span></span>

<span data-ttu-id="72c01-141">[![技术流派页面](deploying-a-database-cs/_static/image5.jpg)](deploying-a-database-cs/_static/image4.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-141">[![The Technology Genre Page](deploying-a-database-cs/_static/image5.jpg)](deploying-a-database-cs/_static/image4.jpg)</span></span> 

<span data-ttu-id="72c01-142">**图 2**：技术流派页面（[单击以查看完全尺寸的图像](deploying-a-database-cs/_static/image6.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-142">**Figure 2**: The Technology Genre Page ([Click to view full-size image](deploying-a-database-cs/_static/image6.jpg))</span></span>

<span data-ttu-id="72c01-143">[![在24小时内讲授 ASP.NET 3.5 的评论](deploying-a-database-cs/_static/image8.jpg)](deploying-a-database-cs/_static/image7.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-143">[![The Review for Teach Yourself ASP.NET 3.5 in 24 Hours](deploying-a-database-cs/_static/image8.jpg)](deploying-a-database-cs/_static/image7.jpg)</span></span> 

<span data-ttu-id="72c01-144">**图 3**：*在24小时内讲授 ASP.NET 3.5*的评论（[单击查看全尺寸图像](deploying-a-database-cs/_static/image9.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-144">**Figure 3**: The Review for *Teach Yourself ASP.NET 3.5 in 24 Hours* ([Click to view full-size image](deploying-a-database-cs/_static/image9.jpg))</span></span>

<span data-ttu-id="72c01-145">书籍评论 web 应用程序还包括管理部分，管理员可以在其中添加、编辑和删除流派、评论和作者信息。</span><span class="sxs-lookup"><span data-stu-id="72c01-145">The Book Reviews web application also includes an administration section where administrators can add, edit, and delete genres, reviews, and author information.</span></span> <span data-ttu-id="72c01-146">目前，任何访问者都可以访问管理部分。</span><span class="sxs-lookup"><span data-stu-id="72c01-146">Currently, any visitor can access the administration section.</span></span> <span data-ttu-id="72c01-147">在将来的教程中，我们将为用户帐户添加支持，并仅允许授权用户进入 "管理" 页。</span><span class="sxs-lookup"><span data-stu-id="72c01-147">In a future tutorial we'll add support for user accounts and only permit authorized users into the administration pages.</span></span>

<span data-ttu-id="72c01-148">如果下载书籍评论应用程序，请记住，其目的是演示如何部署数据驱动的应用程序。</span><span class="sxs-lookup"><span data-stu-id="72c01-148">If you download the Book Reviews application please keep in mind that its purpose is to demonstrate deploying a data-driven application.</span></span> <span data-ttu-id="72c01-149">这并不像应用程序设计那样表现最佳做法。</span><span class="sxs-lookup"><span data-stu-id="72c01-149">It does not exhibit best practices as far as application design.</span></span> <span data-ttu-id="72c01-150">例如，没有单独的数据访问层（DAL）;ASP.NET 页面通过其代码隐藏类中的 SqlDataSource 控件或 ADO.NET 代码直接与数据库进行通信。</span><span class="sxs-lookup"><span data-stu-id="72c01-150">For example, there is no separate Data Access Layer (DAL); the ASP.NET pages communicate directly with the database through the SqlDataSource control or ADO.NET code in their code-behind classes.</span></span> <span data-ttu-id="72c01-151">若要深入了解如何使用分层体系结构创建数据驱动的应用程序，请参阅使用[*数据*教程](../../data-access/index.md)。</span><span class="sxs-lookup"><span data-stu-id="72c01-151">For a more in-depth look at creating data-driven applications using a tiered architecture, refer to my [*Working with Data* tutorials](../../data-access/index.md).</span></span>

## <a name="databases-on-development-versus-production"></a><span data-ttu-id="72c01-152">开发数据库与生产环境</span><span class="sxs-lookup"><span data-stu-id="72c01-152">Databases on Development Versus Production</span></span>

<span data-ttu-id="72c01-153">当你开始在数据驱动的 web 应用程序上进行开发时，必须指定一个数据库连接字符串，该字符串提供有关如何连接到数据库的应用程序详细信息。</span><span class="sxs-lookup"><span data-stu-id="72c01-153">When you start development on a data-driven web application you must specify a database connection string, which provides the application details on how to connect to the database.</span></span> <span data-ttu-id="72c01-154">此连接字符串指定数据库服务器、数据库名称和安全信息。</span><span class="sxs-lookup"><span data-stu-id="72c01-154">This connection string specifies, among other things, the database server, the database name, and security information.</span></span> <span data-ttu-id="72c01-155">大多数情况下，应用程序在开发期间使用的数据库与生产环境中使用的数据库不同。</span><span class="sxs-lookup"><span data-stu-id="72c01-155">Most often, the database used by the application during development is different than the database used when it s in production.</span></span> <span data-ttu-id="72c01-156">使用不同的数据库进行开发与生产有很多好处。</span><span class="sxs-lookup"><span data-stu-id="72c01-156">There are many benefits of using different databases for development versus production.</span></span> <span data-ttu-id="72c01-157">如果在开发中使用其他数据库，就不必担心意外修改或删除实时数据。</span><span class="sxs-lookup"><span data-stu-id="72c01-157">Having a different database in development means you don t have to worry about accidentally modifying or deleting live data.</span></span> <span data-ttu-id="72c01-158">它还允许你将虚拟测试数据放入虚拟测试数据或对数据模型进行重大更改，无需担心对应用程序在生产中的影响。</span><span class="sxs-lookup"><span data-stu-id="72c01-158">It also lets you put in dummy test data or make breaking changes to the data model without having to worry about the effects on the application in production.</span></span> <span data-ttu-id="72c01-159">在开发和生产环境中具有不同数据库的缺点在于，在部署应用程序时，还必须部署数据库架构或数据的任何相关更改。</span><span class="sxs-lookup"><span data-stu-id="72c01-159">The downside of having a different database in the development and production environments is that when the application is deployed the database and any pertinent changes to the database s schema or data must also be deployed.</span></span>

<span data-ttu-id="72c01-160">在第一次部署之前，只有数据库的一个实例，并且该实例位于开发环境中。</span><span class="sxs-lookup"><span data-stu-id="72c01-160">Prior to the first deployment, there is only one instance of the database, and that instance is in the development environment.</span></span> <span data-ttu-id="72c01-161">首次将应用程序部署到生产环境时，我们不仅必须复制必需的服务器端文件和客户端文件，还必须将数据库从开发环境复制到生产环境。</span><span class="sxs-lookup"><span data-stu-id="72c01-161">When deploying the application to production for the first time we must not only copy up the necessary server-side and client-side files, but also copy the database from the development environment to the production environment.</span></span> <span data-ttu-id="72c01-162">这就是我们目前所处的书籍回顾 web 应用程序的地方，数据库驻留在开发环境中的 `App_Data` 文件夹中，但尚未推送到生产环境。</span><span class="sxs-lookup"><span data-stu-id="72c01-162">This is where we stand right now with the Book Reviews web application - the database resides in the `App_Data` folder in our development environment but has not yet been pushed up to the production environment.</span></span>

<span data-ttu-id="72c01-163">部署应用程序后，会有两个数据库副本。</span><span class="sxs-lookup"><span data-stu-id="72c01-163">Once the application has been deployed there are two copies of the database.</span></span> <span data-ttu-id="72c01-164">随着应用程序的成熟，可以添加新的功能，使得对数据模型的更改（例如，将新列添加到现有表、更改现有列、添加新表等）。</span><span class="sxs-lookup"><span data-stu-id="72c01-164">As the application matures, new features may be added, necessitating a change to the data model (such as adding new columns to existing tables, making changes to existing columns, adding new tables, and so on).</span></span> <span data-ttu-id="72c01-165">下一次部署 web 应用程序后，必须将更改应用到自上一次部署后开发环境中的数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-165">When the web application is next deployed, the changes applied to the database in the development environment since the last deployment must be applied to the production database.</span></span> <span data-ttu-id="72c01-166">将来的教程中讨论了用于管理此过程的某些策略。</span><span class="sxs-lookup"><span data-stu-id="72c01-166">Some strategies for managing this process are discussed in a future tutorial.</span></span> <span data-ttu-id="72c01-167">本教程重点介绍如何将整个数据库从开发环境部署到生产环境。</span><span class="sxs-lookup"><span data-stu-id="72c01-167">This tutorial focuses on deploying the entire database from the development environment to production.</span></span>

## <a name="deploying-the-database-to-the-production-environment"></a><span data-ttu-id="72c01-168">将数据库部署到生产环境</span><span class="sxs-lookup"><span data-stu-id="72c01-168">Deploying the Database to the Production Environment</span></span>

<span data-ttu-id="72c01-169">本教程的其余部分介绍如何将数据库从开发环境部署到生产环境。</span><span class="sxs-lookup"><span data-stu-id="72c01-169">The remainder of this tutorial looks at how to deploy the database from the development environment to the production environment.</span></span> <span data-ttu-id="72c01-170">如果你要继续，请确保你的 web 主机提供商的帐户包含 Microsoft SQL Server 数据库支持。</span><span class="sxs-lookup"><span data-stu-id="72c01-170">If you are following along you need to make sure that your account with your web host provider includes Microsoft SQL Server database support.</span></span> <span data-ttu-id="72c01-171">还需要有一些信息，即数据库服务器名称、数据库名称，以及用于连接到数据库的用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="72c01-171">You'll also need to have some information at hand, namely the database server name, the database name, and the username and password used to connect to the database.</span></span>

<span data-ttu-id="72c01-172">如本教程前面所述，书籍检查网站的数据库是存储在 `App_Data` 文件夹中 SQL Server 2008 Express Edition 数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-172">As noted earlier in this tutorial, the Book Reviews website s database is a SQL Server 2008 Express Edition database stored in the `App_Data` folder.</span></span> <span data-ttu-id="72c01-173">部署此类数据库的原因与将 `App_Data` 文件夹从开发环境复制到生产环境一样简单。</span><span class="sxs-lookup"><span data-stu-id="72c01-173">It would stand to reason that deploying such a database would be as simple as copying the `App_Data` folder from the development environment to the production environment.</span></span> <span data-ttu-id="72c01-174">但出于安全方面的考虑，大多数 web 宿主提供程序不支持在 `App_Data` 文件夹中承载数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-174">However, most web host providers do not support hosting databases in the `App_Data` folder because of security reasons.</span></span> <span data-ttu-id="72c01-175">相反，web 主机会在其环境中的 SQL Server 数据库服务器上提供帐户。</span><span class="sxs-lookup"><span data-stu-id="72c01-175">Instead, web hosts provide an account on a SQL Server database server within their environment.</span></span> <span data-ttu-id="72c01-176">若要将数据库从开发环境部署到生产环境，需要在 web 主机的数据库服务器上注册数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-176">Deploying the database from your development environment to the production environment requires getting your database registered on your web host s database server.</span></span>

<span data-ttu-id="72c01-177">那么，如何将数据库从开发环境转到生产环境呢？</span><span class="sxs-lookup"><span data-stu-id="72c01-177">So how do you get your database from the development environment to the production environment?</span></span> <span data-ttu-id="72c01-178">有几种方法可以完成此操作，具体取决于 web 主机提供的服务。</span><span class="sxs-lookup"><span data-stu-id="72c01-178">There are a couple ways to accomplish this depending on what services your web host offers.</span></span> <span data-ttu-id="72c01-179">在某些主机（如 DiscountASP.NET）中，你可以将数据库或实际 `.mdf` 文件的备份 FTP 到你的网站，然后，从 "控制面板" 中还原备份文件或将 `.mdf` 文件附加到 SQL Server 数据库服务器。</span><span class="sxs-lookup"><span data-stu-id="72c01-179">With some hosts, such as DiscountASP.NET, you can FTP a backup of the database or the actual `.mdf` file to your website and then, from the Control Panel, restore the backup file or attach the `.mdf` file to the SQL Server database server.</span></span> <span data-ttu-id="72c01-180">利用此类工具，可以轻松地将 `App_Data` 文件夹复制到生产环境，然后通过控制面板附加该数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-180">With such tools deploying the database is as simple as copying the `App_Data` folder to the production environment and then attaching it via the Control Panel.</span></span> <span data-ttu-id="72c01-181">这可能是首次发布数据库的最简单、最快捷的方式。</span><span class="sxs-lookup"><span data-stu-id="72c01-181">This is perhaps the easiest and quickest way to publish your database for the first time.</span></span>

<span data-ttu-id="72c01-182">另一种方法是使用 "数据库发布向导"。</span><span class="sxs-lookup"><span data-stu-id="72c01-182">Another approach is to use the Database Publishing Wizard.</span></span> <span data-ttu-id="72c01-183">"数据库发布向导" 是一个 Windows 桌面应用程序，它将生成用于创建数据库架构的 SQL 命令（表、存储过程、视图、用户定义函数等），以及（可选）表中的数据。</span><span class="sxs-lookup"><span data-stu-id="72c01-183">The Database Publishing Wizard is a Windows desktop application that will generate the SQL commands to create your database s schema - the tables, stored procedures, views, user-defined functions, and so forth - and, optionally, the data in its tables.</span></span> <span data-ttu-id="72c01-184">然后，可以通过 SQL Server Management Studio 连接到 web 主机提供程序的数据库服务器，然后执行此脚本以在生产环境中复制数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-184">You can then connect to your web host provider s database server through SQL Server Management Studio and then execute this script to duplicate the database on production.</span></span> <span data-ttu-id="72c01-185">更好的是，如果您的 web 主机提供商支持 Microsoft[数据库发布服务](http://www.codeplex.com/sqlhost/Wiki/View.aspx?title=Database%20Publishing%20Services&amp;referringTitle=Home)，则您可以让 "数据库发布向导" 生成的脚本以您的身份自动在数据库服务器上执行。</span><span class="sxs-lookup"><span data-stu-id="72c01-185">Even better, if your web host provider supports Microsoft s [Database Publishing Services](http://www.codeplex.com/sqlhost/Wiki/View.aspx?title=Database%20Publishing%20Services&amp;referringTitle=Home) you can have the script generated by the Database Publishing Wizard automatically executed on the database server on your behalf.</span></span> <span data-ttu-id="72c01-186">由于 "数据库发布向导" 生成的脚本将创建数据库的架构和数据，因此无论 web 宿主提供程序是否提供附加已上传 `.mdf` 文件之类的功能，它都有效。</span><span class="sxs-lookup"><span data-stu-id="72c01-186">Because the Database Publishing Wizard generates a script that creates the database s schema and data, it will work regardless of whether your web host provider offers features like attaching an uploaded `.mdf` file.</span></span>

### <a name="generating-the-sql-commands-to-create-the-database-schema-and-data-using-the-database-publishing-wizard"></a><span data-ttu-id="72c01-187">使用数据库发布向导生成用于创建数据库架构和数据的 SQL 命令</span><span class="sxs-lookup"><span data-stu-id="72c01-187">Generating the SQL Commands to Create the Database Schema and Data Using the Database Publishing Wizard</span></span>

<span data-ttu-id="72c01-188">让我们逐步介绍如何使用数据库发布向导将书籍检查数据库部署到生产环境。</span><span class="sxs-lookup"><span data-stu-id="72c01-188">Let s walk through using the Database Publishing Wizard to deploy the Book Reviews database to production.</span></span> <span data-ttu-id="72c01-189">如果使用的是 Visual Studio 2008 或更高版本，则已安装 "数据库发布向导"。</span><span class="sxs-lookup"><span data-stu-id="72c01-189">If you are using Visual Studio 2008 or beyond, the Database Publishing Wizard is already installed.</span></span> <span data-ttu-id="72c01-190">如果你使用的是 Visual Studio 2005，你将需要先[下载并安装](https://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&amp;displaylang=en)该向导。</span><span class="sxs-lookup"><span data-stu-id="72c01-190">If you are using Visual Studio 2005 then you will need to first [download and install](https://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&amp;displaylang=en) the wizard.</span></span>

<span data-ttu-id="72c01-191">打开 Visual Studio，然后导航到 `Reviews.mdf` 数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-191">Open Visual Studio and navigate to the `Reviews.mdf` database.</span></span> <span data-ttu-id="72c01-192">如果你正在使用 Visual Web Developer，请前往数据库资源管理器;如果使用的是 Visual Studio，请使用服务器资源管理器。</span><span class="sxs-lookup"><span data-stu-id="72c01-192">If you are using Visual Web Developer, go to the Database Explorer; if you are using Visual Studio, use the Server Explorer.</span></span> <span data-ttu-id="72c01-193">图4显示了 Visual Web Developer 数据库资源管理器中的 `Reviews.mdf` 数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-193">Figure 4 shows the `Reviews.mdf` database in the Database Explorer in Visual Web Developer.</span></span> <span data-ttu-id="72c01-194">如图4所示，`Reviews.mdf` 数据库由四个表组成，三个存储过程和用户定义函数组成。</span><span class="sxs-lookup"><span data-stu-id="72c01-194">As Figure 4 shows, the `Reviews.mdf` database is composed of four tables, three stored procedures, and a user-defined function.</span></span>

<span data-ttu-id="72c01-195">[![在数据库资源管理器或服务器资源管理器中查找数据库](deploying-a-database-cs/_static/image11.jpg)](deploying-a-database-cs/_static/image10.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-195">[![Locate the Database in the Database Explorer or Server Explorer](deploying-a-database-cs/_static/image11.jpg)](deploying-a-database-cs/_static/image10.jpg)</span></span> 

<span data-ttu-id="72c01-196">**图 4**：在数据库资源管理器或服务器资源管理器中找到数据库（[单击查看完全大小的映像](deploying-a-database-cs/_static/image12.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-196">**Figure 4**: Locate the Database in the Database Explorer or Server Explorer ([Click to view full-size image](deploying-a-database-cs/_static/image12.jpg))</span></span>

<span data-ttu-id="72c01-197">右键单击数据库名称，并从上下文菜单中选择 "发布到提供程序" 选项。</span><span class="sxs-lookup"><span data-stu-id="72c01-197">Right-click on the database name and choose the "Publish to provider" option from the context menu.</span></span> <span data-ttu-id="72c01-198">这将启动数据库发布向导（见图5）。</span><span class="sxs-lookup"><span data-stu-id="72c01-198">This launches the Database Publishing Wizard (see Figure 5).</span></span> <span data-ttu-id="72c01-199">单击 "下一步" 以提前越过初始屏幕。</span><span class="sxs-lookup"><span data-stu-id="72c01-199">Click Next to advance past the splash screen.</span></span>

<span data-ttu-id="72c01-200">[![数据库发布向导初始屏幕](deploying-a-database-cs/_static/image14.jpg)](deploying-a-database-cs/_static/image13.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-200">[![The Database Publishing Wizard Splash Screen](deploying-a-database-cs/_static/image14.jpg)](deploying-a-database-cs/_static/image13.jpg)</span></span> 

<span data-ttu-id="72c01-201">**图 5**：数据库发布向导初始屏幕（[单击以查看完全大小的图像](deploying-a-database-cs/_static/image15.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-201">**Figure 5**: The Database Publishing Wizard Splash Screen ([Click to view full-size image](deploying-a-database-cs/_static/image15.jpg))</span></span>

<span data-ttu-id="72c01-202">向导中的第二个屏幕列出了数据库发布向导可访问的数据库，并允许您选择是为所选数据库中的所有对象编写脚本，还是选择要编写脚本的对象。</span><span class="sxs-lookup"><span data-stu-id="72c01-202">The second screen in the wizard lists the databases accessible to the Database Publishing Wizard and lets you choose whether to script all objects in the selected database or to pick which objects to script.</span></span> <span data-ttu-id="72c01-203">选择适当的数据库，并选中 "为所选数据库中的所有对象编写脚本" 选项。</span><span class="sxs-lookup"><span data-stu-id="72c01-203">Select the appropriate database and leave the "Script all objects in the selected database" option checked.</span></span>

> [!NOTE]
> <span data-ttu-id="72c01-204">如果在图6所示的屏幕中单击 "下一步"，则会出现错误 "此向导可编写脚本的数据库的数据库*名称*中没有对象"，请确保数据库文件的路径不太长。</span><span class="sxs-lookup"><span data-stu-id="72c01-204">If you get the error "There are no objects in database *databaseName* of the types scriptable by this wizard" when clicking Next in the screen shown in Figure 6, make sure that the path to your database file is not overly long.</span></span> <span data-ttu-id="72c01-205">已发现，如果数据库文件的路径太长，则会出现此错误。</span><span class="sxs-lookup"><span data-stu-id="72c01-205">It has been discovered that this error can arise if the path to the database file is too long.</span></span>

<span data-ttu-id="72c01-206">[![数据库发布向导初始屏幕](deploying-a-database-cs/_static/image17.jpg)](deploying-a-database-cs/_static/image16.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-206">[![The Database Publishing Wizard Splash Screen](deploying-a-database-cs/_static/image17.jpg)](deploying-a-database-cs/_static/image16.jpg)</span></span> 

<span data-ttu-id="72c01-207">**图 6**：数据库发布向导初始屏幕（[单击以查看完全大小的图像](deploying-a-database-cs/_static/image18.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-207">**Figure 6**: The Database Publishing Wizard Splash Screen ([Click to view full-size image](deploying-a-database-cs/_static/image18.jpg))</span></span>

<span data-ttu-id="72c01-208">在下一个屏幕中，你可以生成一个脚本文件，或者，如果你的 web 主机支持该文件，则将数据库直接发布到你的 web 主机提供程序的数据库服务器。</span><span class="sxs-lookup"><span data-stu-id="72c01-208">From the next screen you can generate a script file or, if your web host supports it, publish the database directly to your web host provider s database server.</span></span> <span data-ttu-id="72c01-209">如图7所示，我已将脚本写入 `C:\REVIEWS.MDF.sql`文件中。</span><span class="sxs-lookup"><span data-stu-id="72c01-209">As Figure 7 shows, I am having the script written to the file `C:\REVIEWS.MDF.sql`.</span></span>

<span data-ttu-id="72c01-210">[![将数据库脚本保存到文件或将其直接发布到 Web 主机提供程序](deploying-a-database-cs/_static/image20.jpg)](deploying-a-database-cs/_static/image19.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-210">[![Script the Database to a File or Publish it Directly to Your Web Host Provider](deploying-a-database-cs/_static/image20.jpg)](deploying-a-database-cs/_static/image19.jpg)</span></span> 

<span data-ttu-id="72c01-211">**图 7**：将数据库脚本保存到文件或将其直接发布到 Web 主机提供程序（[单击查看完全大小的图像](deploying-a-database-cs/_static/image21.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-211">**Figure 7**: Script the Database to a File or Publish it Directly to Your Web Host Provider ([Click to view full-size image](deploying-a-database-cs/_static/image21.jpg))</span></span>

<span data-ttu-id="72c01-212">后续屏幕将提示你提供各种脚本编写选项。</span><span class="sxs-lookup"><span data-stu-id="72c01-212">The subsequent screen prompts you for a variety of scripting options.</span></span> <span data-ttu-id="72c01-213">你可以指定脚本是否应包含 drop 语句来删除这些现有对象。</span><span class="sxs-lookup"><span data-stu-id="72c01-213">You can specify whether the script should include drop statements to remove these existing objects.</span></span> <span data-ttu-id="72c01-214">默认值为 True，这在第一次部署数据库时很合适。</span><span class="sxs-lookup"><span data-stu-id="72c01-214">This defaults to True, which is fine when deploying a database for the first time.</span></span> <span data-ttu-id="72c01-215">你还可以指定目标数据库是 SQL Server 2000、SQL Server 2005 还是 SQL Server 2008。</span><span class="sxs-lookup"><span data-stu-id="72c01-215">You can also specify whether the target database is SQL Server 2000, SQL Server 2005, or SQL Server 2008.</span></span> <span data-ttu-id="72c01-216">最后，您可以指示是编写架构和数据的脚本、仅编写数据还是仅编写架构的脚本。</span><span class="sxs-lookup"><span data-stu-id="72c01-216">Finally, you can indicate whether to script the schema and data, just the data, or just the schema.</span></span> <span data-ttu-id="72c01-217">该架构是数据库对象、表、存储过程、视图等的集合。</span><span class="sxs-lookup"><span data-stu-id="72c01-217">The schema is the collection of database objects, the tables, stored procedures, views, and so on.</span></span> <span data-ttu-id="72c01-218">数据是驻留在表中的信息。</span><span class="sxs-lookup"><span data-stu-id="72c01-218">The data is the information residing in the tables.</span></span>

<span data-ttu-id="72c01-219">如图8所示，将向导配置为删除现有数据库对象，为 SQL Server 2008 数据库生成脚本，同时发布架构和数据。</span><span class="sxs-lookup"><span data-stu-id="72c01-219">As Figure 8 illustrates, I ve got the wizard configured to drop existing database objects, to generate script for a SQL Server 2008 database, and to publish both the schema and data.</span></span>

<span data-ttu-id="72c01-220">[![指定发布选项](deploying-a-database-cs/_static/image23.jpg)](deploying-a-database-cs/_static/image22.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-220">[![Specify the Publishing Options](deploying-a-database-cs/_static/image23.jpg)](deploying-a-database-cs/_static/image22.jpg)</span></span> 

<span data-ttu-id="72c01-221">**图 8**：指定发布选项（[单击以查看完全大小的图像](deploying-a-database-cs/_static/image24.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-221">**Figure 8**: Specify the Publishing Options ([Click to view full-size image](deploying-a-database-cs/_static/image24.jpg))</span></span>

<span data-ttu-id="72c01-222">最后两个屏幕汇总了将要执行的操作，并显示脚本的状态。</span><span class="sxs-lookup"><span data-stu-id="72c01-222">The final two screens summarize the actions that are about to be taken and then display the status of the scripting.</span></span> <span data-ttu-id="72c01-223">运行向导的最终结果是，我们有一个脚本文件，其中包含在生产环境中创建数据库所需的 SQL 命令，并使用与开发时相同的数据进行填充。</span><span class="sxs-lookup"><span data-stu-id="72c01-223">The net result of running the wizard is that we have a script file that contains the SQL commands needed to create the database on production and populate it with the same data as on development.</span></span>

### <a name="executing-the-sql-commands-on-the-production-environment-database"></a><span data-ttu-id="72c01-224">在生产环境数据库上执行 SQL 命令</span><span class="sxs-lookup"><span data-stu-id="72c01-224">Executing the SQL Commands On the Production Environment Database</span></span>

<span data-ttu-id="72c01-225">现在，我们已经有了包含用于创建数据库的 SQL 命令的脚本及其数据，接下来要对生产数据库执行该脚本。</span><span class="sxs-lookup"><span data-stu-id="72c01-225">Now that we have the script that contains the SQL commands to create the database and its data all that remains is to execute the script on the production database.</span></span> <span data-ttu-id="72c01-226">某些 web 宿主提供程序在 "控制面板" 中提供一个文本框，您可以在其中输入要在数据库上执行的 SQL 命令。</span><span class="sxs-lookup"><span data-stu-id="72c01-226">Some web host providers offer a textbox in their Control Panel where you can enter SQL commands to execute on your database.</span></span> <span data-ttu-id="72c01-227">如果你有一个非常大的脚本文件，则此选项可能不起作用（例如 `REVIEWS.MDF.sql` 脚本文件的大小超过 425 KB）。</span><span class="sxs-lookup"><span data-stu-id="72c01-227">If you have a very large script file then this option might not work (the `REVIEWS.MDF.sql` script file is over 425 KB in size, for instance).</span></span>

<span data-ttu-id="72c01-228">更好的方法是使用 SQL Server Management Studio （SSMS）直接连接到生产数据库服务器。</span><span class="sxs-lookup"><span data-stu-id="72c01-228">A better approach is to connect directly to the production database server using SQL Server Management Studio (SSMS).</span></span> <span data-ttu-id="72c01-229">如果计算机上安装了非 Express 版本的 SQL Server，则可能已经安装了 SSMS。</span><span class="sxs-lookup"><span data-stu-id="72c01-229">If you have a non-Express Edition of SQL Server installed on your computer then you likely already have SSMS installed.</span></span> <span data-ttu-id="72c01-230">否则，你可以[下载并安装](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en)SQL Server Management Studio Express Edition 的免费副本。</span><span class="sxs-lookup"><span data-stu-id="72c01-230">Otherwise, you can [download and install](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en) a free copy of SQL Server Management Studio Express Edition.</span></span>

<span data-ttu-id="72c01-231">使用 web 主机提供商提供的信息启动 SSMS 并连接到 web 主机的数据库服务器。</span><span class="sxs-lookup"><span data-stu-id="72c01-231">Launch SSMS and connect to your web host s database server using the information provided by your web host provider.</span></span>

<span data-ttu-id="72c01-232">[![连接到 Web 主机提供程序的数据库服务器](deploying-a-database-cs/_static/image26.jpg)](deploying-a-database-cs/_static/image25.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-232">[![Connect to Your Web Host Provider s Database Server](deploying-a-database-cs/_static/image26.jpg)](deploying-a-database-cs/_static/image25.jpg)</span></span> 

<span data-ttu-id="72c01-233">**图 9**：连接到 Web 主机提供程序的数据库服务器（[单击以查看完全大小的映像](deploying-a-database-cs/_static/image27.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-233">**Figure 9**: Connect to Your Web Host Provider s Database Server ([Click to view full-size image](deploying-a-database-cs/_static/image27.jpg))</span></span>

<span data-ttu-id="72c01-234">展开 "数据库" 选项卡，找到数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-234">Expand the Databases tab and locate your database.</span></span> <span data-ttu-id="72c01-235">单击工具栏左上角的 "新建查询" 按钮，从数据库发布向导创建的脚本文件粘贴 SQL 命令，然后单击 "执行" 按钮在生产数据库服务器上运行这些命令。</span><span class="sxs-lookup"><span data-stu-id="72c01-235">Click the New Query button in the upper left corner of the Toolbar, paste in the SQL commands from the script file created by the Database Publishing Wizard, and click the Execute button to run these commands on the production database server.</span></span> <span data-ttu-id="72c01-236">如果脚本文件特别大，可能需要花费几分钟时间来执行命令。</span><span class="sxs-lookup"><span data-stu-id="72c01-236">If your script file is especially large it may take several minutes to execute the commands.</span></span>

<span data-ttu-id="72c01-237">[![连接到 Web 主机提供程序的数据库服务器](deploying-a-database-cs/_static/image29.jpg)](deploying-a-database-cs/_static/image28.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-237">[![Connect to Your Web Host Provider s Database Server](deploying-a-database-cs/_static/image29.jpg)](deploying-a-database-cs/_static/image28.jpg)</span></span> 

<span data-ttu-id="72c01-238">**图 10**：连接到 Web 主机提供程序的数据库服务器（[单击以查看完全大小的映像](deploying-a-database-cs/_static/image30.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-238">**Figure 10**: Connect to Your Web Host Provider s Database Server ([Click to view full-size image](deploying-a-database-cs/_static/image30.jpg))</span></span>

<span data-ttu-id="72c01-239">就是这样！</span><span class="sxs-lookup"><span data-stu-id="72c01-239">That s all there is to it!</span></span> <span data-ttu-id="72c01-240">此时，开发数据库已复制到生产数据库中。</span><span class="sxs-lookup"><span data-stu-id="72c01-240">At this point the development database has been duplicated to production.</span></span> <span data-ttu-id="72c01-241">如果在 SSMS 中刷新数据库，则应该会看到新的数据库对象。</span><span class="sxs-lookup"><span data-stu-id="72c01-241">If you Refresh the database in SSMS you should see the new database objects.</span></span> <span data-ttu-id="72c01-242">图11显示了生产数据库的表、存储过程和用户定义的函数，这些函数在开发数据库上进行镜像。</span><span class="sxs-lookup"><span data-stu-id="72c01-242">Figure 11 shows the production database s tables, stored procedures, and user-defined functions, which mirror those on the development database.</span></span> <span data-ttu-id="72c01-243">而且，由于我们指示 "数据库发布向导" 发布数据，因此在执行向导时，生产数据库的表与开发数据库的表具有相同的数据。</span><span class="sxs-lookup"><span data-stu-id="72c01-243">And because we instructed the Database Publishing Wizard to publish the data, the production database s tables have the same data as the development database s tables at the time the wizard was executed.</span></span> <span data-ttu-id="72c01-244">图12显示了生产数据库上 `Books` 表中的数据。</span><span class="sxs-lookup"><span data-stu-id="72c01-244">Figure 12 shows the data in the `Books` table on the production database.</span></span>

<span data-ttu-id="72c01-245">[![数据库对象在生产数据库上重复](deploying-a-database-cs/_static/image32.jpg)](deploying-a-database-cs/_static/image31.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-245">[![The Database Objects Have Been Duplicated on the Production Database](deploying-a-database-cs/_static/image32.jpg)](deploying-a-database-cs/_static/image31.jpg)</span></span> 

<span data-ttu-id="72c01-246">**图 11**：数据库对象在生产数据库上重复（[单击以查看完全大小的图像](deploying-a-database-cs/_static/image33.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-246">**Figure 11**: The Database Objects Have Been Duplicated on the Production Database ([Click to view full-size image](deploying-a-database-cs/_static/image33.jpg))</span></span>

<span data-ttu-id="72c01-247">[![生产数据库包含与开发数据库相同的数据](deploying-a-database-cs/_static/image35.jpg)](deploying-a-database-cs/_static/image34.jpg)</span><span class="sxs-lookup"><span data-stu-id="72c01-247">[![The Production Database Contains the Same Data as on the Development Database](deploying-a-database-cs/_static/image35.jpg)](deploying-a-database-cs/_static/image34.jpg)</span></span> 

<span data-ttu-id="72c01-248">**图 12**：生产数据库包含与开发数据库相同的数据（[单击查看完全大小的映像](deploying-a-database-cs/_static/image36.jpg)）</span><span class="sxs-lookup"><span data-stu-id="72c01-248">**Figure 12**: The Production Database Contains the Same Data as on the Development Database ([Click to view full-size image](deploying-a-database-cs/_static/image36.jpg))</span></span>

<span data-ttu-id="72c01-249">此时，我们只将开发数据库部署到生产环境。</span><span class="sxs-lookup"><span data-stu-id="72c01-249">At this point we have only deployed the development database to production.</span></span> <span data-ttu-id="72c01-250">我们尚未介绍如何部署 web 应用程序，或检查在生产环境中使用生产数据库所需的配置更改。</span><span class="sxs-lookup"><span data-stu-id="72c01-250">We have not yet looked at deploying the web application itself or examined what configuration changes are needed to have the application on production use the production database.</span></span> <span data-ttu-id="72c01-251">在下一教程中，我们将介绍这些问题！</span><span class="sxs-lookup"><span data-stu-id="72c01-251">We'll cover these issues in the next tutorial!</span></span>

## <a name="summary"></a><span data-ttu-id="72c01-252">总结</span><span class="sxs-lookup"><span data-stu-id="72c01-252">Summary</span></span>

<span data-ttu-id="72c01-253">部署数据驱动的 web 应用程序需要将开发期间使用的数据库复制到生产环境中。</span><span class="sxs-lookup"><span data-stu-id="72c01-253">Deploying a data-driven web application requires copying the database used during development to the production environment.</span></span> <span data-ttu-id="72c01-254">许多 web 宿主提供程序提供工具来简化数据库的部署过程。</span><span class="sxs-lookup"><span data-stu-id="72c01-254">Many web host providers offer tools to simplify the process of deploying a database.</span></span> <span data-ttu-id="72c01-255">例如，使用 DiscountASP.NET 可以将数据库 `.mdf` 文件（或备份）的 FTP，然后将数据库附加到控制面板中的数据库服务器。</span><span class="sxs-lookup"><span data-stu-id="72c01-255">For example, with DiscountASP.NET you can FTP your database `.mdf` file (or a backup) and then attach the database to the database server from the Control Panel.</span></span> <span data-ttu-id="72c01-256">如果你的 web 宿主提供程序提供的功能是 Microsoft 的数据库发布向导工具，则可以使用另一个选项，它将生成 SQL 命令的脚本来创建开发数据库的架构和数据。</span><span class="sxs-lookup"><span data-stu-id="72c01-256">Another option that works regardless of what features your web host provider offers is Microsoft s Database Publishing Wizard tool, which generates a script of SQL commands to create the development database s schema and data.</span></span> <span data-ttu-id="72c01-257">生成此脚本后，可以在生产数据库中执行它。</span><span class="sxs-lookup"><span data-stu-id="72c01-257">Once this script has been generated you can execute it on the production database.</span></span>

<span data-ttu-id="72c01-258">现在，书籍检查 web 应用程序的数据库是否在生产环境中，我们可以部署该应用程序。</span><span class="sxs-lookup"><span data-stu-id="72c01-258">Now that the Book Reviews web application s database is on production we can deploy the application.</span></span> <span data-ttu-id="72c01-259">但是，web 应用程序的配置信息指定数据库的连接字符串，并且该连接字符串引用开发数据库。</span><span class="sxs-lookup"><span data-stu-id="72c01-259">However, the web application s configuration information specifies the connection string to the database, and that connection string references the development database.</span></span> <span data-ttu-id="72c01-260">在将站点部署到生产环境时，需要更新此连接字符串信息。</span><span class="sxs-lookup"><span data-stu-id="72c01-260">We need to update this connection string information when deploying the site to production.</span></span> <span data-ttu-id="72c01-261">下一教程将介绍这些配置差异，并演练将数据驱动的书籍评论站点发布到生产所需的步骤。</span><span class="sxs-lookup"><span data-stu-id="72c01-261">The next tutorial looks at these configuration differences and walks through the steps needed to publish the data-driven Book Reviews site to production.</span></span>

<span data-ttu-id="72c01-262">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="72c01-262">Happy Programming!</span></span>

#### <a name="further-reading"></a><span data-ttu-id="72c01-263">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="72c01-263">Further Reading</span></span>

<span data-ttu-id="72c01-264">有关本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="72c01-264">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="72c01-265">下载 Microsoft SQL Server 数据库发布向导1。1</span><span class="sxs-lookup"><span data-stu-id="72c01-265">Download the Microsoft SQL Server Database Publishing Wizard 1.1</span></span>](https://www.microsoft.com/downloads/details.aspx?familyid=56E5B1C5-BF17-42E0-A410-371A838E570A&amp;displaylang=en)
- [<span data-ttu-id="72c01-266">下载 Microsoft SQL Server Management Studio Express Edition</span><span class="sxs-lookup"><span data-stu-id="72c01-266">Download the Microsoft SQL Server Management Studio Express Edition</span></span>](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en)

> [!div class="step-by-step"]
> <span data-ttu-id="72c01-267">[上一页](core-differences-between-iis-and-the-asp-net-development-server-cs.md)
> [下一页](configuring-the-production-web-application-to-use-the-production-database-cs.md)</span><span class="sxs-lookup"><span data-stu-id="72c01-267">[Previous](core-differences-between-iis-and-the-asp-net-development-server-cs.md)
[Next](configuring-the-production-web-application-to-use-the-production-database-cs.md)</span></span>

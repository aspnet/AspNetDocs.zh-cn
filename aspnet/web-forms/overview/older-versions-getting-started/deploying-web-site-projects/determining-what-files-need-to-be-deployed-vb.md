---
uid: web-forms/overview/older-versions-getting-started/deploying-web-site-projects/determining-what-files-need-to-be-deployed-vb
title: 确定需要部署哪些文件（VB） |Microsoft Docs
author: rick-anderson
description: 需要从开发环境中将哪些文件部署到生产环境，具体取决于是否生成了 ASP.NET 应用程序。
ms.author: riande
ms.date: 04/01/2009
ms.assetid: ea918f62-c9d6-4a7f-9bc6-e054d3764b2c
msc.legacyurl: /web-forms/overview/older-versions-getting-started/deploying-web-site-projects/determining-what-files-need-to-be-deployed-vb
msc.type: authoredcontent
ms.openlocfilehash: a11dadfda8b6a189acedd7ac723d85f8b2084324
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2020
ms.locfileid: "78515732"
---
# <a name="determining-what-files-need-to-be-deployed-vb"></a><span data-ttu-id="d86f6-103">确定需要部署哪些文件 (VB)</span><span class="sxs-lookup"><span data-stu-id="d86f6-103">Determining What Files Need to Be Deployed (VB)</span></span>

<span data-ttu-id="d86f6-104">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="d86f6-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="d86f6-105">[下载代码](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_02_VB.zip)或[下载 PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial02_FilesToDeploy_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="d86f6-105">[Download Code](https://download.microsoft.com/download/4/5/F/45F815EC-8B0E-46D3-9FB8-2DC015CCA306/ASPNET_Hosting_Tutorial_02_VB.zip) or [Download PDF](https://download.microsoft.com/download/E/8/9/E8920AE6-D441-41A7-8A77-9EF8FF970D8B/aspnet_tutorial02_FilesToDeploy_vb.pdf)</span></span>

> <span data-ttu-id="d86f6-106">需要从开发环境中将哪些文件部署到生产环境，具体取决于是否使用网站模型或 Web 应用程序模型生成了 ASP.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="d86f6-106">What files need to be deployed from the development environment to the production environment depends in part on whether the ASP.NET application was built using the Web Site Model or Web Application Model.</span></span> <span data-ttu-id="d86f6-107">了解有关这两个项目模型的详细信息，以及项目模型如何影响部署。</span><span class="sxs-lookup"><span data-stu-id="d86f6-107">Learn more about these two project models and how the project model affects deployment.</span></span>

## <a name="introduction"></a><span data-ttu-id="d86f6-108">简介</span><span class="sxs-lookup"><span data-stu-id="d86f6-108">Introduction</span></span>

<span data-ttu-id="d86f6-109">部署 ASP.NET web 应用程序需要将 ASP.NET 相关文件从开发环境复制到生产环境。</span><span class="sxs-lookup"><span data-stu-id="d86f6-109">Deploying an ASP.NET web application entails copying the ASP.NET-related files from the development environment to the production environment.</span></span> <span data-ttu-id="d86f6-110">与 ASP.NET 相关的文件包括 ASP.NET 网页标记和代码以及客户端和服务器端支持文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-110">The ASP.NET-related files include ASP.NET web page markup and code and client- and server-side support files.</span></span> <span data-ttu-id="d86f6-111">客户端支持文件是由网页引用并直接发送到浏览器图像、CSS 文件和 JavaScript 文件的那些文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-111">Client-side support files are those files referenced by your web pages and sent directly to the browser - images, CSS files and JavaScript files, for example.</span></span> <span data-ttu-id="d86f6-112">服务器端支持文件包含用于处理服务器端请求的文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-112">Server-side support files include those that are used to process a request on the server-side.</span></span> <span data-ttu-id="d86f6-113">这包括配置文件、web 服务、类文件、类型化数据集和 LINQ to SQL 文件，等等。</span><span class="sxs-lookup"><span data-stu-id="d86f6-113">This includes configuration files, web services, class files, Typed DataSets, and LINQ to SQL files, among others.</span></span>

<span data-ttu-id="d86f6-114">通常情况下，所有客户端支持文件都应该从开发环境复制到生产环境中，但复制哪些服务器端支持文件取决于您是要将服务器端代码显式编译到程序集（`.dll` 文件），还是要自动生成这些程序集。</span><span class="sxs-lookup"><span data-stu-id="d86f6-114">In general, all client-side support files should be copied from the development environment to the production environment, but what server-side support files get copied depends on whether you are explicitly compiling the server-side code into an assembly (a `.dll` file) or if you are having these assemblies auto-generated.</span></span> <span data-ttu-id="d86f6-115">本教程重点介绍在将代码显式编译到程序集中，而不是自动执行此编译步骤时需要部署哪些文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-115">This tutorial highlights what files need to be deployed when explicitly compiling the code into an assembly versus having this compilation step occur automatically.</span></span>

## <a name="explicit-compilation-versus-automatic-compilation"></a><span data-ttu-id="d86f6-116">显式编译与自动编译</span><span class="sxs-lookup"><span data-stu-id="d86f6-116">Explicit Compilation Versus Automatic Compilation</span></span>

<span data-ttu-id="d86f6-117">ASP.NET 网页分为声明性标记和源代码。</span><span class="sxs-lookup"><span data-stu-id="d86f6-117">ASP.NET web pages are divided into declarative markup and source code.</span></span> <span data-ttu-id="d86f6-118">声明性标记部分包括 HTML、Web 控件和数据绑定语法;代码部分包含用 Visual Basic 或C#代码编写的事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="d86f6-118">The declarative markup portion includes HTML, Web controls, and databinding syntax; the code portion contains event handlers written in Visual Basic or C# code.</span></span> <span data-ttu-id="d86f6-119">标记和代码部分通常分成不同的文件：在 `WebPage.aspx.vb` 包含代码时，`WebPage.aspx` 包含声明性标记。</span><span class="sxs-lookup"><span data-stu-id="d86f6-119">The markup and code portions are typically separated into different files: `WebPage.aspx` contains the declarative markup while `WebPage.aspx.vb` houses the code.</span></span>

<span data-ttu-id="d86f6-120">假设有一个名为 `Clock.aspx` 的 "ASP.NET" 页，其中包含一个 "标签" 控件，其 Text 属性设置为当前日期和页面加载时间。</span><span class="sxs-lookup"><span data-stu-id="d86f6-120">Consider an ASP.NET page named `Clock.aspx` that contains a Label control whose Text property is set to the current date and time when the page loads.</span></span> <span data-ttu-id="d86f6-121">声明性标记部分（在 `Clock.aspx`中）包含标签 Web 控件 `<asp:Label runat="server" id="TimeLabel" />` 的标记，而代码部分（在 `Clock.aspx.vb`中）将具有具有以下代码的 `Page_Load` 事件处理程序：</span><span class="sxs-lookup"><span data-stu-id="d86f6-121">The declarative markup portion (in `Clock.aspx`) would contain the markup for a Label Web control - `<asp:Label runat="server" id="TimeLabel" />` - while the code portion (in `Clock.aspx.vb`) would have a `Page_Load` event handler with the following code:</span></span>

[!code-vb[Main](determining-what-files-need-to-be-deployed-vb/samples/sample1.vb)]

<span data-ttu-id="d86f6-122">为了使 ASP.NET 引擎为此页面的请求提供服务，必须首先编译页面的代码部分（ *`WebPage`* `.aspx.vb` 文件）。</span><span class="sxs-lookup"><span data-stu-id="d86f6-122">In order for the ASP.NET engine to service a request for this page, the page's code portion (the *`WebPage`*`.aspx.vb` file) must first be compiled.</span></span> <span data-ttu-id="d86f6-123">此编译可以显式或自动发生。</span><span class="sxs-lookup"><span data-stu-id="d86f6-123">This compilation can happen explicitly or automatically.</span></span>

<span data-ttu-id="d86f6-124">如果编译显式发生，则整个应用程序的源代码将编译为位于应用程序的 `Bin` 目录中的一个或多个程序集（`.dll` 文件）。</span><span class="sxs-lookup"><span data-stu-id="d86f6-124">If the compilation happens explicitly then the entire application's source code is compiled into one or more assemblies (`.dll` files) located in the application's `Bin` directory.</span></span> <span data-ttu-id="d86f6-125">如果编译自动发生，则默认情况下，生成的自动生成的程序集将位于 `Temporary ASP.NET Files` 文件夹中，该文件夹可在 `%WINDOWS%\Microsoft.NET\Framework\<version>`中找到，尽管可通过 `Web.config`中的[&lt;编译&gt; 元素](https://msdn.microsoft.com/library/s10awwz0.aspx)配置此位置。</span><span class="sxs-lookup"><span data-stu-id="d86f6-125">If the compilation happens automatically then the resulting auto-generated assembly is, by default, placed in the `Temporary ASP.NET Files` folder, which can be found at `%WINDOWS%\Microsoft.NET\Framework\<version>`, although this location is configurable via the [&lt;compilation&gt; element](https://msdn.microsoft.com/library/s10awwz0.aspx) in `Web.config`.</span></span> <span data-ttu-id="d86f6-126">使用显式编译时，必须执行一些操作来将 ASP.NET 应用程序的代码编译为程序集，并在部署之前进行此步骤。</span><span class="sxs-lookup"><span data-stu-id="d86f6-126">With explicit compilation you must take some action to compile the ASP.NET application's code into an assembly, and this step occurs prior to deployment.</span></span> <span data-ttu-id="d86f6-127">通过自动编译，在首次访问资源时，会在 web 服务器上执行编译过程。</span><span class="sxs-lookup"><span data-stu-id="d86f6-127">With automatic compilation the compilation process occurs on the web server when the resource is first accessed.</span></span>

<span data-ttu-id="d86f6-128">无论使用何种编译模型，都需要将所有 ASP.NET 页（`WebPage.aspx` 文件）的标记部分复制到生产环境中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-128">Regardless of what compilation model you use, the markup portion of all ASP.NET pages (the `WebPage.aspx` files) need to be copied to the production environment.</span></span> <span data-ttu-id="d86f6-129">对于显式编译，你需要复制 `Bin` 文件夹中的程序集，但不需要复制 ASP.NET 页面的代码部分（`WebPage.aspx.vb` 文件）。</span><span class="sxs-lookup"><span data-stu-id="d86f6-129">With explicit compilation you need to copy up the assemblies in the `Bin` folder, but you do not need to copy up the ASP.NET pages' code portions (the `WebPage.aspx.vb` files).</span></span> <span data-ttu-id="d86f6-130">通过自动编译，你需要复制代码部分文件，使代码存在，并可在访问页面时自动编译。</span><span class="sxs-lookup"><span data-stu-id="d86f6-130">With automatic compilation you need to copy up the code portion files so that the code is present and can be compiled automatically when the page is visited.</span></span> <span data-ttu-id="d86f6-131">每个 ASP.NET 网页的标记部分都包含一个 `@Page` 指令，该指令的特性指示是否已显式编译该页的关联代码，或者是否需要自动编译该页。</span><span class="sxs-lookup"><span data-stu-id="d86f6-131">The markup portion of each ASP.NET web page includes a `@Page` directive with attributes that indicate whether the page's associated code was already explicitly compiled or whether it needs to be automatically compiled.</span></span> <span data-ttu-id="d86f6-132">因此，生产环境可以无缝地使用任一编译模型，并且无需应用任何特殊的配置设置来指示显式或自动编译。</span><span class="sxs-lookup"><span data-stu-id="d86f6-132">As a result, the production environment can work with either compilation model seamlessly and you do not need to apply any special configuration settings to indicate that explicit or automatic compilation is used.</span></span>

<span data-ttu-id="d86f6-133">表1汇总了使用显式编译与自动编译时要部署的不同文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-133">Table 1 summarizes the different files to deploy when using explicit compilation versus automatic compilation.</span></span> <span data-ttu-id="d86f6-134">请注意，无论使用何种编译模型，都应始终将程序集部署到 `Bin` 文件夹中（如果该文件夹存在）。</span><span class="sxs-lookup"><span data-stu-id="d86f6-134">Note that regardless of the compilation model used you should always deploy the assemblies in the `Bin` folder, if that folder exists.</span></span> <span data-ttu-id="d86f6-135">`Bin` 文件夹包含特定于 web 应用程序的程序集，该程序集包括使用显式编译模型时编译的源代码。</span><span class="sxs-lookup"><span data-stu-id="d86f6-135">The `Bin` folder contains the assemblies specific to the web application, which include the compiled source code when using the explicit compilation model.</span></span> <span data-ttu-id="d86f6-136">`Bin` 目录还包含其他项目中的程序集，以及你可能使用的任何开源或第三方程序集，这些程序集需要位于生产服务器上。</span><span class="sxs-lookup"><span data-stu-id="d86f6-136">The `Bin` directory also contains assemblies from other projects and any open-source or third-party assemblies you may be using, and these need to be on the production server.</span></span> <span data-ttu-id="d86f6-137">因此，一般的经验法则是在部署时将 `Bin` 文件夹复制到生产环境中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-137">Therefore, as a general rule of thumb, copy the `Bin` folder up to production when deploying.</span></span> <span data-ttu-id="d86f6-138">（如果使用的是自动编译模型，但不使用任何外部程序集，则不会有 `Bin` 目录-这是正常的！）</span><span class="sxs-lookup"><span data-stu-id="d86f6-138">(If you are using the automatic compilation model and are not using any external assemblies then you won't have a `Bin` directory - that's OK!)</span></span>

| <span data-ttu-id="d86f6-139">**编译模型**</span><span class="sxs-lookup"><span data-stu-id="d86f6-139">**Compilation Model**</span></span> | <span data-ttu-id="d86f6-140">**部署标记部分文件？**</span><span class="sxs-lookup"><span data-stu-id="d86f6-140">**Deploy Markup Portion File?**</span></span> | <span data-ttu-id="d86f6-141">**部署源代码文件？**</span><span class="sxs-lookup"><span data-stu-id="d86f6-141">**Deploy Source Code File?**</span></span> | <span data-ttu-id="d86f6-142">**是否在 `Bin` Directory 中部署程序集？**</span><span class="sxs-lookup"><span data-stu-id="d86f6-142">**Deploy Assemblies in `Bin` Directory?**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="d86f6-143">显式编译</span><span class="sxs-lookup"><span data-stu-id="d86f6-143">Explicit Compilation</span></span> | <span data-ttu-id="d86f6-144">是</span><span class="sxs-lookup"><span data-stu-id="d86f6-144">Yes</span></span> | <span data-ttu-id="d86f6-145">No</span><span class="sxs-lookup"><span data-stu-id="d86f6-145">No</span></span> | <span data-ttu-id="d86f6-146">是</span><span class="sxs-lookup"><span data-stu-id="d86f6-146">Yes</span></span> |
| <span data-ttu-id="d86f6-147">自动编译</span><span class="sxs-lookup"><span data-stu-id="d86f6-147">Automatic Compilation</span></span> | <span data-ttu-id="d86f6-148">是</span><span class="sxs-lookup"><span data-stu-id="d86f6-148">Yes</span></span> | <span data-ttu-id="d86f6-149">是</span><span class="sxs-lookup"><span data-stu-id="d86f6-149">Yes</span></span> | <span data-ttu-id="d86f6-150">是（如果存在）</span><span class="sxs-lookup"><span data-stu-id="d86f6-150">Yes (if it exists)</span></span> |

<span data-ttu-id="d86f6-151">**表1：部署哪些文件取决于所使用的编译模型。**</span><span class="sxs-lookup"><span data-stu-id="d86f6-151">**Table 1: What files you deploy depends on the compilation model used.**</span></span>

## <a name="taking-a-trip-down-memory-lane"></a><span data-ttu-id="d86f6-152">正在向下移动内存通道</span><span class="sxs-lookup"><span data-stu-id="d86f6-152">Taking a Trip Down Memory Lane</span></span>

<span data-ttu-id="d86f6-153">使用哪种编译方法，具体取决于在 Visual Studio 中管理 ASP.NET 应用程序的方式。</span><span class="sxs-lookup"><span data-stu-id="d86f6-153">What compilation approach is used depends, in part, on how the ASP.NET application is managed in Visual Studio.</span></span> <span data-ttu-id="d86f6-154">因此.2000年年，.NET 的开始时间为四个不同版本的 Visual Studio-Visual Studio .NET 2002、Visual Studio .NET 2003、Visual Studio 2005 和 Visual Studio 2008。</span><span class="sxs-lookup"><span data-stu-id="d86f6-154">Since .NET's inception in the year 2000 there have been four different versions of Visual Studio - Visual Studio .NET 2002, Visual Studio .NET 2003, Visual Studio 2005, and Visual Studio 2008.</span></span> <span data-ttu-id="d86f6-155">使用*Web 应用程序项目*模型的 Visual Studio .net 2002 和2003托管的 ASP.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="d86f6-155">Visual Studio .NET 2002 and 2003 managed ASP.NET applications using the *Web Application Project* model.</span></span> <span data-ttu-id="d86f6-156">Web 应用程序项目模型的主要功能是：</span><span class="sxs-lookup"><span data-stu-id="d86f6-156">The key features of the Web Application Project model are:</span></span>

- <span data-ttu-id="d86f6-157">构成项目的文件在单个项目文件中定义。</span><span class="sxs-lookup"><span data-stu-id="d86f6-157">The files that makeup the project are defined in a single project file.</span></span> <span data-ttu-id="d86f6-158">对于未在项目文件中定义的任何文件，Visual Studio 不会将其视为 web 应用程序的一部分。</span><span class="sxs-lookup"><span data-stu-id="d86f6-158">Any files not defined in the project file are not considered part of the web application by Visual Studio.</span></span>
- <span data-ttu-id="d86f6-159">使用显式编译。</span><span class="sxs-lookup"><span data-stu-id="d86f6-159">Uses explicit compilation.</span></span> <span data-ttu-id="d86f6-160">生成项目时，会将项目中的代码文件编译为放置在 `Bin` 文件夹中的单个程序集。</span><span class="sxs-lookup"><span data-stu-id="d86f6-160">Building the project compiles the code files within the project into a single assembly that is placed in the `Bin` folder.</span></span>

<span data-ttu-id="d86f6-161">当 Microsoft 发布 Visual Studio 2005 时，它们会丢弃对 Web 应用程序项目模型的支持，并将其替换为网站项目模型。</span><span class="sxs-lookup"><span data-stu-id="d86f6-161">When Microsoft released Visual Studio 2005 they dropped support for the Web Application Project model and replaced it with the Web Site Project model.</span></span> <span data-ttu-id="d86f6-162">网站项目模型通过以下方式区分*Web 应用程序项目*模型：</span><span class="sxs-lookup"><span data-stu-id="d86f6-162">The Web Site Project model differentiated itself from the *Web Application Project* model in the following ways:</span></span>

- <span data-ttu-id="d86f6-163">改为使用文件系统，而不是使用一个项目文件来拼写出项目的文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-163">Rather than having a single project file that spells out the project's files, the file system is used instead.</span></span> <span data-ttu-id="d86f6-164">简而言之，web 应用程序文件夹中的所有文件（或子文件夹）都被视为项目的一部分。</span><span class="sxs-lookup"><span data-stu-id="d86f6-164">In short, any files within the web application folder (or subfolders) are considered part of the project.</span></span>
- <span data-ttu-id="d86f6-165">在 Visual Studio 中生成项目不会在 `Bin` 目录中创建程序集。</span><span class="sxs-lookup"><span data-stu-id="d86f6-165">Building a project in Visual Studio does not create an assembly in the `Bin` directory.</span></span> <span data-ttu-id="d86f6-166">相反，生成网站项目会报告编译时错误。</span><span class="sxs-lookup"><span data-stu-id="d86f6-166">Instead, building a Web Site Project reports any compile-time errors.</span></span>
- <span data-ttu-id="d86f6-167">支持自动编译。</span><span class="sxs-lookup"><span data-stu-id="d86f6-167">Support for automatic compilation.</span></span> <span data-ttu-id="d86f6-168">通常通过将标记和源代码复制到生产环境来部署网站项目，尽管可以预编译代码（显式编译）。</span><span class="sxs-lookup"><span data-stu-id="d86f6-168">Web Site Projects are typically deployed by copying the markup and source code to the production environment, although the code can be precompiled (explicit compilation).</span></span>

<span data-ttu-id="d86f6-169">Microsoft 在发布 Visual Studio 2005 Service Pack 1 时恢复 Web 应用程序项目模型。</span><span class="sxs-lookup"><span data-stu-id="d86f6-169">Microsoft revived the Web Application Project model when it released Visual Studio 2005 Service Pack 1.</span></span> <span data-ttu-id="d86f6-170">但是，Visual Web Developer 仅支持网站项目模型。</span><span class="sxs-lookup"><span data-stu-id="d86f6-170">However, Visual Web Developer continued to only support the Web Site Project model.</span></span> <span data-ttu-id="d86f6-171">好消息是，Visual Web Developer 2008 Service Pack 1 删除了此限制。</span><span class="sxs-lookup"><span data-stu-id="d86f6-171">The good news is that this limitation was dropped with Visual Web Developer 2008 Service Pack 1.</span></span> <span data-ttu-id="d86f6-172">现在，你可以在 Visual Studio 中使用 Web 应用程序项目模型或网站项目模型创建 ASP.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="d86f6-172">Today you can create ASP.NET applications in Visual Studio (and Visual Web Developer) using either the Web Application Project model or the Web Site Project model.</span></span> <span data-ttu-id="d86f6-173">这两种模型都有其优点和缺点。</span><span class="sxs-lookup"><span data-stu-id="d86f6-173">Both models have their pros and cons.</span></span> <span data-ttu-id="d86f6-174">请参阅[Web 应用程序项目简介：比较网站项目和 Web 应用程序项目](https://msdn.microsoft.com/library/aa730880.aspx#wapp_topic5)以比较两个模型，帮助确定哪种项目模型最适合你的情况。</span><span class="sxs-lookup"><span data-stu-id="d86f6-174">Refer to [Introduction to Web Application Projects: Comparing Web Site Projects and Web Application Projects](https://msdn.microsoft.com/library/aa730880.aspx#wapp_topic5) for a comparison of the two models and to help decide what project model works best for your situation.</span></span>

## <a name="exploring-the-sample-web-application"></a><span data-ttu-id="d86f6-175">浏览示例 Web 应用程序</span><span class="sxs-lookup"><span data-stu-id="d86f6-175">Exploring the Sample Web Application</span></span>

<span data-ttu-id="d86f6-176">本教程的下载内容包括一个名为书籍检查的 ASP.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="d86f6-176">The download for this tutorial includes an ASP.NET application called Book Reviews.</span></span> <span data-ttu-id="d86f6-177">该网站模仿了某个爱好网站，该网站可能会创建一个爱好网站来与在线社区共享其书籍评论。</span><span class="sxs-lookup"><span data-stu-id="d86f6-177">The website mimics a hobby website someone might create to share their book reviews with the online community.</span></span> <span data-ttu-id="d86f6-178">此 ASP.NET web 应用程序非常简单，其中包含以下资源：</span><span class="sxs-lookup"><span data-stu-id="d86f6-178">This ASP.NET web application is very simple and consists of the following resources:</span></span>

- <span data-ttu-id="d86f6-179">`Web.config`，则为应用程序的配置文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-179">`Web.config`, the application's configuration file.</span></span>
- <span data-ttu-id="d86f6-180">一个母版页（`Site.master`）。</span><span class="sxs-lookup"><span data-stu-id="d86f6-180">A master page (`Site.master`).</span></span>
- <span data-ttu-id="d86f6-181">七个不同的 ASP.NET 页：</span><span class="sxs-lookup"><span data-stu-id="d86f6-181">Seven different ASP.NET pages:</span></span>

    - <span data-ttu-id="d86f6-182">~/`Default.aspx`-站点的主页。</span><span class="sxs-lookup"><span data-stu-id="d86f6-182">~/`Default.aspx` - the site's homepage.</span></span>
    - <span data-ttu-id="d86f6-183">~/`About.aspx`-"关于站点" 页面。</span><span class="sxs-lookup"><span data-stu-id="d86f6-183">~/`About.aspx` - an "About the Site" page.</span></span>
    - <span data-ttu-id="d86f6-184">~/`Fiction/Default.aspx`-列出已查看的小说书籍的页面。</span><span class="sxs-lookup"><span data-stu-id="d86f6-184">~/`Fiction/Default.aspx` - a page listing the fiction books that have been reviewed.</span></span>

        - <span data-ttu-id="d86f6-185">~/`Fiction/Blaze.aspx`-审阅 Richard Bachman novel *Blaze*。</span><span class="sxs-lookup"><span data-stu-id="d86f6-185">~/`Fiction/Blaze.aspx` - a review of the Richard Bachman novel *Blaze*.</span></span>
    - <span data-ttu-id="d86f6-186">~/`Tech/Default.aspx`-列出已评审的技术书籍的页面。</span><span class="sxs-lookup"><span data-stu-id="d86f6-186">~/`Tech/Default.aspx` - a page listing the technology books that have been reviewed.</span></span>

        - <span data-ttu-id="d86f6-187">~/`Tech/CYOW.aspx`-*创建你自己的网站*的评审。</span><span class="sxs-lookup"><span data-stu-id="d86f6-187">~/`Tech/CYOW.aspx` - a review of *Create Your Own Website*.</span></span>
        - <span data-ttu-id="d86f6-188">~/`Tech/TYASP35.aspx`-*在24小时内讲授 ASP.NET 3.5*的评论。</span><span class="sxs-lookup"><span data-stu-id="d86f6-188">~/`Tech/TYASP35.aspx` - a review of *Teach Yourself ASP.NET 3.5 in 24 Hours*.</span></span>
- <span data-ttu-id="d86f6-189">`Styles` 文件夹中有三个不同的 CSS 文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-189">Three different CSS files in the `Styles` folder.</span></span>
- <span data-ttu-id="d86f6-190">四个图像文件-由三个审阅的书籍的 ASP.NET 提供支持的徽标和图像-全部位于 `Images` 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-190">Four image files - a Powered by ASP.NET logo and images of the covers of the three reviewed books - all located in the `Images` folder.</span></span>
- <span data-ttu-id="d86f6-191">一个 `Web.sitemap` 文件，用于定义站点地图，并用于在根目录的 `Default.aspx` 页中显示菜单，以及 `Fiction` 和 `Tech` 文件夹。</span><span class="sxs-lookup"><span data-stu-id="d86f6-191">A `Web.sitemap` file, which defines the site map and is used to display menus in the `Default.aspx` pages in the root directory and `Fiction` and `Tech` folders.</span></span>
- <span data-ttu-id="d86f6-192">一个名为 `BasePage.vb` 的类文件，它定义基 `Page` 类。</span><span class="sxs-lookup"><span data-stu-id="d86f6-192">A class file named `BasePage.vb` that defines a base `Page` class.</span></span> <span data-ttu-id="d86f6-193">此类通过基于页面在站点地图中的位置自动设置 `Title` 属性，扩展了 `Page` 类的功能。</span><span class="sxs-lookup"><span data-stu-id="d86f6-193">This class extends the functionality of the `Page` class by automatically setting the `Title` property based on the page's position in the site map.</span></span> <span data-ttu-id="d86f6-194">简而言之，扩展 `BasePage` 的任何 ASP.NET 代码隐藏类（而不是 `System.Web.UI.Page`）都将其标题设置为一个值，具体取决于它在站点地图中的位置。</span><span class="sxs-lookup"><span data-stu-id="d86f6-194">In a nutshell, any ASP.NET code-behind class that extends `BasePage` (instead of `System.Web.UI.Page`) will have its title set to a value depending on its position in the site map.</span></span> <span data-ttu-id="d86f6-195">例如，在查看 ~/`Tech/CYOW.aspx` 页面时，标题设置为 "Home：技术协会：创建自己的网站"。</span><span class="sxs-lookup"><span data-stu-id="d86f6-195">For instance, when viewing the ~/`Tech/CYOW.aspx` page, the title is set to "Home : Technology : Create Your Own Website".</span></span>

<span data-ttu-id="d86f6-196">图1显示了通过浏览器查看时书籍评论网站的屏幕截图。</span><span class="sxs-lookup"><span data-stu-id="d86f6-196">Figure 1 shows a screen shot of the Book Reviews website when viewed through a browser.</span></span> <span data-ttu-id="d86f6-197">在这里，你将看到页面 ~/Tech/TYASP35.aspx，它会*在24小时内查看 ASP.NET 3.5*的书籍。</span><span class="sxs-lookup"><span data-stu-id="d86f6-197">Here you see the page ~/Tech/TYASP35.aspx, which reviews the book *Teach Yourself ASP.NET 3.5 in 24 Hours*.</span></span> <span data-ttu-id="d86f6-198">跨越页面顶部和左侧列中菜单的痕迹导航基于 `Web.sitemap`中定义的站点地图结构。</span><span class="sxs-lookup"><span data-stu-id="d86f6-198">The breadcrumb that spans the top of the page and the menu in the left column are based on the site map structure defined in `Web.sitemap`.</span></span> <span data-ttu-id="d86f6-199">右顶角中的图像是位于 `Images` 文件夹中的一本书封面图像之一。</span><span class="sxs-lookup"><span data-stu-id="d86f6-199">The image in the right upper corner is one of the book cover images located in the `Images` folder.</span></span> <span data-ttu-id="d86f6-200">网站的外观通过 "`Styles`" 文件夹中的 CSS 文件所述的级联样式表规则进行定义，而 "中" 页面布局则在母版页中定义，`Site.master`。</span><span class="sxs-lookup"><span data-stu-id="d86f6-200">The website's look and feel are defined via cascading style sheet rules spelled out by the CSS files in the `Styles` folder, while the overarching page layout is defined in the master page, `Site.master`.</span></span>

<span data-ttu-id="d86f6-201">[![书籍评论网站提供有关标题的评论](determining-what-files-need-to-be-deployed-vb/_static/image2.png)](determining-what-files-need-to-be-deployed-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="d86f6-201">[![The Book Reviews website offers reviews on an assortment of titles](determining-what-files-need-to-be-deployed-vb/_static/image2.png)](determining-what-files-need-to-be-deployed-vb/_static/image1.png)</span></span>

<span data-ttu-id="d86f6-202">**图 1**：书籍评论网站提供了有关标题分类的评论（[单击查看全尺寸图像](determining-what-files-need-to-be-deployed-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="d86f6-202">**Figure 1**: The Book Reviews website offers reviews on an assortment of titles ([Click to view full-size image](determining-what-files-need-to-be-deployed-vb/_static/image3.png))</span></span>

<span data-ttu-id="d86f6-203">此应用程序不使用数据库;每个评审都作为应用程序中的单独网页实现。</span><span class="sxs-lookup"><span data-stu-id="d86f6-203">This application does not use a database; each review is implemented as a separate web page in the application.</span></span> <span data-ttu-id="d86f6-204">本教程（和下几个教程）演练如何部署没有数据库的 web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="d86f6-204">This tutorial (and the next several tutorials) walk through deploying a web application that does not have a database.</span></span> <span data-ttu-id="d86f6-205">但是，在将来的教程中，我们将增强此应用程序以在数据库中存储评审、读者备注和其他信息，并将探索正确部署数据驱动的 web 应用程序所需执行的步骤。</span><span class="sxs-lookup"><span data-stu-id="d86f6-205">However, in a future tutorial we will enhance this application to store reviews, reader comments, and other information within a database, and will explore what steps need to be performed to correctly deploy a data-driven web application.</span></span>

> [!NOTE]
> <span data-ttu-id="d86f6-206">这些教程重点介绍如何使用 web 宿主提供程序托管 ASP.NET 的应用程序，并且不会浏览 ASP 等辅助主题。网络的站点映射系统或使用基本页面类。</span><span class="sxs-lookup"><span data-stu-id="d86f6-206">These tutorials focus on hosting ASP.NET applications with a web host provider and do not explore ancillary topics like ASP.NET's site map system or using a base Page class.</span></span> <span data-ttu-id="d86f6-207">有关这些技术的详细信息，以及本教程中介绍的其他主题的更多背景信息，请参阅每个教程结尾处的其他阅读部分。</span><span class="sxs-lookup"><span data-stu-id="d86f6-207">For more information on these technologies, and for more background on other topics covered throughout the tutorial, refer to the Further Reading section at the end of each tutorial.</span></span>

<span data-ttu-id="d86f6-208">本教程的下载内容包含两个 web 应用程序副本，每个副本都作为不同的 Visual Studio 项目类型实现： BookReviewsWAP、Web 应用程序项目和 BookReviewsWSP，一个网站项目。</span><span class="sxs-lookup"><span data-stu-id="d86f6-208">This tutorial's download has two copies of the web application, each implemented as a different Visual Studio project type: BookReviewsWAP, a Web Application Project, and BookReviewsWSP, a Web Site Project.</span></span> <span data-ttu-id="d86f6-209">这两个项目均使用 Visual Web Developer 2008 SP1 创建，并使用 ASP.NET 3.5 SP1。</span><span class="sxs-lookup"><span data-stu-id="d86f6-209">Both projects were created with Visual Web Developer 2008 SP1 and use ASP.NET 3.5 SP1.</span></span> <span data-ttu-id="d86f6-210">若要使用这些项目，请先将内容解压缩到桌面。</span><span class="sxs-lookup"><span data-stu-id="d86f6-210">To work with these projects start by unzipping the contents to your Desktop.</span></span> <span data-ttu-id="d86f6-211">若要打开 Web 应用程序项目（BookReviewsWAP），请导航到 `BookReviewsWAP` 文件夹，然后双击解决方案文件 `BookReviewsWAP.sln`。</span><span class="sxs-lookup"><span data-stu-id="d86f6-211">To open the Web Application Project (BookReviewsWAP), navigate to the `BookReviewsWAP` folder and double-click the Solution file, `BookReviewsWAP.sln`.</span></span> <span data-ttu-id="d86f6-212">若要打开网站项目（BookReviewsWSP），请启动 Visual Studio，然后从 "文件" 菜单中选择 "打开网站" 选项，浏览到桌面上的 "`BookReviewsWSP`" 文件夹，然后单击 "确定"。</span><span class="sxs-lookup"><span data-stu-id="d86f6-212">To open the Web Site Project (BookReviewsWSP), launch Visual Studio and then, from the File menu, choose the Open Web Site option, browse to the `BookReviewsWSP` folder on your Desktop, and click OK.</span></span>

<span data-ttu-id="d86f6-213">本教程中的其余两个部分介绍在部署应用程序时需要将哪些文件复制到生产环境。</span><span class="sxs-lookup"><span data-stu-id="d86f6-213">The remaining two sections in this tutorial look at what files you will need to copy to the production environment when deploying the application.</span></span> <span data-ttu-id="d86f6-214">接下来的两个教程-[*使用 FTP 部署网站*](deploying-your-site-using-an-ftp-client-vb.md)并[*使用 Visual Studio 部署网站*](deploying-your-site-using-visual-studio-vb.md)-显示将这些文件复制到 web 主机提供程序的不同方法。</span><span class="sxs-lookup"><span data-stu-id="d86f6-214">The next two tutorials - [*Deploying Your Site Using FTP*](deploying-your-site-using-an-ftp-client-vb.md) and [*Deploying Your Site Using Visual Studio*](deploying-your-site-using-visual-studio-vb.md) - show different ways to copy these files to a web host provider.</span></span>

## <a name="determining-the-files-to-deploy-for-the-web-application-project"></a><span data-ttu-id="d86f6-215">确定要为 Web 应用程序项目部署的文件</span><span class="sxs-lookup"><span data-stu-id="d86f6-215">Determining the Files to Deploy for the Web Application Project</span></span>

<span data-ttu-id="d86f6-216">Web 应用程序项目模型使用显式编译-每次生成应用程序时，项目的源代码都将编译为一个程序集。</span><span class="sxs-lookup"><span data-stu-id="d86f6-216">The Web Application Project model uses explicit compilation - the project's source code is compiled into a single assembly each time you build the application.</span></span> <span data-ttu-id="d86f6-217">此编译包括 ASP.NET 页的代码隐藏文件（~/`Default.aspx.vb`、~/`About.aspx.vb`等）以及 `BasePage.vb` 类。</span><span class="sxs-lookup"><span data-stu-id="d86f6-217">This compilation includes the ASP.NET pages' code-behind files (~/`Default.aspx.vb`, ~/`About.aspx.vb`, and so on), as well as the `BasePage.vb` class.</span></span> <span data-ttu-id="d86f6-218">生成的程序集的名称为 `BookReviewsWAP.dll`，位于应用程序的 `Bin` 目录中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-218">The resulting assembly is named `BookReviewsWAP.dll` and is located in the application's `Bin` directory.</span></span>

<span data-ttu-id="d86f6-219">图2显示了本书审查 Web 应用程序项目的文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-219">Figure 2 shows the files that make up the Book Reviews Web Application Project.</span></span>

<span data-ttu-id="d86f6-220">[![解决方案资源管理器列出了包含 Web 应用程序项目的文件。](determining-what-files-need-to-be-deployed-vb/_static/image5.png)](determining-what-files-need-to-be-deployed-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="d86f6-220">[![The Solution Explorer lists the files that comprise the Web Application Project.](determining-what-files-need-to-be-deployed-vb/_static/image5.png)](determining-what-files-need-to-be-deployed-vb/_static/image4.png)</span></span>

<span data-ttu-id="d86f6-221">**图 2**：解决方案资源管理器列出了包含 Web 应用程序项目的文件</span><span class="sxs-lookup"><span data-stu-id="d86f6-221">**Figure 2**: The Solution Explorer lists the files that comprise the Web Application Project</span></span>

> [!NOTE]
> <span data-ttu-id="d86f6-222">如图2所示，ASP.NET 页的代码隐藏文件不会显示在 Visual Basic Web 应用程序项目的解决方案资源管理器中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-222">As Figure 2 shows, the ASP.NET pages' code-behind files are not displayed in the Solution Explorer for a Visual Basic Web Application Project.</span></span> <span data-ttu-id="d86f6-223">若要查看某个页面的代码隐藏类，请在解决方案资源管理器中右键单击该页面，然后选择 "查看代码"。</span><span class="sxs-lookup"><span data-stu-id="d86f6-223">To view the code-behind class for a page, right-click on the page in Solution Explorer and choose View Code.</span></span>

<span data-ttu-id="d86f6-224">若要部署使用 Web 应用程序项目模型开发的 ASP.NET 应用程序，首先需要生成应用程序，以便将最新源代码显式编译为程序集。</span><span class="sxs-lookup"><span data-stu-id="d86f6-224">To deploy an ASP.NET application developed using the Web Application Project model start by building the application so as to explicitly compile the most recent source code into an assembly.</span></span> <span data-ttu-id="d86f6-225">接下来，将以下文件复制到生产环境：</span><span class="sxs-lookup"><span data-stu-id="d86f6-225">Next, copy the following files to the production environment:</span></span>

- <span data-ttu-id="d86f6-226">包含每个 ASP.NET 页的声明性标记的文件，例如 ~/`Default.aspx`、~/`About.aspx`等。</span><span class="sxs-lookup"><span data-stu-id="d86f6-226">The files that contain the declarative markup for every ASP.NET page, such as ~/`Default.aspx`, ~/`About.aspx`, and so on.</span></span> <span data-ttu-id="d86f6-227">此外，请复制任何母版页和用户控件的声明性标记。</span><span class="sxs-lookup"><span data-stu-id="d86f6-227">Also, copy up the declarative markup for any master pages and User Controls.</span></span>
- <span data-ttu-id="d86f6-228">`Bin` 文件夹中的程序集（`.dll` 文件）。</span><span class="sxs-lookup"><span data-stu-id="d86f6-228">The assemblies (`.dll` files) in the `Bin` folder.</span></span> <span data-ttu-id="d86f6-229">不需要复制程序数据库文件（`.pdb`）或可能在 `Bin` 目录中找到的任何 XML 文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-229">You do not need to copy the program database files (`.pdb`) or any XML files you may find in the `Bin` directory.</span></span>

<span data-ttu-id="d86f6-230">不需要将 ASP.NET 页的源代码文件复制到生产环境中，也不需要复制 `BasePage.vb` 类文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-230">You do not need to copy the ASP.NET pages' source code files to the production environment, nor do you need to copy the `BasePage.vb` class file.</span></span>

> [!NOTE]
> <span data-ttu-id="d86f6-231">如图2所示，`BasePage` 类实现为项目中的类文件，放在名为 `HelperClasses`的文件夹中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-231">As Figure 2 shows, the `BasePage` class is implemented as a class file in the project, placed in folder named `HelperClasses`.</span></span> <span data-ttu-id="d86f6-232">编译项目时，会将 `BasePage.vb` 文件中的代码连同 ASP.NET 页面的代码隐藏类一起编译到单个程序集中，`BookReviewsWAP.dll`。</span><span class="sxs-lookup"><span data-stu-id="d86f6-232">When the project is compiled the code in the `BasePage.vb` file is compiled along with the ASP.NET pages' code-behind classes into the single assembly, `BookReviewsWAP.dll`.</span></span> <span data-ttu-id="d86f6-233">ASP.NET 有一个名为 `App_Code` 的特殊文件夹，旨在容纳网站项目的类文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-233">ASP.NET has a special folder named `App_Code` that is designed to hold class files for Web Site Projects.</span></span> <span data-ttu-id="d86f6-234">`App_Code` 文件夹中的代码是自动编译的，因此不应将其用于 Web 应用程序项目。</span><span class="sxs-lookup"><span data-stu-id="d86f6-234">The code in the `App_Code` folder is automatically compiled and therefore should not be used with Web Application Projects.</span></span> <span data-ttu-id="d86f6-235">相反，应将应用程序的类文件放在名为 `HelperClasses`、`Classes`或类似内容的普通文件夹中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-235">Instead, you should place your application's class files in a normal folder named `HelperClasses`, or `Classes`, or something similar.</span></span> <span data-ttu-id="d86f6-236">或者，你可以将类文件放在单独的类库项目中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-236">Alternatively, you can place class files in a separate Class Library project.</span></span>

<span data-ttu-id="d86f6-237">除了将 ASP.NET 相关标记文件和程序集复制到 `Bin` 文件夹中外，还需要复制客户端支持文件-图像和 CSS 文件以及其他服务器端支持文件，`Web.config` 和 `Web.sitemap`。</span><span class="sxs-lookup"><span data-stu-id="d86f6-237">In addition to copying the ASP.NET-related markup files and the assembly in the `Bin` folder, you also need to copy the client-side support files - the images and CSS files - as well as the other server-side support files, `Web.config` and `Web.sitemap`.</span></span> <span data-ttu-id="d86f6-238">无论你使用的是显式编译还是自动编译，都需要将这些客户端和服务器端支持文件复制到生产环境中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-238">These client- and server-side support files need to be copied to the production environment regardless of whether you use explicit or automatic compilation.</span></span>

## <a name="determining-the-files-to-deploy-for-the-web-site-project-files"></a><span data-ttu-id="d86f6-239">确定要为网站项目文件部署的文件</span><span class="sxs-lookup"><span data-stu-id="d86f6-239">Determining the Files to Deploy for the Web Site Project Files</span></span>

<span data-ttu-id="d86f6-240">网站项目模型支持自动编译，这是在使用 Web 应用程序项目模型时不可用的功能。</span><span class="sxs-lookup"><span data-stu-id="d86f6-240">The Web Site Project model supports automatic compilation, a feature not available when using the Web Application Project model.</span></span> <span data-ttu-id="d86f6-241">使用显式编译时，必须将项目的源代码编译为程序集，并将该程序集复制到生产环境中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-241">With explicit compilation you must compile your project's source code into an assembly and copy that assembly to the production environment.</span></span> <span data-ttu-id="d86f6-242">另一方面，通过自动编译，只需将源代码复制到生产环境，并根据需要按需运行时编译。</span><span class="sxs-lookup"><span data-stu-id="d86f6-242">On the other hand, with automatic compilation you simply copy the source code to the production environment and it is compiled by the runtime on demand as needed.</span></span>

<span data-ttu-id="d86f6-243">Visual Studio 中的 "生成" 菜单选项同时存在于 Web 应用程序项目和网站项目中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-243">The Build menu option in Visual Studio is present in both Web Application Projects and Web Site Projects.</span></span> <span data-ttu-id="d86f6-244">构建 Web 应用程序项目会将项目的源代码编译为位于 `Bin` 目录中的单个程序集;构建网站项目时将检查是否存在任何编译时错误，但不会创建任何程序集。</span><span class="sxs-lookup"><span data-stu-id="d86f6-244">Building a Web Application Projects compiles the project's source code into a single assembly located in the `Bin` directory; building a Web Site Project checks for any compile-time errors, but does not create any assemblies.</span></span> <span data-ttu-id="d86f6-245">若要部署使用网站项目模型开发的 ASP.NET 应用程序，只需将相应的文件复制到生产环境中，但我会鼓励您首先构建项目，以确保没有编译时错误。</span><span class="sxs-lookup"><span data-stu-id="d86f6-245">To deploy an ASP.NET application developed using the Web Site Project model all you need to do is copy the appropriate files to the production environment, but I would encourage you to first build the project to ensure that there are no compile-time errors.</span></span>

<span data-ttu-id="d86f6-246">图3显示了使书籍审阅网站项目的文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-246">Figure 3 shows the files that make up the Book Reviews Web Site Project.</span></span>

<span data-ttu-id="d86f6-247">[![解决方案资源管理器列出了包含网站项目的文件。](determining-what-files-need-to-be-deployed-vb/_static/image7.png)](determining-what-files-need-to-be-deployed-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="d86f6-247">[![The Solution Explorer lists the files that comprise the Web Site Project.](determining-what-files-need-to-be-deployed-vb/_static/image7.png)](determining-what-files-need-to-be-deployed-vb/_static/image6.png)</span></span>

<span data-ttu-id="d86f6-248">**图 3**：解决方案资源管理器列出了包含网站项目的文件</span><span class="sxs-lookup"><span data-stu-id="d86f6-248">**Figure 3**: The Solution Explorer lists the files that comprise the Web Site Project</span></span>

<span data-ttu-id="d86f6-249">部署网站项目时，需要将所有与 ASP.NET 相关的文件复制到生产环境中，其中包括 ASP.NET 页、母版页和用户控件的标记页，以及它们的代码文件。</span><span class="sxs-lookup"><span data-stu-id="d86f6-249">Deploying a Web Site Project involves copying all of the ASP.NET-related files to the production environment - that includes the markup pages for ASP.NET pages, master pages, and User Controls, along with their code files.</span></span> <span data-ttu-id="d86f6-250">还需要复制任何类文件，如 `BasePage.vb`。</span><span class="sxs-lookup"><span data-stu-id="d86f6-250">You also need to copy up any class files, such as `BasePage.vb`.</span></span> <span data-ttu-id="d86f6-251">请注意，`BasePage.vb` 文件位于 `App_Code` 文件夹中，该文件夹是用于类文件的网站项目中使用的特殊 ASP.NET 文件夹。</span><span class="sxs-lookup"><span data-stu-id="d86f6-251">Note that the `BasePage.vb` file is located in the `App_Code` folder, which is a special ASP.NET folder used in Web Site Projects for class files.</span></span> <span data-ttu-id="d86f6-252">还需要在生产环境中创建特殊文件夹，因为必须将开发环境中 `App_Code` 文件夹中的类文件复制到生产上的 `App_Code` 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-252">The special folder needs to be created on production, as well, as the class files in the `App_Code` folder on the development environment must be copied to the `App_Code` folder on production.</span></span>

<span data-ttu-id="d86f6-253">除了复制 ASP.NET 标记和源代码文件以外，还需要复制客户端支持文件-图像和 CSS 文件以及其他服务器端支持文件，`Web.config` 和 `Web.sitemap`。</span><span class="sxs-lookup"><span data-stu-id="d86f6-253">In addition to copying the ASP.NET markup and source code files, you also need to copy the client-side support files - the images and CSS files - as well as the other server-side support files, `Web.config` and `Web.sitemap`.</span></span>

> [!NOTE]
> <span data-ttu-id="d86f6-254">网站项目还可以使用显式编译。</span><span class="sxs-lookup"><span data-stu-id="d86f6-254">Web Site Projects can also use explicit compilation.</span></span> <span data-ttu-id="d86f6-255">将来的教程将介绍如何显式编译网站项目。</span><span class="sxs-lookup"><span data-stu-id="d86f6-255">A future tutorial will examine how to explicitly compile a Web Site Project.</span></span>

## <a name="summary"></a><span data-ttu-id="d86f6-256">摘要</span><span class="sxs-lookup"><span data-stu-id="d86f6-256">Summary</span></span>

<span data-ttu-id="d86f6-257">部署 ASP.NET 应用程序需要将所需的文件从开发环境复制到生产环境。</span><span class="sxs-lookup"><span data-stu-id="d86f6-257">Deploying an ASP.NET application entails copying the necessary files from the development environment to the production environment.</span></span> <span data-ttu-id="d86f6-258">需要同步的精确文件集取决于 ASP.NET 应用程序的代码是显式还是自动编译。</span><span class="sxs-lookup"><span data-stu-id="d86f6-258">The precise set of files that need to be synced depends on whether the ASP.NET application's code is explicitly or automatically compiled.</span></span> <span data-ttu-id="d86f6-259">如果将 Visual Studio 配置为使用 Web 应用程序项目模型或网站项目模型管理 ASP.NET 应用程序，则所采用的编译策略将受到影响。</span><span class="sxs-lookup"><span data-stu-id="d86f6-259">The compilation strategy employed is influenced by whether Visual Studio is configured to manage the ASP.NET application using the Web Application Project model or the Web Site Project model.</span></span>

<span data-ttu-id="d86f6-260">Web 应用程序项目模型使用显式编译，并将项目的代码编译到 `Bin` 文件夹中的单个程序集中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-260">The Web Application Project model uses explicit compilation and compiles the project's code into a single assembly in the `Bin` folder.</span></span> <span data-ttu-id="d86f6-261">部署应用程序时，ASP.NET 页的标记部分和 `Bin` 文件夹的内容必须推送到生产环境;应用程序中的源代码（例如，不需要将代码文件和代码隐藏类复制到生产环境）。</span><span class="sxs-lookup"><span data-stu-id="d86f6-261">When deploying the application, the markup portion of the ASP.NET pages and the contents of the `Bin` folder must be pushed up to the production environment; the source code in the application - the code files and code-behind classes, for example - do not need to be copied to the production environment.</span></span>

<span data-ttu-id="d86f6-262">默认情况下，网站项目模型使用自动编译，尽管可以显式编译网站项目，如以后的教程中所示。</span><span class="sxs-lookup"><span data-stu-id="d86f6-262">The Web Site Project model uses automatic compilation by default, although it is possible to explicitly compile a Web Site Project, as we will see in future tutorials.</span></span> <span data-ttu-id="d86f6-263">部署使用自动编译的 ASP.NET 应用程序要求必须将标记部分*和*源代码复制到生产环境中。</span><span class="sxs-lookup"><span data-stu-id="d86f6-263">Deploying an ASP.NET application that uses automatic compilation requires that the markup portion *and* source code must be copied to the production environment.</span></span> <span data-ttu-id="d86f6-264">首次请求时，将在生产环境中自动编译代码。</span><span class="sxs-lookup"><span data-stu-id="d86f6-264">The code is automatically compiled on the production environment when it is requested for the first time.</span></span>

<span data-ttu-id="d86f6-265">现在，我们已经检查了需要在开发和生产环境之间同步的文件，我们已准备好将书籍评论应用程序部署到 web 主机提供商。</span><span class="sxs-lookup"><span data-stu-id="d86f6-265">Now that we have examined what files need to be synced between the development and production environments we are ready to deploy the Book Reviews application to a web host provider.</span></span>

<span data-ttu-id="d86f6-266">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="d86f6-266">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="d86f6-267">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="d86f6-267">Further Reading</span></span>

<span data-ttu-id="d86f6-268">有关本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="d86f6-268">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="d86f6-269">ASP.NET 编译概述</span><span class="sxs-lookup"><span data-stu-id="d86f6-269">ASP.NET Compilation Overview</span></span>](https://msdn.microsoft.com/library/ms178466.aspx)
- [<span data-ttu-id="d86f6-270">ASP.NET 用户控件</span><span class="sxs-lookup"><span data-stu-id="d86f6-270">ASP.NET User Controls</span></span>](https://msdn.microsoft.com/library/y6wb1a0e.aspx)
- [<span data-ttu-id="d86f6-271">正在检查 ASP。网络站点导航</span><span class="sxs-lookup"><span data-stu-id="d86f6-271">Examining ASP.NET's Site Navigation</span></span>](http://aspnet.4guysfromrolla.com/articles/111605-1.aspx)
- [<span data-ttu-id="d86f6-272">Web 应用程序项目简介</span><span class="sxs-lookup"><span data-stu-id="d86f6-272">Introduction to Web Application Projects</span></span>](https://msdn.microsoft.com/library/aa730880.aspx)
- [<span data-ttu-id="d86f6-273">母版页教程</span><span class="sxs-lookup"><span data-stu-id="d86f6-273">Master Page Tutorials</span></span>](../master-pages/creating-a-site-wide-layout-using-master-pages-cs.md)
- [<span data-ttu-id="d86f6-274">在页面之间共享代码</span><span class="sxs-lookup"><span data-stu-id="d86f6-274">Sharing Code Between Pages</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/pages/code.aspx)
- [<span data-ttu-id="d86f6-275">为 ASP.NET 页的代码隐藏类使用自定义基类</span><span class="sxs-lookup"><span data-stu-id="d86f6-275">Using a Custom Base Class For Your ASP.NET Pages' Code-Behind Classes</span></span>](http://aspnet.4guysfromrolla.com/articles/041305-1.aspx)
- [<span data-ttu-id="d86f6-276">Visual Studio 2005 的网站项目系统：它是什么？为什么要这样做呢？</span><span class="sxs-lookup"><span data-stu-id="d86f6-276">Visual Studio 2005's Web Site Project System: What Is It and Why Did We Do It?</span></span>](https://weblogs.asp.net/scottgu/archive/2005/08/21/423201.aspx)
- [<span data-ttu-id="d86f6-277">演练：在 Visual Studio 中将网站项目转换为 Web 应用程序项目</span><span class="sxs-lookup"><span data-stu-id="d86f6-277">Walkthrough: Converting a Web Site Project to a Web Application Project in Visual Studio</span></span>](https://msdn.microsoft.com/library/aa983476.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="d86f6-278">[上一页](asp-net-hosting-options-vb.md)
> [下一页](deploying-your-site-using-an-ftp-client-vb.md)</span><span class="sxs-lookup"><span data-stu-id="d86f6-278">[Previous](asp-net-hosting-options-vb.md)
[Next](deploying-your-site-using-an-ftp-client-vb.md)</span></span>

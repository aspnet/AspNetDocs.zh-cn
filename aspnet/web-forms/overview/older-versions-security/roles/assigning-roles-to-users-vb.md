---
uid: web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
title: 将角色分配给用户 (VB) |Microsoft Docs
author: rick-anderson
description: 在本教程中，我们将生成两个 ASP.NET 页，以帮助管理哪些用户属于哪些角色。 第一页将包括相应的工具来了解...
ms.author: riande
ms.date: 03/24/2008
ms.assetid: fd208ee9-69cc-4467-9783-b4e039bdd1d3
msc.legacyurl: /web-forms/overview/older-versions-security/roles/assigning-roles-to-users-vb
msc.type: authoredcontent
ms.openlocfilehash: 334440f514e94927e428aef8fdba53f0b99e4460
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/01/2019
ms.locfileid: "57056744"
---
<a name="assigning-roles-to-users-vb"></a><span data-ttu-id="3be6e-104">向用户分配角色 (VB)</span><span class="sxs-lookup"><span data-stu-id="3be6e-104">Assigning Roles to Users (VB)</span></span>
====================
<span data-ttu-id="3be6e-105">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="3be6e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="3be6e-106">[下载代码](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip)或[下载 PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="3be6e-106">[Download Code](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/VB.10.zip) or [Download PDF](http://download.microsoft.com/download/6/0/3/6032582f-360d-4739-b935-38721fdb86ea/aspnet_tutorial10_AssigningRoles_vb.pdf)</span></span>

> <span data-ttu-id="3be6e-107">在本教程中，我们将生成两个 ASP.NET 页，以帮助管理哪些用户属于哪些角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-107">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="3be6e-108">第一页将包括相应的工具来查看哪些用户属于给定角色特定的用户属于哪些角色和分配或从特定角色中删除特定用户的能力。</span><span class="sxs-lookup"><span data-stu-id="3be6e-108">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="3be6e-109">在第二页中我们将补充 CreateUserWizard 控件，以便它包含一个步骤来指定新创建的用户属于哪些角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-109">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="3be6e-110">这是在管理员能够创建新的用户帐户的情况下很有用。</span><span class="sxs-lookup"><span data-stu-id="3be6e-110">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>


## <a name="introduction"></a><span data-ttu-id="3be6e-111">介绍</span><span class="sxs-lookup"><span data-stu-id="3be6e-111">Introduction</span></span>

<span data-ttu-id="3be6e-112"><a id="_msoanchor_1"> </a>[前一篇教程](creating-and-managing-roles-vb.md)检查角色框架并`SqlRoleProvider`; 我们已了解如何使用`Roles`类来创建、 检索和删除角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-112">The <a id="_msoanchor_1"></a>[previous tutorial](creating-and-managing-roles-vb.md) examined the Roles framework and the `SqlRoleProvider`; we saw how to use the `Roles` class to create, retrieve, and delete roles.</span></span> <span data-ttu-id="3be6e-113">除了创建和删除角色，我们需要能够将分配或从角色中删除用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-113">In addition to creating and deleting roles, we need to be able to assign or remove users from a role.</span></span> <span data-ttu-id="3be6e-114">遗憾的是，ASP.NET 不随附于任何 Web 控件，用于管理哪些用户属于哪些角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-114">Unfortunately, ASP.NET does not ship with any Web controls for managing what users belong to what roles.</span></span> <span data-ttu-id="3be6e-115">相反，我们必须创建我们自己的 ASP.NET 页面来管理这些关联。</span><span class="sxs-lookup"><span data-stu-id="3be6e-115">Instead, we must create our own ASP.NET pages to manage these associations.</span></span> <span data-ttu-id="3be6e-116">值得高兴的是，添加和删除用户角色是非常简单。</span><span class="sxs-lookup"><span data-stu-id="3be6e-116">The good news is that adding and removing users to roles is quite easy.</span></span> <span data-ttu-id="3be6e-117">`Roles`类包含多种方法来将一个或多个用户添加到一个或多个角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-117">The `Roles` class contains a number of methods for adding one or more users to one or more roles.</span></span>

<span data-ttu-id="3be6e-118">在本教程中，我们将生成两个 ASP.NET 页，以帮助管理哪些用户属于哪些角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-118">In this tutorial we will build two ASP.NET pages to assist with managing what users belong to what roles.</span></span> <span data-ttu-id="3be6e-119">第一页将包括相应的工具来查看哪些用户属于给定角色特定的用户属于哪些角色和分配或从特定角色中删除特定用户的能力。</span><span class="sxs-lookup"><span data-stu-id="3be6e-119">The first page will include facilities to see what users belong to a given role, what roles a particular user belongs to, and the ability to assign or remove a particular user from a particular role.</span></span> <span data-ttu-id="3be6e-120">在第二页中我们将补充 CreateUserWizard 控件，以便它包含一个步骤来指定新创建的用户属于哪些角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-120">In the second page we will augment the CreateUserWizard control so that it includes a step to specify what roles the newly created user belongs to.</span></span> <span data-ttu-id="3be6e-121">这是在管理员能够创建新的用户帐户的情况下很有用。</span><span class="sxs-lookup"><span data-stu-id="3be6e-121">This is useful in scenarios where an administrator is able to create new user accounts.</span></span>

<span data-ttu-id="3be6e-122">让我们进入正题！</span><span class="sxs-lookup"><span data-stu-id="3be6e-122">Let's get started!</span></span>

## <a name="listing-what-users-belong-to-what-roles"></a><span data-ttu-id="3be6e-123">列出哪些用户属于哪些角色</span><span class="sxs-lookup"><span data-stu-id="3be6e-123">Listing What Users Belong To What Roles</span></span>

<span data-ttu-id="3be6e-124">首要任务对于本教程将创建 web 页，从中可为用户分配到角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-124">The first order of business for this tutorial is to create a web page from which users can be assigned to roles.</span></span> <span data-ttu-id="3be6e-125">我们考虑自己如何将用户分配到角色之前，让我们首先集中精力如何确定哪些用户属于哪些角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-125">Before we concern ourselves with how to assign users to roles, let's first concentrate on how to determine what users belong to what roles.</span></span> <span data-ttu-id="3be6e-126">有两种方法来显示此信息:"角色"或""用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-126">There are two ways to display this information: "by role" or "by user."</span></span> <span data-ttu-id="3be6e-127">我们可以允许访问者可以选择一个角色，然后显示它们的所有用户属于角色 （"按角色"显示中），或者我们无法提示选择一个用户，然后显示其分配给该用户 （"按用户"显示） 的角色的访问者。</span><span class="sxs-lookup"><span data-stu-id="3be6e-127">We could allow the visitor to select a role and then show them all of the users that belong to the role (the "by role" display), or we could prompt the visitor to select a user and then show them the roles assigned to that user (the "by user" display).</span></span>

<span data-ttu-id="3be6e-128">"按角色"视图都适用于情况访问者希望知道属于特定角色; 用户组访问者需要知道特定用户的角色时，"由用户"视图是理想之选。</span><span class="sxs-lookup"><span data-stu-id="3be6e-128">The "by role" view is useful in circumstances where the visitor wants to know the set of users that belong to a particular role; the "by user" view is ideal when the visitor needs to know a particular user's role(s).</span></span> <span data-ttu-id="3be6e-129">让我们了解我们的页面包括"的 role"和"按用户"接口。</span><span class="sxs-lookup"><span data-stu-id="3be6e-129">Let's have our page include both "by role" and "by user" interfaces.</span></span>

<span data-ttu-id="3be6e-130">我们将首先创建"由用户"接口。</span><span class="sxs-lookup"><span data-stu-id="3be6e-130">We will start with creating the "by user" interface.</span></span> <span data-ttu-id="3be6e-131">此接口将包含下拉列表和复选框的列表。</span><span class="sxs-lookup"><span data-stu-id="3be6e-131">This interface will consist of a drop-down list and a list of checkboxes.</span></span> <span data-ttu-id="3be6e-132">下拉列表将随系统; 中的用户组相应的复选框将枚举这些角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-132">The drop-down list will be populated with the set of users in the system; the checkboxes will enumerate the roles.</span></span> <span data-ttu-id="3be6e-133">从下拉列表中选择用户将检查用户属于这些角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-133">Selecting a user from the drop-down list will check those roles the user belongs to.</span></span> <span data-ttu-id="3be6e-134">访问的页面的人可以然后选中或取消选中复选框，以添加或删除所选的用户对应的角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-134">The person visiting the page can then check or uncheck the checkboxes to add or remove the selected user from the corresponding roles.</span></span>

> [!NOTE]
> <span data-ttu-id="3be6e-135">使用下拉列表添加到列表的用户帐户不是网站的理想之选其中可能有数百个用户帐户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-135">Using a drop-down list to list the user accounts is not an ideal choice for websites where there may be hundreds of user accounts.</span></span> <span data-ttu-id="3be6e-136">下拉列表设计以允许用户选择一项相对较短的列表中的选项。</span><span class="sxs-lookup"><span data-stu-id="3be6e-136">A drop-down list is designed to allow a user to pick one item from a relatively short list of options.</span></span> <span data-ttu-id="3be6e-137">它很快会变得难以处理随着列表项的数量增加。</span><span class="sxs-lookup"><span data-stu-id="3be6e-137">It quickly becomes unwieldy as the number of list items grows.</span></span> <span data-ttu-id="3be6e-138">如果您正在生成将具有可能较大数量的用户帐户的网站，可能想要考虑使用一个备用用户界面，如可分页 GridView 或可筛选的接口，其中列出提示选择号的访问者，然后仅显示了其用户名以所选的字母开头的用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-138">If you are building a website that will have potentially large numbers of user accounts, you may want to consider using an alternative user interface, such as a pageable GridView or a filterable interface that lists prompts the visitor to choose a letter and then only shows those users whose username starts with the selected letter.</span></span>


## <a name="step-1-building-the-by-user-user-interface"></a><span data-ttu-id="3be6e-139">步骤 1：生成"按用户"用户界面</span><span class="sxs-lookup"><span data-stu-id="3be6e-139">Step 1: Building the "By User" User Interface</span></span>

<span data-ttu-id="3be6e-140">打开`UsersAndRoles.aspx`页。</span><span class="sxs-lookup"><span data-stu-id="3be6e-140">Open the `UsersAndRoles.aspx` page.</span></span> <span data-ttu-id="3be6e-141">在页面顶部，添加名为的标签 Web 控件`ActionStatus`并将清除其`Text`属性。</span><span class="sxs-lookup"><span data-stu-id="3be6e-141">At the top of the page, add a Label Web control named `ActionStatus` and clear out its `Text` property.</span></span> <span data-ttu-id="3be6e-142">我们将使用此标签显示与此类似，所执行的操作上提供反馈，"用户 Tito 已添加到管理员角色中，"或者"用户 Jisun 已从主管角色。"</span><span class="sxs-lookup"><span data-stu-id="3be6e-142">We will use this Label to provide feedback on the actions performed, displaying messages like, "User Tito has been added to the Administrators role," or "User Jisun has been removed from the Supervisors role."</span></span> <span data-ttu-id="3be6e-143">若要使这些消息凸显出来，设置标签的`CssClass`属性设置为"Important"。</span><span class="sxs-lookup"><span data-stu-id="3be6e-143">In order to make these messages stand out, set the Label's `CssClass` property to "Important".</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample1.aspx)]

<span data-ttu-id="3be6e-144">接下来，添加以下 CSS 类定义到`Styles.css`样式表：</span><span class="sxs-lookup"><span data-stu-id="3be6e-144">Next, add the following CSS class definition to the `Styles.css` stylesheet:</span></span>

[!code-css[Main](assigning-roles-to-users-vb/samples/sample2.css)]

<span data-ttu-id="3be6e-145">此 CSS 定义会指示浏览器显示使用的大型的红色字体的标签。</span><span class="sxs-lookup"><span data-stu-id="3be6e-145">This CSS definition instructs the browser to display the Label using a large, red font.</span></span> <span data-ttu-id="3be6e-146">图 1 显示了 Visual Studio 设计器通过这种效果。</span><span class="sxs-lookup"><span data-stu-id="3be6e-146">Figure 1 shows this effect through the Visual Studio Designer.</span></span>


<span data-ttu-id="3be6e-147">[![标签的 CssClass 属性会导致大型，红色字体](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-147">[![The Label's CssClass Property Results in a Large, Red Font](assigning-roles-to-users-vb/_static/image2.png)](assigning-roles-to-users-vb/_static/image1.png)</span></span>

<span data-ttu-id="3be6e-148">**图 1**:标签`CssClass`属性会导致大型，红色字体 ([单击以查看实际尺寸的图像](assigning-roles-to-users-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-148">**Figure 1**: The Label's `CssClass` Property Results in a Large, Red Font  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image3.png))</span></span>


<span data-ttu-id="3be6e-149">接下来，将 DropDownList 添加到页上，设置其`ID`属性设置为`UserList`，并设置其`AutoPostBack`属性设为 True。</span><span class="sxs-lookup"><span data-stu-id="3be6e-149">Next, add a DropDownList to the page, set its `ID` property to `UserList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="3be6e-150">我们将使用此 DropDownList 系统中列出的所有用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-150">We will use this DropDownList to list all of the users in the system.</span></span> <span data-ttu-id="3be6e-151">此 DropDownList 将绑定到的 MembershipUser 对象的集合。</span><span class="sxs-lookup"><span data-stu-id="3be6e-151">This DropDownList will be bound to a collection of MembershipUser objects.</span></span> <span data-ttu-id="3be6e-152">因为我们希望 DropDownList 以显示 MembershipUser 对象的用户名属性 （并将其用作列表项的值），设置 DropDownList`DataTextField`和`DataValueField`为"UserName"的属性。</span><span class="sxs-lookup"><span data-stu-id="3be6e-152">Because we want the DropDownList to display the UserName property of the MembershipUser object (and use it as the value of the list items), set the DropDownList's `DataTextField` and `DataValueField` properties to "UserName".</span></span>

<span data-ttu-id="3be6e-153">下面的下拉列表中，添加名为 Repeater `UsersRoleList`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-153">Underneath the DropDownList, add a Repeater named `UsersRoleList`.</span></span> <span data-ttu-id="3be6e-154">此 Repeater 将列出所有角色的系统中为一系列的复选框。</span><span class="sxs-lookup"><span data-stu-id="3be6e-154">This Repeater will list all of the roles in the system as a series of checkboxes.</span></span> <span data-ttu-id="3be6e-155">定义 Repeater 的`ItemTemplate`使用下面的声明性标记：</span><span class="sxs-lookup"><span data-stu-id="3be6e-155">Define the Repeater's `ItemTemplate` using the following declarative markup:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample3.aspx)]

<span data-ttu-id="3be6e-156">`ItemTemplate`标记包含一个名为的单个复选框 Web 控件`RoleCheckBox`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-156">The `ItemTemplate` markup includes a single CheckBox Web control named `RoleCheckBox`.</span></span> <span data-ttu-id="3be6e-157">该复选框`AutoPostBack`属性设置为 True 并`Text`属性绑定到`Container.DataItem`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-157">The CheckBox's `AutoPostBack` property is set to True and the `Text` property is bound to `Container.DataItem`.</span></span> <span data-ttu-id="3be6e-158">原因的数据绑定语法是`Container.DataItem`是因为角色框架将返回作为字符串数组的角色名称的列表，我们将绑定到 Repeater 此字符串数组。</span><span class="sxs-lookup"><span data-stu-id="3be6e-158">The reason the databinding syntax is simply `Container.DataItem` is because the Roles framework returns the list of role names as a string array, and it is this string array that we will be binding to the Repeater.</span></span> <span data-ttu-id="3be6e-159">为什么要使用此语法显示数组绑定到数据 Web 控件的内容的详尽描述不在本教程的范围。</span><span class="sxs-lookup"><span data-stu-id="3be6e-159">A thorough description of why this syntax is used to display the contents of an array bound to a data Web control is beyond the scope of this tutorial.</span></span> <span data-ttu-id="3be6e-160">有关此问题的详细信息，请参阅[标量数组绑定到数据 Web 控件](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3be6e-160">For more information on this matter, refer to [Binding a Scalar Array to a Data Web Control](http://aspnet.4guysfromrolla.com/articles/082504-1.aspx).</span></span>

<span data-ttu-id="3be6e-161">此时你"按用户"接口的声明性标记应类似以下：</span><span class="sxs-lookup"><span data-stu-id="3be6e-161">At this point your "by user" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample4.aspx)]

<span data-ttu-id="3be6e-162">我们现已准备好编写代码以将用户帐户添加到 DropDownList 的集和 Repeater 的角色集的绑定。</span><span class="sxs-lookup"><span data-stu-id="3be6e-162">We are now ready to write the code to bind the set of user accounts to the DropDownList and the set of roles to the Repeater.</span></span> <span data-ttu-id="3be6e-163">在页面的代码隐藏类中，添加一个名为`BindUsersToUserList`，另一个名为`BindRolesList`，使用以下代码：</span><span class="sxs-lookup"><span data-stu-id="3be6e-163">In the page's code-behind class, add a method named `BindUsersToUserList` and another named `BindRolesList`, using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample5.vb)]

<span data-ttu-id="3be6e-164">`BindUsersToUserList`方法通过在系统中检索的所有用户帐户[`Membership.GetAllUsers`方法](https://msdn.microsoft.com/library/dy8swhya.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3be6e-164">The `BindUsersToUserList` method retrieves all of the user accounts in the system via the [`Membership.GetAllUsers` method](https://msdn.microsoft.com/library/dy8swhya.aspx).</span></span> <span data-ttu-id="3be6e-165">这将返回[`MembershipUserCollection`对象](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx)，这是一系列[`MembershipUser`实例](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3be6e-165">This returns a [`MembershipUserCollection` object](https://msdn.microsoft.com/library/system.web.security.membershipusercollection.aspx), which is a collection of [`MembershipUser` instances](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx).</span></span> <span data-ttu-id="3be6e-166">此集合绑定到`UserList`DropDownList。</span><span class="sxs-lookup"><span data-stu-id="3be6e-166">This collection is then bound to the `UserList` DropDownList.</span></span> <span data-ttu-id="3be6e-167">`MembershipUser`实例的集合包含的各种属性，如该构成`UserName`， `Email`， `CreationDate`，和`IsOnline`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-167">The `MembershipUser` instances that makeup the collection contain a variety of properties, like `UserName`, `Email`, `CreationDate`, and `IsOnline`.</span></span> <span data-ttu-id="3be6e-168">若要指示 DropDownList 中显示的值`UserName`属性，确保`UserList`DropDownList 的`DataTextField`和`DataValueField`属性已设置为"UserName"。</span><span class="sxs-lookup"><span data-stu-id="3be6e-168">In order to instruct the DropDownList to display the value of the `UserName` property, ensure that the `UserList` DropDownList's `DataTextField` and `DataValueField` properties have been set to "UserName".</span></span>

> [!NOTE]
> <span data-ttu-id="3be6e-169">`Membership.GetAllUsers`方法有两个重载： 一个接受任何输入的参数并返回的所有用户，另一个使用的页索引和页大小的整数值并返回仅指定用户的子集。</span><span class="sxs-lookup"><span data-stu-id="3be6e-169">The `Membership.GetAllUsers` method has two overloads: one that accepts no input parameters and returns all of the users, and one that takes in integer values for the page index and page size, and returns only the specified subset of the users.</span></span> <span data-ttu-id="3be6e-170">当存在大量的用户帐户的可分页用户界面元素中显示时，第二个重载可以使用更高效地通过用户的页面中，因为它返回的用户帐户，而不是所有这些只是精确的子集。</span><span class="sxs-lookup"><span data-stu-id="3be6e-170">When there are large amounts of user accounts being displayed in a pageable user interface element, the second overload can be used to more efficiently page through the users since it returns just the precise subset of user accounts rather than all of them.</span></span>


<span data-ttu-id="3be6e-171">`BindRolesToList`方法通过调用来启动`Roles`类的[`GetAllRoles`方法](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx)，这会返回系统中包含的角色的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="3be6e-171">The `BindRolesToList` method starts by calling the `Roles` class's [`GetAllRoles` method](https://msdn.microsoft.com/library/system.web.security.roles.getallroles.aspx), which returns a string array containing the roles in the system.</span></span> <span data-ttu-id="3be6e-172">此字符串数组，则绑定到 Repeater 中。</span><span class="sxs-lookup"><span data-stu-id="3be6e-172">This string array is then bound to the Repeater.</span></span>

<span data-ttu-id="3be6e-173">最后，我们需要调用这两种方法，首次加载页面时。</span><span class="sxs-lookup"><span data-stu-id="3be6e-173">Finally, we need to call these two methods when the page is first loaded.</span></span> <span data-ttu-id="3be6e-174">将以下代码添加到 `Page_Load` 事件处理程序中：</span><span class="sxs-lookup"><span data-stu-id="3be6e-174">Add the following code to the `Page_Load` event handler:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample6.vb)]

<span data-ttu-id="3be6e-175">利用此代码，请花费片刻时间访问通过浏览器; 页面屏幕应类似于图 2。</span><span class="sxs-lookup"><span data-stu-id="3be6e-175">With this code in place, take a moment to visit the page through a browser; your screen should look similar to Figure 2.</span></span> <span data-ttu-id="3be6e-176">所有用户帐户被填充下拉列表中，，在其中，每个角色显示为一个复选框。</span><span class="sxs-lookup"><span data-stu-id="3be6e-176">All of the user accounts are populated in the drop-down list and, underneath that, each role appears as a checkbox.</span></span> <span data-ttu-id="3be6e-177">因为我们设置`AutoPostBack`属性的 DropDownList 和复选框为 True，则更改所选的用户或选中或取消选中角色导致回发。</span><span class="sxs-lookup"><span data-stu-id="3be6e-177">Because we set the `AutoPostBack` properties of the DropDownList and CheckBoxes to True, changing the selected user or checking or unchecking a role causes a postback.</span></span> <span data-ttu-id="3be6e-178">但是，因为我们尚未编写代码来处理这些操作，不执行任何操作。</span><span class="sxs-lookup"><span data-stu-id="3be6e-178">No action is performed, however, because we have yet to write code to handle these actions.</span></span> <span data-ttu-id="3be6e-179">例如，我们将介绍以下两个部分中的这些任务。</span><span class="sxs-lookup"><span data-stu-id="3be6e-179">We'll tackle these tasks in the next two sections.</span></span>


<span data-ttu-id="3be6e-180">[![页面显示的用户和角色](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-180">[![The Page Displays the Users and Roles](assigning-roles-to-users-vb/_static/image5.png)](assigning-roles-to-users-vb/_static/image4.png)</span></span>

<span data-ttu-id="3be6e-181">**图 2**:页面显示的用户和角色 ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-181">**Figure 2**: The Page Displays the Users and Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image6.png))</span></span>


### <a name="checking-the-roles-the-selected-user-belongs-to"></a><span data-ttu-id="3be6e-182">检查这些角色所选的用户归属的</span><span class="sxs-lookup"><span data-stu-id="3be6e-182">Checking the Roles the Selected User Belongs To</span></span>

<span data-ttu-id="3be6e-183">首次加载页面，或访问者从下拉列表中选择新用户，我们需要更新`UsersRoleList`的复选框，以便仅当选定的用户属于该角色检查一个给定的角色的复选框。</span><span class="sxs-lookup"><span data-stu-id="3be6e-183">When the page is first loaded, or whenever the visitor selects a new user from the drop-down list, we need to update the `UsersRoleList`'s checkboxes so that a given role checkbox is checked only if the selected user belongs to that role.</span></span> <span data-ttu-id="3be6e-184">若要实现此目的，创建一个名为方法`CheckRolesForSelectedUser`使用以下代码：</span><span class="sxs-lookup"><span data-stu-id="3be6e-184">To accomplish this, create a method named `CheckRolesForSelectedUser` with the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample7.vb)]

<span data-ttu-id="3be6e-185">上面的代码首先会确定所选的用户是谁。</span><span class="sxs-lookup"><span data-stu-id="3be6e-185">The above code starts by determining who the selected user is.</span></span> <span data-ttu-id="3be6e-186">然后，它使用角色类的[`GetRolesForUser(userName)`方法](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx)返回角色作为一个字符串数组，指定的用户的组。</span><span class="sxs-lookup"><span data-stu-id="3be6e-186">It then uses the Roles class's [`GetRolesForUser(userName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getrolesforuser.aspx) to return the specified user's set of roles as a string array.</span></span> <span data-ttu-id="3be6e-187">接下来，枚举 Repeater 的项和每个项的`RoleCheckBox`复选框以编程方式引用。</span><span class="sxs-lookup"><span data-stu-id="3be6e-187">Next, the Repeater's items are enumerated and each item's `RoleCheckBox` CheckBox is programmatically referenced.</span></span> <span data-ttu-id="3be6e-188">仅当它对应于该角色包含在选中该复选框`selectedUsersRoles`字符串数组。</span><span class="sxs-lookup"><span data-stu-id="3be6e-188">The CheckBox is checked only if the role it corresponds to is contained within the `selectedUsersRoles` string array.</span></span>

> [!NOTE]
> <span data-ttu-id="3be6e-189">`Linq.Enumerable.Contains(Of String)(...)`语法将无法编译，如果您使用的 ASP.NET 2.0 版。</span><span class="sxs-lookup"><span data-stu-id="3be6e-189">The `Linq.Enumerable.Contains(Of String)(...)` syntax will not compile if you are using ASP.NET version 2.0.</span></span> <span data-ttu-id="3be6e-190">`Contains(Of String)`方法属于[LINQ 库](http://en.wikipedia.org/wiki/Language_Integrated_Query)，这是 ASP.NET 3.5 中新增。</span><span class="sxs-lookup"><span data-stu-id="3be6e-190">The `Contains(Of String)` method is part of the [LINQ library](http://en.wikipedia.org/wiki/Language_Integrated_Query), which is new to ASP.NET 3.5.</span></span> <span data-ttu-id="3be6e-191">如果您仍在使用 ASP.NET 2.0 版中，使用[`Array.IndexOf(Of String)`方法](https://msdn.microsoft.com/library/eha9t187.aspx)相反。</span><span class="sxs-lookup"><span data-stu-id="3be6e-191">If you are still using ASP.NET version 2.0, use the [`Array.IndexOf(Of String)` method](https://msdn.microsoft.com/library/eha9t187.aspx) instead.</span></span>


<span data-ttu-id="3be6e-192">`CheckRolesForSelectedUser`方法需要两种情况下调用： 首次加载页面时，只要`UserList`DropDownList 的所选的索引更改。</span><span class="sxs-lookup"><span data-stu-id="3be6e-192">The `CheckRolesForSelectedUser` method needs to be called in two cases: when the page is first loaded and whenever the `UserList` DropDownList's selected index is changed.</span></span> <span data-ttu-id="3be6e-193">因此，调用此方法从`Page_Load`事件处理程序 (调用后`BindUsersToUserList`和`BindRolesToList`)。</span><span class="sxs-lookup"><span data-stu-id="3be6e-193">Therefore, call this method from the `Page_Load` event handler (after the calls to `BindUsersToUserList` and `BindRolesToList`).</span></span> <span data-ttu-id="3be6e-194">此外，为 DropDownList 的创建事件处理程序`SelectedIndexChanged`事件，并从中调用此方法。</span><span class="sxs-lookup"><span data-stu-id="3be6e-194">Also, create an event handler for the DropDownList's `SelectedIndexChanged` event and call this method from there.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample8.vb)]

<span data-ttu-id="3be6e-195">利用此代码，可以通过浏览器页进行测试。</span><span class="sxs-lookup"><span data-stu-id="3be6e-195">With this code in place, you can test the page through the browser.</span></span> <span data-ttu-id="3be6e-196">但是，由于`UsersAndRoles.aspx`页当前不具备的功能，若要将用户分配到角色，没有用户的角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-196">However, since the `UsersAndRoles.aspx` page currently lacks the ability to assign users to roles, no users have roles.</span></span> <span data-ttu-id="3be6e-197">我们将创建将用户分配到角色的那样，因此可以相信我所说，此代码有效，并验证这一点更高版本，接口或可以手动添加用户到角色的方法是插入记录到`aspnet_UsersInRoles`为了测试此 functi 表现在 onality。</span><span class="sxs-lookup"><span data-stu-id="3be6e-197">We will create the interface for assigning users to roles in a moment, so you can either take my word that this code works and verify that it does so later, or you can manually add users to roles by inserting records into the `aspnet_UsersInRoles` table in order to test this functionality now.</span></span>

### <a name="assigning-and-removing-users-from-roles"></a><span data-ttu-id="3be6e-198">分配或从角色删除用户</span><span class="sxs-lookup"><span data-stu-id="3be6e-198">Assigning and Removing Users from Roles</span></span>

<span data-ttu-id="3be6e-199">访问者时选中或取消选中中的复选框`UsersRoleList`Repeater 我们需要添加或删除选定的用户从相应的角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-199">When the visitor checks or unchecks a CheckBox in the `UsersRoleList` Repeater we need to add or remove the selected user from the corresponding role.</span></span> <span data-ttu-id="3be6e-200">复选框的`AutoPostBack`属性当前设置为 True，这会导致回发，只要 Repeater 中的复选框是选中或取消选中。</span><span class="sxs-lookup"><span data-stu-id="3be6e-200">The CheckBox's `AutoPostBack` property is currently set to True, which causes a postback anytime a CheckBox in the Repeater is checked or unchecked.</span></span> <span data-ttu-id="3be6e-201">简单地说，我们需要创建一个事件处理程序的复选框的`CheckChanged`事件。</span><span class="sxs-lookup"><span data-stu-id="3be6e-201">In short, we need to create an event handler for the CheckBox's `CheckChanged` event.</span></span> <span data-ttu-id="3be6e-202">由于该复选框，在 Repeater 控件中，我们需要手动添加事件处理程序管道。</span><span class="sxs-lookup"><span data-stu-id="3be6e-202">Since the CheckBox is in a Repeater control, we need to manually add the event handler plumbing.</span></span> <span data-ttu-id="3be6e-203">首先将事件处理程序添加到代码隐藏类作为`Protected`方法，如下所示：</span><span class="sxs-lookup"><span data-stu-id="3be6e-203">Start by adding the event handler to the code-behind class as a `Protected` method, like so:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample9.vb)]

<span data-ttu-id="3be6e-204">我们将返回为此事件处理程序在一段时间中编写代码。</span><span class="sxs-lookup"><span data-stu-id="3be6e-204">We will return to write the code for this event handler in a moment.</span></span> <span data-ttu-id="3be6e-205">但首先让我们来完成的事件处理管道。</span><span class="sxs-lookup"><span data-stu-id="3be6e-205">But first let's complete the event handling plumbing.</span></span> <span data-ttu-id="3be6e-206">从 Repeater 中的复选框`ItemTemplate`，添加`OnCheckedChanged="RoleCheckBox_CheckChanged"`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-206">From the CheckBox within the Repeater's `ItemTemplate`, add `OnCheckedChanged="RoleCheckBox_CheckChanged"`.</span></span> <span data-ttu-id="3be6e-207">此语法绑定`RoleCheckBox_CheckChanged`事件处理程序`RoleCheckBox`的`CheckedChanged`事件。</span><span class="sxs-lookup"><span data-stu-id="3be6e-207">This syntax wires the `RoleCheckBox_CheckChanged` event handler to the `RoleCheckBox`'s `CheckedChanged` event.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample10.aspx)]

<span data-ttu-id="3be6e-208">最后一项任务是完成`RoleCheckBox_CheckChanged`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="3be6e-208">Our final task is to complete the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="3be6e-209">我们需要通过引用引发事件，因为可以告诉我们哪些角色已选中还是通过取消选中此复选框实例的复选框控件开始其`Text`和`Checked`属性。</span><span class="sxs-lookup"><span data-stu-id="3be6e-209">We need to start by referencing the CheckBox control that raised the event because this CheckBox instance tells us what role was checked or unchecked via its `Text` and `Checked` properties.</span></span> <span data-ttu-id="3be6e-210">使用此信息，以及用户名的所选用户，我们中添加或删除用户通过角色`Roles`类的[ `AddUserToRole` ](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx)或[`RemoveUserFromRole`方法](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3be6e-210">Using this information along with the UserName of the selected user, we add or remove the user from the role via the `Roles` class's [`AddUserToRole`](https://msdn.microsoft.com/library/system.web.security.roles.addusertorole.aspx) or [`RemoveUserFromRole` method](https://msdn.microsoft.com/library/system.web.security.roles.removeuserfromrole.aspx).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample11.vb)]

<span data-ttu-id="3be6e-211">上面的代码以编程方式引用引发事件，可通过该复选框`sender`输入的参数。</span><span class="sxs-lookup"><span data-stu-id="3be6e-211">The above code starts by programmatically referencing the CheckBox that raised the event, which is available via the `sender` input parameter.</span></span> <span data-ttu-id="3be6e-212">如果选中此复选框，则会将所选的用户添加到指定角色，否则为会从角色中删除。</span><span class="sxs-lookup"><span data-stu-id="3be6e-212">If the CheckBox is checked, the selected user is added to the specified role, otherwise they are removed from the role.</span></span> <span data-ttu-id="3be6e-213">在任一情况下，`ActionStatus`标签显示一条消息，汇总只需执行的操作。</span><span class="sxs-lookup"><span data-stu-id="3be6e-213">In either case, the `ActionStatus` Label displays a message summarizing the action just performed.</span></span>

<span data-ttu-id="3be6e-214">请花费片刻时间来查看此页，通过浏览器测试。</span><span class="sxs-lookup"><span data-stu-id="3be6e-214">Take a moment to test out this page through a browser.</span></span> <span data-ttu-id="3be6e-215">选择用户 Tito，然后将 Tito 添加到管理员和在监督器角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-215">Select user Tito and then add Tito to both the Administrators and Supervisors roles.</span></span>


<span data-ttu-id="3be6e-216">[![Tito 已添加到管理员和在监督器角色](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-216">[![Tito Has Been Added to the Administrators and Supervisors Roles](assigning-roles-to-users-vb/_static/image8.png)](assigning-roles-to-users-vb/_static/image7.png)</span></span>

<span data-ttu-id="3be6e-217">**图 3**:已添加到管理员和主管角色 Tito ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-217">**Figure 3**: Tito Has Been Added to the Administrators and Supervisors Roles  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image9.png))</span></span>


<span data-ttu-id="3be6e-218">接下来，从下拉列表中选择用户 Bruce。</span><span class="sxs-lookup"><span data-stu-id="3be6e-218">Next, select user Bruce from the drop-down list.</span></span> <span data-ttu-id="3be6e-219">没有为在回发和 Repeater 的复选框会更新通过`CheckRolesForSelectedUser`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-219">There is a postback and the Repeater's CheckBoxes are updated via the `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="3be6e-220">由于 Bruce 尚不属于任何角色，两个复选框的未选中状态。</span><span class="sxs-lookup"><span data-stu-id="3be6e-220">Since Bruce does not yet belong to any roles, the two checkboxes are unchecked.</span></span> <span data-ttu-id="3be6e-221">接下来，将 Bruce 添加到在监督器角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-221">Next, add Bruce to the Supervisors role.</span></span>


<span data-ttu-id="3be6e-222">[![Bruce 已添加到在监督器角色](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-222">[![Bruce Has Been Added to the Supervisors Role](assigning-roles-to-users-vb/_static/image11.png)](assigning-roles-to-users-vb/_static/image10.png)</span></span>

<span data-ttu-id="3be6e-223">**图 4**:Bruce 已添加到主管角色 ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-223">**Figure 4**: Bruce Has Been Added to the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image12.png))</span></span>


<span data-ttu-id="3be6e-224">若要进一步验证的功能`CheckRolesForSelectedUser`方法中，选择一个 Tito 或 Bruce 以外的用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-224">To further verify the functionality of the `CheckRolesForSelectedUser` method, select a user other than Tito or Bruce.</span></span> <span data-ttu-id="3be6e-225">请注意如何复选框的未自动选中，表示它们确实不属于任何角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-225">Note how the checkboxes are automatically unchecked, denoting that they do not belong to any roles.</span></span> <span data-ttu-id="3be6e-226">返回到 Tito。</span><span class="sxs-lookup"><span data-stu-id="3be6e-226">Return to Tito.</span></span> <span data-ttu-id="3be6e-227">应检查管理员和在监督器复选框。</span><span class="sxs-lookup"><span data-stu-id="3be6e-227">Both the Administrators and Supervisors checkboxes should be checked.</span></span>

## <a name="step-2-building-the-by-roles-user-interface"></a><span data-ttu-id="3be6e-228">步骤 2：生成"的角色"用户界面</span><span class="sxs-lookup"><span data-stu-id="3be6e-228">Step 2: Building the "By Roles" User Interface</span></span>

<span data-ttu-id="3be6e-229">现在我们已完成"的用户"接口，并准备好开始处理"的角色"接口。</span><span class="sxs-lookup"><span data-stu-id="3be6e-229">At this point we have completed the "by users" interface and are ready to start tackling the "by roles" interface.</span></span> <span data-ttu-id="3be6e-230">"按角色"接口会提示用户从下拉列表选择一个角色，然后显示属于该角色的 GridView 中的用户组。</span><span class="sxs-lookup"><span data-stu-id="3be6e-230">The "by roles" interface prompts the user to select a role from a drop-down list and then displays the set of users that belong to that role in a GridView.</span></span>

<span data-ttu-id="3be6e-231">添加到另一个 DropDownList 控件`UsersAndRoles.aspx page`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-231">Add another DropDownList control to the `UsersAndRoles.aspx page`.</span></span> <span data-ttu-id="3be6e-232">将此某个的 Repeater 控件下方，将其命名`RoleList`，并设置其`AutoPostBack`属性设为 True。</span><span class="sxs-lookup"><span data-stu-id="3be6e-232">Place this one beneath the Repeater control, name it `RoleList`, and set its `AutoPostBack` property to True.</span></span> <span data-ttu-id="3be6e-233">下方，添加一个 GridView 并将其命名`RolesUserList`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-233">Underneath that, add a GridView and name it `RolesUserList`.</span></span> <span data-ttu-id="3be6e-234">此 GridView 将列出属于所选角色的用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-234">This GridView will list the users that belong to the selected role.</span></span> <span data-ttu-id="3be6e-235">设置 GridView`AutoGenerateColumns`属性设置为 False，向网格添加 TemplateField`Columns`集合，并设置其`HeaderText`属性设置为"用户"。</span><span class="sxs-lookup"><span data-stu-id="3be6e-235">Set the GridView's `AutoGenerateColumns` property to False, add a TemplateField to the grid's `Columns` collection, and set its `HeaderText` property to "Users".</span></span> <span data-ttu-id="3be6e-236">定义 TemplateField `ItemTemplate` ，以便显示数据绑定表达式的值`Container.DataItem`中`Text`属性的一个名为标签`UserNameLabel`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-236">Define the TemplateField's `ItemTemplate` so that it displays the value of the databinding expression `Container.DataItem` in the `Text` property of a Label named `UserNameLabel`.</span></span>

<span data-ttu-id="3be6e-237">添加并配置 GridView 之后, 你"按角色"接口的声明性标记应类似于下面：</span><span class="sxs-lookup"><span data-stu-id="3be6e-237">After adding and configuring the GridView, your "by role" interface's declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample12.aspx)]

<span data-ttu-id="3be6e-238">我们需要填充`RoleList`DropDownList 与系统中的角色集。</span><span class="sxs-lookup"><span data-stu-id="3be6e-238">We need to populate the `RoleList` DropDownList with the set of roles in the system.</span></span> <span data-ttu-id="3be6e-239">若要完成此操作，更新`BindRolesToList`方法，这就是绑定以便通过返回的字符串数组`Roles.GetAllRoles`方法`RolesList`DropDownList (以及`UsersRoleList`Repeater)。</span><span class="sxs-lookup"><span data-stu-id="3be6e-239">To accomplish this, update the `BindRolesToList` method so that is binds the string array returned by the `Roles.GetAllRoles` method to the `RolesList` DropDownList (as well as the `UsersRoleList` Repeater).</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample13.vb)]

<span data-ttu-id="3be6e-240">中的最后两行`BindRolesToList`方法已添加要绑定到的角色集`RoleList`DropDownList 控件。</span><span class="sxs-lookup"><span data-stu-id="3be6e-240">The last two lines in the `BindRolesToList` method have been added to bind the set of roles to the `RoleList` DropDownList control.</span></span> <span data-ttu-id="3be6e-241">图 5 显示了最终结果时的浏览器 – 使用系统的角色填充下拉列表查看。</span><span class="sxs-lookup"><span data-stu-id="3be6e-241">Figure 5 shows the end result when viewed through a browser – a drop-down list populated with the system's roles.</span></span>


<span data-ttu-id="3be6e-242">[![角色显示在 RoleList DropDownList](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-242">[![The Roles are Displayed in the RoleList DropDownList](assigning-roles-to-users-vb/_static/image14.png)](assigning-roles-to-users-vb/_static/image13.png)</span></span>

<span data-ttu-id="3be6e-243">**图 5**:角色显示在`RoleList`DropDownList ([单击以查看实际尺寸的图像](assigning-roles-to-users-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-243">**Figure 5**: The Roles are Displayed in the `RoleList` DropDownList  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image15.png))</span></span>


### <a name="displaying-the-users-that-belong-to-the-selected-role"></a><span data-ttu-id="3be6e-244">显示属于所选角色的用户</span><span class="sxs-lookup"><span data-stu-id="3be6e-244">Displaying the Users That Belong To the Selected Role</span></span>

<span data-ttu-id="3be6e-245">首次加载页面时，或从选择的新角色时`RoleList`下拉列表中，我们需要显示属于该角色在 GridView 中的用户的列表。</span><span class="sxs-lookup"><span data-stu-id="3be6e-245">When the page is first loaded, or when a new role is selected from the `RoleList` DropDownList, we need to display the list of users that belong to that role in the GridView.</span></span> <span data-ttu-id="3be6e-246">创建一个名为方法`DisplayUsersBelongingToRole`使用以下代码：</span><span class="sxs-lookup"><span data-stu-id="3be6e-246">Create a method named `DisplayUsersBelongingToRole` using the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample14.vb)]

<span data-ttu-id="3be6e-247">此方法开始时获取从所选的角色`RoleList`DropDownList。</span><span class="sxs-lookup"><span data-stu-id="3be6e-247">This method starts by getting the selected role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="3be6e-248">然后，它使用[`Roles.GetUsersInRole(roleName)`方法](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx)检索属于该角色的用户的用户名的字符串数组。</span><span class="sxs-lookup"><span data-stu-id="3be6e-248">It then uses the [`Roles.GetUsersInRole(roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.getusersinrole.aspx) to retrieve a string array of the UserNames of the users that belong to that role.</span></span> <span data-ttu-id="3be6e-249">然后，此数组绑定到`RolesUserList`GridView。</span><span class="sxs-lookup"><span data-stu-id="3be6e-249">This array is then bound to the `RolesUserList` GridView.</span></span>

<span data-ttu-id="3be6e-250">此方法需要在两种情况下调用： 和最初加载页面时中的所选的角色`RoleList`DropDownList 的更改。</span><span class="sxs-lookup"><span data-stu-id="3be6e-250">This method needs to be called in two circumstances: when the page is initially loaded and when the selected role in the `RoleList` DropDownList changes.</span></span> <span data-ttu-id="3be6e-251">因此，更新`Page_Load`事件处理程序，以便在调用后调用此方法`CheckRolesForSelectedUser`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-251">Therefore, update the `Page_Load` event handler so that this method is invoked after the call to `CheckRolesForSelectedUser`.</span></span> <span data-ttu-id="3be6e-252">接下来，创建的事件处理程序`RoleList`的`SelectedIndexChanged`事件，并太从中调用此方法。</span><span class="sxs-lookup"><span data-stu-id="3be6e-252">Next, create an event handler for the `RoleList`'s `SelectedIndexChanged` event, and call this method from there, too.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample15.vb)]

<span data-ttu-id="3be6e-253">利用此代码， `RolesUserList` GridView 应显示那些属于所选角色的用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-253">With this code in place, the `RolesUserList` GridView should display those users that belong to the selected role.</span></span> <span data-ttu-id="3be6e-254">如图 6 所示，在监督器角色都包含两个成员：Bruce 和 Tito。</span><span class="sxs-lookup"><span data-stu-id="3be6e-254">As Figure 6 shows, the Supervisors role consists of two members: Bruce and Tito.</span></span>


<span data-ttu-id="3be6e-255">[![GridView 列出了这些属于所选角色的用户](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-255">[![The GridView Lists Those Users That Belong to the Selected Role](assigning-roles-to-users-vb/_static/image17.png)](assigning-roles-to-users-vb/_static/image16.png)</span></span>

<span data-ttu-id="3be6e-256">**图 6**:GridView 列出了这些用户的属于所选角色 ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-256">**Figure 6**: The GridView Lists Those Users That Belong to the Selected Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image18.png))</span></span>


### <a name="removing-users-from-the-selected-role"></a><span data-ttu-id="3be6e-257">从所选角色中删除用户</span><span class="sxs-lookup"><span data-stu-id="3be6e-257">Removing Users from the Selected Role</span></span>

<span data-ttu-id="3be6e-258">让我们来增强`RolesUserList`GridView，使之包含的列的"删除"按钮。</span><span class="sxs-lookup"><span data-stu-id="3be6e-258">Let's augment the `RolesUserList` GridView so that it includes a column of "Remove" buttons.</span></span> <span data-ttu-id="3be6e-259">单击特定用户的"删除"按钮将其从该角色中删除。</span><span class="sxs-lookup"><span data-stu-id="3be6e-259">Clicking the "Remove" button for a particular user will remove them from that role.</span></span>

<span data-ttu-id="3be6e-260">首先删除按钮字段添加到 GridView。</span><span class="sxs-lookup"><span data-stu-id="3be6e-260">Start by adding a Delete button field to the GridView.</span></span> <span data-ttu-id="3be6e-261">将此字段显示为字段最左侧，并更改其`DeleteText`属性从"删除"（默认值） 为"删除"。</span><span class="sxs-lookup"><span data-stu-id="3be6e-261">Make this field appear as the left most filed and change its `DeleteText` property from "Delete" (the default) to "Remove".</span></span>


<span data-ttu-id="3be6e-262">[![添加](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-262">[![Add the](assigning-roles-to-users-vb/_static/image20.png)](assigning-roles-to-users-vb/_static/image19.png)</span></span>

<span data-ttu-id="3be6e-263">**图 7**:将"删除"按钮添加到 GridView ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-263">**Figure 7**: Add the "Remove" Button to the GridView  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image21.png))</span></span>


<span data-ttu-id="3be6e-264">单击"删除"按钮时，才会回发和 GridView`RowDeleting`引发事件。</span><span class="sxs-lookup"><span data-stu-id="3be6e-264">When the "Remove" button is clicked a postback ensues and the GridView's `RowDeleting` event is raised.</span></span> <span data-ttu-id="3be6e-265">我们需要创建此事件的事件处理程序和编写代码，从所选角色中删除用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-265">We need to create an event handler for this event and write code that removes the user from the selected role.</span></span> <span data-ttu-id="3be6e-266">创建事件处理程序，并添加以下代码：</span><span class="sxs-lookup"><span data-stu-id="3be6e-266">Create the event handler and then add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample16.vb)]

<span data-ttu-id="3be6e-267">代码首先会确定所选的角色名称。</span><span class="sxs-lookup"><span data-stu-id="3be6e-267">The code starts by determining the selected role name.</span></span> <span data-ttu-id="3be6e-268">然后，它以编程方式引用`UserNameLabel`控件从其"删除"按钮被单击以确定要删除的用户的用户名的行。</span><span class="sxs-lookup"><span data-stu-id="3be6e-268">It then programmatically references the `UserNameLabel` control from the row whose "Remove" button was clicked in order to determine the UserName of the user to remove.</span></span> <span data-ttu-id="3be6e-269">然后通过调用在角色中删除用户`Roles.RemoveUserFromRole`方法。</span><span class="sxs-lookup"><span data-stu-id="3be6e-269">The user is then removed from the role via a call to the `Roles.RemoveUserFromRole` method.</span></span> <span data-ttu-id="3be6e-270">`RolesUserList` GridView 然后被刷新，并且通过显示一条消息`ActionStatus`标签控件。</span><span class="sxs-lookup"><span data-stu-id="3be6e-270">The `RolesUserList` GridView is then refreshed and a message is displayed via the `ActionStatus` Label control.</span></span>

> [!NOTE]
> <span data-ttu-id="3be6e-271">"删除"按钮不需要任何种类的来自用户的确认之前从角色中删除用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-271">The "Remove" button does not require any sort of confirmation from the user before removing the user from the role.</span></span> <span data-ttu-id="3be6e-272">我邀请您添加某一级别的用户进行确认。</span><span class="sxs-lookup"><span data-stu-id="3be6e-272">I invite you to add some level of user confirmation.</span></span> <span data-ttu-id="3be6e-273">若要确认某项操作的最简单方法之一是通过客户端的确认对话框。</span><span class="sxs-lookup"><span data-stu-id="3be6e-273">One of the easiest ways to confirm an action is through a client-side confirm dialog box.</span></span> <span data-ttu-id="3be6e-274">有关此技术的详细信息，请参阅[删除时添加客户端确认](https://asp.net/learn/data-access/tutorial-42-vb.aspx)。</span><span class="sxs-lookup"><span data-stu-id="3be6e-274">For more information on this technique, see [Adding Client-Side Confirmation When Deleting](https://asp.net/learn/data-access/tutorial-42-vb.aspx).</span></span>


<span data-ttu-id="3be6e-275">图 8 在监督器组中删除用户 Tito 后显示的页。</span><span class="sxs-lookup"><span data-stu-id="3be6e-275">Figure 8 shows the page after user Tito has been removed from the Supervisors group.</span></span>


<span data-ttu-id="3be6e-276">[![唉，Tito 不再负责管理](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-276">[![Alas, Tito is No Longer a Supervisor](assigning-roles-to-users-vb/_static/image23.png)](assigning-roles-to-users-vb/_static/image22.png)</span></span>

<span data-ttu-id="3be6e-277">**图 8**:唉，Tito 不再负责管理 ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-277">**Figure 8**: Alas, Tito is No Longer a Supervisor  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image24.png))</span></span>


### <a name="adding-new-users-to-the-selected-role"></a><span data-ttu-id="3be6e-278">将新用户添加到所选角色</span><span class="sxs-lookup"><span data-stu-id="3be6e-278">Adding New Users to the Selected Role</span></span>

<span data-ttu-id="3be6e-279">从所选角色中删除用户，以及到此页的访问者也应该能够将用户添加到所选角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-279">Along with removing users from the selected role, the visitor to this page should also be able to add a user to the selected role.</span></span> <span data-ttu-id="3be6e-280">将用户添加到所选角色的最佳接口取决于你预期获得的用户帐户数。</span><span class="sxs-lookup"><span data-stu-id="3be6e-280">The best interface for adding a user to the selected role depends on the number of user accounts you expect to have.</span></span> <span data-ttu-id="3be6e-281">如果你的网站将容纳几几十个用户帐户或更少，您可以在此处使用 DropDownList。</span><span class="sxs-lookup"><span data-stu-id="3be6e-281">If your website will house just a few dozen user accounts or less, you could use a DropDownList here.</span></span> <span data-ttu-id="3be6e-282">可能有数千个用户帐户，如果你想要包括允许的访问者可以逐页查看的帐户，搜索特定帐户，或筛选以某种其他方式的用户帐户的用户界面。</span><span class="sxs-lookup"><span data-stu-id="3be6e-282">If there might be thousands of user accounts, you would want to include a user interface that permits the visitor to page through the accounts, search for a particular account, or filter the user accounts in some other fashion.</span></span>

<span data-ttu-id="3be6e-283">此页让我们使用在系统中工作而不考虑用户帐户数的接口非常简单。</span><span class="sxs-lookup"><span data-stu-id="3be6e-283">For this page let's use a very simple interface that works regardless of the number of user accounts in the system.</span></span> <span data-ttu-id="3be6e-284">也就是说，我们将使用文本框中，提示她想要添加到所选角色的用户的用户名中的类型的访问者。</span><span class="sxs-lookup"><span data-stu-id="3be6e-284">Namely, we will use a TextBox, prompting the visitor to type in the username of the user she wants to add to the selected role.</span></span> <span data-ttu-id="3be6e-285">如果存在具有该名称没有用户，或者如果用户已是角色的成员，我们将显示一条消息中的`ActionStatus`标签。</span><span class="sxs-lookup"><span data-stu-id="3be6e-285">If no user with that name exists, or if the user is already a member of the role, we'll display a message in `ActionStatus` Label.</span></span> <span data-ttu-id="3be6e-286">但是，如果用户存在，并且不是角色的成员，我们将添加到角色并刷新该网格。</span><span class="sxs-lookup"><span data-stu-id="3be6e-286">But if the user exists and is not a member of the role, we'll add them to the role and refresh the grid.</span></span>

<span data-ttu-id="3be6e-287">添加一个文本框和按钮下方 GridView。</span><span class="sxs-lookup"><span data-stu-id="3be6e-287">Add a TextBox and Button beneath the GridView.</span></span> <span data-ttu-id="3be6e-288">设置文本框的`ID`到`UserNameToAddToRole`并设置按钮的`ID`并`Text`属性设置为`AddUserToRoleButton`和"添加用户到角色"，分别。</span><span class="sxs-lookup"><span data-stu-id="3be6e-288">Set the TextBox's `ID` to `UserNameToAddToRole` and set the Button's `ID` and `Text` properties to `AddUserToRoleButton` and "Add User to Role", respectively.</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample17.aspx)]

<span data-ttu-id="3be6e-289">接下来，创建`Click`事件处理程序`AddUserToRoleButton`并添加以下代码：</span><span class="sxs-lookup"><span data-stu-id="3be6e-289">Next, create a `Click` event handler for the `AddUserToRoleButton` and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample18.vb)]

<span data-ttu-id="3be6e-290">中的代码大部分`Click`事件处理程序执行各种验证检查。</span><span class="sxs-lookup"><span data-stu-id="3be6e-290">The majority of the code in the `Click` event handler performs various validation checks.</span></span> <span data-ttu-id="3be6e-291">它可确保访问者提供中的用户名`UserNameToAddToRole`文本框中，该用户在系统中，存在并且已不属于所选角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-291">It ensures that the visitor supplied a username in the `UserNameToAddToRole` TextBox, that the user exists in the system, and that they don't already belong to the selected role.</span></span> <span data-ttu-id="3be6e-292">如果任一检查失败，相应的消息将显示在`ActionStatus`和退出事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="3be6e-292">If any of these checks fails, an appropriate message is displayed in `ActionStatus` and the event handler is exited.</span></span> <span data-ttu-id="3be6e-293">如果所有检查都通过，将用户添加到通过角色`Roles.AddUserToRole`方法。</span><span class="sxs-lookup"><span data-stu-id="3be6e-293">If all of the checks pass, the user is added to the role via the `Roles.AddUserToRole` method.</span></span> <span data-ttu-id="3be6e-294">之后，文本框中的`Text`清除属性、 刷新 GridView，和`ActionStatus`标签显示一条消息，该值指示指定的用户已成功添加到所选角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-294">Following that, the TextBox's `Text` property is cleared out, the GridView is refreshed, and the `ActionStatus` Label displays a message indicating that the specified user was successfully added to the selected role.</span></span>

> [!NOTE]
> <span data-ttu-id="3be6e-295">若要确保不已属于所选角色指定的用户，我们使用[`Roles.IsUserInRole(userName, roleName)`方法](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx)，它返回一个布尔值，该值指示是否*用户名*属于*roleName*。</span><span class="sxs-lookup"><span data-stu-id="3be6e-295">To ensure that the specified user does not already belong to the selected role, we use the [`Roles.IsUserInRole(userName, roleName)` method](https://msdn.microsoft.com/library/system.web.security.roles.isuserinrole.aspx), which returns a Boolean value indicating whether *userName* is a member of *roleName*.</span></span> <span data-ttu-id="3be6e-296">我们将使用此方法在再次<a id="_msoanchor_2"> </a>[下一教程](role-based-authorization-vb.md)当我们查看基于角色的授权。</span><span class="sxs-lookup"><span data-stu-id="3be6e-296">We will use this method again in the <a id="_msoanchor_2"></a>[next tutorial](role-based-authorization-vb.md) when we look at role-based authorization.</span></span>


<span data-ttu-id="3be6e-297">访问通过浏览器页面，然后选择从主管角色`RoleList`DropDownList。</span><span class="sxs-lookup"><span data-stu-id="3be6e-297">Visit the page through a browser and select the Supervisors role from the `RoleList` DropDownList.</span></span> <span data-ttu-id="3be6e-298">请尝试输入无效的用户名 – 你应看到一条消息说明用户不存在系统中。</span><span class="sxs-lookup"><span data-stu-id="3be6e-298">Try entering an invalid username – you should see a message explaining that the user does not exist in the system.</span></span>


<span data-ttu-id="3be6e-299">[![不能将不存在的用户添加到角色](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-299">[![You Cannot Add a Non-Existent User to a Role](assigning-roles-to-users-vb/_static/image26.png)](assigning-roles-to-users-vb/_static/image25.png)</span></span>

<span data-ttu-id="3be6e-300">**图 9**:不能将非存在的用户添加到角色 ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-300">**Figure 9**: You Cannot Add a Non-Existent User to a Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image27.png))</span></span>


<span data-ttu-id="3be6e-301">现在，尝试添加的有效用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-301">Now try adding a valid user.</span></span> <span data-ttu-id="3be6e-302">继续操作并将 Tito 重新添加到在监督器角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-302">Go ahead and re-add Tito to the Supervisors role.</span></span>


<span data-ttu-id="3be6e-303">[![Tito 是再一次监督程序 ！](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-303">[![Tito Is Once Again a Supervisor!](assigning-roles-to-users-vb/_static/image29.png)](assigning-roles-to-users-vb/_static/image28.png)</span></span>

<span data-ttu-id="3be6e-304">**图 10**:Tito 是再一次监督程序 ！</span><span class="sxs-lookup"><span data-stu-id="3be6e-304">**Figure 10**: Tito Is Once Again a Supervisor!</span></span>  <span data-ttu-id="3be6e-305">([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-305">([Click to view full-size image](assigning-roles-to-users-vb/_static/image30.png))</span></span>


## <a name="step-3-cross-updating-the-by-user-and-by-role-interfaces"></a><span data-ttu-id="3be6e-306">步骤 3：跨更新"用户"和"的角色"接口</span><span class="sxs-lookup"><span data-stu-id="3be6e-306">Step 3: Cross-Updating the "By User" and "By Role" Interfaces</span></span>

<span data-ttu-id="3be6e-307">`UsersAndRoles.aspx`页提供了用于管理用户和角色的两个不同接口。</span><span class="sxs-lookup"><span data-stu-id="3be6e-307">The `UsersAndRoles.aspx` page offers two distinct interfaces for managing users and roles.</span></span> <span data-ttu-id="3be6e-308">目前，这两个接口互相独立地处理，因此，在一个接口中所做的更改将不会立即反映在其他。</span><span class="sxs-lookup"><span data-stu-id="3be6e-308">Currently, these two interfaces act independently of one another so it is possible that a change made in one interface will not be reflected immediately in the other.</span></span> <span data-ttu-id="3be6e-309">例如，假设到页面的访问者选择的主管角色`RoleList`下拉列表中，其中列出 Bruce 和 Tito 了作为其成员。</span><span class="sxs-lookup"><span data-stu-id="3be6e-309">For example, imagine that the visitor to the page selects the Supervisors role from the `RoleList` DropDownList, which lists Bruce and Tito as its members.</span></span> <span data-ttu-id="3be6e-310">接下来，访问者选择从 Tito`UserList`下拉列表中，它检查中的管理员和监督复选框`UsersRoleList`Repeater。</span><span class="sxs-lookup"><span data-stu-id="3be6e-310">Next, the visitor selects Tito from the `UserList` DropDownList, which checks the Administrators and Supervisors checkboxes in the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="3be6e-311">如果访问者然后取消选中从 Repeater 监督者角色，从在监督器角色中删除 Tito 但是"的角色"界面中不会反映这种修改。</span><span class="sxs-lookup"><span data-stu-id="3be6e-311">If the visitor then unchecks the Supervisor role from the Repeater, Tito is removed from the Supervisors role, but this modification is not reflected in the "by role" interface.</span></span> <span data-ttu-id="3be6e-312">GridView 仍会显示 Tito 视为在监督器角色的成员。</span><span class="sxs-lookup"><span data-stu-id="3be6e-312">The GridView will still show Tito as being a member of the Supervisors role.</span></span>

<span data-ttu-id="3be6e-313">若要修复此，我们需要只要角色是 checked 或 unchecked 从刷新 GridView `UsersRoleList` Repeater。</span><span class="sxs-lookup"><span data-stu-id="3be6e-313">To fix this we need to refresh the GridView whenever a role is checked or unchecked from the `UsersRoleList` Repeater.</span></span> <span data-ttu-id="3be6e-314">同样，我们需要刷新 Repeater，每当用户删除或从"按角色"接口添加到角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-314">Likewise, we need to refresh the Repeater whenever a user is removed or added to a role from the "by role" interface.</span></span>

<span data-ttu-id="3be6e-315">在"按用户"界面 Repeater 刷新通过调用`CheckRolesForSelectedUser`方法。</span><span class="sxs-lookup"><span data-stu-id="3be6e-315">The Repeater in the "by user" interface is refreshed by calling the `CheckRolesForSelectedUser` method.</span></span> <span data-ttu-id="3be6e-316">"按角色"接口可以中修改`RolesUserList`GridView`RowDeleting`事件处理程序和`AddUserToRoleButton`按钮的`Click`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="3be6e-316">The "by role" interface can be modified in the `RolesUserList` GridView's `RowDeleting` event handler and the `AddUserToRoleButton` Button's `Click` event handler.</span></span> <span data-ttu-id="3be6e-317">因此，我们需要调用`CheckRolesForSelectedUser`从每个这些方法的方法。</span><span class="sxs-lookup"><span data-stu-id="3be6e-317">Therefore, we need to call the `CheckRolesForSelectedUser` method from each of these methods.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample19.vb)]

<span data-ttu-id="3be6e-318">同样，通过调用刷新"的角色"界面中 GridView`DisplayUsersBelongingToRole`方法和"按用户"接口通过修改`RoleCheckBox_CheckChanged`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="3be6e-318">Similarly, the GridView in the "by role" interface is refreshed by calling the `DisplayUsersBelongingToRole` method and the "by user" interface is modified through the `RoleCheckBox_CheckChanged` event handler.</span></span> <span data-ttu-id="3be6e-319">因此，我们需要调用`DisplayUsersBelongingToRole`来自此事件处理程序方法。</span><span class="sxs-lookup"><span data-stu-id="3be6e-319">Therefore, we need to call the `DisplayUsersBelongingToRole` method from this event handler.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample20.vb)]

<span data-ttu-id="3be6e-320">这些细微的代码更改，"按用户"和"按角色"接口现在正确地跨更新。</span><span class="sxs-lookup"><span data-stu-id="3be6e-320">With these minor code changes, the "by user" and "by role" interfaces now correctly cross-update.</span></span> <span data-ttu-id="3be6e-321">若要验证这一点，请访问通过浏览器页面，并选择 Tito 和在监督器从`UserList`和`RoleList`Dropdownlist，分别。</span><span class="sxs-lookup"><span data-stu-id="3be6e-321">To verify this, visit the page through a browser and select Tito and Supervisors from the `UserList` and `RoleList` DropDownLists, respectively.</span></span> <span data-ttu-id="3be6e-322">请注意用于从"按用户"界面中 Repeater Tito 取消选中在监督器角色，如 Tito 会自动删除从"按角色"界面中 GridView。</span><span class="sxs-lookup"><span data-stu-id="3be6e-322">Note that as you uncheck the Supervisors role for Tito from the Repeater in the "by user" interface, Tito is automatically removed from the GridView in the "by role" interface.</span></span> <span data-ttu-id="3be6e-323">将添加 Tito 回主管角色从"按角色"接口会自动重新检查"由用户"接口中的主管复选框。</span><span class="sxs-lookup"><span data-stu-id="3be6e-323">Adding Tito back to the Supervisors role from the "by role" interface automatically re-checks the Supervisors checkbox in the "by user" interface.</span></span>

## <a name="step-4-customizing-the-createuserwizard-to-include-a-specify-roles-step"></a><span data-ttu-id="3be6e-324">步骤 4：自定义 CreateUserWizard 包括"指定角色"的步骤</span><span class="sxs-lookup"><span data-stu-id="3be6e-324">Step 4: Customizing the CreateUserWizard to Include a "Specify Roles" Step</span></span>

<span data-ttu-id="3be6e-325">在中<a id="_msoanchor_3"> </a> [*创建用户帐户*](../membership/creating-user-accounts-vb.md)教程中我们已了解如何使用 CreateUserWizard Web 控件来提供用于创建新的用户帐户的接口。</span><span class="sxs-lookup"><span data-stu-id="3be6e-325">In the <a id="_msoanchor_3"></a>[*Creating User Accounts*](../membership/creating-user-accounts-vb.md) tutorial we saw how to use the CreateUserWizard Web control to provide an interface for creating a new user account.</span></span> <span data-ttu-id="3be6e-326">CreateUserWizard 控件可以采用两种方式之一：</span><span class="sxs-lookup"><span data-stu-id="3be6e-326">The CreateUserWizard control can be used in one of two ways:</span></span>

- <span data-ttu-id="3be6e-327">作为一种方式为在站点上创建其自己的用户帐户的访问者和</span><span class="sxs-lookup"><span data-stu-id="3be6e-327">As a means for visitors to create their own user account on the site, and</span></span>
- <span data-ttu-id="3be6e-328">作为一种方式创建新的帐户管理员</span><span class="sxs-lookup"><span data-stu-id="3be6e-328">As a means for administrators to create new accounts</span></span>

<span data-ttu-id="3be6e-329">在第一个用例，访问者进入这个网站并填写 CreateUserWizard，以便在网站注册以输入他们的信息。</span><span class="sxs-lookup"><span data-stu-id="3be6e-329">In the first use case, a visitor comes to the site and fills out the CreateUserWizard, entering their information in order to register on the site.</span></span> <span data-ttu-id="3be6e-330">在第二种情况下，管理员将为其他人创建新帐户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-330">In the second case, an administrator creates a new account for another person.</span></span>

<span data-ttu-id="3be6e-331">通过某些其他人的管理员创建帐户后，可能会有帮助，可允许管理员指定新的用户帐户所属的哪些角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-331">When an account is being created by an administrator for some other person, it might be helpful to allow the administrator to specify what roles the new user account belongs to.</span></span> <span data-ttu-id="3be6e-332">在中<a id="_msoanchor_4"> </a> [*存储\*\*其他用户信息*](../membership/storing-additional-user-information-vb.md)我们已了解如何通过添加其他自定义 CreateUserWizard 教程`WizardSteps`.</span><span class="sxs-lookup"><span data-stu-id="3be6e-332">In the <a id="_msoanchor_4"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we saw how to customize the CreateUserWizard by adding additional `WizardSteps`.</span></span> <span data-ttu-id="3be6e-333">让我们看看如何将一个额外的步骤添加到 CreateUserWizard，以指定新用户的角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-333">Let's look at how to add an additional step to the CreateUserWizard in order to specify the new user's roles.</span></span>

<span data-ttu-id="3be6e-334">打开`CreateUserWizardWithRoles.aspx`页上，添加名为的 CreateUserWizard 控件`RegisterUserWithRoles`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-334">Open the `CreateUserWizardWithRoles.aspx` page and add a CreateUserWizard control named `RegisterUserWithRoles`.</span></span> <span data-ttu-id="3be6e-335">设置控件的`ContinueDestinationPageUrl`属性设置为"~ / Default.aspx"。</span><span class="sxs-lookup"><span data-stu-id="3be6e-335">Set the control's `ContinueDestinationPageUrl` property to "~/Default.aspx".</span></span> <span data-ttu-id="3be6e-336">由于这里的思路是，管理员使用此 CreateUserWizard 控件来创建新的用户帐户，设置控件的`LoginCreatedUser`属性设置为 False。</span><span class="sxs-lookup"><span data-stu-id="3be6e-336">Because the idea here is that an administrator will be using this CreateUserWizard control to create new user accounts, set the control's `LoginCreatedUser` property to False.</span></span> <span data-ttu-id="3be6e-337">这`LoginCreatedUser`属性指定是否以刚创建的用户自动登录访问者和默认为 True。</span><span class="sxs-lookup"><span data-stu-id="3be6e-337">This `LoginCreatedUser` property specifies whether the visitor is automatically logged on as the just-created user, and it defaults to True.</span></span> <span data-ttu-id="3be6e-338">我们将其设置为 False 则因为管理员创建新帐户时我们想要使他自己以身份登录。</span><span class="sxs-lookup"><span data-stu-id="3be6e-338">We set it to False because when an administrator creates a new account we want to keep him signed in as himself.</span></span>

<span data-ttu-id="3be6e-339">接下来，选择"添加/删除`WizardSteps`..."选项从 CreateUserWizard 的智能标记，然后添加一个新`WizardStep`，并设置其`ID`到`SpecifyRolesStep`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-339">Next, select the "Add/Remove `WizardSteps`…" option from the CreateUserWizard's Smart Tag and add a new `WizardStep`, setting its `ID` to `SpecifyRolesStep`.</span></span> <span data-ttu-id="3be6e-340">移动`SpecifyRolesStep WizardStep`，以便它出现在"符号注册新帐户"步骤中，但在"完成"步骤之前。</span><span class="sxs-lookup"><span data-stu-id="3be6e-340">Move the `SpecifyRolesStep WizardStep` so that it comes after the "Sign Up for Your New Account" step, but before the "Complete" step.</span></span> <span data-ttu-id="3be6e-341">设置`WizardStep`的`Title`属性设置为"指定的角色"其`StepType`属性设置为`Step`，并将其`AllowReturn`属性设置为 False。</span><span class="sxs-lookup"><span data-stu-id="3be6e-341">Set the `WizardStep`'s `Title` property to "Specify Roles", its `StepType` property to `Step`, and its `AllowReturn` property to False.</span></span>


<span data-ttu-id="3be6e-342">[![添加](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-342">[![Add the](assigning-roles-to-users-vb/_static/image32.png)](assigning-roles-to-users-vb/_static/image31.png)</span></span>

<span data-ttu-id="3be6e-343">**图 11**:添加"指定角色"`WizardStep`到 CreateUserWizard ([单击以查看实际尺寸的图像](assigning-roles-to-users-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-343">**Figure 11**: Add the "Specify Roles" `WizardStep` to the CreateUserWizard  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image33.png))</span></span>


<span data-ttu-id="3be6e-344">此更改后 CreateUserWizard 的声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="3be6e-344">After this change your CreateUserWizard's declarative markup should look like the following:</span></span>

[!code-aspx[Main](assigning-roles-to-users-vb/samples/sample21.aspx)]

<span data-ttu-id="3be6e-345">在"指定角色" `WizardStep`，添加名为 CheckBoxList`RoleList.`此 CheckBoxList 将列出可用的角色、 访问的页面的人员，以检查哪些角色启用新创建的用户属于。</span><span class="sxs-lookup"><span data-stu-id="3be6e-345">In the "Specify Roles" `WizardStep`, add a CheckBoxList named `RoleList.` This CheckBoxList will list the available roles, enabling the person visiting the page to check what roles the newly created user belongs to.</span></span>

<span data-ttu-id="3be6e-346">我们仍然面临着两个编码任务： 首先，我们必须填充`RoleList`CheckBoxList 系统; 中的角色与第二，我们需要将创建的用户添加到所选角色中，当用户从"指定的角色"步骤移动到"已完成"步骤。</span><span class="sxs-lookup"><span data-stu-id="3be6e-346">We are left with two coding tasks: first we must populate the `RoleList` CheckBoxList with the roles in the system; second, we need to add the created user to the selected roles when the user moves from the "Specify Roles" step to the "Complete" step.</span></span> <span data-ttu-id="3be6e-347">我们可以完成的第一个任务`Page_Load`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="3be6e-347">We can accomplish the first task in the `Page_Load` event handler.</span></span> <span data-ttu-id="3be6e-348">下面的代码以编程方式引用`RoleList`复选框在第一天访问网页，并对其绑定在系统中的角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-348">The following code programmatically references the `RoleList` CheckBox on the first visit to the page and binds the roles in the system to it.</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample22.vb)]

<span data-ttu-id="3be6e-349">上面的代码应该很熟悉。</span><span class="sxs-lookup"><span data-stu-id="3be6e-349">The above code should look familiar.</span></span> <span data-ttu-id="3be6e-350">在中<a id="_msoanchor_5"> </a> [*存储\*\*其他用户信息*](../membership/storing-additional-user-information-vb.md)教程中我们使用了两个`FindControl`语句，以引用 Web 控件从自定义内`WizardStep`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-350">In the <a id="_msoanchor_5"></a>[*Storing* *Additional User Information*](../membership/storing-additional-user-information-vb.md) tutorial we used two `FindControl` statements to reference a Web control from within a custom `WizardStep`.</span></span> <span data-ttu-id="3be6e-351">并将角色绑定到 CheckBoxList 的代码已在本教程前面从中获取。</span><span class="sxs-lookup"><span data-stu-id="3be6e-351">And the code that binds the roles to the CheckBoxList was taken from earlier in this tutorial.</span></span>

<span data-ttu-id="3be6e-352">若要执行的第二个编程任务，我们需要知道"指定的角色"步骤已在已完成。</span><span class="sxs-lookup"><span data-stu-id="3be6e-352">In order to perform the second programming task we need to know when the "Specify Roles" step has been completed.</span></span> <span data-ttu-id="3be6e-353">回想一下，CreateUserWizard 具有`ActiveStepChanged`访问者从某一步导航到另一个每次触发的事件。</span><span class="sxs-lookup"><span data-stu-id="3be6e-353">Recall that the CreateUserWizard has an `ActiveStepChanged` event, which fires each time the visitor navigates from one step to another.</span></span> <span data-ttu-id="3be6e-354">此处我们可以确定用户是否已达到"完成"步骤中;如果是这样，我们需要将用户添加到所选角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-354">Here we can determine if the user has reached the "Complete" step; if so, we need to add the user to the selected roles.</span></span>

<span data-ttu-id="3be6e-355">创建事件处理程序`ActiveStepChanged`事件，并添加以下代码：</span><span class="sxs-lookup"><span data-stu-id="3be6e-355">Create an event handler for the `ActiveStepChanged` event and add the following code:</span></span>

[!code-vb[Main](assigning-roles-to-users-vb/samples/sample23.vb)]

<span data-ttu-id="3be6e-356">如果用户只是已达到"已完成"步骤，事件处理程序的项进行枚举`RoleList`CheckBoxList 和刚创建的用户分配给所选角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-356">If the user has just reached the "Completed" step, the event handler enumerates the items of the `RoleList` CheckBoxList and the just-created user is assigned to the selected roles.</span></span>

<span data-ttu-id="3be6e-357">访问本页可通过浏览器。</span><span class="sxs-lookup"><span data-stu-id="3be6e-357">Visit this page through a browser.</span></span> <span data-ttu-id="3be6e-358">CreateUserWizard 的第一步是标准的"符号注册新帐户"步骤，该对话框提示输入新用户的用户名、 密码、 电子邮件和其他重要信息。</span><span class="sxs-lookup"><span data-stu-id="3be6e-358">The first step in the CreateUserWizard is the standard "Sign Up for Your New Account" step, which prompts for the new user's username, password, email, and other key information.</span></span> <span data-ttu-id="3be6e-359">输入要创建一个名为 Wanda 的新用户的信息。</span><span class="sxs-lookup"><span data-stu-id="3be6e-359">Enter the information to create a new user named Wanda.</span></span>


<span data-ttu-id="3be6e-360">[![创建名为 Wanda 的新用户](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-360">[![Create a New User Named Wanda](assigning-roles-to-users-vb/_static/image35.png)](assigning-roles-to-users-vb/_static/image34.png)</span></span>

<span data-ttu-id="3be6e-361">**图 12**:创建新的用户名为 Wanda ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-361">**Figure 12**: Create a New User Named Wanda  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image36.png))</span></span>


<span data-ttu-id="3be6e-362">单击"创建用户"按钮。</span><span class="sxs-lookup"><span data-stu-id="3be6e-362">Click the "Create User" button.</span></span> <span data-ttu-id="3be6e-363">在内部调用 CreateUserWizard`Membership.CreateUser`方法，创建新用户帐户，然后将前进到下一步"指定角色。"</span><span class="sxs-lookup"><span data-stu-id="3be6e-363">The CreateUserWizard internally calls the `Membership.CreateUser` method, creating the new user account, and then progresses to the next step, "Specify Roles."</span></span> <span data-ttu-id="3be6e-364">此处列出的系统角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-364">Here the system roles are listed.</span></span> <span data-ttu-id="3be6e-365">检查在监督器复选框，然后单击下一步。</span><span class="sxs-lookup"><span data-stu-id="3be6e-365">Check the Supervisors checkbox and click Next.</span></span>


<span data-ttu-id="3be6e-366">[![使 Wanda 在监督器角色的成员](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-366">[![Make Wanda a Member of the Supervisors Role](assigning-roles-to-users-vb/_static/image38.png)](assigning-roles-to-users-vb/_static/image37.png)</span></span>

<span data-ttu-id="3be6e-367">**图 13**:使 Wanda 在监督器角色的成员 ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-367">**Figure 13**: Make Wanda a Member of the Supervisors Role  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image39.png))</span></span>


<span data-ttu-id="3be6e-368">单击下一步会导致回发和更新`ActiveStep`到"已完成"步骤。</span><span class="sxs-lookup"><span data-stu-id="3be6e-368">Clicking Next causes a postback and updates the `ActiveStep` to the "Complete" step.</span></span> <span data-ttu-id="3be6e-369">在`ActiveStepChanged`事件处理程序的最近创建的用户帐户分配给在监督器角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-369">In the `ActiveStepChanged` event handler, the recently-created user account is assigned to the Supervisors role.</span></span> <span data-ttu-id="3be6e-370">若要验证这一点，返回到`UsersAndRoles.aspx`页上，选择在监督器从`RoleList`DropDownList。</span><span class="sxs-lookup"><span data-stu-id="3be6e-370">To verify this, return to the `UsersAndRoles.aspx` page and select Supervisors from the `RoleList` DropDownList.</span></span> <span data-ttu-id="3be6e-371">如图 14 所示，在监督器现在由组成的三个用户：Bruce、 Tito 和 Wanda。</span><span class="sxs-lookup"><span data-stu-id="3be6e-371">As Figure 14 shows, the Supervisors are now made up of three users: Bruce, Tito, and Wanda.</span></span>


<span data-ttu-id="3be6e-372">[![Bruce、 Tito 和 Wanda 是所有主管](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="3be6e-372">[![Bruce, Tito, and Wanda are All Supervisors](assigning-roles-to-users-vb/_static/image41.png)](assigning-roles-to-users-vb/_static/image40.png)</span></span>

<span data-ttu-id="3be6e-373">**图 14**:Bruce、 Tito 和 Wanda 是所有监督器 ([单击此项可查看原尺寸图像](assigning-roles-to-users-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="3be6e-373">**Figure 14**: Bruce, Tito, and Wanda are All Supervisors  ([Click to view full-size image](assigning-roles-to-users-vb/_static/image42.png))</span></span>


## <a name="summary"></a><span data-ttu-id="3be6e-374">总结</span><span class="sxs-lookup"><span data-stu-id="3be6e-374">Summary</span></span>

<span data-ttu-id="3be6e-375">角色框架提供了用于检索有关特定用户的角色和方法来确定哪些用户属于指定角色信息的方法。</span><span class="sxs-lookup"><span data-stu-id="3be6e-375">The Roles framework offers methods for retrieving information about a particular user's roles and methods for determining what users belong to a specified role.</span></span> <span data-ttu-id="3be6e-376">此外，有多种方法来添加和删除一个或多个用户到一个或多个角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-376">Furthermore, there are a number of methods for adding and removing one or more users to one or more roles.</span></span> <span data-ttu-id="3be6e-377">在本教程中我们主要介绍这些方法的两个：`AddUserToRole`和`RemoveUserFromRole`。</span><span class="sxs-lookup"><span data-stu-id="3be6e-377">In this tutorial we focused on just two of these methods: `AddUserToRole` and `RemoveUserFromRole`.</span></span> <span data-ttu-id="3be6e-378">有其他变体旨在将多个用户添加到单个角色，并将多个角色分配给单个用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-378">There are additional variants designed to add multiple users to a single role and to assign multiple roles to a single user.</span></span>

<span data-ttu-id="3be6e-379">本教程还包括一看扩展 CreateUserWizard 控件以包含`WizardStep`指定新建的用户的角色。</span><span class="sxs-lookup"><span data-stu-id="3be6e-379">This tutorial also included a look at extending the CreateUserWizard control to include a `WizardStep` to specify the newly-created user's roles.</span></span> <span data-ttu-id="3be6e-380">此类步骤可以帮助管理员简化创建新用户的用户帐户的过程。</span><span class="sxs-lookup"><span data-stu-id="3be6e-380">Such a step could help an administrator streamline the process of creating user accounts for new users.</span></span>

<span data-ttu-id="3be6e-381">现在我们已了解如何创建和删除角色以及如何添加和删除角色的用户。</span><span class="sxs-lookup"><span data-stu-id="3be6e-381">At this point we have seen how to create and delete roles and how to add and remove users from roles.</span></span> <span data-ttu-id="3be6e-382">但我们还未以看看应用基于角色的授权。</span><span class="sxs-lookup"><span data-stu-id="3be6e-382">But we have yet to look at applying role-based authorization.</span></span> <span data-ttu-id="3be6e-383">在中<a id="_msoanchor_6"> </a>[以下教程](role-based-authorization-vb.md)我们将了解基于角色的角色定义 URL 授权规则以及如何基于当前登录的用户的角色来限制页级别的功能。</span><span class="sxs-lookup"><span data-stu-id="3be6e-383">In the <a id="_msoanchor_6"></a>[following tutorial](role-based-authorization-vb.md) we will look at defining URL authorization rules on a role-by-role basis, as well as how to limit page-level functionality based on the currently logged in user's roles.</span></span>

<span data-ttu-id="3be6e-384">快乐编程 ！</span><span class="sxs-lookup"><span data-stu-id="3be6e-384">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="3be6e-385">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="3be6e-385">Further Reading</span></span>

<span data-ttu-id="3be6e-386">在本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="3be6e-386">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="3be6e-387">ASP.NET 网站管理工具概述</span><span class="sxs-lookup"><span data-stu-id="3be6e-387">ASP.NET Web Site Administration Tool Overview</span></span>](https://msdn.microsoft.com/library/ms228053.aspx)
- [<span data-ttu-id="3be6e-388">正在检查 ASP。NET 的成员资格、 角色和配置文件</span><span class="sxs-lookup"><span data-stu-id="3be6e-388">Examining ASP.NET's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="3be6e-389">滚动你自己的网站管理工具</span><span class="sxs-lookup"><span data-stu-id="3be6e-389">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="3be6e-390">关于作者</span><span class="sxs-lookup"><span data-stu-id="3be6e-390">About the Author</span></span>

<span data-ttu-id="3be6e-391">自 1998 年以来，Scott Mitchell，多部 asp/ASP.NET 书籍的作者及 4GuysFromRolla.com 的已从事 Microsoft Web 技术工作。</span><span class="sxs-lookup"><span data-stu-id="3be6e-391">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="3be6e-392">Scott 是独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="3be6e-392">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="3be6e-393">他最新著作是 *[Sams Teach 自己 ASP.NET 2.0 24 小时内](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*。</span><span class="sxs-lookup"><span data-stu-id="3be6e-393">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="3be6e-394">可以在达到 Scott [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com)或通过他的博客[ http://ScottOnWriting.NET ](http://scottonwriting.net/)。</span><span class="sxs-lookup"><span data-stu-id="3be6e-394">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="3be6e-395">特别感谢...</span><span class="sxs-lookup"><span data-stu-id="3be6e-395">Special Thanks To…</span></span>

<span data-ttu-id="3be6e-396">很多有用的审阅者已评审本系列教程。</span><span class="sxs-lookup"><span data-stu-id="3be6e-396">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="3be6e-397">本教程中的潜在顾客审阅者已 Teresa Murphy。</span><span class="sxs-lookup"><span data-stu-id="3be6e-397">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="3be6e-398">是否有兴趣查看我即将推出的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="3be6e-398">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="3be6e-399">如果是这样，给我在行 [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="3be6e-399">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="3be6e-400">[上一页](creating-and-managing-roles-vb.md)
> [下一页](role-based-authorization-vb.md)</span><span class="sxs-lookup"><span data-stu-id="3be6e-400">[Previous](creating-and-managing-roles-vb.md)
[Next](role-based-authorization-vb.md)</span></span>

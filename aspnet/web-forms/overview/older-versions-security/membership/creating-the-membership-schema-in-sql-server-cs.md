---
uid: web-forms/overview/older-versions-security/membership/creating-the-membership-schema-in-sql-server-cs
title: 在 SQL Server （C#）中创建成员身份架构 |Microsoft Docs
author: rick-anderson
description: 本教程首先检查将必要的架构添加到数据库的方法，以便使用 SqlMembershipProvider。 接下来，我们将
ms.author: riande
ms.date: 01/18/2008
ms.assetid: b4ac129d-1b8e-41ca-a38f-9b19d7c7bb0e
msc.legacyurl: /web-forms/overview/older-versions-security/membership/creating-the-membership-schema-in-sql-server-cs
msc.type: authoredcontent
ms.openlocfilehash: 97623e7c13ab7799b9dadbb8e52be8e0cd99e252
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2020
ms.locfileid: "78464438"
---
# <a name="creating-the-membership-schema-in-sql-server-c"></a><span data-ttu-id="babc2-104">在 SQL Server 中创建成员身份架构 (C#)</span><span class="sxs-lookup"><span data-stu-id="babc2-104">Creating the Membership Schema in SQL Server (C#)</span></span>

<span data-ttu-id="babc2-105">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="babc2-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="babc2-106">[下载代码](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_04_CS.zip)或[下载 PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial04_MembershipSetup_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="babc2-106">[Download Code](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_04_CS.zip) or [Download PDF](https://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial04_MembershipSetup_cs.pdf)</span></span>

> <span data-ttu-id="babc2-107">本教程首先检查将必要的架构添加到数据库的方法，以便使用 SqlMembershipProvider。</span><span class="sxs-lookup"><span data-stu-id="babc2-107">This tutorial starts by examining techniques for adding the necessary schema to the database in order to use the SqlMembershipProvider.</span></span> <span data-ttu-id="babc2-108">接下来，我们将检查架构中的关键表并讨论其用途和重要性。</span><span class="sxs-lookup"><span data-stu-id="babc2-108">Following that, we will examine the key tables in the schema and discuss their purpose and importance.</span></span> <span data-ttu-id="babc2-109">本教程将介绍如何判断成员身份框架应使用的 ASP.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-109">This tutorial ends with a look at how to tell an ASP.NET application which provider the Membership framework should use.</span></span>

## <a name="introduction"></a><span data-ttu-id="babc2-110">简介</span><span class="sxs-lookup"><span data-stu-id="babc2-110">Introduction</span></span>

<span data-ttu-id="babc2-111">前面的两个教程使用窗体身份验证来识别网站访问者。</span><span class="sxs-lookup"><span data-stu-id="babc2-111">The previous two tutorials examined using forms authentication to identify website visitors.</span></span> <span data-ttu-id="babc2-112">利用 forms 身份验证框架，开发人员可以轻松地将用户登录到网站，并通过使用身份验证票证在页面访问中记住他们。</span><span class="sxs-lookup"><span data-stu-id="babc2-112">The forms authentication framework makes it easy for developers to log a user into a website and to remember them across page visits through the use of authentication tickets.</span></span> <span data-ttu-id="babc2-113">`FormsAuthentication` 类包括用于生成票证并将其添加到访问者 cookie 的方法。</span><span class="sxs-lookup"><span data-stu-id="babc2-113">The `FormsAuthentication` class includes methods for generating the ticket and adding it to the visitor's cookies.</span></span> <span data-ttu-id="babc2-114">`FormsAuthenticationModule` 检查所有传入请求，对于具有有效身份验证票证的请求，将创建一个 `GenericPrincipal` 并将 `FormsIdentity` 对象与当前请求相关联。</span><span class="sxs-lookup"><span data-stu-id="babc2-114">The `FormsAuthenticationModule` examines all incoming requests and, for those with a valid authentication ticket, creates and associates a `GenericPrincipal` and a `FormsIdentity` object with the current request.</span></span> <span data-ttu-id="babc2-115">Forms 身份验证只是一种机制，用于在登录时向访问者授予身份验证票证，并在后续请求中对该票证进行分析，以确定用户的身份。</span><span class="sxs-lookup"><span data-stu-id="babc2-115">Forms authentication is merely a mechanism for granting an authentication ticket to a visitor when logging in and, on subsequent requests, parsing that ticket to determine the user's identity.</span></span> <span data-ttu-id="babc2-116">对于支持用户帐户的 web 应用程序，我们仍需要实现一个用户存储并添加功能来验证凭据、注册新用户以及其他许多与用户帐户相关的任务。</span><span class="sxs-lookup"><span data-stu-id="babc2-116">For a web application to support user accounts, we still need to implement a user store and add functionality to validate credentials, register new users, and the myriad of other user account-related tasks.</span></span>

<span data-ttu-id="babc2-117">在 ASP.NET 2.0 之前，开发人员处于挂钩上，用于实现所有与用户帐户相关的任务。</span><span class="sxs-lookup"><span data-stu-id="babc2-117">Prior to ASP.NET 2.0, developers were on the hook for implementing all of these user account-related tasks.</span></span> <span data-ttu-id="babc2-118">幸运的是，ASP.NET 团队认识到了这种缺点，并引入了 ASP.NET 2.0 的成员身份框架。</span><span class="sxs-lookup"><span data-stu-id="babc2-118">Fortunately the ASP.NET team recognized this shortcoming and introduced the Membership framework with ASP.NET 2.0.</span></span> <span data-ttu-id="babc2-119">成员身份框架是 .NET Framework 中的一组类，这些类提供用于完成与核心用户帐户相关的任务的编程接口。</span><span class="sxs-lookup"><span data-stu-id="babc2-119">The Membership framework is a set of classes in the .NET Framework that provide a programmatic interface for accomplishing core user account-related tasks.</span></span> <span data-ttu-id="babc2-120">此框架是在[提供程序模型](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx)的顶层构建的，使开发人员能够将自定义的实现插入到标准化的 API 中。</span><span class="sxs-lookup"><span data-stu-id="babc2-120">This framework is built atop the [provider model](http://aspnet.4guysfromrolla.com/articles/101905-1.aspx), which allows developers to plug a customized implementation into a standardized API.</span></span>

<span data-ttu-id="babc2-121">如<a id="Tutorial1"> </a>[*安全基础知识和 ASP.NET 支持*](../introduction/security-basics-and-asp-net-support-cs.md)教程中所述，.NET Framework 附带了两个内置成员资格提供程序： [`ActiveDirectoryMembershipProvider`](https://msdn.microsoft.com/library/system.web.security.activedirectorymembershipprovider.aspx)和[`SqlMembershipProvider`](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx)。</span><span class="sxs-lookup"><span data-stu-id="babc2-121">As discussed in the <a id="Tutorial1"></a>[*Security Basics and ASP.NET Support*](../introduction/security-basics-and-asp-net-support-cs.md) tutorial, the .NET Framework ships with two built-in Membership providers: [`ActiveDirectoryMembershipProvider`](https://msdn.microsoft.com/library/system.web.security.activedirectorymembershipprovider.aspx) and [`SqlMembershipProvider`](https://msdn.microsoft.com/library/system.web.security.sqlmembershipprovider.aspx).</span></span> <span data-ttu-id="babc2-122">顾名思义，`SqlMembershipProvider` 使用 Microsoft SQL Server 数据库作为用户存储区。</span><span class="sxs-lookup"><span data-stu-id="babc2-122">As its name implies, the `SqlMembershipProvider` uses a Microsoft SQL Server database as the user store.</span></span> <span data-ttu-id="babc2-123">为了在应用程序中使用此提供程序，我们需要告知提供程序要用作存储的数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-123">In order to use this provider in an application, we need to tell the provider what database to use as the store.</span></span> <span data-ttu-id="babc2-124">如您所料，`SqlMembershipProvider` 要求用户存储数据库包含某些数据库表、视图和存储过程。</span><span class="sxs-lookup"><span data-stu-id="babc2-124">As you might imagine, the `SqlMembershipProvider` expects the user store database to have certain database tables, views, and stored procedures.</span></span> <span data-ttu-id="babc2-125">需要将此预期的架构添加到所选数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-125">We need to add this expected schema to the selected database.</span></span>

<span data-ttu-id="babc2-126">本教程首先检查将必要的架构添加到数据库的方法，以便使用 `SqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="babc2-126">This tutorial starts by examining techniques for adding the necessary schema to the database in order to use the `SqlMembershipProvider`.</span></span> <span data-ttu-id="babc2-127">接下来，我们将检查架构中的关键表并讨论其用途和重要性。</span><span class="sxs-lookup"><span data-stu-id="babc2-127">Following that, we will examine the key tables in the schema and discuss their purpose and importance.</span></span> <span data-ttu-id="babc2-128">本教程将介绍如何判断成员身份框架应使用的 ASP.NET 应用程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-128">This tutorial ends with a look at how to tell an ASP.NET application which provider the Membership framework should use.</span></span>

<span data-ttu-id="babc2-129">让我们进入正题！</span><span class="sxs-lookup"><span data-stu-id="babc2-129">Let's get started!</span></span>

## <a name="step-1-deciding-where-to-place-the-user-store"></a><span data-ttu-id="babc2-130">步骤1：确定将用户存储放置在何处</span><span class="sxs-lookup"><span data-stu-id="babc2-130">Step 1: Deciding Where to Place the User Store</span></span>

<span data-ttu-id="babc2-131">ASP.NET 应用程序的数据通常存储在数据库的多个表中。</span><span class="sxs-lookup"><span data-stu-id="babc2-131">An ASP.NET application's data is commonly stored in a number of tables in a database.</span></span> <span data-ttu-id="babc2-132">在实现 `SqlMembershipProvider` 数据库架构时，必须决定是将成员身份架构放在与应用程序数据相同的数据库中，还是放置在备用数据库中。</span><span class="sxs-lookup"><span data-stu-id="babc2-132">When implementing the `SqlMembershipProvider` database schema we must decide whether to place the Membership schema in the same database as the application data or in an alternate database.</span></span>

<span data-ttu-id="babc2-133">建议在与应用程序数据相同的数据库中查找成员身份架构，原因如下：</span><span class="sxs-lookup"><span data-stu-id="babc2-133">I recommend locating the Membership schema in the same database as the application data for the following reasons:</span></span>

- <span data-ttu-id="babc2-134">可**维护性**：其中的数据封装在一个数据库中的应用程序比具有两个独立数据库的应用程序更易于理解、维护和部署。</span><span class="sxs-lookup"><span data-stu-id="babc2-134">**Maintainability** � an application whose data is encapsulated in one database is easier to understand, maintain, and deploy than an application that has two separate databases.</span></span>
- <span data-ttu-id="babc2-135">**关系完整性**：通过在与应用程序表相同的数据库中查找与成员相关的表，可以在与成员相关的表和相关的应用程序表中的主键之间建立[外键约束](http://en.wikipedia.org/wiki/Foreign_key)。</span><span class="sxs-lookup"><span data-stu-id="babc2-135">**Relational Integrity** � by locating the Membership-related tables in the same database as the application tables it is possible to establish [foreign key constraints](http://en.wikipedia.org/wiki/Foreign_key) between the primary keys in the Membership-related tables and related application tables.</span></span>

<span data-ttu-id="babc2-136">如果你有多个应用程序，而每个应用程序都使用不同的数据库，但需要共享一个公共用户存储，那么仅当你有多个应用程序时，将用户存储和应用程序数据分离</span><span class="sxs-lookup"><span data-stu-id="babc2-136">Decoupling the user store and application data into separate databases only makes sense if you have multiple applications that each use separate databases, but need to share a common user store.</span></span>

### <a name="creating-a-database"></a><span data-ttu-id="babc2-137">创建数据库</span><span class="sxs-lookup"><span data-stu-id="babc2-137">Creating a Database</span></span>

<span data-ttu-id="babc2-138">在第二个教程中，我们已生成的应用程序尚未需要数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-138">The application we have been building since the second tutorial has not yet needed a database.</span></span> <span data-ttu-id="babc2-139">但是，我们现在需要为用户存储提供一个。</span><span class="sxs-lookup"><span data-stu-id="babc2-139">We need one now, however, for the user store.</span></span> <span data-ttu-id="babc2-140">让我们创建一个架构，然后向其添加 `SqlMembershipProvider` 提供程序所需的架构（请参阅步骤2）。</span><span class="sxs-lookup"><span data-stu-id="babc2-140">Let's create one and then add to it the schema required by the `SqlMembershipProvider` provider (see Step 2).</span></span>

> [!NOTE]
> <span data-ttu-id="babc2-141">在本系列教程中，我们将使用[Microsoft SQL Server 2005 Express Edition](https://msdn.microsoft.com/sql/Aa336346.aspx)数据库来存储应用程序表和 `SqlMembershipProvider` 架构。</span><span class="sxs-lookup"><span data-stu-id="babc2-141">Throughout this tutorial series we will be using a [Microsoft SQL Server 2005 Express Edition](https://msdn.microsoft.com/sql/Aa336346.aspx) database to store our application tables and the `SqlMembershipProvider` schema.</span></span> <span data-ttu-id="babc2-142">由于以下两个原因导致了此决定：第一种情况是因为其成本免费-Express Edition 是 SQL Server 2005 的最 readably 的可访问版本;其次，SQL Server 2005 Express Edition 数据库可以直接放置在 web 应用程序的 `App_Data` 文件夹中，从而 cinch 将数据库和 web 应用程序打包到一个 ZIP 文件中，并在不使用任何特殊安装说明或配置选项的情况下重新部署它。</span><span class="sxs-lookup"><span data-stu-id="babc2-142">This decision was made for two reasons: first, due to its cost - free - the Express Edition is the most readably accessible version of SQL Server 2005; second, SQL Server 2005 Express Edition databases can be placed directly in the web application's `App_Data` folder, making it a cinch to package the database and web application together in one ZIP file and to redeploy it without any special setup instructions or configuration options.</span></span> <span data-ttu-id="babc2-143">如果希望继续使用 SQL Server 的非速成版版本，请随时免费。</span><span class="sxs-lookup"><span data-stu-id="babc2-143">If you'd prefer to follow along using a non-Express Edition version of SQL Server, feel free.</span></span> <span data-ttu-id="babc2-144">步骤几乎完全相同。</span><span class="sxs-lookup"><span data-stu-id="babc2-144">The steps are virtually identical.</span></span> <span data-ttu-id="babc2-145">`SqlMembershipProvider` 架构将适用于 Microsoft SQL Server 2000 及更高版本的任何版本。</span><span class="sxs-lookup"><span data-stu-id="babc2-145">The `SqlMembershipProvider` schema will work with any version of Microsoft SQL Server 2000 and up.</span></span>

<span data-ttu-id="babc2-146">在解决方案资源管理器中，右键单击 `App_Data` 文件夹，然后选择 "添加新项"。</span><span class="sxs-lookup"><span data-stu-id="babc2-146">From the Solution Explorer, right-click on the `App_Data` folder and choose to Add New Item.</span></span> <span data-ttu-id="babc2-147">（如果未在项目中看到 `App_Data` 文件夹，请在解决方案资源管理器中右键单击该项目，选择 "添加 ASP.NET 文件夹"，然后选择 "`App_Data`"。）从 "添加新项" 对话框中，选择添加名为 `SecurityTutorials.mdf`的新 SQL 数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-147">(If you do not see an `App_Data` folder in your project, right-click on the project in Solution Explorer, select Add ASP.NET Folder, and pick `App_Data`.) From the Add New Item dialog box, choose to add a new SQL Database named `SecurityTutorials.mdf`.</span></span> <span data-ttu-id="babc2-148">在本教程中，我们将向此数据库添加 `SqlMembershipProvider` 架构;在后续教程中，我们将创建其他表来捕获应用程序数据。</span><span class="sxs-lookup"><span data-stu-id="babc2-148">In this tutorial we will add the `SqlMembershipProvider` schema to this database; in subsequent tutorials we will create additional tables to capture our application data.</span></span>

<span data-ttu-id="babc2-149">[![将名为 SecurityTutorials 的新 SQL 数据库添加到 App_Data 文件夹](creating-the-membership-schema-in-sql-server-cs/_static/image2.png)](creating-the-membership-schema-in-sql-server-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-149">[![Add a New SQL Database Named SecurityTutorials.mdf Database to the App_Data Folder](creating-the-membership-schema-in-sql-server-cs/_static/image2.png)](creating-the-membership-schema-in-sql-server-cs/_static/image1.png)</span></span>

<span data-ttu-id="babc2-150">**图 1**：将名为 `SecurityTutorials.mdf` 数据库的新 SQL 数据库添加到 `App_Data` 文件夹（[单击查看完全大小的映像](creating-the-membership-schema-in-sql-server-cs/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-150">**Figure 1**: Add a New SQL Database Named `SecurityTutorials.mdf` Database to the `App_Data` Folder ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image3.png))</span></span>

<span data-ttu-id="babc2-151">将数据库添加到 `App_Data` 文件夹会自动将其包含在数据库资源管理器视图中。</span><span class="sxs-lookup"><span data-stu-id="babc2-151">Adding a database to the `App_Data` folder automatically includes it in the Database Explorer view.</span></span> <span data-ttu-id="babc2-152">（在 Visual Studio 的非速成版版本中，数据库资源管理器称为服务器资源管理器。）中转到数据库资源管理器并展开刚刚添加的 `SecurityTutorials` 数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-152">(In the non-Express Edition version of Visual Studio, the Database Explorer is called the Server Explorer.) Go to the Database Explorer and expand the just-added `SecurityTutorials` database.</span></span> <span data-ttu-id="babc2-153">如果在屏幕上看不到 "数据库资源管理器"，请单击 "查看" 菜单，然后选择 "数据库资源管理器" 或按 Ctrl + Alt + S。</span><span class="sxs-lookup"><span data-stu-id="babc2-153">If you do not see the Database Explorer on screen, go to the View menu and choose Database Explorer, or hit Ctrl+Alt+S.</span></span> <span data-ttu-id="babc2-154">如图2所示，`SecurityTutorials` 数据库为空-它不包含任何表、视图和存储过程。</span><span class="sxs-lookup"><span data-stu-id="babc2-154">As Figure 2 shows, the `SecurityTutorials` database is empty - it contains no tables, no views, and no stored procedures.</span></span>

<span data-ttu-id="babc2-155">[![SecurityTutorials 数据库当前为空](creating-the-membership-schema-in-sql-server-cs/_static/image5.png)](creating-the-membership-schema-in-sql-server-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-155">[![The SecurityTutorials Database is Currently Empty](creating-the-membership-schema-in-sql-server-cs/_static/image5.png)](creating-the-membership-schema-in-sql-server-cs/_static/image4.png)</span></span>

<span data-ttu-id="babc2-156">**图 2**： `SecurityTutorials` 数据库当前为空（[单击以查看完全大小的图像](creating-the-membership-schema-in-sql-server-cs/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-156">**Figure 2**: The `SecurityTutorials` Database is Currently Empty ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image6.png))</span></span>

## <a name="step-2-adding-thesqlmembershipproviderschema-to-the-database"></a><span data-ttu-id="babc2-157">步骤2：将`SqlMembershipProvider`架构添加到数据库</span><span class="sxs-lookup"><span data-stu-id="babc2-157">Step 2: Adding the`SqlMembershipProvider`Schema to the Database</span></span>

<span data-ttu-id="babc2-158">`SqlMembershipProvider` 要求在用户存储数据库中安装一组特定的表、视图和存储过程。</span><span class="sxs-lookup"><span data-stu-id="babc2-158">The `SqlMembershipProvider` requires a particular set of tables, views, and stored procedures to be installed in the user store database.</span></span> <span data-ttu-id="babc2-159">可以使用[`aspnet_regsql.exe` 工具](https://msdn.microsoft.com/library/ms229862.aspx)添加这些必需的数据库对象。</span><span class="sxs-lookup"><span data-stu-id="babc2-159">These requisite database objects can be added using the [`aspnet_regsql.exe` tool](https://msdn.microsoft.com/library/ms229862.aspx).</span></span> <span data-ttu-id="babc2-160">此文件位于 `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\` 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="babc2-160">This file is located in the `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\` folder.</span></span>

> [!NOTE]
> <span data-ttu-id="babc2-161">`aspnet_regsql.exe` 工具提供了命令行功能和图形用户界面。</span><span class="sxs-lookup"><span data-stu-id="babc2-161">The `aspnet_regsql.exe` tool offers both command line functionality and a graphical user interface.</span></span> <span data-ttu-id="babc2-162">图形界面更易于用户理解，在本教程中我们将对此进行介绍。</span><span class="sxs-lookup"><span data-stu-id="babc2-162">The graphical interface is more user friendly and is what we will examine in this tutorial.</span></span> <span data-ttu-id="babc2-163">如果添加 `SqlMembershipProvider` 架构需要自动执行，例如在生成脚本或自动测试方案中，则命令行接口非常有用。</span><span class="sxs-lookup"><span data-stu-id="babc2-163">The command line interface is useful when the addition of the `SqlMembershipProvider` schema needs to be automated, such as in build scripts or automated testing scenarios.</span></span>

<span data-ttu-id="babc2-164">`aspnet_regsql.exe` 工具用于在指定的 SQL Server 数据库中添加或删除*ASP.NET 应用程序服务*。</span><span class="sxs-lookup"><span data-stu-id="babc2-164">The `aspnet_regsql.exe` tool is used to add or remove *ASP.NET application services* to a specified SQL Server database.</span></span> <span data-ttu-id="babc2-165">ASP.NET 应用程序服务包含 `SqlMembershipProvider` 和 `SqlRoleProvider`的架构，以及适用于其他 ASP.NET 2.0 框架的基于 SQL 的提供程序的架构。</span><span class="sxs-lookup"><span data-stu-id="babc2-165">The ASP.NET application services encompass the schemas for the `SqlMembershipProvider` and `SqlRoleProvider`, along with the schemas for the SQL-based providers for other ASP.NET 2.0 frameworks.</span></span> <span data-ttu-id="babc2-166">我们需要向 `aspnet_regsql.exe` 工具提供两位信息：</span><span class="sxs-lookup"><span data-stu-id="babc2-166">We need to provide two bits of information to the `aspnet_regsql.exe` tool:</span></span>

- <span data-ttu-id="babc2-167">是要添加还是删除应用程序服务，以及</span><span class="sxs-lookup"><span data-stu-id="babc2-167">Whether we want to add or remove application services, and</span></span>
- <span data-ttu-id="babc2-168">要从中添加或删除应用程序服务架构的数据库</span><span class="sxs-lookup"><span data-stu-id="babc2-168">The database from which to add or remove the application services schema</span></span>

<span data-ttu-id="babc2-169">在提示数据库使用的情况下，`aspnet_regsql.exe` 工具会要求我们提供数据库所在服务器的名称、用于连接到数据库的安全凭据以及数据库名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-169">In prompting for the database to use, the `aspnet_regsql.exe` tool asks us to provide the name of the server the database resides on, the security credentials for connecting to the database, and the database name.</span></span> <span data-ttu-id="babc2-170">如果你使用的是非 Express 版本的 SQL Server，则应该已经知道此信息，因为它是你在通过 ASP.NET 网页使用数据库时必须通过连接字符串提供的相同信息。</span><span class="sxs-lookup"><span data-stu-id="babc2-170">If you are using the non-Express Edition of SQL Server, you should already know this information, as it is the same information you must provide through a connection string when working with the database through an ASP.NET web page.</span></span> <span data-ttu-id="babc2-171">但是，在使用 `App_Data` 文件夹中的 SQL Server 2005 Express Edition 数据库时，确定服务器和数据库名称更多。</span><span class="sxs-lookup"><span data-stu-id="babc2-171">Determining the server and database name when using a SQL Server 2005 Express Edition database in the `App_Data` folder, however, is a bit more involved.</span></span>

<span data-ttu-id="babc2-172">以下部分介绍了在 `App_Data` 文件夹中指定 SQL Server 2005 Express Edition 数据库的服务器和数据库名称的一种简单方法。</span><span class="sxs-lookup"><span data-stu-id="babc2-172">The following section examines a straightforward way for specifying the server and database name for a SQL Server 2005 Express Edition database in the `App_Data` folder.</span></span> <span data-ttu-id="babc2-173">如果使用的不是 SQL Server 2005 Express Edition 请随意跳到安装应用程序服务部分。</span><span class="sxs-lookup"><span data-stu-id="babc2-173">If you are not using SQL Server 2005 Express Edition feel free to skip ahead to the Installing the Application Services section.</span></span>

### <a name="determining-the-server-and-database-name-for-a-sql-server-2005-express-edition-database-in-theapp_datafolder"></a><span data-ttu-id="babc2-174">确定`App_Data`文件夹中 SQL Server 2005 Express Edition 数据库的服务器和数据库名称</span><span class="sxs-lookup"><span data-stu-id="babc2-174">Determining the Server and Database Name for a SQL Server 2005 Express Edition Database in the`App_Data`Folder</span></span>

<span data-ttu-id="babc2-175">为了使用 `aspnet_regsql.exe` 工具，我们需要知道服务器和数据库的名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-175">In order to use the `aspnet_regsql.exe` tool we need to know the server and database names.</span></span> <span data-ttu-id="babc2-176">服务器名称为 `localhost\InstanceName`。</span><span class="sxs-lookup"><span data-stu-id="babc2-176">The server name is `localhost\InstanceName`.</span></span> <span data-ttu-id="babc2-177">这很可能是因为*InstanceName* `SQLExpress`。</span><span class="sxs-lookup"><span data-stu-id="babc2-177">Most likely, the *InstanceName* is `SQLExpress`.</span></span> <span data-ttu-id="babc2-178">但是，如果手动安装了 SQL Server 2005 Express Edition （即，安装 Visual Studio 时未自动安装），则可能选择了不同的实例名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-178">However, if you installed SQL Server 2005 Express Edition manually (that is, you did not install it automatically while installing Visual Studio), then it is possible that you selected a different instance name.</span></span>

<span data-ttu-id="babc2-179">确定数据库名称有点棘手。</span><span class="sxs-lookup"><span data-stu-id="babc2-179">The database name is a bit trickier to determine.</span></span> <span data-ttu-id="babc2-180">`App_Data` 文件夹中的数据库通常具有一个数据库名称，其中包含一个[全局唯一标识符](http://en.wikipedia.org/wiki/Globally_Unique_Identifier)以及数据库文件的路径。</span><span class="sxs-lookup"><span data-stu-id="babc2-180">Databases in the `App_Data` folder typically have a database name that includes a [globally unique identifier](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) along with the path to the database file.</span></span> <span data-ttu-id="babc2-181">我们需要确定此数据库名称，以便通过 `aspnet_regsql.exe`添加应用程序服务架构。</span><span class="sxs-lookup"><span data-stu-id="babc2-181">We need to determine this database name in order to add the application services schema through `aspnet_regsql.exe`.</span></span>

<span data-ttu-id="babc2-182">确定数据库名称的最简单方法是通过 SQL Server Management Studio 来检查数据库名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-182">The easiest way to ascertain the database name is to examine it through SQL Server Management Studio.</span></span> <span data-ttu-id="babc2-183">SQL Server Management Studio 提供了一个图形界面用于管理 SQL Server 2005 数据库，但它不附带 SQL Server 2005 的 Express 版本。</span><span class="sxs-lookup"><span data-stu-id="babc2-183">SQL Server Management Studio provides a graphical interface for managing SQL Server 2005 databases, but it does not ship with the Express Edition of SQL Server 2005.</span></span> <span data-ttu-id="babc2-184">好消息是，[你可以下载](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en)SQL Server Management Studio 的免费 Express 版。</span><span class="sxs-lookup"><span data-stu-id="babc2-184">The good news is that [you can download](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en) the free Express Edition of SQL Server Management Studio.</span></span>

> [!NOTE]
> <span data-ttu-id="babc2-185">如果你的桌面上还安装了非 Express Edition 版本的 SQL Server 2005，则可能会安装 Management Studio 的完整版本。</span><span class="sxs-lookup"><span data-stu-id="babc2-185">If you also have a non-Express Edition version of SQL Server 2005 installed on your desktop then the full version of Management Studio is likely installed.</span></span> <span data-ttu-id="babc2-186">您可以使用完整版本来确定数据库名称，遵循的步骤与学习版中所述的步骤相同。</span><span class="sxs-lookup"><span data-stu-id="babc2-186">You can use the full version to determine the database name, following the same steps as outlined below for the Express Edition.</span></span>

<span data-ttu-id="babc2-187">首先关闭 Visual Studio，以确保已关闭 Visual Studio 在数据库文件上施加的任何锁。</span><span class="sxs-lookup"><span data-stu-id="babc2-187">Start by closing Visual Studio to ensure that any locks imposed by Visual Studio on the database file are closed.</span></span> <span data-ttu-id="babc2-188">接下来，启动 SQL Server Management Studio 并连接到 SQL Server 2005 Express Edition 的 `localhost\InstanceName` 数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-188">Next, launch SQL Server Management Studio and connect to the `localhost\InstanceName` database for SQL Server 2005 Express Edition.</span></span> <span data-ttu-id="babc2-189">如前文所述，实例名称可能 `SQLExpress`。</span><span class="sxs-lookup"><span data-stu-id="babc2-189">As noted earlier, chances are the instance name is `SQLExpress`.</span></span> <span data-ttu-id="babc2-190">对于 "身份验证" 选项，请选择 "Windows 身份验证"。</span><span class="sxs-lookup"><span data-stu-id="babc2-190">For the Authentication option, select Windows Authentication.</span></span>

<span data-ttu-id="babc2-191">[![连接到 SQL Server 2005 Express Edition 实例](creating-the-membership-schema-in-sql-server-cs/_static/image8.png)](creating-the-membership-schema-in-sql-server-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-191">[![Connect to the SQL Server 2005 Express Edition Instance](creating-the-membership-schema-in-sql-server-cs/_static/image8.png)](creating-the-membership-schema-in-sql-server-cs/_static/image7.png)</span></span>

<span data-ttu-id="babc2-192">**图 3**：连接到 SQL Server 2005 Express Edition 实例（[单击以查看完全大小的图像](creating-the-membership-schema-in-sql-server-cs/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-192">**Figure 3**: Connect to the SQL Server 2005 Express Edition Instance ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image9.png))</span></span>

<span data-ttu-id="babc2-193">连接到 SQL Server 2005 Express Edition 实例后，Management Studio 显示数据库、安全设置、服务器对象等文件夹。</span><span class="sxs-lookup"><span data-stu-id="babc2-193">After connecting to the SQL Server 2005 Express Edition instance, Management Studio displays folders for the Databases, the Security settings, the Server Objects, and so on.</span></span> <span data-ttu-id="babc2-194">如果你展开 "数据库" 选项卡，你将看到 `SecurityTutorials.mdf` 数据库*未*在数据库实例中注册-我们需要首先附加数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-194">If you expand the Databases tab you will see that the `SecurityTutorials.mdf` database is *not* registered in the database instance - we need to attach the database first.</span></span>

<span data-ttu-id="babc2-195">右键单击 "数据库" 文件夹，然后从上下文菜单中选择 "附加"。</span><span class="sxs-lookup"><span data-stu-id="babc2-195">Right-click on the Databases folder and choose Attach from the context menu.</span></span> <span data-ttu-id="babc2-196">这将显示 "附加数据库" 对话框。</span><span class="sxs-lookup"><span data-stu-id="babc2-196">This will display the Attach Databases dialog box.</span></span> <span data-ttu-id="babc2-197">在此处单击 "添加" 按钮，浏览到 `SecurityTutorials.mdf` 数据库，然后单击 "确定"。</span><span class="sxs-lookup"><span data-stu-id="babc2-197">From here, click the Add button, browse to the `SecurityTutorials.mdf` database, and click OK.</span></span> <span data-ttu-id="babc2-198">图4在选择 `SecurityTutorials.mdf` 数据库后，显示 "附加数据库" 对话框。</span><span class="sxs-lookup"><span data-stu-id="babc2-198">Figure 4 shows the Attach Databases dialog box after the `SecurityTutorials.mdf` database has been selected.</span></span> <span data-ttu-id="babc2-199">图5显示了成功附加数据库后 Management Studio 对象资源管理器。</span><span class="sxs-lookup"><span data-stu-id="babc2-199">Figure 5 shows Management Studio's Object Explorer after the database has been successfully attached.</span></span>

<span data-ttu-id="babc2-200">[![附加 SecurityTutorials 数据库](creating-the-membership-schema-in-sql-server-cs/_static/image11.png)](creating-the-membership-schema-in-sql-server-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-200">[![Attach the SecurityTutorials.mdf Database](creating-the-membership-schema-in-sql-server-cs/_static/image11.png)](creating-the-membership-schema-in-sql-server-cs/_static/image10.png)</span></span>

<span data-ttu-id="babc2-201">**图 4**：附加 `SecurityTutorials.mdf` 数据库（[单击以查看完全大小的图像](creating-the-membership-schema-in-sql-server-cs/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-201">**Figure 4**: Attach the `SecurityTutorials.mdf` Database ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image12.png))</span></span>

<span data-ttu-id="babc2-202">[![SecurityTutorials 数据库出现在 "数据库" 文件夹中](creating-the-membership-schema-in-sql-server-cs/_static/image14.png)](creating-the-membership-schema-in-sql-server-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-202">[![The SecurityTutorials.mdf Database Appears in the Databases Folder](creating-the-membership-schema-in-sql-server-cs/_static/image14.png)](creating-the-membership-schema-in-sql-server-cs/_static/image13.png)</span></span>

<span data-ttu-id="babc2-203">**图 5**： `SecurityTutorials.mdf` 数据库显示在 "数据库" 文件夹中（[单击以查看完全大小的图像](creating-the-membership-schema-in-sql-server-cs/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-203">**Figure 5**: The `SecurityTutorials.mdf` Database Appears in the Databases Folder ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image15.png))</span></span>

<span data-ttu-id="babc2-204">如图5所示，`SecurityTutorials.mdf` 数据库具有 abstruse 的名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-204">As Figure 5 shows, the `SecurityTutorials.mdf` database has a rather abstruse name.</span></span> <span data-ttu-id="babc2-205">让我们将其更改为更容易记忆的名称（更易于键入）。</span><span class="sxs-lookup"><span data-stu-id="babc2-205">Let's change it to a more memorable (and easier to type) name.</span></span> <span data-ttu-id="babc2-206">右键单击该数据库，从上下文菜单中选择 "重命名"，然后将其重命名为 "`SecurityTutorialsDatabase`"。</span><span class="sxs-lookup"><span data-stu-id="babc2-206">Right-click on the database, choose Rename from the context menu, and rename it `SecurityTutorialsDatabase`.</span></span> <span data-ttu-id="babc2-207">这不会更改文件名，而只会更改数据库用来标识自身 SQL Server 的名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-207">This does not change the filename, just the name the database uses to identify itself to SQL Server.</span></span>

<span data-ttu-id="babc2-208">[![将数据库重命名为 SecurityTutorialsDatabase](creating-the-membership-schema-in-sql-server-cs/_static/image17.png)](creating-the-membership-schema-in-sql-server-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-208">[![Rename the Database to SecurityTutorialsDatabase](creating-the-membership-schema-in-sql-server-cs/_static/image17.png)](creating-the-membership-schema-in-sql-server-cs/_static/image16.png)</span></span>

<span data-ttu-id="babc2-209">**图 6**：将数据库重命名为 `SecurityTutorialsDatabase`（[单击查看完全大小的映像](creating-the-membership-schema-in-sql-server-cs/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-209">**Figure 6**: Rename the Database to `SecurityTutorialsDatabase`([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image18.png))</span></span>

<span data-ttu-id="babc2-210">此时，我们知道 `SecurityTutorials.mdf` 数据库文件的服务器和数据库名称：分别为 `localhost\InstanceName` 和 `SecurityTutorialsDatabase`。</span><span class="sxs-lookup"><span data-stu-id="babc2-210">At this point we know the server and database names for the `SecurityTutorials.mdf` database file: `localhost\InstanceName` and `SecurityTutorialsDatabase`, respectively.</span></span> <span data-ttu-id="babc2-211">现在，可以通过 `aspnet_regsql.exe` 工具安装应用程序服务了。</span><span class="sxs-lookup"><span data-stu-id="babc2-211">We are now ready to install the application services through the `aspnet_regsql.exe` tool.</span></span>

### <a name="installing-the-application-services"></a><span data-ttu-id="babc2-212">安装应用程序服务</span><span class="sxs-lookup"><span data-stu-id="babc2-212">Installing the Application Services</span></span>

<span data-ttu-id="babc2-213">若要启动 `aspnet_regsql.exe` 工具，请在 "开始" 菜单中，选择 "运行"。</span><span class="sxs-lookup"><span data-stu-id="babc2-213">To launch the `aspnet_regsql.exe` tool, go to the start menu and choose Run.</span></span> <span data-ttu-id="babc2-214">在文本框中输入 "`%WINDIR%\Microsoft.Net\Framework\v2.0.50727\aspnet_regsql.exe`"，然后单击 "确定"。</span><span class="sxs-lookup"><span data-stu-id="babc2-214">Enter `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\aspnet_regsql.exe` into the textbox and click OK.</span></span> <span data-ttu-id="babc2-215">或者，您可以使用 Windows 资源管理器向下钻取到相应的文件夹，然后双击 `aspnet_regsql.exe` 文件。</span><span class="sxs-lookup"><span data-stu-id="babc2-215">Alternatively, you can use Windows Explorer to drill down to the appropriate folder and double-click the `aspnet_regsql.exe` file.</span></span> <span data-ttu-id="babc2-216">这两种方法都将产生相同的结果。</span><span class="sxs-lookup"><span data-stu-id="babc2-216">Either approach will net the same results.</span></span>

<span data-ttu-id="babc2-217">在没有任何命令行参数的情况下运行 `aspnet_regsql.exe` 工具将启动 ASP.NET SQL Server 安装向导图形用户界面。</span><span class="sxs-lookup"><span data-stu-id="babc2-217">Running the `aspnet_regsql.exe` tool without any command line arguments launches the ASP.NET SQL Server Setup Wizard graphical user interface.</span></span> <span data-ttu-id="babc2-218">使用该向导，可以轻松地在指定的数据库上添加或删除 ASP.NET 应用程序服务。</span><span class="sxs-lookup"><span data-stu-id="babc2-218">The wizard makes it easy to add or remove the ASP.NET application services on a specified database.</span></span> <span data-ttu-id="babc2-219">向导的第一个屏幕（如图7所示）描述了该工具的用途。</span><span class="sxs-lookup"><span data-stu-id="babc2-219">The first screen of the wizard, shown in Figure 7, describes the purpose of the tool.</span></span>

<span data-ttu-id="babc2-220">[![使用 ASP.NET SQL Server 安装向导添加成员身份架构](creating-the-membership-schema-in-sql-server-cs/_static/image20.png)](creating-the-membership-schema-in-sql-server-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-220">[![Use the ASP.NET SQL Server Setup Wizard Makes to Add the Membership Schema](creating-the-membership-schema-in-sql-server-cs/_static/image20.png)](creating-the-membership-schema-in-sql-server-cs/_static/image19.png)</span></span>

<span data-ttu-id="babc2-221">**图 7**：使用 ASP.NET SQL Server 安装向导来添加成员身份架构（[单击以查看完全大小的映像](creating-the-membership-schema-in-sql-server-cs/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-221">**Figure 7**: Use the ASP.NET SQL Server Setup Wizard Makes to Add the Membership Schema ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image21.png))</span></span>

<span data-ttu-id="babc2-222">向导中的第二个步骤询问我们是否要添加应用程序服务或删除它们。</span><span class="sxs-lookup"><span data-stu-id="babc2-222">The second step in the wizard asks us whether we want to add the application services or remove them.</span></span> <span data-ttu-id="babc2-223">由于我们要为 `SqlMembershipProvider`添加所需的表、视图和存储过程，请选择 "为应用程序服务配置 SQL Server" 选项。</span><span class="sxs-lookup"><span data-stu-id="babc2-223">Since we want to add the tables, views, and stored procedures necessary for the `SqlMembershipProvider`, choose the Configure SQL Server for application services option.</span></span> <span data-ttu-id="babc2-224">稍后，如果要从数据库中删除此架构，请重新运行此向导，而不是选择 "从现有数据库中删除应用程序服务信息" 选项。</span><span class="sxs-lookup"><span data-stu-id="babc2-224">Later, if you want to remove this schema from your database, re-run this wizard, but instead choose the Remove application services information from an existing database option.</span></span>

<span data-ttu-id="babc2-225">[![选择为应用程序服务选项配置 SQL Server](creating-the-membership-schema-in-sql-server-cs/_static/image23.png)](creating-the-membership-schema-in-sql-server-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-225">[![Choose the Configure SQL Server for Application Services Option](creating-the-membership-schema-in-sql-server-cs/_static/image23.png)](creating-the-membership-schema-in-sql-server-cs/_static/image22.png)</span></span>

<span data-ttu-id="babc2-226">**图 8**：选择 "为应用程序服务配置 SQL Server" 选项（[单击以查看完全大小的映像](creating-the-membership-schema-in-sql-server-cs/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-226">**Figure 8**: Choose the Configure SQL Server for Application Services Option ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image24.png))</span></span>

<span data-ttu-id="babc2-227">第三步提示输入数据库信息：服务器名称、身份验证信息和数据库名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-227">The third step prompts for the database information: the server name, authentication information, and the database name.</span></span> <span data-ttu-id="babc2-228">如果已与本教程一起使用，并已将 `SecurityTutorials.mdf` 数据库添加到 `App_Data`中，将其附加到 `localhost\InstanceName`，并将其重命名为 `SecurityTutorialsDatabase`，则使用以下值：</span><span class="sxs-lookup"><span data-stu-id="babc2-228">If you have been following along with this tutorial and have added the `SecurityTutorials.mdf` database to `App_Data`, attached it to `localhost\InstanceName`, and renamed it to `SecurityTutorialsDatabase`, then use the following values:</span></span>

- <span data-ttu-id="babc2-229">服务器： `localhost\InstanceName`</span><span class="sxs-lookup"><span data-stu-id="babc2-229">Server: `localhost\InstanceName`</span></span>
- <span data-ttu-id="babc2-230">Windows 身份验证</span><span class="sxs-lookup"><span data-stu-id="babc2-230">Windows authentication</span></span>
- <span data-ttu-id="babc2-231">数据库： `SecurityTutorialsDatabase`</span><span class="sxs-lookup"><span data-stu-id="babc2-231">Database: `SecurityTutorialsDatabase`</span></span>

<span data-ttu-id="babc2-232">[![输入数据库信息](creating-the-membership-schema-in-sql-server-cs/_static/image26.png)](creating-the-membership-schema-in-sql-server-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-232">[![Enter the Database Information](creating-the-membership-schema-in-sql-server-cs/_static/image26.png)](creating-the-membership-schema-in-sql-server-cs/_static/image25.png)</span></span>

<span data-ttu-id="babc2-233">**图 9**：输入数据库信息（[单击以查看完全大小的映像](creating-the-membership-schema-in-sql-server-cs/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-233">**Figure 9**: Enter the Database Information ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image27.png))</span></span>

<span data-ttu-id="babc2-234">输入数据库信息后，单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="babc2-234">After entering the database information, click Next.</span></span> <span data-ttu-id="babc2-235">最后一个步骤汇总了将要执行的步骤。</span><span class="sxs-lookup"><span data-stu-id="babc2-235">The final step summarizes the steps that will be taken.</span></span> <span data-ttu-id="babc2-236">单击 "下一步" 以安装应用程序服务，然后单击 "完成" 完成向导。</span><span class="sxs-lookup"><span data-stu-id="babc2-236">Click Next to install the application services and then Finish to complete the wizard.</span></span>

> [!NOTE]
> <span data-ttu-id="babc2-237">如果使用 Management Studio 附加数据库并重命名数据库文件，请确保分离数据库并关闭 Management Studio，然后再重新打开 Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="babc2-237">If you used Management Studio to attach the database and rename the database file, be sure to detach the database and close Management Studio before reopening Visual Studio.</span></span> <span data-ttu-id="babc2-238">若要分离 `SecurityTutorialsDatabase` 数据库，请右键单击数据库名称，然后在 "任务" 菜单中选择 "分离"。</span><span class="sxs-lookup"><span data-stu-id="babc2-238">To detach the `SecurityTutorialsDatabase` database, right-click on the database name and, from the Tasks menu, choose Detach.</span></span>

<span data-ttu-id="babc2-239">完成向导后，返回到 Visual Studio 并导航到数据库资源管理器。</span><span class="sxs-lookup"><span data-stu-id="babc2-239">Upon completion of the wizard, return to Visual Studio and navigate to the Database Explorer.</span></span> <span data-ttu-id="babc2-240">展开“表”文件夹。</span><span class="sxs-lookup"><span data-stu-id="babc2-240">Expand the Tables folder.</span></span> <span data-ttu-id="babc2-241">应该会看到一系列表的名称以前缀 `aspnet_`开头。</span><span class="sxs-lookup"><span data-stu-id="babc2-241">You should see a series of tables whose names start with the prefix `aspnet_`.</span></span> <span data-ttu-id="babc2-242">同样，可以在 "视图" 和 "存储过程" 文件夹下找到各种视图和存储过程。</span><span class="sxs-lookup"><span data-stu-id="babc2-242">Likewise, a variety of views and stored procedures can be found under the Views and Stored Procedures folders.</span></span> <span data-ttu-id="babc2-243">这些数据库对象构成应用程序服务架构。</span><span class="sxs-lookup"><span data-stu-id="babc2-243">These database objects make up the application services schema.</span></span> <span data-ttu-id="babc2-244">我们将在步骤3中检查成员身份和特定于角色的数据库对象。</span><span class="sxs-lookup"><span data-stu-id="babc2-244">We will examine the membership- and role-specific database objects in Step 3.</span></span>

<span data-ttu-id="babc2-245">[已在数据库中添加了 ![多个表、视图和存储过程](creating-the-membership-schema-in-sql-server-cs/_static/image29.png)](creating-the-membership-schema-in-sql-server-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-245">[![A Variety of Tables, Views, and Stored Procedures Have Been Added to the Database](creating-the-membership-schema-in-sql-server-cs/_static/image29.png)](creating-the-membership-schema-in-sql-server-cs/_static/image28.png)</span></span>

<span data-ttu-id="babc2-246">**图 10**：已将各种表、视图和存储过程添加到数据库中（[单击以查看完全大小的图像](creating-the-membership-schema-in-sql-server-cs/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-246">**Figure 10**: A Variety of Tables, Views, and Stored Procedures Have Been Added to the Database ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image30.png))</span></span>

> [!NOTE]
> <span data-ttu-id="babc2-247">`aspnet_regsql.exe` 工具的图形用户界面将安装整个应用程序服务架构。</span><span class="sxs-lookup"><span data-stu-id="babc2-247">The `aspnet_regsql.exe` tool's graphical user interface installs the entire application services schema.</span></span> <span data-ttu-id="babc2-248">但从命令行执行 `aspnet_regsql.exe` 时，可以指定要安装的特定应用程序服务组件（或删除）。</span><span class="sxs-lookup"><span data-stu-id="babc2-248">But when executing `aspnet_regsql.exe` from the command-line you can specify what particular application services components to install (or remove).</span></span> <span data-ttu-id="babc2-249">因此，如果只想要添加 `SqlMembershipProvider` 和 `SqlRoleProvider` 提供程序所需的表、视图和存储过程，请从命令行运行 `aspnet_regsql.exe`。</span><span class="sxs-lookup"><span data-stu-id="babc2-249">Therefore, if you want to add just the tables, views, and stored procedures necessary for the `SqlMembershipProvider` and `SqlRoleProvider` providers, run `aspnet_regsql.exe` from the command-line.</span></span> <span data-ttu-id="babc2-250">或者，你可以手动运行 `aspnet_regsql.exe`使用的 T-sql create 脚本的适当子集。</span><span class="sxs-lookup"><span data-stu-id="babc2-250">Alternatively, you can manually run the appropriate subset of T-SQL create scripts used by `aspnet_regsql.exe`.</span></span> <span data-ttu-id="babc2-251">这些脚本位于 `WINDIR%\Microsoft.Net\Framework\v2.0.50727\` 文件夹中，名称如 `InstallCommon.sql`、`InstallMembership.sql`、`InstallRoles.sql`、`InstallProfile.sql`、`InstallSqlState.sql`等。</span><span class="sxs-lookup"><span data-stu-id="babc2-251">These scripts are located in the `WINDIR%\Microsoft.Net\Framework\v2.0.50727\` folder with names like `InstallCommon.sql`,`InstallMembership.sql`,`InstallRoles.sql`, `InstallProfile.sql`,`InstallSqlState.sql`, and so on.</span></span>

<span data-ttu-id="babc2-252">此时，我们已创建 `SqlMembershipProvider`所需的数据库对象。</span><span class="sxs-lookup"><span data-stu-id="babc2-252">At this point we have created the database objects needed by the `SqlMembershipProvider`.</span></span> <span data-ttu-id="babc2-253">但是，我们仍需要指示成员身份框架应使用 `SqlMembershipProvider` （与 `ActiveDirectoryMembershipProvider`），并且 `SqlMembershipProvider` 应使用 `SecurityTutorials` 数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-253">However, we still need to instruct the Membership framework that it should use the `SqlMembershipProvider` (versus, say, the `ActiveDirectoryMembershipProvider`) and that the `SqlMembershipProvider` should use the `SecurityTutorials` database.</span></span> <span data-ttu-id="babc2-254">我们将介绍如何指定要使用的提供程序，以及如何在步骤4中自定义所选提供程序的设置。</span><span class="sxs-lookup"><span data-stu-id="babc2-254">We'll look at how to specify what provider to use and how to customize the selected provider's settings in Step 4.</span></span> <span data-ttu-id="babc2-255">但首先，让我们深入了解刚创建的数据库对象。</span><span class="sxs-lookup"><span data-stu-id="babc2-255">But first, let's take a deeper look at the database objects that were just created.</span></span>

## <a name="step-3-a-look-at-the-schemas-core-tables"></a><span data-ttu-id="babc2-256">步骤3：查看架构的核心表</span><span class="sxs-lookup"><span data-stu-id="babc2-256">Step 3: A Look at the Schema's Core Tables</span></span>

<span data-ttu-id="babc2-257">在 ASP.NET 应用程序中使用成员身份和角色框架时，提供程序会封装实现细节。</span><span class="sxs-lookup"><span data-stu-id="babc2-257">When working with the Membership and Roles frameworks in an ASP.NET application, the implementation details are encapsulated by the provider.</span></span> <span data-ttu-id="babc2-258">在将来的教程中，我们将通过 .NET Framework 的 `Membership` 和 `Roles` 类与这些框架进行交互。</span><span class="sxs-lookup"><span data-stu-id="babc2-258">In future tutorials we will interface with these frameworks via the .NET Framework's `Membership` and `Roles` classes.</span></span> <span data-ttu-id="babc2-259">使用这些高级 Api 时，我们不需要为自己提供低级别的详细信息，例如执行的查询或 `SqlMembershipProvider` 和 `SqlRoleProvider`修改的表。</span><span class="sxs-lookup"><span data-stu-id="babc2-259">When using these high-level APIs we do not need to concern ourselves with the low-level details, like what queries are executed or what tables are modified by the `SqlMembershipProvider` and `SqlRoleProvider`.</span></span>

<span data-ttu-id="babc2-260">为此，我们可以放心地使用成员身份和角色框架，而无需探索在步骤2中创建的数据库架构。</span><span class="sxs-lookup"><span data-stu-id="babc2-260">Given this, we could confidently use the Membership and Roles frameworks without having explored the database schema created in Step 2.</span></span> <span data-ttu-id="babc2-261">但是，在创建用于存储应用程序数据的表时，可能需要创建与用户或角色相关的实体。</span><span class="sxs-lookup"><span data-stu-id="babc2-261">However, when creating the tables to store application data we may need to create entities that relate to users or roles.</span></span> <span data-ttu-id="babc2-262">在应用程序数据表和步骤2中创建的表之间建立外键约束时，它有助于熟悉 `SqlMembershipProvider` 和 `SqlRoleProvider` 架构。</span><span class="sxs-lookup"><span data-stu-id="babc2-262">It helps to have a familiarity with the `SqlMembershipProvider` and `SqlRoleProvider` schemas when establishing foreign key constraints between the application data tables and those tables created in Step 2.</span></span> <span data-ttu-id="babc2-263">此外，在某些极少数情况下，我们可能需要直接在数据库级别（而不是通过 `Membership` 或 `Roles` 类）与用户和角色存储区交互。</span><span class="sxs-lookup"><span data-stu-id="babc2-263">Moreover, in certain rare circumstances we may need to interface with the user and role stores directly at the database level (instead of through the `Membership` or `Roles` classes).</span></span>

### <a name="partitioning-the-user-store-into-applications"></a><span data-ttu-id="babc2-264">将用户存储分区到应用程序中</span><span class="sxs-lookup"><span data-stu-id="babc2-264">Partitioning the User Store Into Applications</span></span>

<span data-ttu-id="babc2-265">成员资格和角色框架的设计使单个用户和角色存储可以在许多不同的应用程序之间共享。</span><span class="sxs-lookup"><span data-stu-id="babc2-265">The Membership and Roles frameworks are designed such that a single user and role store can be shared among many different applications.</span></span> <span data-ttu-id="babc2-266">使用成员身份或角色框架的 ASP.NET 应用程序必须指定要使用的应用程序分区。</span><span class="sxs-lookup"><span data-stu-id="babc2-266">An ASP.NET application that uses the Membership or Roles frameworks must specify what application partition to use.</span></span> <span data-ttu-id="babc2-267">简而言之，多个 web 应用程序可以使用相同的用户和角色存储。</span><span class="sxs-lookup"><span data-stu-id="babc2-267">In short, multiple web applications can use the same user and role stores.</span></span> <span data-ttu-id="babc2-268">图11描述了分区为三个应用程序的用户和角色存储： HRSite、CustomerSite 和 SalesSite。</span><span class="sxs-lookup"><span data-stu-id="babc2-268">Figure 11 depicts user and role stores that are partitioned into three applications: HRSite, CustomerSite, and SalesSite.</span></span> <span data-ttu-id="babc2-269">这三个 web 应用程序都有自己唯一的用户和角色，但它们在物理上将其用户帐户和角色信息存储在相同的数据库表中。</span><span class="sxs-lookup"><span data-stu-id="babc2-269">These three web applications each have their own unique users and roles, yet they all physically store their user account and role information in the same database tables.</span></span>

<span data-ttu-id="babc2-270">[![用户帐户可以跨多个应用程序进行分区](creating-the-membership-schema-in-sql-server-cs/_static/image32.png)](creating-the-membership-schema-in-sql-server-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="babc2-270">[![User Accounts May Be Partitioned Across Multiple Applications](creating-the-membership-schema-in-sql-server-cs/_static/image32.png)](creating-the-membership-schema-in-sql-server-cs/_static/image31.png)</span></span>

<span data-ttu-id="babc2-271">**图 11**：可以跨多个应用程序对用户帐户进行分区（[单击查看完全大小的映像](creating-the-membership-schema-in-sql-server-cs/_static/image33.png)）</span><span class="sxs-lookup"><span data-stu-id="babc2-271">**Figure 11**: User Accounts May Be Partitioned Across Multiple Applications ([Click to view full-size image](creating-the-membership-schema-in-sql-server-cs/_static/image33.png))</span></span>

<span data-ttu-id="babc2-272">`aspnet_Applications` 表定义了这些分区。</span><span class="sxs-lookup"><span data-stu-id="babc2-272">The `aspnet_Applications` table is what defines these partitions.</span></span> <span data-ttu-id="babc2-273">使用数据库存储用户帐户信息的每个应用程序都用此表中的一行表示。</span><span class="sxs-lookup"><span data-stu-id="babc2-273">Each application that uses the database to store user account information is represented by a row in this table.</span></span> <span data-ttu-id="babc2-274">`aspnet_Applications` 表具有四列： `ApplicationId`、`ApplicationName`、`LoweredApplicationName`和 `Description`。</span><span class="sxs-lookup"><span data-stu-id="babc2-274">The `aspnet_Applications` table has four columns: `ApplicationId`, `ApplicationName`, `LoweredApplicationName`, and `Description`.</span></span> <span data-ttu-id="babc2-275">`ApplicationId` 的类型为[`uniqueidentifier`](https://msdn.microsoft.com/library/ms187942.aspx) ，是表的主键;`ApplicationName` 为每个应用程序提供唯一的友好名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-275">`ApplicationId` is of type [`uniqueidentifier`](https://msdn.microsoft.com/library/ms187942.aspx) and is the table's primary key; `ApplicationName` provides a unique human-friendly name for each application.</span></span>

<span data-ttu-id="babc2-276">其他成员身份和角色相关表将链接回 `aspnet_Applications`中的 "`ApplicationId`" 字段。</span><span class="sxs-lookup"><span data-stu-id="babc2-276">The other Membership- and Role-related tables link back to the `ApplicationId` field in `aspnet_Applications`.</span></span> <span data-ttu-id="babc2-277">例如，`aspnet_Users` 表中包含每个用户帐户的记录，都有一个 `ApplicationId` 外键字段;`aspnet_Roles` 表的 ditto。</span><span class="sxs-lookup"><span data-stu-id="babc2-277">For example, the `aspnet_Users` table, which contains a record for each user account, has an `ApplicationId` foreign key field; ditto for the `aspnet_Roles` table.</span></span> <span data-ttu-id="babc2-278">这些表中的 "`ApplicationId`" 字段指定用户帐户或角色所属的应用程序分区。</span><span class="sxs-lookup"><span data-stu-id="babc2-278">The `ApplicationId` field in these tables specifies the application partition the user account or role belongs to.</span></span>

### <a name="storing-user-account-information"></a><span data-ttu-id="babc2-279">存储用户帐户信息</span><span class="sxs-lookup"><span data-stu-id="babc2-279">Storing User Account Information</span></span>

<span data-ttu-id="babc2-280">用户帐户信息保存在两个表中： `aspnet_Users` 和 `aspnet_Membership`。</span><span class="sxs-lookup"><span data-stu-id="babc2-280">User account information is housed in two tables: `aspnet_Users` and `aspnet_Membership`.</span></span> <span data-ttu-id="babc2-281">`aspnet_Users` 表包含保存重要用户帐户信息的字段。</span><span class="sxs-lookup"><span data-stu-id="babc2-281">The `aspnet_Users` table contains fields that hold the essential user account information.</span></span> <span data-ttu-id="babc2-282">最相关的三个列是：</span><span class="sxs-lookup"><span data-stu-id="babc2-282">The three most pertinent columns are:</span></span>

- `UserId`
- `UserName`
- `ApplicationId`

<span data-ttu-id="babc2-283">`UserId` 是主键（类型 `uniqueidentifier`）。</span><span class="sxs-lookup"><span data-stu-id="babc2-283">`UserId` is the primary key (and of type `uniqueidentifier`).</span></span> <span data-ttu-id="babc2-284">`UserName` 的类型 `nvarchar(256)`，以及密码构成用户的凭据。</span><span class="sxs-lookup"><span data-stu-id="babc2-284">`UserName` is of type `nvarchar(256)` and, along with the password, makes up the user's credentials.</span></span> <span data-ttu-id="babc2-285">（用户的密码存储在 `aspnet_Membership` 表中。）`ApplicationId` 将用户帐户链接到 `aspnet_Applications`中的特定应用程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-285">(A user's password is stored in the `aspnet_Membership` table.) `ApplicationId` links the user account to a particular application in `aspnet_Applications`.</span></span> <span data-ttu-id="babc2-286">`UserName` 和 `ApplicationId` 列上存在复合[`UNIQUE` 约束](https://msdn.microsoft.com/library/ms191166.aspx)。</span><span class="sxs-lookup"><span data-stu-id="babc2-286">There is a composite [`UNIQUE` constraint](https://msdn.microsoft.com/library/ms191166.aspx) on the `UserName` and `ApplicationId` columns.</span></span> <span data-ttu-id="babc2-287">这可确保在给定的应用程序中，每个用户名都是唯一的，但它允许在不同的应用程序中使用相同的 `UserName`。</span><span class="sxs-lookup"><span data-stu-id="babc2-287">This ensures that in a given application each UserName is unique, yet it allows for the same `UserName` to be used in different applications.</span></span>

<span data-ttu-id="babc2-288">`aspnet_Membership` 表包含附加的用户帐户信息，如用户的密码、电子邮件地址、上次登录日期和时间等。</span><span class="sxs-lookup"><span data-stu-id="babc2-288">The `aspnet_Membership` table includes additional user account information, like the user's password, email address, the last login date and time, and so forth.</span></span> <span data-ttu-id="babc2-289">`aspnet_Users` 和 `aspnet_Membership` 表中的记录之间存在一对一的对应关系。</span><span class="sxs-lookup"><span data-stu-id="babc2-289">There is a one-to-one correspondence between records in the `aspnet_Users` and `aspnet_Membership` tables.</span></span> <span data-ttu-id="babc2-290">此关系由 `aspnet_Membership`中的 `UserId` 字段确保，该字段用作表的主键。</span><span class="sxs-lookup"><span data-stu-id="babc2-290">This relationship is ensured by the `UserId` field in `aspnet_Membership`, which serves as the table's primary key.</span></span> <span data-ttu-id="babc2-291">与 `aspnet_Users` 表一样，`aspnet_Membership` 包含将此信息与特定应用程序分区联系的 `ApplicationId` 字段。</span><span class="sxs-lookup"><span data-stu-id="babc2-291">Like the `aspnet_Users` table, `aspnet_Membership` includes an `ApplicationId` field that ties this information to a particular application partition.</span></span>

### <a name="securing-passwords"></a><span data-ttu-id="babc2-292">保护密码</span><span class="sxs-lookup"><span data-stu-id="babc2-292">Securing Passwords</span></span>

<span data-ttu-id="babc2-293">密码信息存储在 `aspnet_Membership` 表中。</span><span class="sxs-lookup"><span data-stu-id="babc2-293">Password information is stored in the `aspnet_Membership` table.</span></span> <span data-ttu-id="babc2-294">`SqlMembershipProvider` 允许使用以下三种方法之一在数据库中存储密码：</span><span class="sxs-lookup"><span data-stu-id="babc2-294">The `SqlMembershipProvider` allows for passwords to be stored in the database using one of the following three techniques:</span></span>

- <span data-ttu-id="babc2-295">**清除**-密码以纯文本形式存储在数据库中。</span><span class="sxs-lookup"><span data-stu-id="babc2-295">**Clear** - the password is stored in the database as plain-text.</span></span> <span data-ttu-id="babc2-296">我强烈反对使用此选项。</span><span class="sxs-lookup"><span data-stu-id="babc2-296">I strongly discourage using this option.</span></span> <span data-ttu-id="babc2-297">如果数据库遭到入侵，黑客会发现后门或有不满的雇员拥有数据库访问权限，这是每个用户的凭据，</span><span class="sxs-lookup"><span data-stu-id="babc2-297">If the database is compromised - be it by a hacker who finds a back door or a disgruntled employee who has database access - every single user's credentials are there for the taking.</span></span>
- <span data-ttu-id="babc2-298">**哈**希-使用单向哈希算法和随机生成的 salt 值对密码进行哈希处理。</span><span class="sxs-lookup"><span data-stu-id="babc2-298">**Hashed** - passwords are hashed using a one-way hash algorithm and a randomly generated salt value.</span></span> <span data-ttu-id="babc2-299">此哈希值（连同 salt）存储在数据库中。</span><span class="sxs-lookup"><span data-stu-id="babc2-299">This hashed value (along with the salt) is stored in the database.</span></span>
- <span data-ttu-id="babc2-300">已**加密**-密码的加密版本存储在数据库中。</span><span class="sxs-lookup"><span data-stu-id="babc2-300">**Encrypted** - an encrypted version of the password is stored in the database.</span></span>

<span data-ttu-id="babc2-301">使用的密码存储方法取决于 `Web.config`中指定的 `SqlMembershipProvider` 设置。</span><span class="sxs-lookup"><span data-stu-id="babc2-301">The password storage technique used depends on the `SqlMembershipProvider` settings specified in `Web.config`.</span></span> <span data-ttu-id="babc2-302">我们将在步骤4中查看自定义 `SqlMembershipProvider` 设置。</span><span class="sxs-lookup"><span data-stu-id="babc2-302">We will look at customizing the `SqlMembershipProvider` settings in Step 4.</span></span> <span data-ttu-id="babc2-303">默认行为是存储密码的哈希。</span><span class="sxs-lookup"><span data-stu-id="babc2-303">The default behavior is to store the hash of the password.</span></span>

<span data-ttu-id="babc2-304">负责存储密码的列 `Password`、`PasswordFormat`和 `PasswordSalt`。</span><span class="sxs-lookup"><span data-stu-id="babc2-304">The columns responsible for storing the password are `Password`, `PasswordFormat`, and `PasswordSalt`.</span></span> <span data-ttu-id="babc2-305">`PasswordFormat` 是类型 `int` 的字段，其值指示用于存储密码的方法：0表示明文;1表示哈希;2表示已加密。</span><span class="sxs-lookup"><span data-stu-id="babc2-305">`PasswordFormat` is a field of type `int` whose value indicates the technique used for storing the password: 0 for Clear; 1 for Hashed; 2 for Encrypted.</span></span> <span data-ttu-id="babc2-306">无论使用何种密码存储技术，都将为 `PasswordSalt` 分配一个随机生成的字符串。仅在计算密码的哈希值时才使用 `PasswordSalt` 的值。</span><span class="sxs-lookup"><span data-stu-id="babc2-306">`PasswordSalt` is assigned a randomly generated string regardless of the password storage technique used; the value of `PasswordSalt` is only used when computing the hash of the password.</span></span> <span data-ttu-id="babc2-307">最后，`Password` 列包含实际的密码数据，即纯文本密码、密码哈希或加密密码。</span><span class="sxs-lookup"><span data-stu-id="babc2-307">Finally, the `Password` column contains the actual password data, be it the plain-text password, the hash of the password, or the encrypted password.</span></span>

<span data-ttu-id="babc2-308">表1说明了在存储密码 MySecret 时，这三列可能会显示在各种存储技术中的情况！</span><span class="sxs-lookup"><span data-stu-id="babc2-308">Table 1 illustrates what these three columns might look like for the various storage techniques when storing the password MySecret!</span></span> <span data-ttu-id="babc2-309">.</span><span class="sxs-lookup"><span data-stu-id="babc2-309">.</span></span>

| <span data-ttu-id="babc2-310">**存储技术&lt;\_o3a\_p/&gt;**</span><span class="sxs-lookup"><span data-stu-id="babc2-310">**Storage Technique&lt;\_o3a\_p /&gt;**</span></span> | <span data-ttu-id="babc2-311">**密码&lt;\_o3a\_p/&gt;**</span><span class="sxs-lookup"><span data-stu-id="babc2-311">**Password&lt;\_o3a\_p /&gt;**</span></span> | <span data-ttu-id="babc2-312">**PasswordFormat&lt;\_o3a\_p/&gt;**</span><span class="sxs-lookup"><span data-stu-id="babc2-312">**PasswordFormat&lt;\_o3a\_p /&gt;**</span></span> | <span data-ttu-id="babc2-313">**PasswordSalt&lt;\_o3a\_p/&gt;**</span><span class="sxs-lookup"><span data-stu-id="babc2-313">**PasswordSalt&lt;\_o3a\_p /&gt;**</span></span> |
| --- | --- | --- | --- |
| <span data-ttu-id="babc2-314">清除</span><span class="sxs-lookup"><span data-stu-id="babc2-314">Clear</span></span> | <span data-ttu-id="babc2-315">MySecret!</span><span class="sxs-lookup"><span data-stu-id="babc2-315">MySecret!</span></span> | <span data-ttu-id="babc2-316">0</span><span class="sxs-lookup"><span data-stu-id="babc2-316">0</span></span> | <span data-ttu-id="babc2-317">tTnkPlesqissc2y2SMEygA==</span><span class="sxs-lookup"><span data-stu-id="babc2-317">tTnkPlesqissc2y2SMEygA==</span></span> |
| <span data-ttu-id="babc2-318">计算</span><span class="sxs-lookup"><span data-stu-id="babc2-318">Hashed</span></span> | <span data-ttu-id="babc2-319">2oXm6sZHWbTHFgjgkGQsc2Ec9ZM=</span><span class="sxs-lookup"><span data-stu-id="babc2-319">2oXm6sZHWbTHFgjgkGQsc2Ec9ZM=</span></span> | <span data-ttu-id="babc2-320">1</span><span class="sxs-lookup"><span data-stu-id="babc2-320">1</span></span> | <span data-ttu-id="babc2-321">wFgjUfhdUFOCKQiI61vtiQ==</span><span class="sxs-lookup"><span data-stu-id="babc2-321">wFgjUfhdUFOCKQiI61vtiQ==</span></span> |
| <span data-ttu-id="babc2-322">加密</span><span class="sxs-lookup"><span data-stu-id="babc2-322">Encrypted</span></span> | <span data-ttu-id="babc2-323">62RZgDvhxykkqsMchZ0Yly7HS6onhpaoCYaRxV8g0F4CW56OXUU3e7Inza9j9BKp</span><span class="sxs-lookup"><span data-stu-id="babc2-323">62RZgDvhxykkqsMchZ0Yly7HS6onhpaoCYaRxV8g0F4CW56OXUU3e7Inza9j9BKp</span></span> | <span data-ttu-id="babc2-324">2</span><span class="sxs-lookup"><span data-stu-id="babc2-324">2</span></span> | <span data-ttu-id="babc2-325">LSRzhGS/aa/oqAXGLHJNBw==</span><span class="sxs-lookup"><span data-stu-id="babc2-325">LSRzhGS/aa/oqAXGLHJNBw==</span></span> |

<span data-ttu-id="babc2-326">**表 1**：存储密码 MySecret 时与密码相关的字段的示例值！</span><span class="sxs-lookup"><span data-stu-id="babc2-326">**Table 1**: Example Values for the Password-Related Fields When Storing the Password MySecret!</span></span>

> [!NOTE]
> <span data-ttu-id="babc2-327">`SqlMembershipProvider` 所使用的特定加密或哈希算法由 `<machineKey>` 元素中的设置确定。</span><span class="sxs-lookup"><span data-stu-id="babc2-327">The particular encryption or hashing algorithm used by the `SqlMembershipProvider` is determined by the settings in the `<machineKey>` element.</span></span> <span data-ttu-id="babc2-328">我们在<a id="Tutorial3"> </a> [*Forms 身份验证配置和高级主题*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md)教程的步骤3中讨论了此配置元素。</span><span class="sxs-lookup"><span data-stu-id="babc2-328">We discussed this configuration element in Step 3 of the <a id="Tutorial3"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) tutorial.</span></span>

### <a name="storing-roles-and-role-associations"></a><span data-ttu-id="babc2-329">存储角色和角色关联</span><span class="sxs-lookup"><span data-stu-id="babc2-329">Storing Roles and Role Associations</span></span>

<span data-ttu-id="babc2-330">角色框架允许开发人员定义一组角色并指定哪些用户属于哪些角色。</span><span class="sxs-lookup"><span data-stu-id="babc2-330">The Roles framework allows developers to define a set of roles and specify what users belong to what roles.</span></span> <span data-ttu-id="babc2-331">此信息通过两个表在数据库中捕获： `aspnet_Roles` 和 `aspnet_UsersInRoles`。</span><span class="sxs-lookup"><span data-stu-id="babc2-331">This information is captured in the database through two tables: `aspnet_Roles` and `aspnet_UsersInRoles`.</span></span> <span data-ttu-id="babc2-332">`aspnet_Roles` 表中的每条记录都表示特定应用程序的角色。</span><span class="sxs-lookup"><span data-stu-id="babc2-332">Each record in the `aspnet_Roles` table represents a role for a particular application.</span></span> <span data-ttu-id="babc2-333">与 `aspnet_Users` 表非常类似，`aspnet_Roles` 表有三列与我们的讨论相关：</span><span class="sxs-lookup"><span data-stu-id="babc2-333">Much like the `aspnet_Users` table, the `aspnet_Roles` table has three columns pertinent to our discussion:</span></span>

- `RoleId`
- `RoleName`
- `ApplicationId`

<span data-ttu-id="babc2-334">`RoleId` 是主键（类型 `uniqueidentifier`）。</span><span class="sxs-lookup"><span data-stu-id="babc2-334">`RoleId` is the primary key (and of type `uniqueidentifier`).</span></span> <span data-ttu-id="babc2-335">`RoleName` 的类型为 `nvarchar(256)`。</span><span class="sxs-lookup"><span data-stu-id="babc2-335">`RoleName` is of type `nvarchar(256)`.</span></span> <span data-ttu-id="babc2-336">和 `ApplicationId` 将用户帐户链接到 `aspnet_Applications`中的特定应用程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-336">And `ApplicationId` links the user account to a particular application in `aspnet_Applications`.</span></span> <span data-ttu-id="babc2-337">`RoleName` 和 `ApplicationId` 列有一个组合的 `UNIQUE` 约束，这确保了在给定的应用程序中，每个角色名称都是唯一的。</span><span class="sxs-lookup"><span data-stu-id="babc2-337">There is a composite `UNIQUE` constraint on the `RoleName` and `ApplicationId` columns, ensuring that in a given application each role name is unique.</span></span>

<span data-ttu-id="babc2-338">`aspnet_UsersInRoles` 表用作用户和角色之间的映射。</span><span class="sxs-lookup"><span data-stu-id="babc2-338">The `aspnet_UsersInRoles` table serves as a mapping between users and roles.</span></span> <span data-ttu-id="babc2-339">只有两列 `UserId` 和 `RoleId` 两者共同构成了一个组合主键。</span><span class="sxs-lookup"><span data-stu-id="babc2-339">There are only two columns - `UserId` and `RoleId` - and together they make up a composite primary key.</span></span>

## <a name="step-4-specifying-the-provider-and-customizing-its-settings"></a><span data-ttu-id="babc2-340">步骤4：指定提供程序并自定义其设置</span><span class="sxs-lookup"><span data-stu-id="babc2-340">Step 4: Specifying the Provider and Customizing Its Settings</span></span>

<span data-ttu-id="babc2-341">支持该提供程序模型的所有框架（例如成员身份和角色框架）本身缺乏实现细节，而是将该责任委托给提供程序类。</span><span class="sxs-lookup"><span data-stu-id="babc2-341">All of the frameworks that support the provider model - such as the Membership and Roles frameworks - lack implementation details themselves and instead delegate that responsibility to a provider class.</span></span> <span data-ttu-id="babc2-342">对于成员身份框架，`Membership` 类定义用于管理用户帐户的 API，但它不与任何用户存储直接交互。</span><span class="sxs-lookup"><span data-stu-id="babc2-342">In the case of the Membership framework, the `Membership` class defines the API for managing user accounts, but it does not interact directly with any user store.</span></span> <span data-ttu-id="babc2-343">相反，`Membership` 类的方法将请求移交给配置的提供程序-我们将使用 `SqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="babc2-343">Rather, the `Membership` class's methods hand off the request to the configured provider - we will be using the `SqlMembershipProvider`.</span></span> <span data-ttu-id="babc2-344">当我们调用 `Membership` 类中的方法之一时，成员身份框架如何知道如何委托对 `SqlMembershipProvider`的调用？</span><span class="sxs-lookup"><span data-stu-id="babc2-344">When we invoke one of the methods in the `Membership` class, how does the Membership framework know to delegate the call to the `SqlMembershipProvider`?</span></span>

<span data-ttu-id="babc2-345">`Membership` 类具有一个[`Providers` 属性](https://msdn.microsoft.com/library/system.web.security.membership.providers.aspx)，该属性包含对成员身份框架可使用的所有已注册提供程序类的引用。</span><span class="sxs-lookup"><span data-stu-id="babc2-345">The `Membership` class has a [`Providers` property](https://msdn.microsoft.com/library/system.web.security.membership.providers.aspx) that contains a reference to all of the registered provider classes available for use by the Membership framework.</span></span> <span data-ttu-id="babc2-346">每个注册的提供程序都有关联的名称和类型。</span><span class="sxs-lookup"><span data-stu-id="babc2-346">Each registered provider has an associated name and type.</span></span> <span data-ttu-id="babc2-347">该名称提供了一种友好的方法来引用 `Providers` 集合中的特定提供程序，而类型则标识提供程序类。</span><span class="sxs-lookup"><span data-stu-id="babc2-347">The name offers a human-friendly way to reference a particular provider in the `Providers` collection, while the type identifies the provider class.</span></span> <span data-ttu-id="babc2-348">而且，每个注册的提供程序都可以包括配置设置。</span><span class="sxs-lookup"><span data-stu-id="babc2-348">Moreover, each registered provider may include configuration settings.</span></span> <span data-ttu-id="babc2-349">成员身份框架的配置设置包括 `passwordFormat` 和 `requiresUniqueEmail`以及许多其他设置。</span><span class="sxs-lookup"><span data-stu-id="babc2-349">Configuration settings for the Membership framework include `passwordFormat` and `requiresUniqueEmail`, among many others.</span></span> <span data-ttu-id="babc2-350">有关 `SqlMembershipProvider`使用的配置设置的完整列表，请参阅表2。</span><span class="sxs-lookup"><span data-stu-id="babc2-350">See Table 2 for a complete list of configuration settings used by the `SqlMembershipProvider`.</span></span>

<span data-ttu-id="babc2-351">通过 web 应用程序的配置设置来指定 `Providers` 属性的内容。</span><span class="sxs-lookup"><span data-stu-id="babc2-351">The `Providers` property's contents are specified through the web application's configuration settings.</span></span> <span data-ttu-id="babc2-352">默认情况下，所有 web 应用程序都有一个名为 `AspNetSqlMembershipProvider` 类型 `SqlMembershipProvider`的提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-352">By default, all web applications have a provider named `AspNetSqlMembershipProvider` of type `SqlMembershipProvider`.</span></span> <span data-ttu-id="babc2-353">此默认成员资格提供程序在 `machine.config` 中注册（位于 `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG)`：</span><span class="sxs-lookup"><span data-stu-id="babc2-353">This default Membership provider is registered in `machine.config` (located at `%WINDIR%\Microsoft.Net\Framework\v2.0.50727\CONFIG)`:</span></span>

[!code-xml[Main](creating-the-membership-schema-in-sql-server-cs/samples/sample1.xml)]

<span data-ttu-id="babc2-354">正如上面的标记所示， [`<membership>` 元素](https://msdn.microsoft.com/library/1b9hw62f.aspx)定义成员身份框架的配置设置，而[`<providers>` 子元素](https://msdn.microsoft.com/library/6d4936ht.aspx)指定已注册的提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-354">As the markup above shows, the [`<membership>` element](https://msdn.microsoft.com/library/1b9hw62f.aspx) defines the configuration settings for the Membership framework while the [`<providers>` child element](https://msdn.microsoft.com/library/6d4936ht.aspx) specifies the registered providers.</span></span> <span data-ttu-id="babc2-355">可以使用[`<add>`](https://msdn.microsoft.com/library/whae3t94.aspx)或[`<remove>`](https://msdn.microsoft.com/library/aykw9a6d.aspx)元素添加或删除提供程序;使用[`<clear>`](https://msdn.microsoft.com/library/t062y6yc.aspx)元素删除所有当前已注册的提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-355">Providers may be added or removed using the [`<add>`](https://msdn.microsoft.com/library/whae3t94.aspx) or [`<remove>`](https://msdn.microsoft.com/library/aykw9a6d.aspx) elements; use the [`<clear>`](https://msdn.microsoft.com/library/t062y6yc.aspx) element to remove all currently registered providers.</span></span> <span data-ttu-id="babc2-356">如以上标记所示，`machine.config` 会添加一个名为 `AspNetSqlMembershipProvider` 类型 `SqlMembershipProvider`的提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-356">As the markup above shows, `machine.config` adds a provider named `AspNetSqlMembershipProvider` of type `SqlMembershipProvider`.</span></span>

<span data-ttu-id="babc2-357">除 `name` 和 `type` 属性外，`<add>` 元素还包含一些属性，这些属性定义了不同配置设置的值。</span><span class="sxs-lookup"><span data-stu-id="babc2-357">In addition to the `name` and `type` attributes, the `<add>` element contains attributes that define the values for various configuring settings.</span></span> <span data-ttu-id="babc2-358">表2列出了可用 `SqlMembershipProvider`特定的配置设置，以及每个设置的说明。</span><span class="sxs-lookup"><span data-stu-id="babc2-358">Table 2 lists the available `SqlMembershipProvider`-specific configuration settings, along with a description of each.</span></span>

> [!NOTE]
> <span data-ttu-id="babc2-359">表2中记下的任何默认值都是指在 `SqlMembershipProvider` 类中定义的默认值。</span><span class="sxs-lookup"><span data-stu-id="babc2-359">Any default values noted in Table 2 refer to the default values defined in the `SqlMembershipProvider` class.</span></span> <span data-ttu-id="babc2-360">请注意，`AspNetSqlMembershipProvider` 中的所有配置设置都不对应于 `SqlMembershipProvider` 类的默认值。</span><span class="sxs-lookup"><span data-stu-id="babc2-360">Note that not all of the configuration settings in `AspNetSqlMembershipProvider` correspond to the default values of the `SqlMembershipProvider` class.</span></span> <span data-ttu-id="babc2-361">例如，如果未在成员资格提供程序中指定，则 `requiresUniqueEmail` 设置默认为 true。</span><span class="sxs-lookup"><span data-stu-id="babc2-361">For example, if not specified in a Membership provider, the `requiresUniqueEmail` setting defaults to true.</span></span> <span data-ttu-id="babc2-362">但是，`AspNetSqlMembershipProvider` 通过显式指定 `false`值来覆盖此默认值。</span><span class="sxs-lookup"><span data-stu-id="babc2-362">However, the `AspNetSqlMembershipProvider` overrides this default value by explicitly specifying a value of `false`.</span></span>

| <span data-ttu-id="babc2-363">**设置&lt;\_o3a\_p/&gt;**</span><span class="sxs-lookup"><span data-stu-id="babc2-363">**Setting&lt;\_o3a\_p /&gt;**</span></span> | <span data-ttu-id="babc2-364">**说明&lt;\_o3a\_p/&gt;**</span><span class="sxs-lookup"><span data-stu-id="babc2-364">**Description&lt;\_o3a\_p /&gt;**</span></span> |
| --- | --- |
| `ApplicationName` | <span data-ttu-id="babc2-365">请记住，成员身份框架允许跨多个应用程序对单个用户存储进行分区。</span><span class="sxs-lookup"><span data-stu-id="babc2-365">Recall that the Membership framework allows for a single user store to be partitioned across multiple applications.</span></span> <span data-ttu-id="babc2-366">此设置指示成员资格提供程序所使用的应用程序分区的名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-366">This setting indicates the name of the application partition used by the Membership provider.</span></span> <span data-ttu-id="babc2-367">如果未显式指定此值，则在运行时将其设置为应用程序的虚拟根路径的值。</span><span class="sxs-lookup"><span data-stu-id="babc2-367">If this value is not explicitly specified, it is set, at runtime, to the value of the application's virtual root path.</span></span> |
| `commandTimeout` | <span data-ttu-id="babc2-368">指定 SQL 命令超时值（以秒为单位）。</span><span class="sxs-lookup"><span data-stu-id="babc2-368">Specifies the SQL command timeout value (in seconds).</span></span> <span data-ttu-id="babc2-369">默认值为 30。</span><span class="sxs-lookup"><span data-stu-id="babc2-369">The default value is 30.</span></span> |
| `connectionStringName` | <span data-ttu-id="babc2-370">`<connectionStrings>` 元素中用于连接到用户存储数据库的连接字符串的名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-370">The name of the connection string in the `<connectionStrings>` element to use to connect to the user store database.</span></span> <span data-ttu-id="babc2-371">此值是必需的。</span><span class="sxs-lookup"><span data-stu-id="babc2-371">This value is required.</span></span> |
| `description` | <span data-ttu-id="babc2-372">提供已注册提供程序的友好说明。</span><span class="sxs-lookup"><span data-stu-id="babc2-372">Provides a human-friendly description of the registered provider.</span></span> |
| `enablePasswordRetrieval` | <span data-ttu-id="babc2-373">指定用户是否可以检索其忘记的密码。</span><span class="sxs-lookup"><span data-stu-id="babc2-373">Specifies whether users may retrieve their forgotten password.</span></span> <span data-ttu-id="babc2-374">默认值为 `false`。</span><span class="sxs-lookup"><span data-stu-id="babc2-374">The default value is `false`.</span></span> |
| `enablePasswordReset` | <span data-ttu-id="babc2-375">指示是否允许用户重置其密码。</span><span class="sxs-lookup"><span data-stu-id="babc2-375">Indicates whether users are allowed to reset their password.</span></span> <span data-ttu-id="babc2-376">默认为 `true`。</span><span class="sxs-lookup"><span data-stu-id="babc2-376">Defaults to `true`.</span></span> |
| `maxInvalidPasswordAttempts` | <span data-ttu-id="babc2-377">用户被锁定之前，指定的 `passwordAttemptWindow` 期间，给定用户可能出现的最大失败登录尝试次数。默认值为5。</span><span class="sxs-lookup"><span data-stu-id="babc2-377">The maximum number of unsuccessful login attempts that may occur for a given user during the specified `passwordAttemptWindow` before the user is locked out. The default value is 5.</span></span> |
| `minRequiredNonalphanumericCharacters` | <span data-ttu-id="babc2-378">必须出现在用户密码中的非字母数字字符的最小数目。</span><span class="sxs-lookup"><span data-stu-id="babc2-378">The minimum number of non-alphanumeric characters that must appear in a user's password.</span></span> <span data-ttu-id="babc2-379">此值必须介于0到128之间;默认值为1。</span><span class="sxs-lookup"><span data-stu-id="babc2-379">This value must be between 0 and 128; the default is 1.</span></span> |
| `minRequiredPasswordLength` | <span data-ttu-id="babc2-380">密码中所需的最小字符数。</span><span class="sxs-lookup"><span data-stu-id="babc2-380">The minimum number of characters required in a password.</span></span> <span data-ttu-id="babc2-381">此值必须介于0到128之间;默认值为7。</span><span class="sxs-lookup"><span data-stu-id="babc2-381">This value must be between 0 and 128; the default is 7.</span></span> |
| `name` | <span data-ttu-id="babc2-382">已注册的提供程序的名称。</span><span class="sxs-lookup"><span data-stu-id="babc2-382">The name of the registered provider.</span></span> <span data-ttu-id="babc2-383">此值是必需的。</span><span class="sxs-lookup"><span data-stu-id="babc2-383">This value is required.</span></span> |
| `passwordAttemptWindow` | <span data-ttu-id="babc2-384">跟踪失败的登录尝试的分钟数。</span><span class="sxs-lookup"><span data-stu-id="babc2-384">The number of minutes during which failed login attempts are tracked.</span></span> <span data-ttu-id="babc2-385">如果用户在此指定窗口中 `maxInvalidPasswordAttempts` 次提供了无效的登录凭据，则会被锁定。默认值为10。</span><span class="sxs-lookup"><span data-stu-id="babc2-385">If a user supplies invalid login credentials `maxInvalidPasswordAttempts` times within this specified window, they are locked out. The default value is 10.</span></span> |
| `PasswordFormat` | <span data-ttu-id="babc2-386">密码存储格式： `Clear`、`Hashed`或 `Encrypted`。</span><span class="sxs-lookup"><span data-stu-id="babc2-386">The password storage format: `Clear`, `Hashed`, or `Encrypted`.</span></span> <span data-ttu-id="babc2-387">默认值为 `Hashed`。</span><span class="sxs-lookup"><span data-stu-id="babc2-387">The default is `Hashed`.</span></span> |
| `passwordStrengthRegularExpression` | <span data-ttu-id="babc2-388">如果提供了此正则表达式，则在创建新帐户或更改其密码时，将使用此正则表达式来评估用户所选密码的强度。</span><span class="sxs-lookup"><span data-stu-id="babc2-388">If provided, this regular expression is used to evaluate the strength of the user's selected password when creating a new account or when changing their password.</span></span> <span data-ttu-id="babc2-389">默认值为一个空字符串。</span><span class="sxs-lookup"><span data-stu-id="babc2-389">The default value is an empty string.</span></span> |
| `requiresQuestionAndAnswer` | <span data-ttu-id="babc2-390">指定在检索或重置其密码时，用户是否必须回答其安全问题。</span><span class="sxs-lookup"><span data-stu-id="babc2-390">Specifies whether a user must answer his security question when retrieving or resetting his password.</span></span> <span data-ttu-id="babc2-391">默认值为 `true`。</span><span class="sxs-lookup"><span data-stu-id="babc2-391">The default value is `true`.</span></span> |
| `requiresUniqueEmail` | <span data-ttu-id="babc2-392">指示给定应用程序分区中的所有用户帐户是否都必须具有唯一的电子邮件地址。</span><span class="sxs-lookup"><span data-stu-id="babc2-392">Indicates whether all user accounts in a given application partition must have a unique email address.</span></span> <span data-ttu-id="babc2-393">默认值为 `true`。</span><span class="sxs-lookup"><span data-stu-id="babc2-393">The default value is `true`.</span></span> |
| `type` | <span data-ttu-id="babc2-394">指定提供程序的类型。</span><span class="sxs-lookup"><span data-stu-id="babc2-394">Specifies the type of the provider.</span></span> <span data-ttu-id="babc2-395">此值是必需的。</span><span class="sxs-lookup"><span data-stu-id="babc2-395">This value is required.</span></span> |

<span data-ttu-id="babc2-396">**表 2**：成员身份和 `SqlMembershipProvider` 配置设置</span><span class="sxs-lookup"><span data-stu-id="babc2-396">**Table 2**: Membership and `SqlMembershipProvider` Configuration Settings</span></span>

<span data-ttu-id="babc2-397">除了 `AspNetSqlMembershipProvider`之外，还可以通过将类似标记添加到 `Web.config` 文件，逐个应用程序向应用程序注册其他成员资格提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-397">In addition to `AspNetSqlMembershipProvider`, other Membership providers may be registered on an application-by-application basis by adding similar markup to the `Web.config` file.</span></span>

> [!NOTE]
> <span data-ttu-id="babc2-398">角色框架的工作方式大致相同： `machine.config` 中有一个默认的注册角色提供程序，并且可以在 `Web.config`中按应用程序自定义已注册的提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-398">The Roles framework works in much the same way: there is a default registered role provider in `machine.config` and the registered providers may be customized on an application-by-application basis in `Web.config`.</span></span> <span data-ttu-id="babc2-399">在将来的教程中，我们将详细介绍角色框架及其配置标记。</span><span class="sxs-lookup"><span data-stu-id="babc2-399">We will examine the Roles framework and its configuration markup in detail in a future tutorial.</span></span>

### <a name="customizing-thesqlmembershipprovidersettings"></a><span data-ttu-id="babc2-400">自定义`SqlMembershipProvider`设置</span><span class="sxs-lookup"><span data-stu-id="babc2-400">Customizing the`SqlMembershipProvider`Settings</span></span>

<span data-ttu-id="babc2-401">默认 `SqlMembershipProvider` （`AspNetSqlMembershipProvider`）将其 `connectionStringName` 特性设置为 "`LocalSqlServer`"。</span><span class="sxs-lookup"><span data-stu-id="babc2-401">The default `SqlMembershipProvider` (`AspNetSqlMembershipProvider`) has its `connectionStringName` attribute set to `LocalSqlServer`.</span></span> <span data-ttu-id="babc2-402">与 `AspNetSqlMembershipProvider` 提供程序一样，`machine.config`中定义了连接字符串名称 `LocalSqlServer`。</span><span class="sxs-lookup"><span data-stu-id="babc2-402">Like the `AspNetSqlMembershipProvider` provider, the connection string name `LocalSqlServer` is defined in `machine.config`.</span></span>

[!code-xml[Main](creating-the-membership-schema-in-sql-server-cs/samples/sample2.xml)]

<span data-ttu-id="babc2-403">如您所见，此连接字符串定义2005了位于 |DataDirectory | aspnetdb.mdf。</span><span class="sxs-lookup"><span data-stu-id="babc2-403">As you can see, this connection string defines a SQL 2005 Express Edition database located at |DataDirectory|aspnetdb.mdf�.</span></span> <span data-ttu-id="babc2-404">字符串 |DataDirectory | 在运行时转换为指向 `~/App_Data/` 目录，因此，数据库路径 |DataDirectory | aspnetdb.mdf 转换为 `~/App_Data`/`aspnet.mdf`。</span><span class="sxs-lookup"><span data-stu-id="babc2-404">The string |DataDirectory|� is translated at runtime to point to the `~/App_Data/` directory, so the database path |DataDirectory|aspnetdb.mdf" translates to `~/App_Data`/`aspnet.mdf`.</span></span>

<span data-ttu-id="babc2-405">如果未在应用程序的 `Web.config` 文件中指定任何成员身份提供程序信息，则应用程序将使用默认注册的成员资格提供程序，`AspNetSqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="babc2-405">If we did not specify any Membership provider information in our application's `Web.config` file, the application uses the default registered Membership provider, `AspNetSqlMembershipProvider`.</span></span> <span data-ttu-id="babc2-406">如果 `~/App_Data/aspnet.mdf` 数据库不存在，ASP.NET 运行时将自动创建它并添加应用程序服务架构。</span><span class="sxs-lookup"><span data-stu-id="babc2-406">If the `~/App_Data/aspnet.mdf` database does not exist, the ASP.NET runtime will automatically create it and add the application services schema.</span></span> <span data-ttu-id="babc2-407">但是，我们不想使用 `aspnet.mdf` 数据库;相反，我们想要使用我们在步骤2中创建的 `SecurityTutorials.mdf` 数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-407">However, we don't want to use the `aspnet.mdf` database; rather, we want to use the `SecurityTutorials.mdf` database we created in Step 2.</span></span> <span data-ttu-id="babc2-408">可以通过以下两种方式之一完成此修改：</span><span class="sxs-lookup"><span data-stu-id="babc2-408">This modification can be accomplished in one of two ways:</span></span>

- <span data-ttu-id="babc2-409">为<strong>`Web.config`</strong>中<strong>`LocalSqlServer`</strong><strong>连接字符串名称</strong><strong>指定值</strong> <strong>。</strong></span><span class="sxs-lookup"><span data-stu-id="babc2-409"><strong>Specify a value for the</strong><strong>`LocalSqlServer`</strong><strong>connection string name in</strong><strong>`Web.config`</strong><strong>.</strong></span></span> <span data-ttu-id="babc2-410">通过在 `Web.config`中覆盖 `LocalSqlServer` 连接字符串名称值，我们可以使用默认注册的成员资格提供程序（`AspNetSqlMembershipProvider`）并使其与 `SecurityTutorials.mdf` 数据库一起正确使用。</span><span class="sxs-lookup"><span data-stu-id="babc2-410">By overwriting the `LocalSqlServer` connection string name value in `Web.config`, we can use the default registered Membership provider (`AspNetSqlMembershipProvider`) and have it correctly work with the `SecurityTutorials.mdf` database.</span></span> <span data-ttu-id="babc2-411">如果你是具有 `AspNetSqlMembershipProvider`指定的配置设置的内容，则此方法很合适。</span><span class="sxs-lookup"><span data-stu-id="babc2-411">This approach is fine if you are content with the configuration settings specified by `AspNetSqlMembershipProvider`.</span></span> <span data-ttu-id="babc2-412">有关此技术的详细信息，请参阅[Scott Guthrie](https://weblogs.asp.net/scottgu/)的博客文章将[ASP.NET 2.0 应用程序服务配置为使用 SQL Server 2000 或 SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx)。</span><span class="sxs-lookup"><span data-stu-id="babc2-412">For more information on this technique, see [Scott Guthrie](https://weblogs.asp.net/scottgu/)'s blog post, [Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx).</span></span>
- <span data-ttu-id="babc2-413"><strong>添加`SqlMembershipProvider`类型的新注册的提供程序</strong> <strong>，并将其</strong><strong>`connectionStringName`</strong><strong>设置配置为指向</strong><strong>`SecurityTutorials.mdf`</strong><strong>数据库。</strong></span><span class="sxs-lookup"><span data-stu-id="babc2-413"><strong>Add a new registered provider of type</strong><strong>`SqlMembershipProvider`</strong><strong>and configure its</strong><strong>`connectionStringName`</strong><strong>setting to point to the</strong><strong>`SecurityTutorials.mdf`</strong><strong>database.</strong></span></span> <span data-ttu-id="babc2-414">如果要自定义数据库连接字符串以外的其他配置属性，则此方法非常有用。</span><span class="sxs-lookup"><span data-stu-id="babc2-414">This approach is useful in scenarios where you want to customize other configuration properties in addition to the database connection string.</span></span> <span data-ttu-id="babc2-415">在我自己的项目中，我始终使用这种方法，因为它具有灵活性和可读性。</span><span class="sxs-lookup"><span data-stu-id="babc2-415">In my own projects I always use this approach because of its flexibility and readability.</span></span>

<span data-ttu-id="babc2-416">在我们可以添加引用 `SecurityTutorials.mdf` 数据库的新注册的提供程序之前，首先需要在 `Web.config`的 `<connectionStrings>` 部分中添加适当的连接字符串值。</span><span class="sxs-lookup"><span data-stu-id="babc2-416">Before we can add a new registered provider that references the `SecurityTutorials.mdf` database, we first need to add an appropriate connection string value in the `<connectionStrings>` section in `Web.config`.</span></span> <span data-ttu-id="babc2-417">以下标记添加了一个名为 `SecurityTutorialsConnectionString` 的新连接字符串，该字符串引用 `App_Data` 文件夹中的 SQL Server 2005 Express Edition `SecurityTutorials.mdf` 数据库。</span><span class="sxs-lookup"><span data-stu-id="babc2-417">The following markup adds a new connection string named `SecurityTutorialsConnectionString` that references the SQL Server 2005 Express Edition `SecurityTutorials.mdf` database in the `App_Data` folder.</span></span>

[!code-xml[Main](creating-the-membership-schema-in-sql-server-cs/samples/sample3.xml)]

> [!NOTE]
> <span data-ttu-id="babc2-418">如果使用的是备用数据库文件，请根据需要更新连接字符串。</span><span class="sxs-lookup"><span data-stu-id="babc2-418">If you are using an alternate database file, update the connection string as needed.</span></span> <span data-ttu-id="babc2-419">有关形成正确连接字符串的详细信息，请参阅[ConnectionStrings.com](http://www.connectionstrings.com/)。</span><span class="sxs-lookup"><span data-stu-id="babc2-419">For more information on forming the correct connection string, refer to [ConnectionStrings.com](http://www.connectionstrings.com/).</span></span>

<span data-ttu-id="babc2-420">接下来，将以下成员身份配置标记添加到 `Web.config` 文件中。</span><span class="sxs-lookup"><span data-stu-id="babc2-420">Next, add the following Membership configuration markup to the `Web.config` file.</span></span> <span data-ttu-id="babc2-421">此标记将注册一个名为 `SecurityTutorialsSqlMembershipProvider`的新提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-421">This markup registers a new provider named `SecurityTutorialsSqlMembershipProvider`.</span></span>

[!code-xml[Main](creating-the-membership-schema-in-sql-server-cs/samples/sample4.xml)]

<span data-ttu-id="babc2-422">除了注册 `SecurityTutorialsSqlMembershipProvider` 提供程序外，上述标记还将 `SecurityTutorialsSqlMembershipProvider` 定义为默认提供程序（通过 `<membership>` 元素中的 `defaultProvider` 特性）。</span><span class="sxs-lookup"><span data-stu-id="babc2-422">In addition to registering the `SecurityTutorialsSqlMembershipProvider` provider, the above markup defines the `SecurityTutorialsSqlMembershipProvider` as the default provider (via the `defaultProvider` attribute in the `<membership>` element).</span></span> <span data-ttu-id="babc2-423">请记住，成员身份框架可以有多个已注册的提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-423">Recall that the Membership framework can have multiple registered providers.</span></span> <span data-ttu-id="babc2-424">由于 `AspNetSqlMembershipProvider` 注册为 `machine.config`中的第一个提供程序，因此它将作为默认提供程序，除非我们指出。</span><span class="sxs-lookup"><span data-stu-id="babc2-424">Since `AspNetSqlMembershipProvider` is registered as the first provider in `machine.config`, it serves as the default provider unless we indicate otherwise.</span></span>

<span data-ttu-id="babc2-425">目前，我们的应用程序有两个注册的提供程序： `AspNetSqlMembershipProvider` 和 `SecurityTutorialsSqlMembershipProvider`。</span><span class="sxs-lookup"><span data-stu-id="babc2-425">Currently, our application has two registered providers: `AspNetSqlMembershipProvider` and `SecurityTutorialsSqlMembershipProvider`.</span></span> <span data-ttu-id="babc2-426">但是，在注册 `SecurityTutorialsSqlMembershipProvider` 提供程序之前，我们可以通过在 `<add>` 元素前面添加[`<clear />` 元素](https://msdn.microsoft.com/library/t062y6yc.aspx)，清除所有以前注册的提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-426">However, before registering the `SecurityTutorialsSqlMembershipProvider` provider we could have cleared out all previously registered providers by adding a [`<clear />` element](https://msdn.microsoft.com/library/t062y6yc.aspx) immediately before our `<add>` element.</span></span> <span data-ttu-id="babc2-427">这将从已注册的提供程序列表中清除 `AspNetSqlMembershipProvider`，这意味着 `SecurityTutorialsSqlMembershipProvider` 只是注册的成员资格提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-427">This would clear out the `AspNetSqlMembershipProvider` from the list of registered providers, meaning that the `SecurityTutorialsSqlMembershipProvider` would be the only registered Membership provider.</span></span> <span data-ttu-id="babc2-428">如果使用此方法，则不需要将 `SecurityTutorialsSqlMembershipProvider` 标记为默认提供程序，因为它是唯一注册的成员资格提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-428">If we used this approach, then we would not need to mark the `SecurityTutorialsSqlMembershipProvider` as the default provider, since it would be the only registered Membership provider.</span></span> <span data-ttu-id="babc2-429">有关使用 `<clear />`的详细信息，请参阅[添加提供程序时使用 `<clear />`](https://weblogs.asp.net/scottgu/archive/2006/11/20/common-gotcha-don-t-forget-to-clear-when-adding-providers.aspx)。</span><span class="sxs-lookup"><span data-stu-id="babc2-429">For more information on using `<clear />`, see [Using `<clear />` When Adding Providers](https://weblogs.asp.net/scottgu/archive/2006/11/20/common-gotcha-don-t-forget-to-clear-when-adding-providers.aspx).</span></span>

<span data-ttu-id="babc2-430">请注意，`SecurityTutorialsSqlMembershipProvider`的 `connectionStringName` 设置引用刚刚添加的 `SecurityTutorialsConnectionString` 连接字符串名称，并且其 `applicationName` 设置已设置为 SecurityTutorials 值。</span><span class="sxs-lookup"><span data-stu-id="babc2-430">Note that the `SecurityTutorialsSqlMembershipProvider`'s `connectionStringName` setting references the just-added `SecurityTutorialsConnectionString` connection string name, and that its `applicationName` setting has been set to a value of SecurityTutorials.</span></span> <span data-ttu-id="babc2-431">此外，`requiresUniqueEmail` 设置已设置为 `true`。</span><span class="sxs-lookup"><span data-stu-id="babc2-431">Additionally, the `requiresUniqueEmail` setting has been set to `true`.</span></span> <span data-ttu-id="babc2-432">所有其他配置选项都与 `AspNetSqlMembershipProvider`中的值相同。</span><span class="sxs-lookup"><span data-stu-id="babc2-432">All other configuration options are identical to the values in `AspNetSqlMembershipProvider`.</span></span> <span data-ttu-id="babc2-433">如果需要，可以在此处随意进行任何配置修改。</span><span class="sxs-lookup"><span data-stu-id="babc2-433">Feel free to make any configuration modifications here, if you wish.</span></span> <span data-ttu-id="babc2-434">例如，你可以通过要求使用两个非字母数字的字符而不是一个，或者将密码长度增加到八个字符而不是七个字符来提高密码强度。</span><span class="sxs-lookup"><span data-stu-id="babc2-434">For example, you could tighten the password strength by requiring two non-alphanumeric characters instead of one, or by increasing the password length to eight characters instead of seven.</span></span>

> [!NOTE]
> <span data-ttu-id="babc2-435">请记住，成员身份框架允许跨多个应用程序对单个用户存储进行分区。</span><span class="sxs-lookup"><span data-stu-id="babc2-435">Recall that the Membership framework allows for a single user store to be partitioned across multiple applications.</span></span> <span data-ttu-id="babc2-436">成员资格提供程序的 `applicationName` 设置指示当使用用户存储区时提供程序所使用的应用程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-436">The Membership provider's `applicationName` setting indicates what application the provider uses when working with the user store.</span></span> <span data-ttu-id="babc2-437">为 `applicationName` 配置设置显式设置值非常重要，因为如果未显式设置 `applicationName`，则在运行时将其分配给 web 应用程序的虚拟根路径。</span><span class="sxs-lookup"><span data-stu-id="babc2-437">It is important that you explicitly set a value for the `applicationName` configuration setting because if the `applicationName` is not explicitly set, it is assigned to the web application's virtual root path at runtime.</span></span> <span data-ttu-id="babc2-438">只要应用程序的虚拟根路径不改变，此操作就会正常运行，但如果将应用程序移到不同的路径，则 `applicationName` 设置也会更改。</span><span class="sxs-lookup"><span data-stu-id="babc2-438">This works fine as long as the application's virtual root path doesn't change, but if you move the application to a different path, the `applicationName` setting will change too.</span></span> <span data-ttu-id="babc2-439">发生这种情况时，成员资格提供程序将开始处理与以前使用的应用程序分区不同的应用程序分区。</span><span class="sxs-lookup"><span data-stu-id="babc2-439">When this happens, the Membership provider will start working with a different application partition than was previously used.</span></span> <span data-ttu-id="babc2-440">在移动之前创建的用户帐户将驻留在不同的应用程序分区中，这些用户将无法再登录到该站点。</span><span class="sxs-lookup"><span data-stu-id="babc2-440">User accounts created prior to the move will reside in a different application partition and those users will no longer be able to log into the site.</span></span> <span data-ttu-id="babc2-441">有关此问题的更深入讨论，请参阅[配置 ASP.NET 2.0 成员身份和其他提供程序时，始终设置 `applicationName` 属性](https://weblogs.asp.net/scottgu/443634)。</span><span class="sxs-lookup"><span data-stu-id="babc2-441">For a more in-depth discussion on this matter, see [Always Set the `applicationName` Property When Configuring ASP.NET 2.0 Membership and Other Providers](https://weblogs.asp.net/scottgu/443634).</span></span>

## <a name="summary"></a><span data-ttu-id="babc2-442">摘要</span><span class="sxs-lookup"><span data-stu-id="babc2-442">Summary</span></span>

<span data-ttu-id="babc2-443">此时，我们有了一个具有配置的应用程序服务（`SecurityTutorials.mdf`）的数据库，并配置了 web 应用程序，以便成员身份框架使用刚才注册的 `SecurityTutorialsSqlMembershipProvider` 提供程序。</span><span class="sxs-lookup"><span data-stu-id="babc2-443">At this point we have a database with the configured application services (`SecurityTutorials.mdf`) and have configured our web application so that the Membership framework uses the `SecurityTutorialsSqlMembershipProvider` provider we just registered.</span></span> <span data-ttu-id="babc2-444">此注册的提供程序的类型为 `SqlMembershipProvider`，其 `connectionStringName` 设置为适当的连接字符串（`SecurityTutorialsConnectionString`）并显式设置其 `applicationName` 值。</span><span class="sxs-lookup"><span data-stu-id="babc2-444">This registered provider is of type `SqlMembershipProvider` and has its `connectionStringName` set to the appropriate connection string (`SecurityTutorialsConnectionString`) and its `applicationName` value explicitly set.</span></span>

<span data-ttu-id="babc2-445">现在，我们已准备好从应用程序使用成员身份框架。</span><span class="sxs-lookup"><span data-stu-id="babc2-445">We are now ready to use the Membership framework from our application.</span></span> <span data-ttu-id="babc2-446">在下一教程中，我们将介绍如何创建新的用户帐户。</span><span class="sxs-lookup"><span data-stu-id="babc2-446">In the next tutorial we will examine how to create new user accounts.</span></span> <span data-ttu-id="babc2-447">接下来，我们将探索对用户进行身份验证，执行基于用户的授权，并在数据库中存储其他用户相关信息。</span><span class="sxs-lookup"><span data-stu-id="babc2-447">Following that we will explore authenticating users, performing user-based authorization, and storing additional user-related information in the database.</span></span>

<span data-ttu-id="babc2-448">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="babc2-448">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="babc2-449">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="babc2-449">Further Reading</span></span>

<span data-ttu-id="babc2-450">有关本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="babc2-450">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="babc2-451">配置 ASP.NET 2.0 成员身份和其他提供程序时，始终设置 `applicationName` 属性</span><span class="sxs-lookup"><span data-stu-id="babc2-451">Always Set the `applicationName` Property When Configuring ASP.NET 2.0 Membership and Other Providers</span></span>](https://weblogs.asp.net/scottgu/443634)
- [<span data-ttu-id="babc2-452">配置 ASP.NET 2.0 应用程序服务以使用 SQL Server 2000 或 SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="babc2-452">Configuring ASP.NET 2.0 Application Services to Use SQL Server 2000 or SQL Server 2005</span></span>](https://weblogs.asp.net/scottgu/archive/2005/08/25/423703.aspx)
- [<span data-ttu-id="babc2-453">下载 SQL Server Management Studio Express Edition</span><span class="sxs-lookup"><span data-stu-id="babc2-453">Download SQL Server Management Studio Express Edition</span></span>](https://www.microsoft.com/downloads/details.aspx?FamilyId=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796&amp;displaylang=en)
- [<span data-ttu-id="babc2-454">检查 ASP.NET 2.0 s 成员资格、角色和配置文件</span><span class="sxs-lookup"><span data-stu-id="babc2-454">Examining ASP.NET 2.0�s Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="babc2-455">成员资格提供程序的 `<add>` 元素</span><span class="sxs-lookup"><span data-stu-id="babc2-455">The `<add>` Element for Providers for Membership</span></span>](https://msdn.microsoft.com/library/whae3t94.aspx)
- [<span data-ttu-id="babc2-456">`<membership>` 元素</span><span class="sxs-lookup"><span data-stu-id="babc2-456">The `<membership>` Element</span></span>](https://msdn.microsoft.com/library/1b9hw62f.aspx)
- [<span data-ttu-id="babc2-457">成员资格的 `<providers>` 元素</span><span class="sxs-lookup"><span data-stu-id="babc2-457">The `<providers>` Element for Membership</span></span>](https://msdn.microsoft.com/library/6d4936ht.aspx)
- [<span data-ttu-id="babc2-458">添加提供程序时使用 `<clear />`</span><span class="sxs-lookup"><span data-stu-id="babc2-458">Using `<clear />` When Adding Providers</span></span>](https://weblogs.asp.net/scottgu/archive/2006/11/20/common-gotcha-don-t-forget-to-clear-when-adding-providers.aspx)
- [<span data-ttu-id="babc2-459">直接使用 `SqlMembershipProvider`</span><span class="sxs-lookup"><span data-stu-id="babc2-459">Working Directly with the `SqlMembershipProvider`</span></span>](http://aspnet.4guysfromrolla.com/articles/091207-1.aspx)

### <a name="video-training-on-topics-contained-in-this-tutorial"></a><span data-ttu-id="babc2-460">本教程中包含的主题的视频培训</span><span class="sxs-lookup"><span data-stu-id="babc2-460">Video Training on Topics Contained in this Tutorial</span></span>

- [<span data-ttu-id="babc2-461">了解 ASP.NET 成员身份</span><span class="sxs-lookup"><span data-stu-id="babc2-461">Understanding ASP.NET Memberships</span></span>](../../../videos/authentication/understanding-aspnet-memberships.md)
- [<span data-ttu-id="babc2-462">配置 SQL 以使用成员身份架构</span><span class="sxs-lookup"><span data-stu-id="babc2-462">Configuring SQL To Work with Membership Schemas</span></span>](../../../videos/authentication/configuring-sql-to-work-with-membership-schemas.md)
- [<span data-ttu-id="babc2-463">更改默认成员身份架构中的成员身份设置</span><span class="sxs-lookup"><span data-stu-id="babc2-463">Changing Membership Settings in the Default Membership Schema</span></span>](../../../videos/authentication/changing-membership-settings-in-the-default-membership-schema.md)

### <a name="about-the-author"></a><span data-ttu-id="babc2-464">关于作者</span><span class="sxs-lookup"><span data-stu-id="babc2-464">About the Author</span></span>

<span data-ttu-id="babc2-465">Scott Mitchell，创始人的多个 ASP/ASP 和4GuysFromRolla.com 的作者已使用 Microsoft Web 技术，1998。</span><span class="sxs-lookup"><span data-stu-id="babc2-465">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="babc2-466">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="babc2-466">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="babc2-467">他的最新书籍是， *[在24小时内，sam ASP.NET 2.0](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)* 。</span><span class="sxs-lookup"><span data-stu-id="babc2-467">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="babc2-468">可以通过[http://ScottOnWriting.NET](http://scottonwriting.net/) [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com)或通过他的博客访问 Scott。</span><span class="sxs-lookup"><span data-stu-id="babc2-468">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="babc2-469">特别感谢</span><span class="sxs-lookup"><span data-stu-id="babc2-469">Special Thanks To</span></span>

<span data-ttu-id="babc2-470">此教程系列由许多有用的审阅者查看。</span><span class="sxs-lookup"><span data-stu-id="babc2-470">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="babc2-471">本教程的主管审查人员是 Alicja Maziarz。</span><span class="sxs-lookup"><span data-stu-id="babc2-471">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="babc2-472">想要查看我即将发布的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="babc2-472">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="babc2-473">如果是这样，请在[mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com)放置一行。</span><span class="sxs-lookup"><span data-stu-id="babc2-473">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="babc2-474">下一部分</span><span class="sxs-lookup"><span data-stu-id="babc2-474">Next</span></span>](creating-user-accounts-cs.md)

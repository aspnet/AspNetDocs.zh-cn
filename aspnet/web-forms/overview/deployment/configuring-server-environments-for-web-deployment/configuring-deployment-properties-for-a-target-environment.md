---
uid: web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
title: 为目标环境配置部署属性 |Microsoft Docs
author: jrjlee
description: 本主题介绍如何配置特定于环境的属性，以便将示例联系人管理器解决方案部署到特定目标环境 。
ms.author: riande
ms.date: 05/04/2012
ms.assetid: b5b86e03-b8ed-46e6-90fa-e1da88ef34e9
msc.legacyurl: /web-forms/overview/deployment/configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment
msc.type: authoredcontent
ms.openlocfilehash: 9742be7d718384c1b108d5f2c0c43e8e8d4fe8a9
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2020
ms.locfileid: "78516806"
---
# <a name="configuring-deployment-properties-for-a-target-environment"></a><span data-ttu-id="d84ca-103">配置目标环境的部署属性</span><span class="sxs-lookup"><span data-stu-id="d84ca-103">Configuring Deployment Properties for a Target Environment</span></span>

<span data-ttu-id="d84ca-104">作者： [Jason](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="d84ca-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="d84ca-105">下载 PDF</span><span class="sxs-lookup"><span data-stu-id="d84ca-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="d84ca-106">本主题介绍如何配置特定于环境的属性，以便将示例联系人管理器解决方案部署到特定目标环境。</span><span class="sxs-lookup"><span data-stu-id="d84ca-106">This topic describes how to configure environment-specific properties in order to deploy the sample Contact Manager solution to a specific target environment.</span></span>

<span data-ttu-id="d84ca-107">本主题介绍一系列教程的一部分，这些教程基于名为 Fabrikam，Inc. 的虚构公司的企业部署要求。本教程系列使用一个示例解决方案&#x2014;，该解决方案使用&#x2014;[联系人管理器](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)解决方案来表示具有真实复杂性级别的 WEB 应用程序，包括 ASP.NET MVC 3 应用程序、Windows Communication Foundation （WCF）服务和数据库项目。</span><span class="sxs-lookup"><span data-stu-id="d84ca-107">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) solution&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="d84ca-108">这些教程核心的部署方法基于[理解生成过程](../web-deployment-in-the-enterprise/understanding-the-build-process.md)中所述的拆分项目文件方法，其中，生成过程由两个项目文件&#x2014;控制，其中一个包含适用于每个目标环境的生成说明，另一个包含特定于环境的生成和部署设置。</span><span class="sxs-lookup"><span data-stu-id="d84ca-108">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="d84ca-109">在生成时，特定于环境的项目文件将合并到环境无关的项目文件中，以形成一组完整的生成说明。</span><span class="sxs-lookup"><span data-stu-id="d84ca-109">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="process-overview"></a><span data-ttu-id="d84ca-110">流程概述</span><span class="sxs-lookup"><span data-stu-id="d84ca-110">Process Overview</span></span>

<span data-ttu-id="d84ca-111">用于生成和部署联系人管理器解决方案的项目文件分为两个物理文件：</span><span class="sxs-lookup"><span data-stu-id="d84ca-111">The project file that you'll use to build and deploy the Contact Manager solution is split into two physical files:</span></span>

- <span data-ttu-id="d84ca-112">一个包含通用生成设置和说明（*发布*文件文件）。</span><span class="sxs-lookup"><span data-stu-id="d84ca-112">One that contains universal build settings and instructions (the *Publish.proj* file).</span></span>
- <span data-ttu-id="d84ca-113">一个包含特定于环境的生成设置（即 *，环境、* *环境、环境*）。</span><span class="sxs-lookup"><span data-stu-id="d84ca-113">One that contains environment-specific build settings (*Env-Dev.proj*, *Env-Stage.proj*, and so on).</span></span>

<span data-ttu-id="d84ca-114">在生成时，适当的特定于环境的项目文件将合并到通用*发布*文件文件中，以形成一组完整的生成说明。</span><span class="sxs-lookup"><span data-stu-id="d84ca-114">At build time, the appropriate environment-specific project file is merged into the universal *Publish.proj* file to form a complete set of build instructions.</span></span> <span data-ttu-id="d84ca-115">你可以通过使用描述你自己的部署方案的设置创建或自定义特定于环境的项目文件来配置特定目标环境的部署。</span><span class="sxs-lookup"><span data-stu-id="d84ca-115">You can configure deployment to specific destination environments by creating or customizing environment-specific project files with settings that describe your own deployment scenario.</span></span>

<span data-ttu-id="d84ca-116">这些值中的许多取决于目标环境的配置&#x2014;方式（具体取决于目标 web 服务器是否配置为使用 Web 部署代理服务（远程代理）或 Web 部署处理程序。</span><span class="sxs-lookup"><span data-stu-id="d84ca-116">Lots of these values are determined by how your destination environment is configured&#x2014;in particular, whether your target web server is configured to use the Web Deployment Agent Service (the remote agent) or the Web Deploy Handler.</span></span> <span data-ttu-id="d84ca-117">有关这些方法的详细信息，以及有关为自己的环境选择适当方法的指导，请参阅[选择正确的 Web 部署方法](choosing-the-right-approach-to-web-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="d84ca-117">For more information on these approaches, and for guidance on choosing the right approach for your own environment, see [Choosing the Right Approach to Web Deployment](choosing-the-right-approach-to-web-deployment.md).</span></span>

<span data-ttu-id="d84ca-118">[联系人管理器方案](../deploying-web-applications-in-enterprise-scenarios/enterprise-web-deployment-scenario-overview.md)需要两个特定于环境的项目文件：</span><span class="sxs-lookup"><span data-stu-id="d84ca-118">The [Contact Manager scenario](../deploying-web-applications-in-enterprise-scenarios/enterprise-web-deployment-scenario-overview.md) requires two environment-specific project files:</span></span>

- <span data-ttu-id="d84ca-119">部署到开发人员测试环境（环境*开发*人员）。</span><span class="sxs-lookup"><span data-stu-id="d84ca-119">Deployment to a developer test environment (*Env-Dev.proj*).</span></span> <span data-ttu-id="d84ca-120">开发人员测试环境配置为接受使用远程代理的远程部署，如[方案：配置用于 Web 部署的测试环境](scenario-configuring-a-test-environment-for-web-deployment.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="d84ca-120">The developer test environment is configured to accept remote deployments using the remote agent, as described in [Scenario: Configuring a Test Environment for Web Deployment](scenario-configuring-a-test-environment-for-web-deployment.md).</span></span> <span data-ttu-id="d84ca-121">此文件需要提供远程代理终结点地址以及特定于位置的设置（如连接字符串和服务终结点）。</span><span class="sxs-lookup"><span data-stu-id="d84ca-121">This file needs to provide the remote agent endpoint address as well as location-specific settings like connection strings and service endpoints.</span></span>
- <span data-ttu-id="d84ca-122">部署到过渡环境（*环境*中）。</span><span class="sxs-lookup"><span data-stu-id="d84ca-122">Deployment to a staging environment (*Env-Stage.proj*).</span></span> <span data-ttu-id="d84ca-123">过渡环境配置为使用 Web 部署处理程序接受远程部署，如[方案：配置用于 Web 部署的过渡环境](scenario-configuring-a-staging-environment-for-web-deployment.md)中所述。</span><span class="sxs-lookup"><span data-stu-id="d84ca-123">The staging environment is configured to accept remote deployments using the Web Deploy Handler, as described in [Scenario: Configuring a Staging Environment for Web Deployment](scenario-configuring-a-staging-environment-for-web-deployment.md).</span></span> <span data-ttu-id="d84ca-124">此文件需要提供 Web 部署处理程序终结点地址以及特定于位置的设置，例如连接字符串和服务终结点。</span><span class="sxs-lookup"><span data-stu-id="d84ca-124">This file needs to provide the Web Deploy Handler endpoint address as well as location-specific settings like connection strings and service endpoints.</span></span>

<span data-ttu-id="d84ca-125">请务必注意，在环境特定的项目文件中配置的设置不会影响 web 包本身&#x2014;的内容，而是控制包的部署方式以及提取包时提供的参数值。</span><span class="sxs-lookup"><span data-stu-id="d84ca-125">It's important to note that the settings you configure in the environment-specific project file don't affect the contents of the web package itself&#x2014;instead, they control how the package is deployed and what parameter values are provided when the package is extracted.</span></span> <span data-ttu-id="d84ca-126">你要按照[方案：配置用于 Web 部署的生产环境](scenario-configuring-a-production-environment-for-web-deployment.md)和[手动安装 web 包](../web-deployment-in-the-enterprise/manually-installing-web-packages.md)中所述，手动将 web 包导入到生产环境中，因此在生成包时，与环境特定的项目文件中使用的设置无关。</span><span class="sxs-lookup"><span data-stu-id="d84ca-126">You're importing the web package into the production environment manually, as described in [Scenario: Configuring a Production Environment for Web Deployment](scenario-configuring-a-production-environment-for-web-deployment.md) and [Manually Installing Web Packages](../web-deployment-in-the-enterprise/manually-installing-web-packages.md), so it doesn't matter what settings you used in the environment-specific project file when you generated the package.</span></span> <span data-ttu-id="d84ca-127">导入包时，Internet Information Services （IIS）管理器将提示你输入任何参数化值（如连接字符串和服务终结点）。</span><span class="sxs-lookup"><span data-stu-id="d84ca-127">Internet Information Services (IIS) Manager will prompt you for any parameterized values, like connection strings and service endpoints, when you import the package.</span></span>

<span data-ttu-id="d84ca-128">若要将 Contact Manager 解决方案部署到你自己的目标环境，你可以自定义此文件或将其用作模板并创建你自己的文件。</span><span class="sxs-lookup"><span data-stu-id="d84ca-128">To deploy the Contact Manager solution to your own target environment, you can either customize this file or use it as a template and create your own file.</span></span>

<span data-ttu-id="d84ca-129">**为 "联系人管理器" 解决方案配置特定于环境的部署设置**</span><span class="sxs-lookup"><span data-stu-id="d84ca-129">**To configure environment-specific deployment settings for the Contact Manager solution**</span></span>

1. <span data-ttu-id="d84ca-130">在 Visual Studio 2010 中打开 ContactManager-WCF 解决方案。</span><span class="sxs-lookup"><span data-stu-id="d84ca-130">Open the ContactManager-WCF solution in Visual Studio 2010.</span></span>
2. <span data-ttu-id="d84ca-131">在 "**解决方案资源管理器**" 窗口中，展开 "**发布**" 文件夹，展开 " **EnvConfig** " 文件夹，然后双击 " **Env-Dev**"。</span><span class="sxs-lookup"><span data-stu-id="d84ca-131">In the **Solution Explorer** window, expand the **Publish** folder, expand the **EnvConfig** folder, and then double-click **Env-Dev.proj**.</span></span>

    ![](configuring-deployment-properties-for-a-target-environment/_static/image1.png)
3. <span data-ttu-id="d84ca-132">将*Env-Dev*文件中的属性值替换为你自己的测试环境的正确值。</span><span class="sxs-lookup"><span data-stu-id="d84ca-132">Replace the property values in the *Env-Dev.proj* file with the correct values for your own test environment.</span></span>

    > [!NOTE]
    > <span data-ttu-id="d84ca-133">此过程后面的表提供了有关这些属性中每个属性的详细信息。</span><span class="sxs-lookup"><span data-stu-id="d84ca-133">The table that follows this procedure provides more information on each of these properties.</span></span>
4. <span data-ttu-id="d84ca-134">保存您的工作，然后关闭*Env 开发*文件。</span><span class="sxs-lookup"><span data-stu-id="d84ca-134">Save your work, and then close the *Env-Dev.proj* file.</span></span>

## <a name="choosing-the-right-deployment-properties"></a><span data-ttu-id="d84ca-135">选择正确的部署属性</span><span class="sxs-lookup"><span data-stu-id="d84ca-135">Choosing the Right Deployment Properties</span></span>

<span data-ttu-id="d84ca-136">下表描述了特定于示例环境的项目文件中的每个属性的*用途，并*对应该提供的值提供了一些指导。</span><span class="sxs-lookup"><span data-stu-id="d84ca-136">This table describes the purpose of each property in the sample environment-specific project file, *Env-Dev.proj*, and provides some guidance on the values you should provide.</span></span>

|                                                        <span data-ttu-id="d84ca-137">属性名</span><span class="sxs-lookup"><span data-stu-id="d84ca-137">Property Name</span></span>                                                         |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <span data-ttu-id="d84ca-138">详细信息</span><span class="sxs-lookup"><span data-stu-id="d84ca-138">Details</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|              <span data-ttu-id="d84ca-139"><strong>MSDeployComputerName</strong>目标 web 服务器或服务终结点的名称。</span><span class="sxs-lookup"><span data-stu-id="d84ca-139"><strong>MSDeployComputerName</strong> The name of the destination web server or service endpoint.</span></span>               |                                                                                                                                                                                                                                              <span data-ttu-id="d84ca-140">如果要部署到目标 web 服务器上的远程代理服务，可以指定目标计算机的名称（例如， <strong>TESTWEB1</strong>或<strong>TESTWEB1.fabrikam.net</strong>），也可以指定远程代理终结点（例如 `http://TESTWEB1/MSDEPLOYAGENTSERVICE`）。</span><span class="sxs-lookup"><span data-stu-id="d84ca-140">If you're deploying to the remote agent service on the destination web server, you can specify the target computer name (for example, <strong>TESTWEB1</strong> or <strong>TESTWEB1.fabrikam.net</strong>), or you can specify the remote agent endpoint (for example, `http://TESTWEB1/MSDEPLOYAGENTSERVICE`).</span></span> <span data-ttu-id="d84ca-141">在每种情况下，部署的工作方式相同。</span><span class="sxs-lookup"><span data-stu-id="d84ca-141">The deployment works the same way in each case.</span></span> <span data-ttu-id="d84ca-142">如果要部署到目标 Web 服务器上的 Web 部署处理程序，则应指定服务终结点，并包括 IIS 网站的名称作为查询字符串参数（例如，`https://STAGEWEB1:8172/MSDeploy.axd?site=DemoSite`）。</span><span class="sxs-lookup"><span data-stu-id="d84ca-142">If you're deploying to the Web Deploy Handler on the destination web server, you should specify the service endpoint and include the name of the IIS website as a query string parameter (for example, `https://STAGEWEB1:8172/MSDeploy.axd?site=DemoSite`).</span></span>                                                                                                                                                                                                                                              |
|         <span data-ttu-id="d84ca-143"><strong>MSDeployAuth</strong>Web 部署应用于向远程计算机进行身份验证的方法。</span><span class="sxs-lookup"><span data-stu-id="d84ca-143"><strong>MSDeployAuth</strong> The method that Web Deploy should use to authenticate to the remote computer.</span></span>          |                                                                                                                                                                                                                          <span data-ttu-id="d84ca-144">此设置应设置为 " <strong>NTLM</strong> " 或 "<strong>基本</strong>"。</span><span class="sxs-lookup"><span data-stu-id="d84ca-144">This should be set to <strong>NTLM</strong> or <strong>Basic</strong>.</span></span> <span data-ttu-id="d84ca-145">通常，如果要部署到远程代理服务，则将使用<strong>NTLM</strong> ，如果要部署到 Web 部署处理程序，则使用<strong>Basic</strong> 。</span><span class="sxs-lookup"><span data-stu-id="d84ca-145">Typically, you'll use <strong>NTLM</strong> if you're deploying to the remote agent service and <strong>Basic</strong> if you're deploying to the Web Deploy Handler.</span></span> <span data-ttu-id="d84ca-146">如果使用基本身份验证，则还需指定 IIS Web 部署工具（Web 部署）应模拟的用户名和密码，以便执行部署。</span><span class="sxs-lookup"><span data-stu-id="d84ca-146">If you use basic authentication, you also need to specify the user name and password that the IIS Web Deployment Tool (Web Deploy) should impersonate in order to perform the deployment.</span></span> <span data-ttu-id="d84ca-147">在此示例中，这些值通过<strong>MSDeployUsername</strong>和<strong>MSDeployPassword</strong>属性提供。</span><span class="sxs-lookup"><span data-stu-id="d84ca-147">In this example, these values are provided through the <strong>MSDeployUsername</strong> and <strong>MSDeployPassword</strong> properties.</span></span> <span data-ttu-id="d84ca-148">如果你使用 NTLM 身份验证，则可以省略这些属性或将其保留为空。</span><span class="sxs-lookup"><span data-stu-id="d84ca-148">If you use NTLM authentication, you can omit these properties or leave them blank.</span></span>                                                                                                                                                                                                                          |
| <span data-ttu-id="d84ca-149"><strong>MSDeployUsername</strong>如果使用基本身份验证，Web 部署将在远程计算机上使用此帐户。</span><span class="sxs-lookup"><span data-stu-id="d84ca-149"><strong>MSDeployUsername</strong> If you use basic authentication, Web Deploy will use this account on the remote computer.</span></span>  |                                                                                                                                                                                                                                                                                                                                                                                                                       <span data-ttu-id="d84ca-150">这应采用 "<em>域</em>\*用户名" 格式（例如<strong>FABRIKAM\matt</strong>）。</span><span class="sxs-lookup"><span data-stu-id="d84ca-150">This should take the form <em>DOMAIN</em>\*username\* (for example, <strong>FABRIKAM\matt</strong>).</span></span> <span data-ttu-id="d84ca-151">仅当指定了基本身份验证时，才使用此值。</span><span class="sxs-lookup"><span data-stu-id="d84ca-151">This value is only used if you specify basic authentication.</span></span> <span data-ttu-id="d84ca-152">如果你使用 NTLM 身份验证，则可以省略此属性。</span><span class="sxs-lookup"><span data-stu-id="d84ca-152">If you use NTLM authentication, the property can be omitted.</span></span> <span data-ttu-id="d84ca-153">如果提供了值，则将忽略该值。</span><span class="sxs-lookup"><span data-stu-id="d84ca-153">If a value is supplied, it will be ignored.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                        |
| <span data-ttu-id="d84ca-154"><strong>MSDeployPassword</strong>如果使用基本身份验证，Web 部署将在远程计算机上使用此密码。</span><span class="sxs-lookup"><span data-stu-id="d84ca-154"><strong>MSDeployPassword</strong> If you use basic authentication, Web Deploy will use this password on the remote computer.</span></span> |                                                                                                                                                                                                                                                                                                                                                                                                                    <span data-ttu-id="d84ca-155">这是在<strong>MSDeployUsername</strong>属性中指定的用户帐户的密码。</span><span class="sxs-lookup"><span data-stu-id="d84ca-155">This is the password for the user account you specified in the <strong>MSDeployUsername</strong> property.</span></span> <span data-ttu-id="d84ca-156">仅当指定了基本身份验证时，才使用此值。</span><span class="sxs-lookup"><span data-stu-id="d84ca-156">This value is only used if you specify basic authentication.</span></span> <span data-ttu-id="d84ca-157">如果你使用 NTLM 身份验证，则可以省略此属性。</span><span class="sxs-lookup"><span data-stu-id="d84ca-157">If you use NTLM authentication, the property can be omitted.</span></span> <span data-ttu-id="d84ca-158">如果提供了值，则将忽略该值。</span><span class="sxs-lookup"><span data-stu-id="d84ca-158">If a value is supplied, it will be ignored.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                    |
|     <span data-ttu-id="d84ca-159"><strong>ContactManagerIisPath</strong>要在其上部署 Contact Manager MVC 应用程序的 IIS 路径。</span><span class="sxs-lookup"><span data-stu-id="d84ca-159"><strong>ContactManagerIisPath</strong> The IIS path on which you want to deploy the Contact Manager MVC application.</span></span>     |                                                                                                                                                                                                                                                                                                                                                                        <span data-ttu-id="d84ca-160">这应该是显示在 IIS 管理器中的路径，格式为 [<em>iis 网站名称</em>]/[<em>web</em><em>应用程序名称</em>]。</span><span class="sxs-lookup"><span data-stu-id="d84ca-160">This should be the path as it appears in IIS Manager, in the form [<em>IIS website name</em>]/[<em>web</em><em>application name</em>].</span></span> <span data-ttu-id="d84ca-161">请记住，在部署应用程序之前 IIS 网站需要存在。</span><span class="sxs-lookup"><span data-stu-id="d84ca-161">Remember that the IIS website needs to exist before you deploy your application.</span></span> <span data-ttu-id="d84ca-162">例如，如果你创建了一个名为 DemoSite 的 IIS 网站，则可将 MVC 应用程序的 IIS 路径指定为 DemoSite/ContactManager。</span><span class="sxs-lookup"><span data-stu-id="d84ca-162">For example, if you've created an IIS website named DemoSite, you could specify the IIS path for the MVC application as DemoSite/ContactManager.</span></span>                                                                                                                                                                                                                                                                                                                                                                        |
|   <span data-ttu-id="d84ca-163"><strong>ContactManagerServiceIisPath</strong>要在其上部署联系人管理器 WCF 服务的 IIS 路径。</span><span class="sxs-lookup"><span data-stu-id="d84ca-163"><strong>ContactManagerServiceIisPath</strong> The IIS path on which you want to deploy the Contact Manager WCF service.</span></span>    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                          <span data-ttu-id="d84ca-164">例如，如果你创建了一个名为 DemoSite 的 IIS 网站，则可以指定 WCF 服务的 IIS 路径为<strong>DemoSite/ContactManagerService</strong>。</span><span class="sxs-lookup"><span data-stu-id="d84ca-164">For example, if you've created an IIS website named DemoSite, you could specify the IIS path for the WCF service as <strong>DemoSite/ContactManagerService</strong>.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|                  <span data-ttu-id="d84ca-165"><strong>ContactManagerTargetUrl</strong>可用于访问 WCF 服务的 URL。</span><span class="sxs-lookup"><span data-stu-id="d84ca-165"><strong>ContactManagerTargetUrl</strong> The URL at which the WCF service can be reached.</span></span>                   |                                                                                                                                                     <span data-ttu-id="d84ca-166">这将采用以下格式： [<em>IIS 网站根 URL</em>]/[<em>服务应用程序名称</em>]/[<em>服务终结点</em>]。</span><span class="sxs-lookup"><span data-stu-id="d84ca-166">This will take the form [<em>IIS website root URL</em>]/[<em>service application name</em>]/[<em>service endpoint</em>].</span></span> <span data-ttu-id="d84ca-167">例如，如果已在端口85上创建了一个 IIS 网站，则该 URL 将采用 `http://localhost:85/ContactManagerService/ContactService.svc`格式。</span><span class="sxs-lookup"><span data-stu-id="d84ca-167">For example, if you've created an IIS website on port 85, the URL would take the form `http://localhost:85/ContactManagerService/ContactService.svc`.</span></span> <span data-ttu-id="d84ca-168">请记住，MVC 应用程序和 WCF 服务部署到同一服务器。</span><span class="sxs-lookup"><span data-stu-id="d84ca-168">Remember that the MVC application and the WCF service are deployed to the same server.</span></span> <span data-ttu-id="d84ca-169">因此，此 URL 只能从安装它的计算机进行访问。</span><span class="sxs-lookup"><span data-stu-id="d84ca-169">As a result, this URL is only ever accessed from the machine on which it's installed.</span></span> <span data-ttu-id="d84ca-170">因此，最好是在 URL 中使用 localhost 或 IP 地址，而不是计算机名或主机标头。</span><span class="sxs-lookup"><span data-stu-id="d84ca-170">Because of this, it's better to use localhost or the IP address, rather than the machine name or a host header, in the URL.</span></span> <span data-ttu-id="d84ca-171">如果使用计算机名或主机标头，则 IIS 中的[环回检查](https://go.microsoft.com/?linkid=9805131)安全功能可能会阻止 URL 并返回<strong>HTTP 401.1-未经授权</strong>的错误。</span><span class="sxs-lookup"><span data-stu-id="d84ca-171">If you use the machine name or a host header, the [loopback check](https://go.microsoft.com/?linkid=9805131) security feature in IIS may block the URL and return an <strong>HTTP 401.1 - Unauthorized</strong> error.</span></span>                                                                                                                                                     |
|                  <span data-ttu-id="d84ca-172"><strong>CmDatabaseConnectionString</strong>数据库服务器的连接字符串。</span><span class="sxs-lookup"><span data-stu-id="d84ca-172"><strong>CmDatabaseConnectionString</strong> The connection string for the database server.</span></span>                  | <span data-ttu-id="d84ca-173">连接字符串确定 VSDBCMD 将用于联系数据库服务器和创建数据库的凭据，以及 web 服务器应用程序池将用于联系数据库服务器并与数据库进行交互的凭据。</span><span class="sxs-lookup"><span data-stu-id="d84ca-173">The connection string determines both the credentials that VSDBCMD will use to contact the database server and create the database and the credentials that the web server application pool will use to contact the database server and interact with the database.</span></span> <span data-ttu-id="d84ca-174">实质上，你有两种选择。</span><span class="sxs-lookup"><span data-stu-id="d84ca-174">Essentially you have two choices here.</span></span> <span data-ttu-id="d84ca-175">可以指定<strong>集成安全性 = true</strong>，在这种情况下使用集成 Windows 身份验证： <strong>DATA Source = TESTDB1; 集成安全性 = true。</strong>在这种情况下，将使用运行 VSDBCMD 可执行文件的用户的凭据创建数据库，并且应用程序将使用 web 服务器计算机帐户的标识访问数据库。</span><span class="sxs-lookup"><span data-stu-id="d84ca-175">You can specify <strong>Integrated Security=true</strong>, in which case integrated Windows authentication is used: <strong>Data Source=TESTDB1;Integrated Security=true</strong> In this case, the database will be created using the credentials of the user who runs the VSDBCMD executable, and the application will access the database using the identity of the web server machine account.</span></span> <span data-ttu-id="d84ca-176">或者，您可以指定 SQL Server 帐户的用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="d84ca-176">Alternatively, you can specify the user name and password of a SQL Server account.</span></span> <span data-ttu-id="d84ca-177">在这种情况下，VSDBCMD 使用 SQL Server 凭据来创建数据库，并使用应用程序池与数据库进行交互： <strong>Data Source = TESTDB1;User Id = ASqlUser;Password = Pa $ $w 0rd</strong>本主题中的演练假定你将使用集成的 Windows 身份验证。</span><span class="sxs-lookup"><span data-stu-id="d84ca-177">In this case, the SQL Server credentials are used both by VSDBCMD to create the database and by the application pool to interact with the database: <strong>Data Source=TESTDB1;User Id=ASqlUser; Password=Pa$$w0rd</strong> The walkthroughs in this topic assume that you'll use integrated Windows authentication.</span></span> |
|        <span data-ttu-id="d84ca-178"><strong>CmTargetDatabase</strong>要在数据库服务器上创建的数据库的名称。</span><span class="sxs-lookup"><span data-stu-id="d84ca-178"><strong>CmTargetDatabase</strong> The name you want to give the database you'll create on the database server.</span></span>        |                                                                                                                                                                                                                                                                                                                                                                                                                                                     <span data-ttu-id="d84ca-179">此处提供的值将作为参数添加到 VSDBCMD 命令。</span><span class="sxs-lookup"><span data-stu-id="d84ca-179">The value you provide here is added to the VSDBCMD command as a parameter.</span></span> <span data-ttu-id="d84ca-180">它还用于生成一个完整的连接字符串，web 服务器上的应用程序池可以使用该字符串来与数据库进行交互。</span><span class="sxs-lookup"><span data-stu-id="d84ca-180">It's also used to build a full connection string that the application pool on the web server can use to interact with the database.</span></span>                                                                                                                                                                                                                                                                                                                                                                                                                                                     |

<span data-ttu-id="d84ca-181">这些示例演示了如何为特定的部署方案配置这些属性。</span><span class="sxs-lookup"><span data-stu-id="d84ca-181">These examples show how you might configure these properties for specific deployment scenarios.</span></span>

### <a name="example-1x2014deployment-to-the-remote-agent-service"></a><span data-ttu-id="d84ca-182">示例 1&#x2014;部署到远程代理服务</span><span class="sxs-lookup"><span data-stu-id="d84ca-182">Example 1&#x2014;Deployment to the Remote Agent Service</span></span>

<span data-ttu-id="d84ca-183">在此示例中：</span><span class="sxs-lookup"><span data-stu-id="d84ca-183">In this example:</span></span>

- <span data-ttu-id="d84ca-184">正在部署到 TESTWEB1 上的远程代理服务。</span><span class="sxs-lookup"><span data-stu-id="d84ca-184">You're deploying to the remote agent service on TESTWEB1.</span></span>
- <span data-ttu-id="d84ca-185">你将指示 Web 部署使用 NTLM 身份验证。</span><span class="sxs-lookup"><span data-stu-id="d84ca-185">You're instructing Web Deploy to use NTLM authentication.</span></span> <span data-ttu-id="d84ca-186">Web 部署将使用用于调用 Microsoft 生成引擎（MSBuild）的凭据运行。</span><span class="sxs-lookup"><span data-stu-id="d84ca-186">Web Deploy will run using the credentials you used to invoke the Microsoft Build Engine (MSBuild).</span></span>
- <span data-ttu-id="d84ca-187">使用集成身份验证将**ContactManager**数据库部署到 TESTDB1。</span><span class="sxs-lookup"><span data-stu-id="d84ca-187">You're using integrated authentication to deploy the **ContactManager** database to TESTDB1.</span></span> <span data-ttu-id="d84ca-188">将使用用于调用 MSBuild 的凭据来部署数据库。</span><span class="sxs-lookup"><span data-stu-id="d84ca-188">The database will be deployed using the credentials you used to invoke MSBuild.</span></span>

[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample1.xml)]

### <a name="example-2x2014deployment-to-the-web-deploy-handler-endpoint"></a><span data-ttu-id="d84ca-189">示例 2&#x2014;部署到 Web 部署处理程序终结点</span><span class="sxs-lookup"><span data-stu-id="d84ca-189">Example 2&#x2014;Deployment to the Web Deploy Handler Endpoint</span></span>

<span data-ttu-id="d84ca-190">在此示例中：</span><span class="sxs-lookup"><span data-stu-id="d84ca-190">In this example:</span></span>

- <span data-ttu-id="d84ca-191">正在部署到 STAGEWEB1 上的 Web 部署处理程序服务终结点。</span><span class="sxs-lookup"><span data-stu-id="d84ca-191">You're deploying to the Web Deploy Handler service endpoint on STAGEWEB1.</span></span>
- <span data-ttu-id="d84ca-192">你将指示 Web 部署使用基本身份验证。</span><span class="sxs-lookup"><span data-stu-id="d84ca-192">You're instructing Web Deploy to use basic authentication.</span></span>
- <span data-ttu-id="d84ca-193">你正在指定 Web 部署应模拟远程计算机上的 FABRIKAM\stagingdeployer 帐户。</span><span class="sxs-lookup"><span data-stu-id="d84ca-193">You're specifying that Web Deploy should impersonate the FABRIKAM\stagingdeployer account on the remote computer.</span></span>
- <span data-ttu-id="d84ca-194">你正在使用 SQL Server 身份验证将**ContactManager**数据库部署到 STAGEDB1。</span><span class="sxs-lookup"><span data-stu-id="d84ca-194">You're using SQL Server authentication to deploy the **ContactManager** database to STAGEDB1.</span></span>

[!code-xml[Main](configuring-deployment-properties-for-a-target-environment/samples/sample2.xml)]

## <a name="conclusion"></a><span data-ttu-id="d84ca-195">结束语</span><span class="sxs-lookup"><span data-stu-id="d84ca-195">Conclusion</span></span>

<span data-ttu-id="d84ca-196">此时，项目文件已完全配置为生成 Contact Manager 解决方案并将其部署到一个或多个目标环境。</span><span class="sxs-lookup"><span data-stu-id="d84ca-196">At this point, your project files are fully configured to build and deploy the Contact Manager solution to one or more destination environments.</span></span>

<span data-ttu-id="d84ca-197">若要使用这些项目文件作为单步、可重复的部署过程的一部分，需要使用 MSBuild 执行*Publish*文件，并传入特定于环境的项目文件的位置作为参数。</span><span class="sxs-lookup"><span data-stu-id="d84ca-197">To use these project files as part of a single-step, repeatable deployment process, you need to execute the *Publish.proj* file using MSBuild and pass in the location of the environment-specific project file as a parameter.</span></span> <span data-ttu-id="d84ca-198">可以通过多种方式实现此目的：</span><span class="sxs-lookup"><span data-stu-id="d84ca-198">You can do this in various ways:</span></span>

- <span data-ttu-id="d84ca-199">有关 MSBuild 的概述以及自定义项目文件的简介，请参阅[了解项目文件](../web-deployment-in-the-enterprise/understanding-the-project-file.md)。</span><span class="sxs-lookup"><span data-stu-id="d84ca-199">For an overview of MSBuild and an introduction to custom project files, see [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md).</span></span>
- <span data-ttu-id="d84ca-200">有关如何表述用于执行自定义项目文件的 MSBuild 命令的信息，请参阅[部署 Web 包](../web-deployment-in-the-enterprise/deploying-web-packages.md)。</span><span class="sxs-lookup"><span data-stu-id="d84ca-200">For information on how to formulate an MSBuild command that executes your custom project files, see [Deploying Web Packages](../web-deployment-in-the-enterprise/deploying-web-packages.md).</span></span>
- <span data-ttu-id="d84ca-201">若要了解如何将 MSBuild 命令合并为单步、可重复部署的命令文件，请参阅[创建和运行部署命令文件](../web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file.md)。</span><span class="sxs-lookup"><span data-stu-id="d84ca-201">For information on how to incorporate your MSBuild commands into a command file for single-step, repeatable deployments, see [Creating and Running a Deployment Command File](../web-deployment-in-the-enterprise/creating-and-running-a-deployment-command-file.md).</span></span>
- <span data-ttu-id="d84ca-202">有关如何从 Team Build 执行自定义项目文件的信息，请参阅[创建支持部署的生成定义](../configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="d84ca-202">For information on how to execute your custom project files from Team Build, see [Creating a Build Definition that Supports Deployment](../configuring-team-foundation-server-for-web-deployment/creating-a-build-definition-that-supports-deployment.md).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="d84ca-203">上一页</span><span class="sxs-lookup"><span data-stu-id="d84ca-203">Previous</span></span>](creating-a-server-farm-with-the-web-farm-framework.md)

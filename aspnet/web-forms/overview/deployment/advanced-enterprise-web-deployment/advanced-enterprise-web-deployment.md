---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/advanced-enterprise-web-deployment
title: 高级企业 Web 部署 |Microsoft Docs
author: jrjlee
description: 本教程将演示如何执行各种必需或在很多企业部署方案所需的任务。 对于意大利语 translati...
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 7dcaba80-f2ec-4db3-ad98-daadc3afdb49
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/advanced-enterprise-web-deployment
msc.type: authoredcontent
ms.openlocfilehash: 34f1bf3bc2c37afc66f458a60a29fe5ce8f6c018
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/01/2019
ms.locfileid: "57026764"
---
<a name="advanced-enterprise-web-deployment"></a><span data-ttu-id="c4bf8-104">高级企业 Web 部署</span><span class="sxs-lookup"><span data-stu-id="c4bf8-104">Advanced Enterprise Web Deployment</span></span>
====================
<span data-ttu-id="c4bf8-105">通过[Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="c4bf8-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="c4bf8-106">下载 PDF</span><span class="sxs-lookup"><span data-stu-id="c4bf8-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="c4bf8-107">本教程将演示如何执行各种必需或在很多企业部署方案所需的任务。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-107">This tutorial will show you how to perform various tasks that are required or desirable in a lot of enterprise deployment scenarios.</span></span>
> 
> <span data-ttu-id="c4bf8-108">这些教程意大利语翻译，请访问[ http://www.lucamorelli.it ](http://www.lucamorelli.it)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-108">For an Italian translation of these tutorials, visit [http://www.lucamorelli.it](http://www.lucamorelli.it).</span></span>


<span data-ttu-id="c4bf8-109">这就构成的系列教程基于虚构公司 Fabrikam，Inc.的企业部署要求本系列教程将使用的示例解决方案&#x2014;[联系人管理器](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)解决方案&#x2014;来表示真实级别的复杂性，包括 ASP.NET MVC 3 应用程序，Windows 通信的 web 应用程序Foundation (WCF) 服务和数据库项目。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-109">This forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager](../web-deployment-in-the-enterprise/the-contact-manager-solution.md) solution&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="c4bf8-110">这些教程的核心部署方法取决于拆分项目文件方法中所述[了解构建过程](../web-deployment-in-the-enterprise/understanding-the-build-process.md)，在生成过程由控制这两个项目文件&#x2014;一个包含构建适用于每个目标环境和一个包含特定于环境的生成和部署设置的说明。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-110">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Build Process](../web-deployment-in-the-enterprise/understanding-the-build-process.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="c4bf8-111">在生成时，特定于环境的项目文件合并到不限环境的项目文件，以形成一组完整的生成说明。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-111">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="scenario-overview"></a><span data-ttu-id="c4bf8-112">方案概述</span><span class="sxs-lookup"><span data-stu-id="c4bf8-112">Scenario Overview</span></span>

<span data-ttu-id="c4bf8-113">这些教程中的高级方案中介绍了[企业 Web 部署：方案概述](../deploying-web-applications-in-enterprise-scenarios/enterprise-web-deployment-scenario-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-113">The high-level scenario for these tutorials is described in [Enterprise Web Deployment: Scenario Overview](../deploying-web-applications-in-enterprise-scenarios/enterprise-web-deployment-scenario-overview.md).</span></span> <span data-ttu-id="c4bf8-114">我们建议在开始本教程为基础之前查看此主题。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-114">We recommend that you review this topic before you get started on this tutorial.</span></span>

## <a name="how-to-use-this-tutorial"></a><span data-ttu-id="c4bf8-115">如何使用本教程</span><span class="sxs-lookup"><span data-stu-id="c4bf8-115">How to Use This Tutorial</span></span>

- <span data-ttu-id="c4bf8-116">在本教程中的主题的每个是自包含，以及处理的特定挑战或企业部署方案中出现问题。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-116">Each of the topics in this tutorial is self-contained and addresses a particular challenge or problem that occurs in enterprise deployment scenarios.</span></span> <span data-ttu-id="c4bf8-117">无需完成任何特定顺序中的以下主题。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-117">You don't need to work through these topics in any particular order.</span></span> <span data-ttu-id="c4bf8-118">但是，本教程介绍一些高级的任务。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-118">However, this tutorial covers some advanced tasks.</span></span> <span data-ttu-id="c4bf8-119">在这种情况下，您应该熟悉的概念和技术的[企业中的 Web 部署](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md)教程介绍如何才能获得此内容的最大效益。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-119">As such, you should familiarize yourself with the concepts and techniques that the [Web Deployment in the Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md) tutorial covers in order to gain the most benefit from this content.</span></span>
- <span data-ttu-id="c4bf8-120">本教程包括以下主题：</span><span class="sxs-lookup"><span data-stu-id="c4bf8-120">This tutorial includes these topics:</span></span>
- <span data-ttu-id="c4bf8-121">[执行"假设"部署](performing-a-what-if-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-121">[Performing a "What If" Deployment](performing-a-what-if-deployment.md).</span></span> <span data-ttu-id="c4bf8-122">在很多情况下，您需要实际进行任何更改之前确定目标环境或任何现有内容建议的部署的影响。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-122">In a lot of scenarios, you'll want to determine the impact of a proposed deployment on a target environment or any existing content before you actually make any changes.</span></span> <span data-ttu-id="c4bf8-123">本主题介绍如何运行"假设"部署以生成日志文件和数据库的更新脚本，相当有到目标环境中部署内容而不实际进行任何更改。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-123">This topic describes how you can run a "what if" deployment to generate log files and database update scripts as if you had deployed content to a target environment, without actually making any changes.</span></span> <span data-ttu-id="c4bf8-124">分析这些资源可以帮助您找出任何潜在问题之前实时部署。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-124">Analyzing these resources can help you to spot any potential problems in advance of a live deployment.</span></span>
- <span data-ttu-id="c4bf8-125">[自定义多个环境的数据库部署](customizing-database-deployments-for-multiple-environments.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-125">[Customizing Database Deployments for Multiple Environments](customizing-database-deployments-for-multiple-environments.md).</span></span> <span data-ttu-id="c4bf8-126">在数据库项目部署到多个目标时，通常需要自定义每个目标环境的部署属性。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-126">When you deploy a database project to multiple destinations, you'll often want to customize the deployment properties for each target environment.</span></span> <span data-ttu-id="c4bf8-127">例如，在测试环境中你将通常重新创建数据库上每个部署，而在过渡或生产环境中，您可能是一种更有可能进行增量更新，以保留您的数据。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-127">For example, in test environments you'd typically recreate the database on every deployment, whereas in staging or production environments you'd be a lot more likely to make incremental updates to preserve your data.</span></span> <span data-ttu-id="c4bf8-128">本主题介绍如何才能将这些属性更改为你的部署逻辑通过创建用于每个目标环境的特定于环境的部署配置 (.sqldeployment) 文件。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-128">This topic describes how you can incorporate these property changes into your deployment logic by creating an environment-specific deployment configuration (.sqldeployment) file for each target environment.</span></span>
- <span data-ttu-id="c4bf8-129">部署到测试环境的数据库角色成员身份。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-129">Deploying Database Role Memberships to Test Environments.</span></span> <span data-ttu-id="c4bf8-130">重新创建每个部署上的数据库&#x2014;例如，作为持续集成 (CI) 的一部分生成并部署到测试环境&#x2014;通常需要配置每个时间的数据库角色成员身份。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-130">When you recreate a database on every deployment&#x2014;for example, as part of a continuous integration (CI) build and deploy to a test environment&#x2014;you'll typically need to configure database role memberships every time.</span></span> <span data-ttu-id="c4bf8-131">例如，您通常需要向与 web 应用程序关联的应用程序池标识授予权限。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-131">For example, you'll usually need to grant permissions to the application pool identity associated with your web application.</span></span> <span data-ttu-id="c4bf8-132">本主题介绍如何通过将后期部署 SQL 脚本添加到你的部署逻辑自动执行此过程。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-132">This topic describes how you can automate this process by adding a post-deployment SQL script to your deployment logic.</span></span>
- <span data-ttu-id="c4bf8-133">[将成员资格数据库部署到企业环境](deploying-membership-databases-to-enterprise-environments.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-133">[Deploying Membership Databases to Enterprise Environments](deploying-membership-databases-to-enterprise-environments.md).</span></span> <span data-ttu-id="c4bf8-134">ASP.NET 成员资格数据库具有各种特征，可以使部署过程变得复杂。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-134">ASP.NET membership databases have various characteristics that can complicate the deployment process.</span></span> <span data-ttu-id="c4bf8-135">例如，仅限架构的部署将使数据库处于不可操作状态的状态。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-135">For example, a schema-only deployment will leave the database in a non-operational state.</span></span> <span data-ttu-id="c4bf8-136">在大多数情况下，最好直接在每个目标环境中创建成员资格数据库。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-136">In most scenarios, it's preferable to create a membership database directly in each destination environment.</span></span> <span data-ttu-id="c4bf8-137">但是，如果你确实必须将成员资格数据库部署，本主题介绍的一些方法可用于满足固有的挑战。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-137">However, if you do have to deploy a membership database, this topic describes some of the approaches you can use to meet the inherent challenges.</span></span>
- <span data-ttu-id="c4bf8-138">[从部署中排除文件和文件夹](excluding-files-and-folders-from-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-138">[Excluding Files and Folders from Deployment](excluding-files-and-folders-from-deployment.md).</span></span> <span data-ttu-id="c4bf8-139">在某些情况下，你将想要调整到特定的目标环境 web 程序包的内容。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-139">In some scenarios, you'll want to tailor the contents of your web package to specific destination environments.</span></span> <span data-ttu-id="c4bf8-140">例如，你可能想要部署到测试环境中，以支持客户端调试，但在部署到过渡或生产环境时使用缩小的版本的库时包括的 JavaScript 库的完整版本。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-140">For example, you might want to include full versions of JavaScript libraries when you deploy to a test environment, to support client-side debugging, but use minified versions of the libraries when you deploy to a staging or production environment.</span></span> <span data-ttu-id="c4bf8-141">本主题介绍如何您可以排除特定文件和文件夹从包创建过程。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-141">This topic describes how you can exclude specific files and folders from the package creation process.</span></span>
- <span data-ttu-id="c4bf8-142">[使 Web 应用程序脱机使用 Web 部署](taking-web-applications-offline-with-web-deploy.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-142">[Taking Web Applications Offline with Web Deploy](taking-web-applications-offline-with-web-deploy.md).</span></span> <span data-ttu-id="c4bf8-143">当你将解决方案部署到过渡或生产环境时，通常需要执行部署过程的持续时间内的 web 应用程序脱机。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-143">When you deploy solutions to a staging or production environment, you'll often want to take your web applications offline for the duration of the deployment process.</span></span> <span data-ttu-id="c4bf8-144">本主题介绍如何将添加*应用程序\_offline.htm*对 web 应用程序在启动部署过程的文件，并在结束时将其删除。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-144">This topic describes how you can add an *App\_offline.htm* file to your web application at the start of the deployment process and remove it at the end.</span></span> <span data-ttu-id="c4bf8-145">虽然*应用程序\_offline.htm*文件的位置中，浏览到 web 应用程序的任何用户自动重定向到*应用\_offline.htm*文件。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-145">While the *App\_offline.htm* file is in place, any users who browse to the web application are automatically redirected to the *App\_offline.htm* file.</span></span>
- <span data-ttu-id="c4bf8-146">[运行 Windows PowerShell 脚本从 MSBuild](running-windows-powershell-scripts-from-msbuild-project-files.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-146">[Running Windows PowerShell Scripts from MSBuild](running-windows-powershell-scripts-from-msbuild-project-files.md).</span></span> <span data-ttu-id="c4bf8-147">许多部署方案需要更复杂的部署后操作，如将自定义事件源添加到注册表或配置 SQL Server 实例之间进行复制。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-147">Many deployment scenarios require more complex post-deployment actions, like adding custom event sources to the registry or configuring replication between SQL Server instances.</span></span> <span data-ttu-id="c4bf8-148">这些操作通常通过 Windows PowerShell 脚本。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-148">These actions are often accomplished through Windows PowerShell scripts.</span></span> <span data-ttu-id="c4bf8-149">本主题介绍如何从 Microsoft Build Engine (MSBuild) 项目文件生成和部署过程的一部分运行的 Windows PowerShell 脚本。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-149">This topic describes how to run Windows PowerShell scripts from a Microsoft Build Engine (MSBuild) project file as part of the build and deployment process.</span></span>
- <span data-ttu-id="c4bf8-150">[打包过程故障排除](troubleshooting-the-packaging-process.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-150">[Troubleshooting the Packaging Process](troubleshooting-the-packaging-process.md).</span></span> <span data-ttu-id="c4bf8-151">Web 发布管道 (WPP) 定义一个名为 MSBuild 属性**EnablePackageProcessLoggingAndAssert**可用于生成 web 应用程序项目的打包过程有关的详细信息。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-151">The Web Publishing Pipeline (WPP) defines an MSBuild property named **EnablePackageProcessLoggingAndAssert** that you can use to generate in-depth information about the packaging process for web application projects.</span></span> <span data-ttu-id="c4bf8-152">本主题介绍了该属性的用途以及如何使用它。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-152">This topic describes what the property does and how to use it.</span></span>

## <a name="key-technologies"></a><span data-ttu-id="c4bf8-153">关键技术</span><span class="sxs-lookup"><span data-stu-id="c4bf8-153">Key Technologies</span></span>

<span data-ttu-id="c4bf8-154">本教程重点介绍如何使用这些产品和技术来支持自动化的生成和 web 部署：</span><span class="sxs-lookup"><span data-stu-id="c4bf8-154">This tutorial focuses on how to use these products and technologies to support automated build and web deployment:</span></span>

- <span data-ttu-id="c4bf8-155">Visual Studio 2010 和 Team Foundation Server (TFS) 2010</span><span class="sxs-lookup"><span data-stu-id="c4bf8-155">Visual Studio 2010 and Team Foundation Server (TFS) 2010</span></span>
- <span data-ttu-id="c4bf8-156">MSBuild 和 TFS Team Build</span><span class="sxs-lookup"><span data-stu-id="c4bf8-156">MSBuild and TFS Team Build</span></span>
- <span data-ttu-id="c4bf8-157">Internet Information Services (IIS) 7.5</span><span class="sxs-lookup"><span data-stu-id="c4bf8-157">Internet Information Services (IIS) 7.5</span></span>
- <span data-ttu-id="c4bf8-158">IIS Web 部署工具 （Web 部署） 2.1</span><span class="sxs-lookup"><span data-stu-id="c4bf8-158">IIS Web Deployment Tool (Web Deploy) 2.1</span></span>
- <span data-ttu-id="c4bf8-159">VSDBCMD.exe 数据库部署实用工具</span><span class="sxs-lookup"><span data-stu-id="c4bf8-159">The VSDBCMD.exe database deployment utility</span></span>

## <a name="other-tutorials-in-this-series"></a><span data-ttu-id="c4bf8-160">本系列中的其他教程</span><span class="sxs-lookup"><span data-stu-id="c4bf8-160">Other Tutorials in This Series</span></span>

<span data-ttu-id="c4bf8-161">这在企业级 web 部署窗体的一系列五个教程的一部分。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-161">This forms part of a series of five tutorials on enterprise-scale web deployment.</span></span> <span data-ttu-id="c4bf8-162">以下是该系列中的其他教程：</span><span class="sxs-lookup"><span data-stu-id="c4bf8-162">These are other tutorials in the series:</span></span>

- <span data-ttu-id="c4bf8-163">[部署 Web 应用程序在企业方案中的](../deploying-web-applications-in-enterprise-scenarios/deploying-web-applications-in-enterprise-scenarios.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-163">[Deploying Web Applications in Enterprise Scenarios](../deploying-web-applications-in-enterprise-scenarios/deploying-web-applications-in-enterprise-scenarios.md).</span></span> <span data-ttu-id="c4bf8-164">此介绍性内容提供了为系列教程的上下文的背景。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-164">This introductory content provides the contextual background for the tutorial series.</span></span> <span data-ttu-id="c4bf8-165">它描述了教程的方案，并说明了任务和演练所述在整个系列如何适应更广泛的应用程序生命周期管理 (ALM) 过程。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-165">It describes the tutorial scenario, and it illustrates how the tasks and walkthroughs described throughout the series fit into a broader Application Lifecycle Management (ALM) process.</span></span>
- <span data-ttu-id="c4bf8-166">[Web 部署在企业中的](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-166">[Web Deployment in the Enterprise](../web-deployment-in-the-enterprise/web-deployment-in-the-enterprise.md).</span></span> <span data-ttu-id="c4bf8-167">本教程提供 MSBuild 项目文件的概念介绍、 WPP、 Web 部署，和其他相关的技术。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-167">This tutorial provides a conceptual introduction to MSBuild project files, the WPP, Web Deploy, and other related technologies.</span></span> <span data-ttu-id="c4bf8-168">它介绍了如何使用这些工具一起管理复杂部署过程。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-168">It explains how you can use these tools together to manage complex deployment processes.</span></span>
- <span data-ttu-id="c4bf8-169">[配置用于 Web 部署的服务器环境](../configuring-server-environments-for-web-deployment/configuring-server-environments-for-web-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-169">[Configuring Server Environments for Web Deployment](../configuring-server-environments-for-web-deployment/configuring-server-environments-for-web-deployment.md).</span></span> <span data-ttu-id="c4bf8-170">本教程介绍如何配置 Windows 服务器以支持各种部署方案，包括使用 Web 部署代理服务 （远程代理） 或 Web 部署处理程序和远程数据库部署的远程 web 包部署。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-170">This tutorial describes how to configure Windows servers to support various deployment scenarios, including remote web package deployment using the Web Deployment Agent Service (the remote agent) or the Web Deploy Handler and remote database deployment.</span></span> <span data-ttu-id="c4bf8-171">它提供有关选择适当的部署方法对您自己的环境的指导并介绍了如何使用 Web Farm Framework (WFF) 在服务器场中的所有 web 服务器之间复制已部署的 web 应用程序。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-171">It provides guidance on choosing the appropriate deployment method for your own environment, and it describes how to use the Web Farm Framework (WFF) to replicate deployed web applications across all the web servers in a server farm.</span></span>
- <span data-ttu-id="c4bf8-172">[配置用于 Web 部署的 Team Foundation Server](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-172">[Configuring Team Foundation Server for Web Deployment](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md).</span></span> <span data-ttu-id="c4bf8-173">本教程介绍如何配置 TFS 以支持多种部署方案，包括作为 CI 过程的一部分的自动的部署和手动触发部署的特定版本。</span><span class="sxs-lookup"><span data-stu-id="c4bf8-173">This tutorial describes how to configure TFS to support various deployment scenarios, including automated deployment as part of a CI process and manually triggered deployments of specific builds.</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="c4bf8-174">下一页</span><span class="sxs-lookup"><span data-stu-id="c4bf8-174">Next</span></span>](performing-a-what-if-deployment.md)

---
uid: web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-project-file
title: 了解项目文件 |Microsoft Docs
author: jrjlee
description: Microsoft 生成引擎（MSBuild）项目文件位于生成和部署过程的核心。 本主题从有关 MSBuild 的概念性概述开始 。
ms.author: riande
ms.date: 05/04/2012
ms.assetid: 07978d9d-341c-4524-bcba-62976f390f77
msc.legacyurl: /web-forms/overview/deployment/web-deployment-in-the-enterprise/understanding-the-project-file
msc.type: authoredcontent
ms.openlocfilehash: 419fe51aaf65bddcc2c50380f099f842a8d9439c
ms.sourcegitcommit: 84b1681d4e6253e30468c8df8a09fe03beea9309
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/02/2019
ms.locfileid: "73445693"
---
# <a name="understanding-the-project-file"></a><span data-ttu-id="9d5fc-104">了解项目文件</span><span class="sxs-lookup"><span data-stu-id="9d5fc-104">Understanding the project file</span></span>

<span data-ttu-id="9d5fc-105">作者： [Jason](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="9d5fc-105">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="9d5fc-106">下载 PDF</span><span class="sxs-lookup"><span data-stu-id="9d5fc-106">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="9d5fc-107">Microsoft 生成引擎（MSBuild）项目文件位于生成和部署过程的核心。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-107">Microsoft Build Engine (MSBuild) project files lie at the heart of the build and deployment process.</span></span> <span data-ttu-id="9d5fc-108">本主题以 MSBuild 和项目文件的概念性概述开头。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-108">This topic starts with a conceptual overview of MSBuild and the project file.</span></span> <span data-ttu-id="9d5fc-109">它介绍了在处理项目文件时将遇到的关键组件，并通过一个示例来演示如何使用项目文件来部署真实的应用程序。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-109">It describes the key components you'll come across when you work with project files, and it works through an example of how you can use project files to deploy real-world applications.</span></span>
> 
> <span data-ttu-id="9d5fc-110">你将学习的内容：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-110">What you'll learn:</span></span>
> 
> - <span data-ttu-id="9d5fc-111">MSBuild 如何使用 MSBuild 项目文件来生成项目。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-111">How MSBuild uses MSBuild project files to build projects.</span></span>
> - <span data-ttu-id="9d5fc-112">MSBuild 如何与部署技术（如 Internet Information Services （IIS） Web 部署工具（Web 部署））集成。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-112">How MSBuild integrates with deployment technologies, like the Internet Information Services (IIS) Web Deployment Tool (Web Deploy).</span></span>
> - <span data-ttu-id="9d5fc-113">如何了解项目文件的关键组件。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-113">How to understand the key components of a project file.</span></span>
> - <span data-ttu-id="9d5fc-114">如何使用项目文件来构建和部署复杂的应用程序。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-114">How you can use project files to build and deploy complex applications.</span></span>

## <a name="msbuild-and-the-project-file"></a><span data-ttu-id="9d5fc-115">MSBuild 和项目文件</span><span class="sxs-lookup"><span data-stu-id="9d5fc-115">MSBuild and the Project File</span></span>

<span data-ttu-id="9d5fc-116">在 Visual Studio 中创建和生成解决方案时，Visual Studio 使用 MSBuild 在解决方案中生成每个项目。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-116">When you create and build solutions in Visual Studio, Visual Studio uses MSBuild to build each project in your solution.</span></span> <span data-ttu-id="9d5fc-117">每个 Visual Studio 项目都包含一个 MSBuild 项目文件，其中包含一个文件扩展名，用于反映&#x2014;项目类型（例如C# ，项目（.Csproj））、Visual Basic.NET 项目（.vbproj）或数据库项目（.dbproj）。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-117">Every Visual Studio project includes an MSBuild project file, with a file extension that reflects the type of project&#x2014;for example, a C# project (.csproj), a Visual Basic.NET project (.vbproj), or a database project (.dbproj).</span></span> <span data-ttu-id="9d5fc-118">为了生成项目，MSBuild 必须处理与项目关联的项目文件。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-118">In order to build a project, MSBuild must process the project file associated with the project.</span></span> <span data-ttu-id="9d5fc-119">项目文件是一个 XML 文档，其中包含 MSBuild 生成项目所需的所有信息和说明，如要包含的内容、平台要求、版本信息、web 服务器或数据库服务器设置，以及必须执行的任务。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-119">The project file is an XML document that contains all the information and instructions that MSBuild needs in order to build your project, like the content to include, the platform requirements, versioning information, web server or database server settings, and the tasks that must be performed.</span></span>

<span data-ttu-id="9d5fc-120">MSBuild 项目文件基于[MSBUILD XML 架构](/visualstudio/msbuild/msbuild-project-file-schema-reference)，因此，生成过程是完全开放且透明的。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-120">MSBuild project files are based on the [MSBuild XML schema](/visualstudio/msbuild/msbuild-project-file-schema-reference), and as a result the build process is entirely open and transparent.</span></span> <span data-ttu-id="9d5fc-121">此外，无需安装 Visual Studio 即可使用 MSBuild 引擎&#x2014;，而 msbuild 可执行文件是 .NET Framework 的一部分，你可以在命令提示符下运行它。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-121">In addition, you don't need to install Visual Studio in order to use the MSBuild engine&#x2014;the MSBuild.exe executable is part of the .NET Framework, and you can run it from a command prompt.</span></span> <span data-ttu-id="9d5fc-122">作为开发人员，您可以使用 MSBuild XML 架构来创建自己的 MSBuild 项目文件，以对项目的生成和部署方式进行完善且精细的控制。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-122">As a developer, you can craft your own MSBuild project files, using the MSBuild XML schema, to impose sophisticated and fine-grained control over how your projects are built and deployed.</span></span> <span data-ttu-id="9d5fc-123">这些自定义项目文件的工作方式与 Visual Studio 自动生成的项目文件的工作方式完全相同。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-123">These custom project files work in exactly the same way as the project files that Visual Studio generates automatically.</span></span>

> [!NOTE]
> <span data-ttu-id="9d5fc-124">你还可以将 MSBuild 项目文件与 Team Foundation Server （TFS）中的团队生成服务一起使用。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-124">You can also use MSBuild project files with the Team Build service in Team Foundation Server (TFS).</span></span> <span data-ttu-id="9d5fc-125">例如，你可以在持续集成（CI）方案中使用项目文件，以便在签入新代码时自动部署到测试环境。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-125">For example, you can use project files in continuous integration (CI) scenarios to automate deployment to a test environment when new code is checked in.</span></span> <span data-ttu-id="9d5fc-126">有关详细信息，请参阅为[自动 Web 部署配置 Team Foundation Server](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-126">For more information, see [Configuring Team Foundation Server for Automated Web Deployment](../configuring-team-foundation-server-for-web-deployment/configuring-team-foundation-server-for-web-deployment.md).</span></span>

### <a name="project-file-naming-conventions"></a><span data-ttu-id="9d5fc-127">项目文件命名约定</span><span class="sxs-lookup"><span data-stu-id="9d5fc-127">Project File Naming Conventions</span></span>

<span data-ttu-id="9d5fc-128">创建自己的项目文件时，可以使用任何所需的文件扩展名。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-128">When you create your own project files, you can use any file extension you like.</span></span> <span data-ttu-id="9d5fc-129">但是，若要使你的解决方案更易于理解，你应该使用以下常见约定：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-129">However, to make your solutions easier for others to understand, you should use these common conventions:</span></span>

- <span data-ttu-id="9d5fc-130">创建生成项目的项目文件时，请使用 proj 扩展。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-130">Use the .proj extension when you create a project file that builds projects.</span></span>
- <span data-ttu-id="9d5fc-131">创建可重用的项目文件时，请使用 .targets 扩展名以导入其他项目文件。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-131">Use the .targets extension when you create a reusable project file to import into other project files.</span></span> <span data-ttu-id="9d5fc-132">带有 .targets 扩展名的文件通常不会生成任何内容，只是包含可以导入到 proj 文件中的说明。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-132">Files with a .targets extension typically don't build anything themselves, they simply contain instructions that you can import into your .proj files.</span></span>

### <a name="integration-with-deployment-technologies"></a><span data-ttu-id="9d5fc-133">与部署技术的集成</span><span class="sxs-lookup"><span data-stu-id="9d5fc-133">Integration with Deployment Technologies</span></span>

<span data-ttu-id="9d5fc-134">如果你使用的是 Visual Studio 2010 中的 web 应用程序项目，例如 ASP.NET web 应用程序和 ASP.NET MVC web 应用程序，则你将知道这些项目包括用于将 web 应用程序打包和部署到目标环境的内置支持。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-134">If you've worked with web application projects in Visual Studio 2010, like ASP.NET web applications and ASP.NET MVC web applications, you'll know that these projects include built-in support for packaging and deploying the web application to a target environment.</span></span> <span data-ttu-id="9d5fc-135">这些项目的**属性**页包括 "**打包/发布 Web** " 和 "**包/发布 SQL** " 选项卡，你可以使用这些选项卡配置应用程序组件的打包和部署方式。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-135">The **Properties** pages for these projects include **Package/Publish Web** and **Package/Publish SQL** tabs that you can use to configure how the components of your application are packaged and deployed.</span></span> <span data-ttu-id="9d5fc-136">这会显示 "**打包/发布 Web** " 选项卡：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-136">This shows the **Package/Publish Web** tab:</span></span>

![](understanding-the-project-file/_static/image1.png)

<span data-ttu-id="9d5fc-137">这些功能背后的基础技术称为 Web 发布管道（WPP）。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-137">The underlying technology behind these capabilities is known as the Web Publishing Pipeline (WPP).</span></span> <span data-ttu-id="9d5fc-138">此 WPP 实质上将 MSBuild 和[Web 部署](https://go.microsoft.com/?linkid=9805122)结合起来，为 Web 应用程序提供完整的生成、打包和部署过程。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-138">The WPP essentially brings MSBuild and [Web Deploy](https://go.microsoft.com/?linkid=9805122) together to provide a complete build, package, and deployment process for your web applications.</span></span>

<span data-ttu-id="9d5fc-139">好消息是，你可以在为 web 项目创建自定义项目文件时利用 WPP 提供的集成点。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-139">The good news is that you can take advantage of the integration points that the WPP provides when you create custom project files for web projects.</span></span> <span data-ttu-id="9d5fc-140">你可以在项目文件中包含部署说明，此操作可让你生成项目、创建 web 部署包，并通过单个项目文件和对 MSBuild 的单次调用在远程服务器上安装这些包。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-140">You can include deployment instructions in your project file, which allows you to build your projects, create web deployment packages, and install these packages on remote servers through a single project file and a single call to MSBuild.</span></span> <span data-ttu-id="9d5fc-141">你还可以调用任何其他可执行文件作为生成过程的一部分。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-141">You can also call any other executables as part of your build process.</span></span> <span data-ttu-id="9d5fc-142">例如，你可以运行 VSDBCMD 命令行工具，以从架构文件部署数据库。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-142">For example, you can run the VSDBCMD.exe command-line tool to deploy a database from a schema file.</span></span> <span data-ttu-id="9d5fc-143">在本主题的过程中，你将了解如何利用这些功能满足企业部署方案的要求。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-143">Over the course of this topic, you'll see how you can take advantage of these capabilities to meet the requirements of your enterprise deployment scenarios.</span></span>

> [!NOTE]
> <span data-ttu-id="9d5fc-144">有关 web 应用程序部署过程工作原理的详细信息，请参阅[ASP.NET Web 应用程序项目部署概述](https://msdn.microsoft.com/library/dd394698.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-144">For more information on how the web application deployment process works, see [ASP.NET Web Application Project Deployment Overview](https://msdn.microsoft.com/library/dd394698.aspx).</span></span>

## <a name="the-anatomy-of-a-project-file"></a><span data-ttu-id="9d5fc-145">项目文件的解析</span><span class="sxs-lookup"><span data-stu-id="9d5fc-145">The Anatomy of a Project File</span></span>

<span data-ttu-id="9d5fc-146">更详细地查看生成过程之前，有必要花一些时间来熟悉 MSBuild 项目文件的基本结构。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-146">Before you look at the build process in more detail, it's worth taking a few moments to familiarize yourself with the basic structure of an MSBuild project file.</span></span> <span data-ttu-id="9d5fc-147">本部分概述了在查看、编辑或创建项目文件时将遇到的更常见的元素。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-147">This section provides an overview of the more common elements that you'll encounter when you review, edit, or create a project file.</span></span> <span data-ttu-id="9d5fc-148">具体来说，您将了解：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-148">In particular, you'll learn:</span></span>

- <span data-ttu-id="9d5fc-149">如何使用*属性*来管理生成过程的变量。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-149">How to use *properties* to manage variables for the build process.</span></span>
- <span data-ttu-id="9d5fc-150">如何使用*项*来标识与生成进程（如代码文件）的输入。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-150">How to use *items* to identify the inputs to the build process, like code files.</span></span>
- <span data-ttu-id="9d5fc-151">如何使用*目标*和*任务*来向 MSBuild 提供执行指令，并使用在项目文件中的其他位置定义的*属性*和*项*。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-151">How to use *targets* and *tasks* to provide execution instructions to MSBuild, using *properties* and *items* defined elsewhere in the project file.</span></span>

<span data-ttu-id="9d5fc-152">这会显示 MSBuild 项目文件中的关键元素之间的关系：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-152">This shows the relationship between the key elements in an MSBuild project file:</span></span>

![](understanding-the-project-file/_static/image2.png)

### <a name="the-project-element"></a><span data-ttu-id="9d5fc-153">项目元素</span><span class="sxs-lookup"><span data-stu-id="9d5fc-153">The Project Element</span></span>

<span data-ttu-id="9d5fc-154">[项目](https://msdn.microsoft.com/library/bcxfsh87.aspx)元素是每个项目文件的根元素。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-154">The [Project](https://msdn.microsoft.com/library/bcxfsh87.aspx) element is the root element of every project file.</span></span> <span data-ttu-id="9d5fc-155">除了标识项目文件的 XML 架构以外，**项目**元素还可以包含属性以指定生成过程的入口点。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-155">In addition to identifying the XML schema for the project file, the **Project** element can include attributes to specify the entry points for the build process.</span></span> <span data-ttu-id="9d5fc-156">例如，在 "[联系人管理器" 示例解决方案](the-contact-manager-solution.md)中， *Publish*文件指定生成应通过调用名为**FullPublish**的目标来启动。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-156">For example, in the [Contact Manager sample solution](the-contact-manager-solution.md), the *Publish.proj* file specifies that the build should start by calling the target named **FullPublish**.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample1.xml)]

### <a name="properties-and-conditions"></a><span data-ttu-id="9d5fc-157">属性和条件</span><span class="sxs-lookup"><span data-stu-id="9d5fc-157">Properties and Conditions</span></span>

<span data-ttu-id="9d5fc-158">若要成功生成和部署项目，项目文件通常需要提供许多不同的信息片段。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-158">A project file typically needs to provide lots of different pieces of information in order to successfully build and deploy your projects.</span></span> <span data-ttu-id="9d5fc-159">这些信息可能包括服务器名称、连接字符串、凭据、生成配置、源和目标文件路径，以及要支持自定义的任何其他信息。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-159">These pieces of information could include server names, connection strings, credentials, build configurations, source and destination file paths, and any other information you want to include to support customization.</span></span> <span data-ttu-id="9d5fc-160">在项目文件中，必须在[PropertyGroup](https://msdn.microsoft.com/library/t4w159bs.aspx)元素内定义属性。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-160">In a project file, properties must be defined within a [PropertyGroup](https://msdn.microsoft.com/library/t4w159bs.aspx) element.</span></span> <span data-ttu-id="9d5fc-161">MSBuild 属性包含键值对。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-161">MSBuild properties consist of key-value pairs.</span></span> <span data-ttu-id="9d5fc-162">在**PropertyGroup**元素中，元素名称定义属性键，元素的内容定义属性值。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-162">Within the **PropertyGroup** element, the element name defines the property key and the content of the element defines the property value.</span></span> <span data-ttu-id="9d5fc-163">例如，可以定义名为**ServerName**和**ConnectionString**的属性，以存储静态服务器名称和连接字符串。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-163">For example, you could define properties named **ServerName** and **ConnectionString** to store a static server name and connection string.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample2.xml)]

<span data-ttu-id="9d5fc-164">若要检索属性值，请使用格式 *$ （PropertyName）* 。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-164">To retrieve a property value, use the format *$(PropertyName)*.</span></span> <span data-ttu-id="9d5fc-165">例如，若要检索**ServerName**属性的值，请键入：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-165">For example, to retrieve the value of the **ServerName** property, you would type:</span></span>

[!code-powershell[Main](understanding-the-project-file/samples/sample3.ps1)]

> [!NOTE]
> <span data-ttu-id="9d5fc-166">你将在本主题的后面部分介绍如何以及何时使用属性值。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-166">You'll see examples of how and when to use property values later in this topic.</span></span>

<span data-ttu-id="9d5fc-167">在项目文件中将信息嵌入为静态属性并非总是用于管理生成过程的理想方法。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-167">Embedding information as static properties in a project file is not always the ideal approach to managing the build process.</span></span> <span data-ttu-id="9d5fc-168">在许多情况下，你将需要从其他源中获取信息，或使用户能够从命令提示符中提供信息。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-168">In a lot of scenarios, you'll want to obtain the information from other sources or empower the user to provide the information from the command prompt.</span></span> <span data-ttu-id="9d5fc-169">MSBuild 允许您将任何属性值指定为命令行参数。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-169">MSBuild allows you to specify any property value as a command-line parameter.</span></span> <span data-ttu-id="9d5fc-170">例如，当用户从命令行运行 Msbuild.exe 时，用户可以提供**ServerName**的值。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-170">For example, the user could provide a value for **ServerName** when he or she runs MSBuild.exe from the command line.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample4.cmd)]

> [!NOTE]
> <span data-ttu-id="9d5fc-171">有关可用于 Msbuild.exe 的参数和开关的详细信息，请参阅[Msbuild 命令行参考](https://msdn.microsoft.com/library/ms164311.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-171">For more information on the arguments and switches you can use with MSBuild.exe, see [MSBuild Command Line Reference](https://msdn.microsoft.com/library/ms164311.aspx).</span></span>

<span data-ttu-id="9d5fc-172">您可以使用相同的属性语法来获取环境变量和内置项目属性的值。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-172">You can use the same property syntax to obtain the values of environment variables and built-in project properties.</span></span> <span data-ttu-id="9d5fc-173">许多常用的属性是为你定义的，你可以通过包含相关参数名称在项目文件中使用它们。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-173">Lots of commonly used properties are defined for you, and you can use them in your project files by including the relevant parameter name.</span></span> <span data-ttu-id="9d5fc-174">例如，&#x2014;若要检索当前项目平台（例如**x86**或**AnyCpu**&#x2014;），可以在项目文件中包含 **$ （platform）** 属性引用。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-174">For example, to retrieve the current project platform&#x2014;for example, **x86** or **AnyCpu**&#x2014;you can include the **$(Platform)** property reference in your project file.</span></span> <span data-ttu-id="9d5fc-175">有关详细信息，请参阅[用于生成命令和属性的宏](https://msdn.microsoft.com/library/c02as0cs.aspx)、[常用的 MSBuild 项目属性](https://msdn.microsoft.com/library/bb629394.aspx)以及[保留属性](https://msdn.microsoft.com/library/ms164309.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-175">For more information, see [Macros for Build Commands and Properties](https://msdn.microsoft.com/library/c02as0cs.aspx), [Common MSBuild Project Properties](https://msdn.microsoft.com/library/bb629394.aspx), and [Reserved Properties](https://msdn.microsoft.com/library/ms164309.aspx).</span></span>

<span data-ttu-id="9d5fc-176">属性通常与*条件*结合使用。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-176">Properties are often used in conjunction with *conditions*.</span></span> <span data-ttu-id="9d5fc-177">大多数 MSBuild 元素都支持**Condition**特性，这使你可以指定 MSBuild 计算元素时所依据的条件。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-177">Most MSBuild elements support the **Condition** attribute, which lets you specify the criteria upon which MSBuild should evaluate the element.</span></span> <span data-ttu-id="9d5fc-178">例如，请考虑以下属性定义：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-178">For example, consider this property definition:</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample5.xml)]

<span data-ttu-id="9d5fc-179">当 MSBuild 处理此属性定义时，它会首先检查 **$ （OutputRoot）** 属性值是否可用。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-179">When MSBuild processes this property definition, it first checks to see whether an **$(OutputRoot)** property value is available.</span></span> <span data-ttu-id="9d5fc-180">如果属性值为空&#x2014;，则该用户未提供此属性&#x2014;的值，条件的计算结果为**true** ，并且属性值设置为 **。\Publish\Out**。如果用户已为此属性提供值，则条件的计算结果为**false** ，并且不使用静态属性值。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-180">If the property value is blank&#x2014;in other words, the user hasn't provided a value for this property&#x2014;the condition evaluates to **true** and the property value is set to **..\Publish\Out**. If the user has provided a value for this property, the condition evaluates to **false** and the static property value is not used.</span></span>

<span data-ttu-id="9d5fc-181">有关可用于指定条件的不同方法的详细信息，请参阅[MSBuild 条件](https://msdn.microsoft.com/library/7szfhaft.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-181">For more information on the different ways in which you can specify conditions, see [MSBuild Conditions](https://msdn.microsoft.com/library/7szfhaft.aspx).</span></span>

### <a name="items-and-item-groups"></a><span data-ttu-id="9d5fc-182">项和项组</span><span class="sxs-lookup"><span data-stu-id="9d5fc-182">Items and Item Groups</span></span>

<span data-ttu-id="9d5fc-183">项目文件的一个重要角色是定义生成过程的输入。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-183">One of the important roles of the project file is to define the inputs to the build process.</span></span> <span data-ttu-id="9d5fc-184">通常，这些输入是文件&#x2014;代码文件、配置文件、命令文件以及您需要在生成过程中进行处理或复制的任何其他文件。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-184">Typically, these inputs are files&#x2014;code files, configuration files, command files, and any other files that you need to process or copy as part of the build process.</span></span> <span data-ttu-id="9d5fc-185">在 MSBuild 项目架构中，这些输入由[项](https://msdn.microsoft.com/library/ms164283.aspx)元素表示。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-185">In the MSBuild project schema, these inputs are represented by [Item](https://msdn.microsoft.com/library/ms164283.aspx) elements.</span></span> <span data-ttu-id="9d5fc-186">在项目文件中，必须在[ItemGroup](https://msdn.microsoft.com/library/646dk05y.aspx)元素中定义项。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-186">In a project file, items must be defined within an [ItemGroup](https://msdn.microsoft.com/library/646dk05y.aspx) element.</span></span> <span data-ttu-id="9d5fc-187">就像**属性**元素一样，你可以按喜欢的方式命名**项**元素。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-187">Just like **Property** elements, you can name an **Item** element however you like.</span></span> <span data-ttu-id="9d5fc-188">但是，必须指定**Include**特性来标识该项表示的文件或通配符。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-188">However, you must specify an **Include** attribute to identify the file or wildcard that the item represents.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample6.xml)]

<span data-ttu-id="9d5fc-189">通过指定多个具有相同名称的**项**元素，您可以有效地创建一个命名的资源列表。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-189">By specifying multiple **Item** elements with the same name, you're effectively creating a named list of resources.</span></span> <span data-ttu-id="9d5fc-190">在操作中查看此操作的一个好方法是查看 Visual Studio 创建的项目文件之一。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-190">A good way to see this in action is to take a look inside one of the project files that Visual Studio creates.</span></span> <span data-ttu-id="9d5fc-191">例如，示例解决方案中的*ContactManager*文件包含许多项组，每个项组具有多个同名的**项**元素。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-191">For example, the *ContactManager.Mvc.csproj* file in the sample solution includes a lot of item groups, each with several identically named **Item** elements.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample7.xml)]

<span data-ttu-id="9d5fc-192">通过这种方式，项目文件将指示 MSBuild 构造文件的列表，这些文件需要以**相同的方式**&#x2014;进行处理。若要成功生成，**编译**列表包含代码必须编译的文件和**内容**列表中包含必须原封不动地复制的资源。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-192">In this way, the project file is instructing MSBuild to construct lists of files that need to be processed in the same way&#x2014;the **Reference** list includes assemblies that must be in place for a successful build, the **Compile** list includes code files that must be compiled, and the **Content** list includes resources that must be copied unaltered.</span></span> <span data-ttu-id="9d5fc-193">我们将在本主题的后面部分介绍生成过程是如何引用和使用这些项的。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-193">We'll look at how the build process references and uses these items later in this topic.</span></span>

<span data-ttu-id="9d5fc-194">Item 元素还可以包含[ItemMetadata](https://msdn.microsoft.com/library/ms164284.aspx)子元素。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-194">Item elements can also include [ItemMetadata](https://msdn.microsoft.com/library/ms164284.aspx) child elements.</span></span> <span data-ttu-id="9d5fc-195">这些是用户定义的键值对，本质上表示特定于该项目的属性。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-195">These are user-defined key-value pairs and essentially represent properties that are specific to that item.</span></span> <span data-ttu-id="9d5fc-196">例如，项目文件中的许多**编译**项元素都包含**DependentUpon**子元素。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-196">For example, a lot of the **Compile** item elements in the project file include **DependentUpon** child elements.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample8.xml)]

> [!NOTE]
> <span data-ttu-id="9d5fc-197">除了用户创建的项元数据外，在创建时将为所有项分配各种通用元数据。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-197">In addition to user-created item metadata, all items are assigned various common metadata on creation.</span></span> <span data-ttu-id="9d5fc-198">有关详细信息，请参阅[常见项元数据](https://msdn.microsoft.com/library/ms164313.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-198">For more information, see [Well-known Item Metadata](https://msdn.microsoft.com/library/ms164313.aspx).</span></span>

<span data-ttu-id="9d5fc-199">可以在根级别**项目**元素内或特定**目标**元素中创建**ItemGroup**元素。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-199">You can create **ItemGroup** elements within the root-level **Project** element or within specific **Target** elements.</span></span> <span data-ttu-id="9d5fc-200">**ItemGroup**元素还支持**条件**属性，这使你可以根据项目配置或平台等条件来定制生成过程的输入。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-200">**ItemGroup** elements also support **Condition** attributes, which lets you tailor the inputs to the build process according to conditions like the project configuration or platform.</span></span>

### <a name="targets-and-tasks"></a><span data-ttu-id="9d5fc-201">目标和任务</span><span class="sxs-lookup"><span data-stu-id="9d5fc-201">Targets and Tasks</span></span>

<span data-ttu-id="9d5fc-202">在 MSBuild 架构中， [Task](https://msdn.microsoft.com/library/77f2hx1s.aspx)元素表示单个生成指令（或任务）。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-202">In the MSBuild schema, a [Task](https://msdn.microsoft.com/library/77f2hx1s.aspx) element represents an individual build instruction (or task).</span></span> <span data-ttu-id="9d5fc-203">MSBuild 包含许多预定义任务。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-203">MSBuild includes a multitude of predefined tasks.</span></span> <span data-ttu-id="9d5fc-204">例如:</span><span class="sxs-lookup"><span data-stu-id="9d5fc-204">For example:</span></span>

- <span data-ttu-id="9d5fc-205">**复制**任务将文件复制到新位置。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-205">The **Copy** task copies files to a new location.</span></span>
- <span data-ttu-id="9d5fc-206">**Csc**任务调用 Visual C#编译器。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-206">The **Csc** task invokes the Visual C# compiler.</span></span>
- <span data-ttu-id="9d5fc-207">**Vbc**任务调用 Visual Basic 编译器。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-207">The **Vbc** task invokes the Visual Basic compiler.</span></span>
- <span data-ttu-id="9d5fc-208">**Exec**任务运行指定的程序。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-208">The **Exec** task runs a specified program.</span></span>
- <span data-ttu-id="9d5fc-209">**消息**任务将消息写入记录器。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-209">The **Message** task writes a message to a logger.</span></span>

> [!NOTE]
> <span data-ttu-id="9d5fc-210">有关现成可用的任务的完整详细信息，请参阅[MSBuild 任务参考](https://msdn.microsoft.com/library/7z253716.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-210">For full details of the tasks that are available out of the box, see [MSBuild Task Reference](https://msdn.microsoft.com/library/7z253716.aspx).</span></span> <span data-ttu-id="9d5fc-211">有关任务的详细信息，包括如何创建您自己的自定义任务，请参阅[MSBuild 任务](https://msdn.microsoft.com/library/ms171466.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-211">For more information on tasks, including how to create your own custom tasks, see [MSBuild Tasks](https://msdn.microsoft.com/library/ms171466.aspx).</span></span>

<span data-ttu-id="9d5fc-212">任务必须始终包含在[目标](https://msdn.microsoft.com/library/t50z2hka.aspx)元素中。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-212">Tasks must always be contained within [Target](https://msdn.microsoft.com/library/t50z2hka.aspx) elements.</span></span> <span data-ttu-id="9d5fc-213">**目标**元素是按顺序执行的一组或多项任务，项目文件可以包含多个目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-213">A **Target** element is a set of one or more tasks that are executed sequentially, and a project file can contain multiple targets.</span></span> <span data-ttu-id="9d5fc-214">当你想要运行一个任务或一组任务时，可以调用包含它们的目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-214">When you want to run a task, or a set of tasks, you invoke the target that contains them.</span></span> <span data-ttu-id="9d5fc-215">例如，假设有一个记录消息的简单项目文件。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-215">For example, suppose you have a simple project file that logs a message.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample9.xml)]

<span data-ttu-id="9d5fc-216">可以通过使用 **/t**开关指定目标，从命令行调用目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-216">You can invoke the target from the command line, by using the **/t** switch to specify the target.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample10.cmd)]

<span data-ttu-id="9d5fc-217">或者，可以将**DefaultTargets**属性添加到**项目**元素，以指定要调用的目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-217">Alternatively, you can add a **DefaultTargets** attribute to the **Project** element, to specify the targets that you want to invoke.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample11.xml)]

<span data-ttu-id="9d5fc-218">在这种情况下，无需从命令行指定目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-218">In this case, you don't need to specify the target from the command line.</span></span> <span data-ttu-id="9d5fc-219">只需指定项目文件，MSBuild 就会调用**FullPublish**目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-219">You can simply specify the project file, and MSBuild will invoke the **FullPublish** target for you.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample12.cmd)]

<span data-ttu-id="9d5fc-220">目标和任务都可以包括**条件**特性。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-220">Both targets and tasks can include **Condition** attributes.</span></span> <span data-ttu-id="9d5fc-221">因此，如果满足某些条件，则可以选择忽略整个目标或单个任务。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-221">As such, you can choose to omit entire targets or individual tasks if certain conditions are met.</span></span>

<span data-ttu-id="9d5fc-222">一般而言，在您创建有用的任务和目标时，您需要参考在项目文件中的其他位置定义的属性和项：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-222">Generally speaking, when you create useful tasks and targets, you'll need to refer to the properties and items that you've defined elsewhere in the project file:</span></span>

- <span data-ttu-id="9d5fc-223">若要使用属性值，请键入 **$ （***propertyname***）** ，其中*PropertyName*是**属性**元素的名称或参数的名称。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-223">To use a property value, type **$(***PropertyName***)**, where *PropertyName* is the name of the **Property** element or the name of the parameter.</span></span>
- <span data-ttu-id="9d5fc-224">若要使用某一项，请键入 **@ （** 项目名称） *，其中，* 项目名称是**item**元素的名称。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-224">To use an item, type **@(***ItemName***)**, where *ItemName* is the name of the **Item** element.</span></span>

> [!NOTE]
> <span data-ttu-id="9d5fc-225">请记住，如果你创建了多个具有相同名称的项，则会生成一个列表。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-225">Remember that if you create multiple items with the same name, you're building a list.</span></span> <span data-ttu-id="9d5fc-226">与此相反，如果您创建了多个具有相同名称的属性，则您提供的最后一个属性值将覆盖任何具有&#x2014;相同名称的以前的属性，属性只能包含单个值。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-226">In contrast, if you create multiple properties with the same name, the last property value you provide will overwrite any previous properties with the same name&#x2014;a property can only contain a single value.</span></span>

<span data-ttu-id="9d5fc-227">例如，在示例解决方案的*Publish*文件中，查看**BuildProjects**目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-227">For example, in the *Publish.proj* file in the sample solution, take a look at the **BuildProjects** target.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample13.xml)]

<span data-ttu-id="9d5fc-228">在此示例中，可以观察到以下要点：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-228">In this sample, you can observe these key points:</span></span>

- <span data-ttu-id="9d5fc-229">如果指定了**BuildingInTeamBuild**参数并且其值为**true**，则将不会执行此目标中的任何任务。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-229">If the **BuildingInTeamBuild** parameter is specified and has a value of **true**, none of the tasks within this target will be executed.</span></span>
- <span data-ttu-id="9d5fc-230">目标包含[MSBuild](https://msdn.microsoft.com/library/z7f65y0d.aspx)任务的单个实例。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-230">The target contains a single instance of the [MSBuild](https://msdn.microsoft.com/library/z7f65y0d.aspx) task.</span></span> <span data-ttu-id="9d5fc-231">此任务允许您生成其他 MSBuild 项目。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-231">This task lets you build other MSBuild projects.</span></span>
- <span data-ttu-id="9d5fc-232">**Buildsettings.projectstobuild**项将传递给任务。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-232">The **ProjectsToBuild** item is passed to the task.</span></span> <span data-ttu-id="9d5fc-233">此项可以表示项目或解决方案文件的列表，这些文件均由项组中的**buildsettings.projectstobuild**项元素定义。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-233">This item could represent a list of project or solution files, all defined by **ProjectsToBuild** item elements within an item group.</span></span> <span data-ttu-id="9d5fc-234">在这种情况下， **buildsettings.projectstobuild**项引用单个解决方案文件。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-234">In this case, the **ProjectsToBuild** item refers to a single solution file.</span></span>

    [!code-xml[Main](understanding-the-project-file/samples/sample14.xml)]
- <span data-ttu-id="9d5fc-235">传递给**MSBuild**任务的属性值包括名为**OutputRoot**和**Configuration**的参数。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-235">The property values passed to the **MSBuild** task include parameters named **OutputRoot** and **Configuration**.</span></span> <span data-ttu-id="9d5fc-236">如果提供了参数值，则将这些参数设置为参数值，如果不是，则设置静态属性值。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-236">These are set to parameter values if they are provided, or static property values if they are not.</span></span>

    [!code-xml[Main](understanding-the-project-file/samples/sample15.xml)]

<span data-ttu-id="9d5fc-237">你还可以看到**MSBuild**任务调用了一个名为 "**生成**" 的目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-237">You can also see that the **MSBuild** task invokes a target named **Build**.</span></span> <span data-ttu-id="9d5fc-238">这是在 Visual Studio 项目文件中广泛使用的几个内置目标之一，可在自定义项目文件中使用，如**生成**、**清理**、**重新生成**和**发布**。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-238">This is one of several built-in targets that are widely used in Visual Studio project files and are available to you in your custom project files, like **Build**, **Clean**, **Rebuild**, and **Publish**.</span></span> <span data-ttu-id="9d5fc-239">你将在本主题的后面部分了解如何使用目标和任务来控制生成过程，以及有关**MSBuild**任务的详细信息。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-239">You'll learn more about using targets and tasks to control the build process, and about the **MSBuild** task in particular, later in this topic.</span></span>

> [!NOTE]
> <span data-ttu-id="9d5fc-240">有关目标的详细信息，请参阅[MSBuild 目标](https://msdn.microsoft.com/library/ms171462.aspx)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-240">For more information on targets, see [MSBuild Targets](https://msdn.microsoft.com/library/ms171462.aspx).</span></span>

## <a name="splitting-project-files-to-support-multiple-environments"></a><span data-ttu-id="9d5fc-241">拆分项目文件以支持多个环境</span><span class="sxs-lookup"><span data-stu-id="9d5fc-241">Splitting Project Files to Support Multiple Environments</span></span>

<span data-ttu-id="9d5fc-242">假设您希望能够将解决方案部署到多个环境，如测试服务器、过渡平台和生产环境。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-242">Suppose you want to be able to deploy a solution to multiple environments, like test servers, staging platforms, and production environments.</span></span> <span data-ttu-id="9d5fc-243">此配置在这些环境&#x2014;之间的差异可能会明显不同于服务器名称、连接字符串等，但在凭据、安全设置和许多其他方面也可能有所不同。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-243">The configuration may vary substantially between these environments&#x2014;not just in terms of server names, connection strings, and so on, but also potentially in terms of credentials, security settings, and lots of other factors.</span></span> <span data-ttu-id="9d5fc-244">如果需要定期执行此操作，则每次切换目标环境时都无法在项目文件中编辑多个属性。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-244">If you need to do this regularly, it's not really expedient to edit multiple properties in your project file every time you switch the target environment.</span></span> <span data-ttu-id="9d5fc-245">它也是一个理想的解决方案，需要向生成过程提供属性值的无限列表。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-245">Nor is it an ideal solution to require an endless list of property values to be provided to the build process.</span></span>

<span data-ttu-id="9d5fc-246">幸运的是，有一种替代方法。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-246">Fortunately there is an alternative.</span></span> <span data-ttu-id="9d5fc-247">MSBuild 使你可以在多个项目文件之间拆分你的生成配置。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-247">MSBuild lets you split your build configuration across multiple project files.</span></span> <span data-ttu-id="9d5fc-248">若要查看其工作原理，请注意，在示例解决方案中，有两个自定义项目文件：</span><span class="sxs-lookup"><span data-stu-id="9d5fc-248">To see how this works, in the sample solution, notice that there are two custom project files:</span></span>

- <span data-ttu-id="9d5fc-249">*发布 proj*，其中包含所有环境通用的属性、项和目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-249">*Publish.proj*, which contains properties, items, and targets that are common to all environments.</span></span>
- <span data-ttu-id="9d5fc-250">*Env-Dev*，其中包含特定于开发人员环境的属性。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-250">*Env-Dev.proj*, which contains properties that are specific to a developer environment.</span></span>

<span data-ttu-id="9d5fc-251">现在请注意， *Publish*文件包含一个[Import](https://msdn.microsoft.com/library/92x05xfs.aspx)元素，紧靠在 "打开**项目**" 标记下。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-251">Now notice that the *Publish.proj* file includes an [Import](https://msdn.microsoft.com/library/92x05xfs.aspx) element, immediately beneath the opening **Project** tag.</span></span>

[!code-xml[Main](understanding-the-project-file/samples/sample16.xml)]

<span data-ttu-id="9d5fc-252">**Import**元素用于将另一个 msbuild 项目文件的内容导入到当前的 msbuild 项目文件中。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-252">The **Import** element is used to import the contents of another MSBuild project file into the current MSBuild project file.</span></span> <span data-ttu-id="9d5fc-253">在这种情况下， **TargetEnvPropsFile**参数提供您要导入的项目文件的文件名。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-253">In this case, the **TargetEnvPropsFile** parameter provides the filename of the project file you want to import.</span></span> <span data-ttu-id="9d5fc-254">在运行 MSBuild 时，可以为此参数提供一个值。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-254">You can provide a value for this parameter when you run MSBuild.</span></span>

[!code-console[Main](understanding-the-project-file/samples/sample17.cmd)]

<span data-ttu-id="9d5fc-255">这会有效地将两个文件的内容合并为一个项目文件。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-255">This effectively merges the contents of the two files into a single project file.</span></span> <span data-ttu-id="9d5fc-256">使用此方法，你可以创建一个项目文件，其中包含通用生成配置和多个包含特定于环境的属性的附加项目文件。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-256">Using this approach, you can create one project file containing your universal build configuration and multiple supplementary project files containing environment-specific properties.</span></span> <span data-ttu-id="9d5fc-257">因此，只需运行包含不同参数值的命令，就能将解决方案部署到不同的环境。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-257">As a result, simply running a command with a different parameter value lets you deploy your solution to a different environment.</span></span>

![](understanding-the-project-file/_static/image3.png)

<span data-ttu-id="9d5fc-258">以这种方式拆分项目文件是一种很好的做法。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-258">Splitting your project files in this way is a good practice to follow.</span></span> <span data-ttu-id="9d5fc-259">它允许开发人员通过运行单个命令部署到多个环境，同时避免跨多个项目文件复制通用生成属性。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-259">It allows developers to deploy to multiple environments by running a single command, while avoiding the duplication of universal build properties across multiple project files.</span></span>

> [!NOTE]
> <span data-ttu-id="9d5fc-260">有关如何为自己的服务器环境自定义特定于环境的项目文件的指南，请参阅[配置目标环境的部署属性](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md)。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-260">For guidance on how to customize the environment-specific project files for your own server environments, see [Configuring Deployment Properties for a Target Environment](../configuring-server-environments-for-web-deployment/configuring-deployment-properties-for-a-target-environment.md).</span></span>

## <a name="conclusion"></a><span data-ttu-id="9d5fc-261">结论</span><span class="sxs-lookup"><span data-stu-id="9d5fc-261">Conclusion</span></span>

<span data-ttu-id="9d5fc-262">本主题提供了对 MSBuild 项目文件的常规介绍，并介绍了如何创建自己的自定义项目文件来控制生成过程。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-262">This topic provided a general introduction to MSBuild project files and explained how you can create your own custom project files to control the build process.</span></span> <span data-ttu-id="9d5fc-263">它还引入了将项目文件拆分为通用生成指令和特定于环境的生成属性的概念，使你可以轻松地生成项目并将其部署到多个目标。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-263">It also introduced the concept of splitting project files into universal build instructions and environment-specific build properties, to make it easy to build and deploy projects to multiple destinations.</span></span>

<span data-ttu-id="9d5fc-264">下一主题 "[了解生成过程](understanding-the-build-process.md)" 将提供更多有关如何使用项目文件来控制生成和部署的详细信息，指导你逐步完成解决方案的部署。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-264">The next topic, [Understanding the Build Process](understanding-the-build-process.md), provides more insight into how you can use project files to control build and deployment by walking you through the deployment of a solution with a realistic level of complexity.</span></span>

## <a name="further-reading"></a><span data-ttu-id="9d5fc-265">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="9d5fc-265">Further Reading</span></span>

<span data-ttu-id="9d5fc-266">有关项目文件和 WPP 的更深入介绍，请参阅[Microsoft 生成引擎内部：使用 MSBuild 和 Team Foundation build](http://amzn.com/0735645248) By Sayed Ibrahim Hashimi 和 William BARTHOLOMEW，ISBN：978-0-7356-4524-0。</span><span class="sxs-lookup"><span data-stu-id="9d5fc-266">For a more in-depth introduction to project files and the WPP, see [Inside the Microsoft Build Engine: Using MSBuild and Team Foundation Build](http://amzn.com/0735645248) by Sayed Ibrahim Hashimi and William Bartholomew, ISBN: 978-0-7356-4524-0.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="9d5fc-267">[上一页](setting-up-the-contact-manager-solution.md)
> [下一页](understanding-the-build-process.md)</span><span class="sxs-lookup"><span data-stu-id="9d5fc-267">[Previous](setting-up-the-contact-manager-solution.md)
[Next](understanding-the-build-process.md)</span></span>

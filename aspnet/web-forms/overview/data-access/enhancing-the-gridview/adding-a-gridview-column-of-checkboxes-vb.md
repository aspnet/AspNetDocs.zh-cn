---
uid: web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
title: 添加 Checkbox 列（VB） |Microsoft Docs
author: rick-anderson
description: 本教程介绍如何向 GridView 控件添加复选框列，以便为用户提供一种直观的方法来选择 G 的多行 。
ms.author: riande
ms.date: 03/06/2007
ms.assetid: 39253d05-75c0-41c7-b9d4-a6c58ecf69ce
msc.legacyurl: /web-forms/overview/data-access/enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb
msc.type: authoredcontent
ms.openlocfilehash: c620b2eac5844d4030c1309b45e7d6a72d1f386a
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2019
ms.locfileid: "74592426"
---
# <a name="adding-a-gridview-column-of-checkboxes-vb"></a><span data-ttu-id="83fa9-103">添加 GridView 复选框列 (VB)</span><span class="sxs-lookup"><span data-stu-id="83fa9-103">Adding a GridView Column of Checkboxes (VB)</span></span>

<span data-ttu-id="83fa9-104">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="83fa9-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="83fa9-105">[下载示例应用](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe)或[下载 PDF](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="83fa9-105">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_52_VB.exe) or [Download PDF](adding-a-gridview-column-of-checkboxes-vb/_static/datatutorial52vb1.pdf)</span></span>

> <span data-ttu-id="83fa9-106">本教程介绍如何向 GridView 控件添加复选框列，以便为用户提供一种直观的方式来选择多个 GridView 行。</span><span class="sxs-lookup"><span data-stu-id="83fa9-106">This tutorial looks at how to add a column of check boxes to a GridView control to provide the user with an intuitive way of selecting multiple rows of the GridView.</span></span>

## <a name="introduction"></a><span data-ttu-id="83fa9-107">简介</span><span class="sxs-lookup"><span data-stu-id="83fa9-107">Introduction</span></span>

<span data-ttu-id="83fa9-108">在前面的教程中，我们介绍了如何将一列单选按钮添加到 GridView，以便选择特定记录。</span><span class="sxs-lookup"><span data-stu-id="83fa9-108">In the preceding tutorial we examined how to add a column of radio buttons to the GridView for the purpose of selecting a particular record.</span></span> <span data-ttu-id="83fa9-109">当用户限制为从网格中选择最多一个项时，单选按钮的列是合适的用户界面。</span><span class="sxs-lookup"><span data-stu-id="83fa9-109">A column of radio buttons is a suitable user interface when the user is limited to choosing at most one item from the grid.</span></span> <span data-ttu-id="83fa9-110">但有时，我们可能希望允许用户从网格中选取任意数量的项目。</span><span class="sxs-lookup"><span data-stu-id="83fa9-110">At times, however, we may want to allow the user to pick an arbitrary number of items from the grid.</span></span> <span data-ttu-id="83fa9-111">例如，基于 Web 的电子邮件客户端通常使用 checkbox 列显示消息列表。</span><span class="sxs-lookup"><span data-stu-id="83fa9-111">Web-based email clients, for example, typically display the list of messages with a column of checkboxes.</span></span> <span data-ttu-id="83fa9-112">用户可以选择任意数量的消息，然后执行一些操作，例如将电子邮件移动到另一个文件夹或将其删除。</span><span class="sxs-lookup"><span data-stu-id="83fa9-112">The user can select an arbitrary number of messages and then perform some action, such as moving the emails to another folder or deleting them.</span></span>

<span data-ttu-id="83fa9-113">在本教程中，我们将了解如何添加复选框列以及如何确定回发时检查了哪些复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-113">In this tutorial we will see how to add a column of checkboxes and how to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="83fa9-114">具体而言，我们将构建一个示例，用于充分模拟基于 web 的电子邮件客户端用户界面。</span><span class="sxs-lookup"><span data-stu-id="83fa9-114">In particular, we'll build an example that closely mimics the web-based email client user interface.</span></span> <span data-ttu-id="83fa9-115">本示例将包含一个分页的 GridView，其中列出了 `Products` 数据库表中的产品，每行包含一个复选框（请参阅图1）。</span><span class="sxs-lookup"><span data-stu-id="83fa9-115">Our example will include a paged GridView listing the products in the `Products` database table with a checkbox in each row (see Figure 1).</span></span> <span data-ttu-id="83fa9-116">单击 "删除所选产品" 按钮后，将删除所选产品。</span><span class="sxs-lookup"><span data-stu-id="83fa9-116">A Delete Selected Products button, when clicked, will delete those products selected.</span></span>

<span data-ttu-id="83fa9-117">[每个产品行 ![都包含一个复选框](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="83fa9-117">[![Each Product Row Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image1.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image1.png)</span></span>

<span data-ttu-id="83fa9-118">**图 1**：每个产品行都包含一个复选框（[单击查看完全大小的图像](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png)）</span><span class="sxs-lookup"><span data-stu-id="83fa9-118">**Figure 1**: Each Product Row Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image2.png))</span></span>

## <a name="step-1-adding-a-paged-gridview-that-lists-product-information"></a><span data-ttu-id="83fa9-119">步骤1：添加列出产品信息的分页 GridView</span><span class="sxs-lookup"><span data-stu-id="83fa9-119">Step 1: Adding a Paged GridView that Lists Product Information</span></span>

<span data-ttu-id="83fa9-120">在考虑如何添加 checkbox 列之前，首先要重点介绍支持分页的 GridView 中的产品。</span><span class="sxs-lookup"><span data-stu-id="83fa9-120">Before we worry about adding a column of checkboxes, let s first focus on listing the products in a GridView that supports paging.</span></span> <span data-ttu-id="83fa9-121">首先打开 `EnhancedGridView` 文件夹中的 "`CheckBoxField.aspx`" 页，然后从 "工具箱" 中将一个 GridView 拖到设计器上，将其 `ID` 设置为 "`Products`"。</span><span class="sxs-lookup"><span data-stu-id="83fa9-121">Start by opening the `CheckBoxField.aspx` page in the `EnhancedGridView` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` to `Products`.</span></span> <span data-ttu-id="83fa9-122">接下来，选择将 GridView 绑定到名为 `ProductsDataSource`的新 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="83fa9-122">Next, choose to bind the GridView to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="83fa9-123">将 ObjectDataSource 配置为使用 `ProductsBLL` 类，调用 `GetProducts()` 方法返回数据。</span><span class="sxs-lookup"><span data-stu-id="83fa9-123">Configure the ObjectDataSource to use the `ProductsBLL` class, calling the `GetProducts()` method to return the data.</span></span> <span data-ttu-id="83fa9-124">由于此 GridView 将是只读的，因此请将 "更新"、"插入" 和 "删除" 选项卡中的下拉列表设置为 "（无）"。</span><span class="sxs-lookup"><span data-stu-id="83fa9-124">Since this GridView will be read-only, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="83fa9-125">[![创建一个名为 ProductsDataSource 的新 ObjectDataSource](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="83fa9-125">[![Create a New ObjectDataSource Named ProductsDataSource](adding-a-gridview-column-of-checkboxes-vb/_static/image2.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image3.png)</span></span>

<span data-ttu-id="83fa9-126">**图 2**：创建名为 `ProductsDataSource` 的新 ObjectDataSource （[单击以查看完全大小的映像](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png)）</span><span class="sxs-lookup"><span data-stu-id="83fa9-126">**Figure 2**: Create a New ObjectDataSource Named `ProductsDataSource` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image4.png))</span></span>

<span data-ttu-id="83fa9-127">[![使用 GetProducts （）方法配置 ObjectDataSource 以检索数据](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="83fa9-127">[![Configure the ObjectDataSource to Retrieve Data Using the GetProducts() Method](adding-a-gridview-column-of-checkboxes-vb/_static/image3.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image5.png)</span></span>

<span data-ttu-id="83fa9-128">**图 3**：使用 `GetProducts()` 方法配置 ObjectDataSource 以检索数据（[单击以查看完全大小的映像](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="83fa9-128">**Figure 3**: Configure the ObjectDataSource to Retrieve Data Using the `GetProducts()` Method ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image6.png))</span></span>

<span data-ttu-id="83fa9-129">[![在 "更新"、"插入" 和 "删除" 选项卡中将下拉列表设置为 "（无）"](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="83fa9-129">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](adding-a-gridview-column-of-checkboxes-vb/_static/image4.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image7.png)</span></span>

<span data-ttu-id="83fa9-130">**图 4**：将 "更新"、"插入" 和 "删除" 选项卡中的下拉列表设置为 "（无）" （[单击查看完全大小的映像](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png)）</span><span class="sxs-lookup"><span data-stu-id="83fa9-130">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image8.png))</span></span>

<span data-ttu-id="83fa9-131">完成 "配置数据源" 向导后，Visual Studio 将自动创建 BoundColumns，并为与产品相关的数据字段创建一个 CheckBoxColumn。</span><span class="sxs-lookup"><span data-stu-id="83fa9-131">After completing the Configure Data Source wizard, Visual Studio will automatically create BoundColumns and a CheckBoxColumn for the product-related data fields.</span></span> <span data-ttu-id="83fa9-132">与上一教程中的操作相同，请删除除 `ProductName`、`CategoryName`和 `UnitPrice` BoundFields 的所有操作，并将 `HeaderText` 属性更改为 "产品"、"类别" 和 "价格"。</span><span class="sxs-lookup"><span data-stu-id="83fa9-132">Like we did in the previous tutorial, remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields, and change the `HeaderText` properties to Product, Category, and Price.</span></span> <span data-ttu-id="83fa9-133">配置 `UnitPrice` BoundField，以便将其值设置为货币格式。</span><span class="sxs-lookup"><span data-stu-id="83fa9-133">Configure the `UnitPrice` BoundField so that its value is formatted as a currency.</span></span> <span data-ttu-id="83fa9-134">此外，通过选中智能标记中的 "启用分页" 复选框，将 GridView 配置为支持分页。</span><span class="sxs-lookup"><span data-stu-id="83fa9-134">Also configure the GridView to support paging by checking the Enable Paging checkbox from the smart tag.</span></span>

<span data-ttu-id="83fa9-135">同时，还可以添加用于删除所选产品的用户界面。</span><span class="sxs-lookup"><span data-stu-id="83fa9-135">Let s also add the user interface for deleting the selected products.</span></span> <span data-ttu-id="83fa9-136">将按钮 Web 控件添加到 GridView 下，并将其 `ID` 设置为 `DeleteSelectedProducts` 及其 `Text` 属性以删除所选产品。</span><span class="sxs-lookup"><span data-stu-id="83fa9-136">Add a Button Web control beneath the GridView, setting its `ID` to `DeleteSelectedProducts` and its `Text` property to Delete Selected Products.</span></span> <span data-ttu-id="83fa9-137">在此示例中，我们只会显示一条消息，指出已删除的产品，而不是从数据库中实际删除产品。</span><span class="sxs-lookup"><span data-stu-id="83fa9-137">Rather than actually deleting products from the database, for this example we'll just display a message stating the products that would have been deleted.</span></span> <span data-ttu-id="83fa9-138">为此，请在按钮的下面添加一个 "标签" Web 控件。</span><span class="sxs-lookup"><span data-stu-id="83fa9-138">To accommodate this, add a Label Web control beneath the Button.</span></span> <span data-ttu-id="83fa9-139">将其 ID 设置为 `DeleteResults`，清除其 `Text` 属性，并将其 `Visible` 和 `EnableViewState` 属性设置为 `False`。</span><span class="sxs-lookup"><span data-stu-id="83fa9-139">Set its ID to `DeleteResults`, clear out its `Text` property, and set its `Visible` and `EnableViewState` properties to `False`.</span></span>

<span data-ttu-id="83fa9-140">进行这些更改后，GridView、ObjectDataSource、按钮和标签的声明性标记应类似于以下内容：</span><span class="sxs-lookup"><span data-stu-id="83fa9-140">After making these changes, the GridView, ObjectDataSource, Button, and Label s declarative markup should similar to the following:</span></span>

[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample1.aspx)]

<span data-ttu-id="83fa9-141">请花点时间查看浏览器中的页面（见图5）。</span><span class="sxs-lookup"><span data-stu-id="83fa9-141">Take a moment to view the page in a browser (see Figure 5).</span></span> <span data-ttu-id="83fa9-142">此时，应会看到前十种产品的名称、类别和价格。</span><span class="sxs-lookup"><span data-stu-id="83fa9-142">At this point you should see the name, category, and price of the first ten products.</span></span>

<span data-ttu-id="83fa9-143">[![列出了前十个产品的名称、类别和价格](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="83fa9-143">[![The Name, Category, and Price of the First Ten Products are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image5.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image9.png)</span></span>

<span data-ttu-id="83fa9-144">**图 5**：列出了前十个产品的名称、类别和价格（[单击查看全尺寸图像](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="83fa9-144">**Figure 5**: The Name, Category, and Price of the First Ten Products are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image10.png))</span></span>

## <a name="step-2-adding-a-column-of-checkboxes"></a><span data-ttu-id="83fa9-145">步骤2：添加复选框的列</span><span class="sxs-lookup"><span data-stu-id="83fa9-145">Step 2: Adding a Column of Checkboxes</span></span>

<span data-ttu-id="83fa9-146">由于 ASP.NET 2.0 包含一个 CheckBoxField，因此可能会认为它可以用于向 GridView 添加复选框的列。</span><span class="sxs-lookup"><span data-stu-id="83fa9-146">Since ASP.NET 2.0 includes a CheckBoxField, one might think that it could be used to add a column of checkboxes to a GridView.</span></span> <span data-ttu-id="83fa9-147">遗憾的是，这种情况并非如此，因为 CheckBoxField 的设计目的是使用布尔数据字段。</span><span class="sxs-lookup"><span data-stu-id="83fa9-147">Unfortunately, that is not the case, as the CheckBoxField is designed to work with a Boolean data field.</span></span> <span data-ttu-id="83fa9-148">也就是说，若要使用 CheckBoxField，必须指定基础数据字段，该字段的值将用于确定是否选中了呈现的复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-148">That is, in order to use the CheckBoxField we must specify the underlying data field whose value is consulted to determine whether the rendered checkbox is checked.</span></span> <span data-ttu-id="83fa9-149">不能使用 CheckBoxField 来只包含一列未选中的复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-149">We cannot use the CheckBoxField to just include a column of unchecked checkboxes.</span></span>

<span data-ttu-id="83fa9-150">相反，我们必须添加 TemplateField，并将复选框 Web 控件添加到其 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="83fa9-150">Instead, we must add a TemplateField and add a CheckBox Web control to its `ItemTemplate`.</span></span> <span data-ttu-id="83fa9-151">继续并将 TemplateField 添加到 `Products` GridView，并使其成为第一个（最左侧）字段。</span><span class="sxs-lookup"><span data-stu-id="83fa9-151">Go ahead and add a TemplateField to the `Products` GridView and make it the first (far-left) field.</span></span> <span data-ttu-id="83fa9-152">从 GridView s 智能标记中，单击 "编辑模板" 链接，然后将 "复选框" Web 控件从工具箱拖动到 `ItemTemplate`中。</span><span class="sxs-lookup"><span data-stu-id="83fa9-152">From the GridView s smart tag, click on the Edit Templates link and then drag a CheckBox Web control from the Toolbox into the `ItemTemplate`.</span></span> <span data-ttu-id="83fa9-153">将此复选框 `ID` 属性设置为 `ProductSelector`。</span><span class="sxs-lookup"><span data-stu-id="83fa9-153">Set this CheckBox s `ID` property to `ProductSelector`.</span></span>

<span data-ttu-id="83fa9-154">[![将名为 ProductSelector 的复选框 Web 控件添加到 TemplateField s ItemTemplate](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="83fa9-154">[![Add a CheckBox Web Control Named ProductSelector to the TemplateField s ItemTemplate](adding-a-gridview-column-of-checkboxes-vb/_static/image6.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image11.png)</span></span>

<span data-ttu-id="83fa9-155">**图 6**：将名为 `ProductSelector` 的复选框 Web 控件添加到 TemplateField s `ItemTemplate` （[单击查看完全大小的图像](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="83fa9-155">**Figure 6**: Add a CheckBox Web Control Named `ProductSelector` to the TemplateField s `ItemTemplate` ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image12.png))</span></span>

<span data-ttu-id="83fa9-156">添加 TemplateField 和 CheckBox Web 控件后，每行现在都包含一个复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-156">With the TemplateField and CheckBox Web control added, each row now includes a checkbox.</span></span> <span data-ttu-id="83fa9-157">图7显示了在浏览器中查看 TemplateField 和 CheckBox 后的此页。</span><span class="sxs-lookup"><span data-stu-id="83fa9-157">Figure 7 shows this page, when viewed through a browser, after the TemplateField and CheckBox have been added.</span></span>

<span data-ttu-id="83fa9-158">[每个产品行 ![现在包含一个复选框](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="83fa9-158">[![Each Product Row Now Includes a Checkbox](adding-a-gridview-column-of-checkboxes-vb/_static/image7.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image13.png)</span></span>

<span data-ttu-id="83fa9-159">**图 7**：每个产品行现在都包含一个复选框（[单击查看完全尺寸的图像](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png)）</span><span class="sxs-lookup"><span data-stu-id="83fa9-159">**Figure 7**: Each Product Row Now Includes a Checkbox ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image14.png))</span></span>

## <a name="step-3-determining-what-checkboxes-were-checked-on-postback"></a><span data-ttu-id="83fa9-160">步骤3：确定回发时检查了哪些复选框</span><span class="sxs-lookup"><span data-stu-id="83fa9-160">Step 3: Determining What Checkboxes Were Checked On Postback</span></span>

<span data-ttu-id="83fa9-161">此时，我们有一列复选框，但无法确定回发时检查了哪些复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-161">At this point we have a column of checkboxes but no way to determine what checkboxes were checked on postback.</span></span> <span data-ttu-id="83fa9-162">但是，当单击 "删除所选产品" 按钮时，我们需要知道选中了哪些复选框，才能删除这些产品。</span><span class="sxs-lookup"><span data-stu-id="83fa9-162">When the Delete Selected Products button is clicked, though, we need to know what checkboxes were checked in order to delete those products.</span></span>

<span data-ttu-id="83fa9-163">GridView s [`Rows` 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx)提供对 gridview 中的数据行的访问权限。</span><span class="sxs-lookup"><span data-stu-id="83fa9-163">The GridView s [`Rows` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview.rows.aspx) provides access to the data rows in the GridView.</span></span> <span data-ttu-id="83fa9-164">我们可以循环访问这些行，以编程方式访问 CheckBox 控件，然后查阅其 `Checked` 属性以确定复选框是否已选中。</span><span class="sxs-lookup"><span data-stu-id="83fa9-164">We can iterate through these rows, programmatically access the CheckBox control, and then consult its `Checked` property to determine whether the CheckBox has been selected.</span></span>

<span data-ttu-id="83fa9-165">为 `DeleteSelectedProducts` 按钮 Web 控件 `Click` 事件创建事件处理程序，并添加以下代码：</span><span class="sxs-lookup"><span data-stu-id="83fa9-165">Create an event handler for the `DeleteSelectedProducts` Button Web control s `Click` event and add the following code:</span></span>

[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample2.vb)]

<span data-ttu-id="83fa9-166">`Rows` 属性返回构成 GridView 数据行的 `GridViewRow` 实例的集合。</span><span class="sxs-lookup"><span data-stu-id="83fa9-166">The `Rows` property returns a collection of `GridViewRow` instances that makeup the GridView s data rows.</span></span> <span data-ttu-id="83fa9-167">此处的 `For Each` 循环枚举此集合。</span><span class="sxs-lookup"><span data-stu-id="83fa9-167">The `For Each` loop here enumerates this collection.</span></span> <span data-ttu-id="83fa9-168">对于每个 `GridViewRow` 对象，均使用 `row.FindControl("controlID")`以编程方式访问第 s 行复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-168">For each `GridViewRow` object, the row s CheckBox is programmatically accessed using `row.FindControl("controlID")`.</span></span> <span data-ttu-id="83fa9-169">如果选中该复选框，则将从 `DataKeys` 集合中检索对应的行 `ProductID` 值。</span><span class="sxs-lookup"><span data-stu-id="83fa9-169">If the CheckBox is checked, the row s corresponding `ProductID` value is retrieved from the `DataKeys` collection.</span></span> <span data-ttu-id="83fa9-170">在此练习中，我们只是在 "`DeleteResults`" 标签中显示一条信息性消息，但在运行的应用程序中，我们将改为调用 `ProductsBLL` class s `DeleteProduct(productID)` 方法。</span><span class="sxs-lookup"><span data-stu-id="83fa9-170">In this exercise, we simply display an informative message in the `DeleteResults` Label, although in a working application we d instead make a call to the `ProductsBLL` class s `DeleteProduct(productID)` method.</span></span>

<span data-ttu-id="83fa9-171">添加此事件处理程序后，单击 "删除所选产品" 按钮，此时将显示选定产品的 `ProductID`。</span><span class="sxs-lookup"><span data-stu-id="83fa9-171">With the addition of this event handler, clicking the Delete Selected Products button now displays the `ProductID` s of the selected products.</span></span>

<span data-ttu-id="83fa9-172">[![当单击 "删除所选产品" 按钮时，将列出所选产品 Productid](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="83fa9-172">[![When the Delete Selected Products Button is Clicked the Selected Products ProductIDs are Listed](adding-a-gridview-column-of-checkboxes-vb/_static/image8.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image15.png)</span></span>

<span data-ttu-id="83fa9-173">**图 8**：单击 "删除所选产品" 按钮后，将列出 `ProductID` 的所选产品（[单击查看完全大小的图像](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png)）</span><span class="sxs-lookup"><span data-stu-id="83fa9-173">**Figure 8**: When the Delete Selected Products Button is Clicked the Selected Products `ProductID` s are Listed ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image16.png))</span></span>

## <a name="step-4-adding-check-all-and-uncheck-all-buttons"></a><span data-ttu-id="83fa9-174">步骤4：添加全部检查并取消选中所有按钮</span><span class="sxs-lookup"><span data-stu-id="83fa9-174">Step 4: Adding Check All and Uncheck All Buttons</span></span>

<span data-ttu-id="83fa9-175">如果用户想要删除当前页面上的所有产品，则必须选中十个复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-175">If a user wants to delete all products on the current page, they must check each of the ten checkboxes.</span></span> <span data-ttu-id="83fa9-176">通过添加 "全部选中" 按钮，可帮助加速此过程，在单击该按钮时，将选择网格中的所有复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-176">We can help expedite this process by adding a Check All button that, when clicked, selects all of the checkboxes in the grid.</span></span> <span data-ttu-id="83fa9-177">"全部取消选中" 按钮将同样有用。</span><span class="sxs-lookup"><span data-stu-id="83fa9-177">An Uncheck All button would be equally helpful.</span></span>

<span data-ttu-id="83fa9-178">将两个按钮 Web 控件添加到页面，并将其放置在 GridView 之上。</span><span class="sxs-lookup"><span data-stu-id="83fa9-178">Add two Button Web controls to the page, placing them above the GridView.</span></span> <span data-ttu-id="83fa9-179">将第一个 `ID` 设置为 `CheckAll`，并将其 `Text` 属性设置为 "全部检查";将第二个 `ID` 设置为 `UncheckAll`，并将其 `Text` 属性设置为 "全部取消选中"。</span><span class="sxs-lookup"><span data-stu-id="83fa9-179">Set the first one s `ID` to `CheckAll` and its `Text` property to Check All ; set the second one s `ID` to `UncheckAll` and its `Text` property to Uncheck All .</span></span>

[!code-aspx[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample3.aspx)]

<span data-ttu-id="83fa9-180">接下来，在名为 `ToggleCheckState(checkState)` 的代码隐藏类中创建一个方法，该方法在调用时枚举 `Products` GridView s `Rows` 集合，并将每个 CheckBox 的 `Checked` 属性设置为传入*checkState*参数的值。</span><span class="sxs-lookup"><span data-stu-id="83fa9-180">Next, create a method in the code-behind class named `ToggleCheckState(checkState)` that, when invoked, enumerates the `Products` GridView s `Rows` collection and sets each CheckBox s `Checked` property to the value of the passed in *checkState* parameter.</span></span>

[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample4.vb)]

<span data-ttu-id="83fa9-181">接下来，为 `CheckAll` 和 `UncheckAll` 按钮创建 `Click` 事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="83fa9-181">Next, create `Click` event handlers for the `CheckAll` and `UncheckAll` buttons.</span></span> <span data-ttu-id="83fa9-182">在 `CheckAll` s 事件处理程序中，只需调用 `ToggleCheckState(True)`;在 `UncheckAll`中，调用 `ToggleCheckState(False)`。</span><span class="sxs-lookup"><span data-stu-id="83fa9-182">In `CheckAll` s event handler, simply call `ToggleCheckState(True)`; in `UncheckAll`, call `ToggleCheckState(False)`.</span></span>

[!code-vb[Main](adding-a-gridview-column-of-checkboxes-vb/samples/sample5.vb)]

<span data-ttu-id="83fa9-183">使用此代码时，单击 "全部选中" 按钮会导致回发并检查 GridView 中的所有复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-183">With this code, clicking the Check All button causes a postback and checks all of the checkboxes in the GridView.</span></span> <span data-ttu-id="83fa9-184">同样，单击 "取消选中所有" 会取消选中所有复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-184">Likewise, clicking Uncheck All unselects all checkboxes.</span></span> <span data-ttu-id="83fa9-185">图9显示选中 "全部选中" 按钮后的屏幕。</span><span class="sxs-lookup"><span data-stu-id="83fa9-185">Figure 9 shows the screen after the Check All button has been checked.</span></span>

<span data-ttu-id="83fa9-186">[![单击 "全部选中" 按钮将选中所有复选框](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="83fa9-186">[![Clicking the Check All Button Selects All Checkboxes](adding-a-gridview-column-of-checkboxes-vb/_static/image9.gif)](adding-a-gridview-column-of-checkboxes-vb/_static/image17.png)</span></span>

<span data-ttu-id="83fa9-187">**图 9**：单击 "全部选中" 按钮将选中所有复选框（[单击查看完全尺寸的图像](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="83fa9-187">**Figure 9**: Clicking the Check All Button Selects All Checkboxes ([Click to view full-size image](adding-a-gridview-column-of-checkboxes-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="83fa9-188">显示复选框列时，选择或取消选择所有复选框的一种方法是通过标题行中的复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-188">When displaying a column of checkboxes, one approach for selecting or unselecting all of the checkboxes is through a checkbox in the header row.</span></span> <span data-ttu-id="83fa9-189">而且，当前的 "全部检查"/"取消选中" 所有实现都需要回发。</span><span class="sxs-lookup"><span data-stu-id="83fa9-189">Moreover, the current Check All / Uncheck All implementation requires a postback.</span></span> <span data-ttu-id="83fa9-190">不过，可以通过客户端脚本完全选中或取消选中这些复选框，从而提供快捷的用户体验。</span><span class="sxs-lookup"><span data-stu-id="83fa9-190">The checkboxes can be checked or unchecked, however, entirely through client-side script, thereby providing a snappier user experience.</span></span> <span data-ttu-id="83fa9-191">若要浏览 "全部选中并取消选中所有内容" 复选框，以及有关使用客户端技术的讨论，请参阅[使用客户端脚本检查 GridView 中的所有复选框和 "全部选中](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx)" 复选框。</span><span class="sxs-lookup"><span data-stu-id="83fa9-191">To explore using a header row checkbox for Check All and Uncheck All in detail, along with a discussion on using client-side techniques, check out [Checking All CheckBoxes in a GridView Using Client-Side Script and a Check All CheckBox](http://aspnet.4guysfromrolla.com/articles/053106-1.aspx).</span></span>

## <a name="summary"></a><span data-ttu-id="83fa9-192">总结</span><span class="sxs-lookup"><span data-stu-id="83fa9-192">Summary</span></span>

<span data-ttu-id="83fa9-193">如果需要让用户在继续操作之前从 GridView 中选择任意数量的行，则添加一个 checkbox 列就是一个选项。</span><span class="sxs-lookup"><span data-stu-id="83fa9-193">In cases where you need to let users choose an arbitrary number of rows from a GridView before proceeding, adding a column of checkboxes is one option.</span></span> <span data-ttu-id="83fa9-194">正如我们在本教程中看到的那样，在 GridView 中包含一列复选框，这需要使用 CheckBox Web 控件添加 TemplateField。</span><span class="sxs-lookup"><span data-stu-id="83fa9-194">As we saw in this tutorial, including a column of checkboxes in the GridView entails adding a TemplateField with a CheckBox Web control.</span></span> <span data-ttu-id="83fa9-195">通过使用 Web 控件（与在模板中直接注入模板中的操作一样），ASP.NET 会自动记住哪些复选框，且未在回发中检查。</span><span class="sxs-lookup"><span data-stu-id="83fa9-195">By using a Web control (versus injecting markup directly into the template, as we did in the previous tutorial) ASP.NET automatically remembers what CheckBoxes were and were not checked across postback.</span></span> <span data-ttu-id="83fa9-196">我们还可以通过编程方式访问代码中的复选框，以确定是否选中了给定的复选框，或更改选中的状态。</span><span class="sxs-lookup"><span data-stu-id="83fa9-196">We can also programmatically access the CheckBoxes in code to determine whether a given CheckBox is checked, or to change the checked state.</span></span>

<span data-ttu-id="83fa9-197">本教程和最后一个教程介绍了如何向 GridView 添加行选择器列。</span><span class="sxs-lookup"><span data-stu-id="83fa9-197">This tutorial and the last one looked at adding a row selector column to the GridView.</span></span> <span data-ttu-id="83fa9-198">在下一教程中，我们将检查如何在多个工作中添加插入功能。</span><span class="sxs-lookup"><span data-stu-id="83fa9-198">In our next tutorial we'll examine how, with a bit of work, we can add inserting capabilities to the GridView.</span></span>

<span data-ttu-id="83fa9-199">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="83fa9-199">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="83fa9-200">关于作者</span><span class="sxs-lookup"><span data-stu-id="83fa9-200">About the Author</span></span>

<span data-ttu-id="83fa9-201">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，创始人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已在使用 Microsoft Web 技术，自1998开始。</span><span class="sxs-lookup"><span data-stu-id="83fa9-201">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="83fa9-202">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="83fa9-202">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="83fa9-203">他的最新书籍是，[*在24小时内，sam ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="83fa9-203">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="83fa9-204">可以[mitchell@4GuysFromRolla.com访问。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="83fa9-204">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="83fa9-205">或通过他的博客，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="83fa9-205">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="83fa9-206">[上一页](adding-a-gridview-column-of-radio-buttons-vb.md)
> [下一页](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span><span class="sxs-lookup"><span data-stu-id="83fa9-206">[Previous](adding-a-gridview-column-of-radio-buttons-vb.md)
[Next](inserting-a-new-record-from-the-gridview-s-footer-vb.md)</span></span>

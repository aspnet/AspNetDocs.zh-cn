---
uid: web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
title: 用 ObjectDataSource 缓存数据（VB） |Microsoft Docs
author: rick-anderson
description: 缓存可以表示慢速 Web 应用程序和快速 Web 应用程序之间的差异。 本教程是第四个教程，详细了解 ASP.NET 中的缓存 。
ms.author: riande
ms.date: 05/30/2007
ms.assetid: 2e56a733-5512-48a6-9276-70a65bbe4d5d
msc.legacyurl: /web-forms/overview/data-access/caching-data/caching-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 16f20d9a0f4f677073174d680418b278dba40b07
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2019
ms.locfileid: "74612261"
---
# <a name="caching-data-with-the-objectdatasource-vb"></a><span data-ttu-id="60a7b-104">使用 ObjectDataSource 缓存数据 (VB)</span><span class="sxs-lookup"><span data-stu-id="60a7b-104">Caching Data with the ObjectDataSource (VB)</span></span>

<span data-ttu-id="60a7b-105">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="60a7b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="60a7b-106">[下载示例应用](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe)或[下载 PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="60a7b-106">[Download Sample App](https://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_58_VB.exe) or [Download PDF](caching-data-with-the-objectdatasource-vb/_static/datatutorial58vb1.pdf)</span></span>

> <span data-ttu-id="60a7b-107">缓存可以表示慢速 Web 应用程序和快速 Web 应用程序之间的差异。</span><span class="sxs-lookup"><span data-stu-id="60a7b-107">Caching can mean the difference between a slow and a fast Web application.</span></span> <span data-ttu-id="60a7b-108">本教程是在 ASP.NET 中详细了解缓存的第四个教程。</span><span class="sxs-lookup"><span data-stu-id="60a7b-108">This tutorial is the first of four that take a detailed look at caching in ASP.NET.</span></span> <span data-ttu-id="60a7b-109">了解缓存的关键概念，以及如何通过 ObjectDataSource 控件将缓存应用到表示层。</span><span class="sxs-lookup"><span data-stu-id="60a7b-109">Learn the key concepts of caching and how to apply caching to the Presentation Layer through the ObjectDataSource control.</span></span>

## <a name="introduction"></a><span data-ttu-id="60a7b-110">简介</span><span class="sxs-lookup"><span data-stu-id="60a7b-110">Introduction</span></span>

<span data-ttu-id="60a7b-111">在计算机科学中，*缓存*是指获取数据或信息的过程，这些数据或信息在访问速度更快的位置获取并存储其副本的费用很高。</span><span class="sxs-lookup"><span data-stu-id="60a7b-111">In computer science, *caching* is the process of taking data or information that is expensive to obtain and storing a copy of it in a location that is quicker to access.</span></span> <span data-ttu-id="60a7b-112">对于数据驱动的应用程序，大型和复杂的查询通常会消耗应用程序的大部分执行时间。</span><span class="sxs-lookup"><span data-stu-id="60a7b-112">For data-driven applications, large and complex queries commonly consume the majority of the application s execution time.</span></span> <span data-ttu-id="60a7b-113">这样，应用程序的性能通常可以通过将昂贵的数据库查询结果存储在内存中来提高性能。</span><span class="sxs-lookup"><span data-stu-id="60a7b-113">Such an application s performance, then, can often be improved by storing the results of expensive database queries in the application s memory.</span></span>

<span data-ttu-id="60a7b-114">ASP.NET 2.0 提供各种缓存选项。</span><span class="sxs-lookup"><span data-stu-id="60a7b-114">ASP.NET 2.0 offers a variety of caching options.</span></span> <span data-ttu-id="60a7b-115">可以通过*输出缓存*来缓存整个网页或用户控件的呈现的标记。</span><span class="sxs-lookup"><span data-stu-id="60a7b-115">An entire web page or User Control s rendered markup can be cached through *output caching*.</span></span> <span data-ttu-id="60a7b-116">ObjectDataSource 和 SqlDataSource 控件也提供了缓存功能，从而允许在控件级别缓存数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-116">The ObjectDataSource and SqlDataSource controls provide caching capabilities as well, thereby allowing data to be cached at the control level.</span></span> <span data-ttu-id="60a7b-117">和 ASP.NET 的*数据缓存*提供丰富的缓存 API，使页面开发人员能够以编程方式缓存对象。</span><span class="sxs-lookup"><span data-stu-id="60a7b-117">And ASP.NET s *data cache* provides a rich caching API that enables page developers to programmatically cache objects.</span></span> <span data-ttu-id="60a7b-118">在本教程和接下来的三个教程中，我们将使用 ObjectDataSource 的缓存功能以及数据缓存来进行检查。</span><span class="sxs-lookup"><span data-stu-id="60a7b-118">In this tutorial and the next three we'll examine using the ObjectDataSource s caching features as well as the data cache.</span></span> <span data-ttu-id="60a7b-119">我们还将探讨如何在启动时缓存应用程序范围内的数据，以及如何通过使用 SQL 缓存依赖项使缓存数据保持最新。</span><span class="sxs-lookup"><span data-stu-id="60a7b-119">We'll also explore how to cache application-wide data at startup and how to keep cached data fresh through the use of SQL cache dependencies.</span></span> <span data-ttu-id="60a7b-120">这些教程不会浏览输出缓存。</span><span class="sxs-lookup"><span data-stu-id="60a7b-120">These tutorials do not explore output caching.</span></span> <span data-ttu-id="60a7b-121">有关输出缓存的详细信息，请参阅[ASP.NET 2.0 中的输出缓存](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="60a7b-121">For a detailed look at output caching, see [Output Caching in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx).</span></span>

<span data-ttu-id="60a7b-122">可以在体系结构中的任何位置应用缓存，从数据访问层到表示层。</span><span class="sxs-lookup"><span data-stu-id="60a7b-122">Caching can be applied at any place in the architecture, from the Data Access Layer up through the Presentation Layer.</span></span> <span data-ttu-id="60a7b-123">在本教程中，我们将介绍如何通过 ObjectDataSource 控件将缓存应用到表示层。</span><span class="sxs-lookup"><span data-stu-id="60a7b-123">In this tutorial we'll look at applying caching to the Presentation Layer through the ObjectDataSource control.</span></span> <span data-ttu-id="60a7b-124">在下一教程中，我们将检查业务逻辑层的缓存数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-124">In the next tutorial we'll examine caching data at the Business Logic Layer.</span></span>

## <a name="key-caching-concepts"></a><span data-ttu-id="60a7b-125">关键缓存概念</span><span class="sxs-lookup"><span data-stu-id="60a7b-125">Key Caching Concepts</span></span>

<span data-ttu-id="60a7b-126">缓存可以通过在可更有效地访问的位置获取大量数据，从而极大地提高应用程序的整体性能和可伸缩性。</span><span class="sxs-lookup"><span data-stu-id="60a7b-126">Caching can greatly improve an application s overall performance and scalability by taking data that is expensive to generate and storing a copy of it in a location that can be more efficiently accessed.</span></span> <span data-ttu-id="60a7b-127">由于缓存只包含实际的基础数据的副本，因此，如果基础数据发生更改，它可能会过时或*过时*。</span><span class="sxs-lookup"><span data-stu-id="60a7b-127">Since the cache holds just a copy of the actual, underlying data, it can become outdated, or *stale*, if the underlying data changes.</span></span> <span data-ttu-id="60a7b-128">若要对付这一点，页面开发人员可以使用以下任一方法来指示缓存项将从缓存中*逐出*的条件：</span><span class="sxs-lookup"><span data-stu-id="60a7b-128">To combat this, a page developer can indicate criteria by which the cache item will be *evicted* from the cache, using either:</span></span>

- <span data-ttu-id="60a7b-129">**基于时间的条件**可以将项添加到缓存中，以获得绝对或可调的持续时间。</span><span class="sxs-lookup"><span data-stu-id="60a7b-129">**Time-based criteria** an item may be added to the cache for an absolute or sliding duration.</span></span> <span data-ttu-id="60a7b-130">例如，页开发人员可能会指示持续时间为60秒。</span><span class="sxs-lookup"><span data-stu-id="60a7b-130">For example, a page developer may indicate a duration of, say, 60 seconds.</span></span> <span data-ttu-id="60a7b-131">对于绝对持续时间，在将缓存项添加到缓存后，将其逐出60秒，而不考虑访问它的频率。</span><span class="sxs-lookup"><span data-stu-id="60a7b-131">With an absolute duration, the cached item is evicted 60 seconds after it was added to cache, regardless of how frequently it was accessed.</span></span> <span data-ttu-id="60a7b-132">使用滑动持续时间时，将在上次访问后的60秒内逐出缓存的项。</span><span class="sxs-lookup"><span data-stu-id="60a7b-132">With a sliding duration, the cached item is evicted 60 seconds after the last access.</span></span>
- <span data-ttu-id="60a7b-133">**基于依赖项的条件：** 依赖项在添加到缓存时可与项关联。</span><span class="sxs-lookup"><span data-stu-id="60a7b-133">**Dependency-based criteria** a dependency can be associated with an item when added to the cache.</span></span> <span data-ttu-id="60a7b-134">当项的依赖项发生更改时，它将从缓存中逐出。</span><span class="sxs-lookup"><span data-stu-id="60a7b-134">When the item s dependency changes it is evicted from the cache.</span></span> <span data-ttu-id="60a7b-135">依赖项可以是文件、其他缓存项或二者的组合。</span><span class="sxs-lookup"><span data-stu-id="60a7b-135">The dependency may be a file, another cache item, or a combination of the two.</span></span> <span data-ttu-id="60a7b-136">ASP.NET 2.0 还允许使用 SQL 缓存依赖项，这些依赖项使开发人员可以向缓存中添加项，并在基础数据库数据发生更改时将其逐出。</span><span class="sxs-lookup"><span data-stu-id="60a7b-136">ASP.NET 2.0 also allows SQL cache dependencies, which enable developers to add an item to the cache and have it evicted when the underlying database data changes.</span></span> <span data-ttu-id="60a7b-137">我们将[使用 Sql 缓存依赖项](using-sql-cache-dependencies-vb.md)教程来检查 sql 缓存依赖关系。</span><span class="sxs-lookup"><span data-stu-id="60a7b-137">We will examine SQL cache dependencies in the upcoming [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="60a7b-138">无论指定了哪些逐出条件，都可以在满足基于时间或依赖项的标准之前*清理*缓存中的项。</span><span class="sxs-lookup"><span data-stu-id="60a7b-138">Regardless of the eviction criteria specified, an item in the cache may be *scavenged* before the time-based or dependency-based criteria has been met.</span></span> <span data-ttu-id="60a7b-139">如果缓存已达到其容量，则必须先删除现有项，然后才能添加新项。</span><span class="sxs-lookup"><span data-stu-id="60a7b-139">If the cache has reached its capacity, existing items must be removed before new ones can be added.</span></span> <span data-ttu-id="60a7b-140">因此，在以编程方式处理缓存数据时，必须始终假定缓存的数据可能不存在。</span><span class="sxs-lookup"><span data-stu-id="60a7b-140">Consequently, when programmatically working with cached data it s vital that you always assume that the cached data may not be present.</span></span> <span data-ttu-id="60a7b-141">我们将在下一教程介绍如何在*体系结构中缓存数据*时，查看以编程方式访问缓存中的数据时使用的模式。</span><span class="sxs-lookup"><span data-stu-id="60a7b-141">We'll look at the pattern to use when accessing data from the cache programmatically in our next tutorial, *Caching Data in the Architecture*.</span></span>

<span data-ttu-id="60a7b-142">缓存提供了一种经济实惠的方法，用于从应用程序中挤压更多性能。</span><span class="sxs-lookup"><span data-stu-id="60a7b-142">Caching provides an economical means for squeezing more performance from an application.</span></span> <span data-ttu-id="60a7b-143">作为[Steven Smith](http://aspadvice.com/blogs/ssmith/)指定了的文章[ASP.NET 缓存：技术和最佳做法](https://msdn.microsoft.com/library/aa478965.aspx)：</span><span class="sxs-lookup"><span data-stu-id="60a7b-143">As [Steven Smith](http://aspadvice.com/blogs/ssmith/) articulates in his article [ASP.NET Caching: Techniques and Best Practices](https://msdn.microsoft.com/library/aa478965.aspx):</span></span>

<span data-ttu-id="60a7b-144">缓存可以是获得足够性能的好办法，无需大量时间和分析。</span><span class="sxs-lookup"><span data-stu-id="60a7b-144">Caching can be a good way to get good enough performance without requiring a lot of time and analysis.</span></span> <span data-ttu-id="60a7b-145">内存开销较低，因此，如果你可以通过缓存30秒的输出来获得所需的性能，而不是花费一天或一周的时间来优化你的代码或数据库，请执行缓存解决方案（假定旧数据为30秒），然后继续。</span><span class="sxs-lookup"><span data-stu-id="60a7b-145">Memory is cheap, so if you can get the performance you need by caching the output for 30 seconds instead of spending a day or a week trying to optimize your code or database, do the caching solution (assuming 30-second old data is ok) and move on.</span></span> <span data-ttu-id="60a7b-146">最终，糟糕的设计可能会与你保持同步，因此，你当然应尝试正确设计应用程序。</span><span class="sxs-lookup"><span data-stu-id="60a7b-146">Eventually, poor design will probably catch up to you, so of course you should try to design your applications correctly.</span></span> <span data-ttu-id="60a7b-147">但是，如果你现在只需获得足够的性能，则缓存可以是一个极佳的 [方法]，如果你有时间，则可以随时购买重构应用程序的时间。</span><span class="sxs-lookup"><span data-stu-id="60a7b-147">But if you just need to get good enough performance today, caching can be an excellent [approach], buying you time to refactor your application at a later date when you have the time to do so.</span></span>

<span data-ttu-id="60a7b-148">虽然缓存可以提供明显的性能增强功能，但它不适用于所有情况（例如，使用实时、频繁更新数据的应用程序），也不适用于不接受的过时数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-148">While caching can provide appreciable performance enhancements, it is not applicable in all situations, such as with applications that use real-time, frequently-updating data, or where even shortly-lived stale data is unacceptable.</span></span> <span data-ttu-id="60a7b-149">但对于大多数应用程序，应该使用缓存。</span><span class="sxs-lookup"><span data-stu-id="60a7b-149">But for the majority of applications, caching should be used.</span></span> <span data-ttu-id="60a7b-150">有关 ASP.NET 2.0 中缓存的更多背景信息，请参阅[ASP.NET 2.0 快速入门教程](https://quickstarts.asp.net/QuickStartv20/aspnet/)中的[性能缓存](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx)部分。</span><span class="sxs-lookup"><span data-stu-id="60a7b-150">For more background on caching in ASP.NET 2.0, refer to the [Caching for Performance](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/default.aspx) section of the [ASP.NET 2.0 QuickStart Tutorials](https://quickstarts.asp.net/QuickStartv20/aspnet/).</span></span>

## <a name="step-1-creating-the-caching-web-pages"></a><span data-ttu-id="60a7b-151">步骤1：创建缓存网页</span><span class="sxs-lookup"><span data-stu-id="60a7b-151">Step 1: Creating the Caching Web Pages</span></span>

<span data-ttu-id="60a7b-152">在开始探索 ObjectDataSource 的缓存功能之前，先花点时间在我们的网站项目中创建 ASP.NET 页面，我们将在本教程和接下来的三个网页中创建。</span><span class="sxs-lookup"><span data-stu-id="60a7b-152">Before we start our exploration of the ObjectDataSource s caching features, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="60a7b-153">首先添加一个名为 `Caching`的新文件夹。</span><span class="sxs-lookup"><span data-stu-id="60a7b-153">Start by adding a new folder named `Caching`.</span></span> <span data-ttu-id="60a7b-154">接下来，将以下 ASP.NET 页面添加到该文件夹，并确保将每个页面与 `Site.master` 母版页关联：</span><span class="sxs-lookup"><span data-stu-id="60a7b-154">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `ObjectDataSource.aspx`
- `FromTheArchitecture.aspx`
- `AtApplicationStartup.aspx`
- `SqlCacheDependencies.aspx`

![为与缓存相关的教程添加 ASP.NET 页](caching-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="60a7b-156">**图 1**：添加用于缓存相关教程的 ASP.NET 页面</span><span class="sxs-lookup"><span data-stu-id="60a7b-156">**Figure 1**: Add the ASP.NET Pages for the Caching-Related Tutorials</span></span>

<span data-ttu-id="60a7b-157">与在其他文件夹中一样，`Caching` 文件夹中的 `Default.aspx` 会在其部分列出教程。</span><span class="sxs-lookup"><span data-stu-id="60a7b-157">Like in the other folders, `Default.aspx` in the `Caching` folder will list the tutorials in its section.</span></span> <span data-ttu-id="60a7b-158">请记住，`SectionLevelTutorialListing.ascx` 用户控件提供此功能。</span><span class="sxs-lookup"><span data-stu-id="60a7b-158">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="60a7b-159">因此，通过将此用户控件从解决方案资源管理器拖到页面 s 设计视图，将该用户控件添加到 `Default.aspx`。</span><span class="sxs-lookup"><span data-stu-id="60a7b-159">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="60a7b-160">[![图2：将 SectionLevelTutorialListing 用户控件添加到 default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="60a7b-160">[![Figure 2: Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](caching-data-with-the-objectdatasource-vb/_static/image3.png)](caching-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="60a7b-161">**图 2**：图2：将 `SectionLevelTutorialListing.ascx` 用户控件添加到 `Default.aspx` （[单击查看完全大小的图像](caching-data-with-the-objectdatasource-vb/_static/image4.png)）</span><span class="sxs-lookup"><span data-stu-id="60a7b-161">**Figure 2**: Figure 2: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="60a7b-162">最后，将这些页面作为条目添加到 `Web.sitemap` 文件中。</span><span class="sxs-lookup"><span data-stu-id="60a7b-162">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="60a7b-163">具体而言，请在使用二进制数据后添加以下标记 `<siteMapNode>`：</span><span class="sxs-lookup"><span data-stu-id="60a7b-163">Specifically, add the following markup after the Working with Binary Data `<siteMapNode>`:</span></span>

[!code-xml[Main](caching-data-with-the-objectdatasource-vb/samples/sample1.xml)]

<span data-ttu-id="60a7b-164">更新 `Web.sitemap`后，请花点时间通过浏览器查看教程网站。</span><span class="sxs-lookup"><span data-stu-id="60a7b-164">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="60a7b-165">左侧的菜单包含用于缓存教程的项。</span><span class="sxs-lookup"><span data-stu-id="60a7b-165">The menu on the left now includes items for the caching tutorials.</span></span>

![站点映射现在包含用于缓存教程的条目](caching-data-with-the-objectdatasource-vb/_static/image5.png)

<span data-ttu-id="60a7b-167">**图 3**：站点地图现在包含用于缓存教程的条目</span><span class="sxs-lookup"><span data-stu-id="60a7b-167">**Figure 3**: The Site Map Now Includes Entries for the Caching Tutorials</span></span>

## <a name="step-2-displaying-a-list-of-products-in-a-web-page"></a><span data-ttu-id="60a7b-168">步骤2：在网页中显示产品列表</span><span class="sxs-lookup"><span data-stu-id="60a7b-168">Step 2: Displaying a List of Products in a Web Page</span></span>

<span data-ttu-id="60a7b-169">本教程介绍如何使用 ObjectDataSource control s 内置缓存功能。</span><span class="sxs-lookup"><span data-stu-id="60a7b-169">This tutorial explores how to use the ObjectDataSource control s built-in caching features.</span></span> <span data-ttu-id="60a7b-170">但在查看这些功能之前，首先需要一个页面。</span><span class="sxs-lookup"><span data-stu-id="60a7b-170">Before we can look at these features, though, we first need a page to work from.</span></span> <span data-ttu-id="60a7b-171">让我们创建一个网页，该网页使用 GridView 列出来自 `ProductsBLL` 类的 ObjectDataSource 检索到的产品信息。</span><span class="sxs-lookup"><span data-stu-id="60a7b-171">Let s create a web page that uses a GridView to list product information retrieved by an ObjectDataSource from the `ProductsBLL` class.</span></span>

<span data-ttu-id="60a7b-172">首先打开 `Caching` 文件夹中的 "`ObjectDataSource.aspx`" 页。</span><span class="sxs-lookup"><span data-stu-id="60a7b-172">Start by opening the `ObjectDataSource.aspx` page in the `Caching` folder.</span></span> <span data-ttu-id="60a7b-173">将 GridView 从工具箱拖到设计器上，将其 `ID` 属性设置为 "`Products`，并从其智能标记中，选择将其绑定到名为 `ProductsDataSource`的新 ObjectDataSource 控件。</span><span class="sxs-lookup"><span data-stu-id="60a7b-173">Drag a GridView from the Toolbox onto the Designer, set its `ID` property to `Products`, and, from its smart tag, choose to bind it to a new ObjectDataSource control named `ProductsDataSource`.</span></span> <span data-ttu-id="60a7b-174">将 ObjectDataSource 配置为使用 `ProductsBLL` 类。</span><span class="sxs-lookup"><span data-stu-id="60a7b-174">Configure the ObjectDataSource to work with the `ProductsBLL` class.</span></span>

<span data-ttu-id="60a7b-175">[![将 ObjectDataSource 配置为使用 ProductsBLL 类](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="60a7b-175">[![Configure the ObjectDataSource to Use the ProductsBLL Class](caching-data-with-the-objectdatasource-vb/_static/image7.png)](caching-data-with-the-objectdatasource-vb/_static/image6.png)</span></span>

<span data-ttu-id="60a7b-176">**图 4**：将 ObjectDataSource 配置为使用 `ProductsBLL` 类（[单击以查看完全大小的映像](caching-data-with-the-objectdatasource-vb/_static/image8.png)）</span><span class="sxs-lookup"><span data-stu-id="60a7b-176">**Figure 4**: Configure the ObjectDataSource to Use the `ProductsBLL` Class ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image8.png))</span></span>

<span data-ttu-id="60a7b-177">在此页中，让我们创建一个可编辑的 GridView，以便我们可以检查当 ObjectDataSource 中缓存的数据通过 GridView s 接口修改时会发生的情况。</span><span class="sxs-lookup"><span data-stu-id="60a7b-177">For this page, let s create an editable GridView so that we can examine what happens when data cached in the ObjectDataSource is modified through the GridView s interface.</span></span> <span data-ttu-id="60a7b-178">将 "选择" 选项卡中的下拉列表设置为默认值 "`GetProducts()`"，但将 "更新" 选项卡中的选定项更改为接受 `productName`、`unitPrice`和 `productID` 作为其输入参数的 `UpdateProduct` 重载。</span><span class="sxs-lookup"><span data-stu-id="60a7b-178">Leave the drop-down list in the SELECT tab set to its default, `GetProducts()`, but change the selected item in the UPDATE tab to the `UpdateProduct` overload that accepts `productName`, `unitPrice`, and `productID` as its input parameters.</span></span>

<span data-ttu-id="60a7b-179">[![将 "更新" 选项卡 s 下拉列表设置为相应的 UpdateProduct 重载](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="60a7b-179">[![Set the UPDATE Tab s Drop-Down List to the Appropriate UpdateProduct Overload](caching-data-with-the-objectdatasource-vb/_static/image10.png)](caching-data-with-the-objectdatasource-vb/_static/image9.png)</span></span>

<span data-ttu-id="60a7b-180">**图 5**：将 "更新" 选项卡 s 下拉列表设置为相应的 `UpdateProduct` 重载（[单击以查看完全大小的图像](caching-data-with-the-objectdatasource-vb/_static/image11.png)）</span><span class="sxs-lookup"><span data-stu-id="60a7b-180">**Figure 5**: Set the UPDATE Tab s Drop-Down List to the Appropriate `UpdateProduct` Overload ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image11.png))</span></span>

<span data-ttu-id="60a7b-181">最后，在 "插入" 和 "删除" 选项卡中将下拉列表设置为 "（无）"，然后单击 "完成"。</span><span class="sxs-lookup"><span data-stu-id="60a7b-181">Finally, set the drop-down lists in the INSERT and DELETE tabs to (None) and click Finish.</span></span> <span data-ttu-id="60a7b-182">完成配置数据源向导后，Visual Studio 会将 ObjectDataSource `OldValuesParameterFormatString` 属性设置为 `original_{0}`。</span><span class="sxs-lookup"><span data-stu-id="60a7b-182">Upon completing the Configure Data Source wizard, Visual Studio sets the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="60a7b-183">如有关[插入、更新和删除数据的概述](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md)教程中所述，需要从声明性语法中删除此属性或将其设置回默认值，`{0}`，以便更新工作流继续进行而不发生错误。</span><span class="sxs-lookup"><span data-stu-id="60a7b-183">As discussed in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-vb.md) tutorial, this property needs to be removed from the declarative syntax or set back to its default value, `{0}`, in order for our update workflow to proceed without error.</span></span>

<span data-ttu-id="60a7b-184">此外，在完成向导后，Visual Studio 会为每个产品数据字段向 GridView 添加一个字段。</span><span class="sxs-lookup"><span data-stu-id="60a7b-184">Furthermore, at the completion of the wizard Visual Studio adds a field to the GridView for each of the product data fields.</span></span> <span data-ttu-id="60a7b-185">删除除 `ProductName`、`CategoryName`和 `UnitPrice` 的所有 BoundFields。</span><span class="sxs-lookup"><span data-stu-id="60a7b-185">Remove all but the `ProductName`, `CategoryName`, and `UnitPrice` BoundFields.</span></span> <span data-ttu-id="60a7b-186">接下来，将每个 BoundFields 的 `HeaderText` 属性分别更新为 "产品"、"类别" 和 "价格"。</span><span class="sxs-lookup"><span data-stu-id="60a7b-186">Next, update the `HeaderText` properties of each of these BoundFields to Product, Category, and Price, respectively.</span></span> <span data-ttu-id="60a7b-187">由于 `ProductName` 字段是必需的，因此将 BoundField 转换为 TemplateField，并将 RequiredFieldValidator 添加到 `EditItemTemplate`中。</span><span class="sxs-lookup"><span data-stu-id="60a7b-187">Since the `ProductName` field is required, convert the BoundField into a TemplateField and add a RequiredFieldValidator to the `EditItemTemplate`.</span></span> <span data-ttu-id="60a7b-188">同样，将 `UnitPrice` BoundField 转换为 TemplateField 并添加 CompareValidator，以确保用户输入的值是大于或等于零的有效货币值。</span><span class="sxs-lookup"><span data-stu-id="60a7b-188">Similarly, convert the `UnitPrice` BoundField into a TemplateField and add a CompareValidator to ensure that the value entered by the user is a valid currency value that s greater than or equal to zero.</span></span> <span data-ttu-id="60a7b-189">除了这些修改以外，还可以随意执行任何美观更改，例如右对齐 `UnitPrice` 值，或者在其只读和编辑界面中指定 `UnitPrice` 文本的格式设置。</span><span class="sxs-lookup"><span data-stu-id="60a7b-189">In addition to these modifications, feel free to perform any aesthetic changes, such as right-aligning the `UnitPrice` value, or specifying the formatting for the `UnitPrice` text in its read-only and editing interfaces.</span></span>

<span data-ttu-id="60a7b-190">选中 GridView s 智能标记中的 "启用编辑" 复选框，使 GridView 可编辑。</span><span class="sxs-lookup"><span data-stu-id="60a7b-190">Make the GridView editable by checking the Enable Editing checkbox in the GridView s smart tag.</span></span> <span data-ttu-id="60a7b-191">另请选中 "启用分页" 和 "启用排序" 复选框。</span><span class="sxs-lookup"><span data-stu-id="60a7b-191">Also check the Enable Paging and Enable Sorting checkboxes.</span></span>

> [!NOTE]
> <span data-ttu-id="60a7b-192">需要回顾如何自定义 GridView s 编辑界面？</span><span class="sxs-lookup"><span data-stu-id="60a7b-192">Need a review of how to customize the GridView s editing interface?</span></span> <span data-ttu-id="60a7b-193">如果是这样，请返回到[自定义数据修改界面](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md)教程。</span><span class="sxs-lookup"><span data-stu-id="60a7b-193">If so, refer back to the [Customizing the Data Modification Interface](../editing-inserting-and-deleting-data/customizing-the-data-modification-interface-vb.md) tutorial.</span></span>

<span data-ttu-id="60a7b-194">[![启用对编辑、排序和分页的 GridView 支持](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="60a7b-194">[![Enable GridView Support for Editing, Sorting, and Paging](caching-data-with-the-objectdatasource-vb/_static/image13.png)](caching-data-with-the-objectdatasource-vb/_static/image12.png)</span></span>

<span data-ttu-id="60a7b-195">**图 6**：启用对编辑、排序和分页的 GridView 支持（[单击以查看完全大小的图像](caching-data-with-the-objectdatasource-vb/_static/image14.png)）</span><span class="sxs-lookup"><span data-stu-id="60a7b-195">**Figure 6**: Enable GridView Support for Editing, Sorting, and Paging ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image14.png))</span></span>

<span data-ttu-id="60a7b-196">进行这些 GridView 修改后，GridView 和 ObjectDataSource 的声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="60a7b-196">After making these GridView modifications, the GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](caching-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="60a7b-197">如图7所示，可编辑 GridView 列出了数据库中每个产品的名称、类别和价格。</span><span class="sxs-lookup"><span data-stu-id="60a7b-197">As Figure 7 shows, the editable GridView lists the name, category, and price of each of the products in the database.</span></span> <span data-ttu-id="60a7b-198">请花点时间测试页的功能、对结果进行分页并编辑记录。</span><span class="sxs-lookup"><span data-stu-id="60a7b-198">Take a moment to test out the page s functionality sort the results, page through them, and edit a record.</span></span>

<span data-ttu-id="60a7b-199">[![每种产品的名称、类别和价格都列在可排序、可分页、可编辑的 GridView 中](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="60a7b-199">[![Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView](caching-data-with-the-objectdatasource-vb/_static/image16.png)](caching-data-with-the-objectdatasource-vb/_static/image15.png)</span></span>

<span data-ttu-id="60a7b-200">**图 7**：每种产品的名称、类别和价格均以可排序、可分页的可编辑 GridView 列出（[单击以查看完全大小的图像](caching-data-with-the-objectdatasource-vb/_static/image17.png)）</span><span class="sxs-lookup"><span data-stu-id="60a7b-200">**Figure 7**: Each Product s Name, Category, and Price is Listed in a Sortable, Pageable, Editable GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image17.png))</span></span>

## <a name="step-3-examining-when-the-objectdatasource-is-requesting-data"></a><span data-ttu-id="60a7b-201">步骤3：检查 ObjectDataSource 请求数据的时间</span><span class="sxs-lookup"><span data-stu-id="60a7b-201">Step 3: Examining When the ObjectDataSource is Requesting Data</span></span>

<span data-ttu-id="60a7b-202">`Products` GridView 通过调用 `ProductsDataSource` ObjectDataSource 的 `Select` 方法来检索要显示的数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-202">The `Products` GridView retrieves its data to display by invoking the `Select` method of the `ProductsDataSource` ObjectDataSource.</span></span> <span data-ttu-id="60a7b-203">此 ObjectDataSource 创建业务逻辑层 s `ProductsBLL` 类的实例，并调用其 `GetProducts()` 方法，后者又将调用数据访问 `ProductsTableAdapter` 层 `GetProducts()` 方法。</span><span class="sxs-lookup"><span data-stu-id="60a7b-203">This ObjectDataSource creates an instance of the Business Logic Layer s `ProductsBLL` class and calls its `GetProducts()` method, which in turn calls the Data Access Layer s `ProductsTableAdapter` s `GetProducts()` method.</span></span> <span data-ttu-id="60a7b-204">DAL 方法连接到 Northwind 数据库，并发出配置的 `SELECT` 查询。</span><span class="sxs-lookup"><span data-stu-id="60a7b-204">The DAL method connects to the Northwind database and issues the configured `SELECT` query.</span></span> <span data-ttu-id="60a7b-205">然后，将此数据返回到 DAL，后者将其打包在 `NorthwindDataTable`中。</span><span class="sxs-lookup"><span data-stu-id="60a7b-205">This data is then returned to the DAL, which packages it up in a `NorthwindDataTable`.</span></span> <span data-ttu-id="60a7b-206">DataTable 对象将返回到 BLL，并将其返回到 ObjectDataSource，后者将其返回给 GridView。</span><span class="sxs-lookup"><span data-stu-id="60a7b-206">The DataTable object is returned to the BLL, which returns it to the ObjectDataSource, which returns it to the GridView.</span></span> <span data-ttu-id="60a7b-207">然后，GridView 为 DataTable 中的每个 `DataRow` 创建一个 `GridViewRow` 对象，每个 `GridViewRow` 最终呈现给返回到客户端并显示在访问者浏览器上的 HTML。</span><span class="sxs-lookup"><span data-stu-id="60a7b-207">The GridView then creates a `GridViewRow` object for each `DataRow` in the DataTable, and each `GridViewRow` is eventually rendered into the HTML that is returned to the client and displayed on the visitor s browser.</span></span>

<span data-ttu-id="60a7b-208">此事件序列每次发生，而 GridView 每次需要绑定到其基础数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-208">This sequence of events happens each and every time the GridView needs to bind to its underlying data.</span></span> <span data-ttu-id="60a7b-209">当首次访问页面、在对 GridView 进行排序时或通过其内置编辑或删除接口修改 GridView 的数据时，会发生这种情况。</span><span class="sxs-lookup"><span data-stu-id="60a7b-209">That happens when the page is first visited, when moving from one page of data to another, when sorting the GridView, or when modifying the GridView s data through its built-in editing or deleting interfaces.</span></span> <span data-ttu-id="60a7b-210">如果 GridView 的视图状态为禁用，则将在每次回发时重新绑定 GridView。</span><span class="sxs-lookup"><span data-stu-id="60a7b-210">If the GridView s view state is disabled, the GridView will be rebound on each and every postback as well.</span></span> <span data-ttu-id="60a7b-211">GridView 还可以通过调用其 `DataBind()` 方法，显式重新绑定到其数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-211">The GridView can also be explicitly rebound to its data by calling its `DataBind()` method.</span></span>

<span data-ttu-id="60a7b-212">若要完全感谢从数据库检索数据的频率，请让 s 显示一条消息，指示何时重新检索数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-212">To fully appreciate the frequency with which the data is retrieved from the database, let s display a message indicating when the data is being re-retrieved.</span></span> <span data-ttu-id="60a7b-213">将标签 Web 控件添加到名为 `ODSEvents`的 GridView 之上。</span><span class="sxs-lookup"><span data-stu-id="60a7b-213">Add a Label Web control above the GridView named `ODSEvents`.</span></span> <span data-ttu-id="60a7b-214">清除其 `Text` 属性，并将其 `EnableViewState` 属性设置为 "`False`"。</span><span class="sxs-lookup"><span data-stu-id="60a7b-214">Clear out its `Text` property and set its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="60a7b-215">在标签下面，添加一个按钮 Web 控件，并将其 `Text` 属性设置为回发。</span><span class="sxs-lookup"><span data-stu-id="60a7b-215">Underneath the Label, add a Button Web control and set its `Text` property to Postback .</span></span>

<span data-ttu-id="60a7b-216">[![向 GridView 上方的页面添加标签和按钮](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="60a7b-216">[![Add a Label and Button to the Page Above the GridView](caching-data-with-the-objectdatasource-vb/_static/image19.png)](caching-data-with-the-objectdatasource-vb/_static/image18.png)</span></span>

<span data-ttu-id="60a7b-217">**图 8**：向 GridView 上方的页面添加标签和按钮（[单击以查看完全尺寸的图像](caching-data-with-the-objectdatasource-vb/_static/image20.png)）</span><span class="sxs-lookup"><span data-stu-id="60a7b-217">**Figure 8**: Add a Label and Button to the Page Above the GridView ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image20.png))</span></span>

<span data-ttu-id="60a7b-218">在数据访问工作流过程中，将在创建基础对象之前激发 ObjectDataSource `Selecting` 事件并调用其配置方法。</span><span class="sxs-lookup"><span data-stu-id="60a7b-218">During the data access workflow, the ObjectDataSource s `Selecting` event fires before the underlying object is created and its configured method invoked.</span></span> <span data-ttu-id="60a7b-219">为此事件创建事件处理程序并添加以下代码：</span><span class="sxs-lookup"><span data-stu-id="60a7b-219">Create an event handler for this event and add the following code:</span></span>

[!code-vb[Main](caching-data-with-the-objectdatasource-vb/samples/sample3.vb)]

<span data-ttu-id="60a7b-220">每次 ObjectDataSource 向数据体系结构发出请求时，该标签都将显示选择 "触发事件" 的文本。</span><span class="sxs-lookup"><span data-stu-id="60a7b-220">Each time the ObjectDataSource makes a request to the architecture for data, the Label will display the text Selecting event fired .</span></span>

<span data-ttu-id="60a7b-221">在浏览器中访问此页。</span><span class="sxs-lookup"><span data-stu-id="60a7b-221">Visit this page in a browser.</span></span> <span data-ttu-id="60a7b-222">首次访问页面时，将显示 "选择触发的事件" 文本。</span><span class="sxs-lookup"><span data-stu-id="60a7b-222">When the page is first visited, the text Selecting event fired is shown.</span></span> <span data-ttu-id="60a7b-223">单击 "回发" 按钮，请注意文本将消失（假设 GridView `EnableViewState` 属性设置为 `True`（默认值）。</span><span class="sxs-lookup"><span data-stu-id="60a7b-223">Click the Postback button and note that the text disappears (assuming that the GridView s `EnableViewState` property is set to `True`, the default).</span></span> <span data-ttu-id="60a7b-224">这是因为，在回发时，GridView 是从其视图状态重新构造的，因此不会转换为其数据的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="60a7b-224">This is because, on postback, the GridView is reconstructed from its view state and therefore doesn t turn to the ObjectDataSource for its data.</span></span> <span data-ttu-id="60a7b-225">但对数据进行排序、分页或编辑会导致 GridView 重新绑定到其数据源，因此会重新出现选择事件激发的文本。</span><span class="sxs-lookup"><span data-stu-id="60a7b-225">Sorting, paging, or editing the data, however, causes the GridView to rebind to its data source, and therefore the Selecting event fired text reappears.</span></span>

<span data-ttu-id="60a7b-226">[每当 GridView 重新绑定到其数据源时 ![，将显示选择 "触发事件"。](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="60a7b-226">[![Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed](caching-data-with-the-objectdatasource-vb/_static/image22.png)](caching-data-with-the-objectdatasource-vb/_static/image21.png)</span></span>

<span data-ttu-id="60a7b-227">**图 9**：每当 GridView 重新绑定到其数据源时，将显示选择 "触发事件" （[单击查看完全大小的图像](caching-data-with-the-objectdatasource-vb/_static/image23.png)）</span><span class="sxs-lookup"><span data-stu-id="60a7b-227">**Figure 9**: Whenever the GridView is Rebound to its Data Source, Selecting event fired is Displayed ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image23.png))</span></span>

<span data-ttu-id="60a7b-228">[单击回发按钮 ![会导致 GridView 从其视图状态重新构造](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="60a7b-228">[![Clicking the Postback Button Causes the GridView to be Reconstructed from its View State](caching-data-with-the-objectdatasource-vb/_static/image25.png)](caching-data-with-the-objectdatasource-vb/_static/image24.png)</span></span>

<span data-ttu-id="60a7b-229">**图 10**：单击 "回发" 按钮会导致 GridView 从其视图状态重新构造（[单击以查看完全大小的图像](caching-data-with-the-objectdatasource-vb/_static/image26.png)）</span><span class="sxs-lookup"><span data-stu-id="60a7b-229">**Figure 10**: Clicking the Postback Button Causes the GridView to be Reconstructed from its View State ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image26.png))</span></span>

<span data-ttu-id="60a7b-230">每次对数据分页或排序时，检索数据库数据可能会浪费。</span><span class="sxs-lookup"><span data-stu-id="60a7b-230">It may seem wasteful to retrieve the database data each time the data is paged through or sorted.</span></span> <span data-ttu-id="60a7b-231">毕竟，由于我们使用默认分页，因此在显示第一页时，ObjectDataSource 已经检索了所有记录。</span><span class="sxs-lookup"><span data-stu-id="60a7b-231">After all, since we re using default paging, the ObjectDataSource has retrieved all of the records when displaying the first page.</span></span> <span data-ttu-id="60a7b-232">即使 GridView 不提供排序和分页支持，每次用户首次访问页面时，都必须从数据库中检索数据（如果禁用了视图状态，则必须在每次回发时）从数据库中检索数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-232">Even if the GridView does not provide sorting and paging support, the data must be retrieved from the database each time the page is first visited by any user (and on every postback, if view state is disabled).</span></span> <span data-ttu-id="60a7b-233">但如果 GridView 向所有用户显示相同的数据，则这些额外的数据库请求是多余的。</span><span class="sxs-lookup"><span data-stu-id="60a7b-233">But if the GridView is showing the same data to all users, these extra database requests are superfluous.</span></span> <span data-ttu-id="60a7b-234">为什么不缓存 `GetProducts()` 方法返回的结果，并将 GridView 绑定到这些缓存的结果？</span><span class="sxs-lookup"><span data-stu-id="60a7b-234">Why not cache the results returned from the `GetProducts()` method and bind the GridView to those cached results?</span></span>

## <a name="step-4-caching-the-data-using-the-objectdatasource"></a><span data-ttu-id="60a7b-235">步骤4：使用 ObjectDataSource 缓存数据</span><span class="sxs-lookup"><span data-stu-id="60a7b-235">Step 4: Caching the Data Using the ObjectDataSource</span></span>

<span data-ttu-id="60a7b-236">只需设置几个属性，ObjectDataSource 就可以配置为在 ASP.NET 数据缓存中自动缓存其检索的数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-236">By simply setting a few properties, the ObjectDataSource can be configured to automatically cache its retrieved data in the ASP.NET data cache.</span></span> <span data-ttu-id="60a7b-237">以下列表汇总了 ObjectDataSource 的与缓存相关的属性：</span><span class="sxs-lookup"><span data-stu-id="60a7b-237">The following list summarizes the cache-related properties of the ObjectDataSource:</span></span>

- <span data-ttu-id="60a7b-238">若要启用缓存， [EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx)必须设置为 `True`。</span><span class="sxs-lookup"><span data-stu-id="60a7b-238">[EnableCaching](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.enablecaching.aspx) must be set to `True` to enable caching.</span></span> <span data-ttu-id="60a7b-239">默认值为 `False`。</span><span class="sxs-lookup"><span data-stu-id="60a7b-239">The default is `False`.</span></span>
- <span data-ttu-id="60a7b-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx)缓存数据的时间量（以秒为单位）。</span><span class="sxs-lookup"><span data-stu-id="60a7b-240">[CacheDuration](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheduration.aspx) the amount of time, in seconds, that the data is cached.</span></span> <span data-ttu-id="60a7b-241">默认值为 0。</span><span class="sxs-lookup"><span data-stu-id="60a7b-241">The default is 0.</span></span> <span data-ttu-id="60a7b-242">如果 `EnableCaching` `True` 并且 `CacheDuration` 设置为大于零的值，则 ObjectDataSource 仅会缓存数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-242">The ObjectDataSource will only cache data if `EnableCaching` is `True` and `CacheDuration` is set to a value greater than zero.</span></span>
- <span data-ttu-id="60a7b-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx)可以设置为 `Absolute` 或 `Sliding`。</span><span class="sxs-lookup"><span data-stu-id="60a7b-243">[CacheExpirationPolicy](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cacheexpirationpolicy.aspx) can be set to `Absolute` or `Sliding`.</span></span> <span data-ttu-id="60a7b-244">如果 `Absolute`，则 ObjectDataSource 会将检索到的数据缓存 `CacheDuration` 秒;如果 `Sliding`，则只有在 `CacheDuration` 秒内访问数据后，数据才会过期。</span><span class="sxs-lookup"><span data-stu-id="60a7b-244">If `Absolute`, the ObjectDataSource caches its retrieved data for `CacheDuration` seconds; if `Sliding`, the data expires only after it has not been accessed for `CacheDuration` seconds.</span></span> <span data-ttu-id="60a7b-245">默认值为 `Absolute`。</span><span class="sxs-lookup"><span data-stu-id="60a7b-245">The default is `Absolute`.</span></span>
- <span data-ttu-id="60a7b-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx)使用此属性将 ObjectDataSource 的缓存条目与现有的缓存依赖项相关联。</span><span class="sxs-lookup"><span data-stu-id="60a7b-246">[CacheKeyDependency](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.cachekeydependency.aspx) use this property to associate the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="60a7b-247">可以通过将 ObjectDataSource 数据条目的关联 `CacheKeyDependency`过期，从缓存中将其提前逐出。</span><span class="sxs-lookup"><span data-stu-id="60a7b-247">The ObjectDataSource s data entries can be prematurely evicted from the cache by expiring its associated `CacheKeyDependency`.</span></span> <span data-ttu-id="60a7b-248">此属性最常用于将 SQL 缓存依赖关系与 ObjectDataSource s 缓存相关联，我们将在以后[使用 SQL 缓存依赖项](using-sql-cache-dependencies-vb.md)教程探讨相关主题。</span><span class="sxs-lookup"><span data-stu-id="60a7b-248">This property is most commonly used to associate a SQL cache dependency with the ObjectDataSource s cache, a topic we'll explore in the future [Using SQL Cache Dependencies](using-sql-cache-dependencies-vb.md) tutorial.</span></span>

<span data-ttu-id="60a7b-249">让 s 配置 `ProductsDataSource` ObjectDataSource，以将其数据缓存30秒，使其达到绝对比例。</span><span class="sxs-lookup"><span data-stu-id="60a7b-249">Let s configure the `ProductsDataSource` ObjectDataSource to cache its data for 30 seconds on an absolute scale.</span></span> <span data-ttu-id="60a7b-250">将 ObjectDataSource s `EnableCaching` 属性设置为 `True`，其 `CacheDuration` 属性设置为30。</span><span class="sxs-lookup"><span data-stu-id="60a7b-250">Set the ObjectDataSource s `EnableCaching` property to `True` and its `CacheDuration` property to 30.</span></span> <span data-ttu-id="60a7b-251">将 `CacheExpirationPolicy` 属性设置为其默认值，`Absolute`。</span><span class="sxs-lookup"><span data-stu-id="60a7b-251">Leave the `CacheExpirationPolicy` property set to its default, `Absolute`.</span></span>

<span data-ttu-id="60a7b-252">[![将 ObjectDataSource 配置为将其数据缓存30秒](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="60a7b-252">[![Configure the ObjectDataSource to Cache its Data for 30 Seconds](caching-data-with-the-objectdatasource-vb/_static/image28.png)](caching-data-with-the-objectdatasource-vb/_static/image27.png)</span></span>

<span data-ttu-id="60a7b-253">**图 11**：将 ObjectDataSource 配置为将其数据缓存30秒（[单击查看完全大小的映像](caching-data-with-the-objectdatasource-vb/_static/image29.png)）</span><span class="sxs-lookup"><span data-stu-id="60a7b-253">**Figure 11**: Configure the ObjectDataSource to Cache its Data for 30 Seconds ([Click to view full-size image](caching-data-with-the-objectdatasource-vb/_static/image29.png))</span></span>

<span data-ttu-id="60a7b-254">保存更改，并在浏览器中重新访问此页。</span><span class="sxs-lookup"><span data-stu-id="60a7b-254">Save your changes and revisit this page in a browser.</span></span> <span data-ttu-id="60a7b-255">首次访问页面时，将显示 "选择事件激发的文本"，因为最初数据不在缓存中。</span><span class="sxs-lookup"><span data-stu-id="60a7b-255">The Selecting event fired text will appear when you first visit the page, as initially the data is not in the cache.</span></span> <span data-ttu-id="60a7b-256">但是，通过单击回发按钮、排序、分页或单击 "编辑" 或 "取消" 按钮触发的后续回发*不*会重新显示选择 "事件触发文本"。</span><span class="sxs-lookup"><span data-stu-id="60a7b-256">But subsequent postbacks triggered by clicking the Postback button, sorting, paging, or clicking the Edit or Cancel buttons does *not* redisplay the Selecting event fired text.</span></span> <span data-ttu-id="60a7b-257">这是因为仅当 ObjectDataSource 从其基础对象获取其数据时才会触发 `Selecting` 事件;如果从数据缓存中提取数据，则不会激发 `Selecting` 事件。</span><span class="sxs-lookup"><span data-stu-id="60a7b-257">This is because the `Selecting` event only fires when the ObjectDataSource gets its data from its underlying object; the `Selecting` event does not fire if the data is pulled from the data cache.</span></span>

<span data-ttu-id="60a7b-258">30秒后，数据将从缓存中逐出。</span><span class="sxs-lookup"><span data-stu-id="60a7b-258">After 30 seconds, the data will be evicted from the cache.</span></span> <span data-ttu-id="60a7b-259">如果调用 ObjectDataSource `Insert`、`Update`或 `Delete` 方法，则数据也将从缓存中逐出。</span><span class="sxs-lookup"><span data-stu-id="60a7b-259">The data will also be evicted from the cache if the ObjectDataSource s `Insert`, `Update`, or `Delete` methods are invoked.</span></span> <span data-ttu-id="60a7b-260">因此，超过30秒后，单击 "更新" 按钮、排序、分页或单击 "编辑" 或 "取消" 按钮将导致 ObjectDataSource 从其基础对象获取其数据，并在 `Selecting` 事件激发时显示选择事件引发的文本。</span><span class="sxs-lookup"><span data-stu-id="60a7b-260">Consequently, after 30 seconds have passed or the Update button has been clicked, sorting, paging, or clicking the Edit or Cancel buttons will cause the ObjectDataSource to get its data from its underlying object, displaying the Selecting event fired text when the `Selecting` event fires.</span></span> <span data-ttu-id="60a7b-261">这些返回的结果会被放回到数据缓存中。</span><span class="sxs-lookup"><span data-stu-id="60a7b-261">These returned results are placed back into the data cache.</span></span>

> [!NOTE]
> <span data-ttu-id="60a7b-262">如果您经常发现选择事件引发的文本，即使您希望 ObjectDataSource 使用缓存的数据，这可能是由于内存限制。</span><span class="sxs-lookup"><span data-stu-id="60a7b-262">If you see the Selecting event fired text frequently, even when you expect the ObjectDataSource to be working with cached data, it may be due to memory constraints.</span></span> <span data-ttu-id="60a7b-263">如果没有足够的可用内存，则由 ObjectDataSource 添加到缓存中的数据可能已被清除。</span><span class="sxs-lookup"><span data-stu-id="60a7b-263">If there is not enough free memory, the data added to the cache by the ObjectDataSource may have been scavenged.</span></span> <span data-ttu-id="60a7b-264">如果 ObjectDataSource 没有正确缓存数据或只是偶尔缓存数据，请关闭一些应用程序以释放内存，然后重试。</span><span class="sxs-lookup"><span data-stu-id="60a7b-264">If the ObjectDataSource doesn t appear to be correctly caching the data or only caches the data sporadically, close some applications to free memory and try again.</span></span>

<span data-ttu-id="60a7b-265">图12说明了 ObjectDataSource s 缓存工作流。</span><span class="sxs-lookup"><span data-stu-id="60a7b-265">Figure 12 illustrates the ObjectDataSource s caching workflow.</span></span> <span data-ttu-id="60a7b-266">当选择 "激发的事件" 文本出现在屏幕上时，是因为数据不在缓存中，必须从基础对象中检索。</span><span class="sxs-lookup"><span data-stu-id="60a7b-266">When the Selecting event fired text appears on your screen, it is because the data was not in the cache and had to be retrieved from the underlying object.</span></span> <span data-ttu-id="60a7b-267">但当缺少此文本时，这是因为数据从缓存中可用。</span><span class="sxs-lookup"><span data-stu-id="60a7b-267">When this text is missing, however, it s because the data was available from the cache.</span></span> <span data-ttu-id="60a7b-268">如果从缓存返回数据，则不会调用基础对象，因此不会执行任何数据库查询。</span><span class="sxs-lookup"><span data-stu-id="60a7b-268">When the data is returned from the cache there s no call to the underlying object and, therefore, no database query executed.</span></span>

![ObjectDataSource 存储和检索数据缓存中的数据](caching-data-with-the-objectdatasource-vb/_static/image30.png)

<span data-ttu-id="60a7b-270">**图 12**： ObjectDataSource 存储和检索数据缓存中的数据</span><span class="sxs-lookup"><span data-stu-id="60a7b-270">**Figure 12**: The ObjectDataSource Stores and Retrieves its Data from the Data Cache</span></span>

<span data-ttu-id="60a7b-271">每个 ASP.NET 应用程序都有自己的数据缓存实例，该实例在所有页面和访问者之间共享。</span><span class="sxs-lookup"><span data-stu-id="60a7b-271">Each ASP.NET application has its own data cache instance that s shared across all pages and visitors.</span></span> <span data-ttu-id="60a7b-272">这意味着由 ObjectDataSource 存储在数据缓存中的数据同样在访问该页面的所有用户之间共享。</span><span class="sxs-lookup"><span data-stu-id="60a7b-272">That means that the data stored in the data cache by the ObjectDataSource is likewise shared across all users who visit the page.</span></span> <span data-ttu-id="60a7b-273">若要验证这一点，请在浏览器中打开 `ObjectDataSource.aspx` 页面。</span><span class="sxs-lookup"><span data-stu-id="60a7b-273">To verify this, open the `ObjectDataSource.aspx` page in a browser.</span></span> <span data-ttu-id="60a7b-274">首次访问页面时，将显示 "选择事件激发的文本" （假设先前测试添加到缓存的数据现在已被逐出）。</span><span class="sxs-lookup"><span data-stu-id="60a7b-274">When first visiting the page, the Selecting event fired text will appear (assuming that the data added to the cache by previous tests has, by now, been evicted).</span></span> <span data-ttu-id="60a7b-275">打开第二个浏览器实例，将第一个浏览器实例中的 URL 复制并粘贴到第二个实例。</span><span class="sxs-lookup"><span data-stu-id="60a7b-275">Open a second browser instance and copy and paste the URL from the first browser instance to the second.</span></span> <span data-ttu-id="60a7b-276">在第二个浏览器实例中，不会显示选择事件激发的文本，因为它使用的是与第一个相同的缓存数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-276">In the second browser instance, the Selecting event fired text is not shown because it s using the same cached data as the first.</span></span>

<span data-ttu-id="60a7b-277">将检索到的数据插入缓存中时，ObjectDataSource 使用缓存键值，其中包括： `CacheDuration` 和 `CacheExpirationPolicy` 属性值;由 ObjectDataSource 使用的基础业务对象的类型（通过[`TypeName` 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx)（在本示例中为`ProductsBLL`指定）;`SelectMethod` 属性的值和 `SelectParameters` 集合中的参数的名称和值;以及在实现[自定义分页](../paging-and-sorting/paging-and-sorting-report-data-vb.md)时使用的 `StartRowIndex` 和 `MaximumRows` 属性的值。</span><span class="sxs-lookup"><span data-stu-id="60a7b-277">When inserting its retrieved data into the cache, the ObjectDataSource uses a cache key value that includes: the `CacheDuration` and `CacheExpirationPolicy` property values; the type of the underlying business object being used by the ObjectDataSource, which is specified via the [`TypeName` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.typename.aspx) (`ProductsBLL`, in this example); the value of the `SelectMethod` property and the name and values of the parameters in the `SelectParameters` collection; and the values of its `StartRowIndex` and `MaximumRows` properties, which are used when implementing [custom paging](../paging-and-sorting/paging-and-sorting-report-data-vb.md).</span></span>

<span data-ttu-id="60a7b-278">将缓存键值作为这些属性的组合进行定制可确保在这些值发生变化时唯一的缓存条目。</span><span class="sxs-lookup"><span data-stu-id="60a7b-278">Crafting the cache key value as a combination of these properties ensures a unique cache entry as these values change.</span></span> <span data-ttu-id="60a7b-279">例如，在过去的教程中，我们已了解如何使用 `ProductsBLL` 类 `GetProductsByCategoryID(categoryID)`，这将返回指定类别的所有产品。</span><span class="sxs-lookup"><span data-stu-id="60a7b-279">For example, in past tutorials we ve looked at using the `ProductsBLL` class s `GetProductsByCategoryID(categoryID)`, which returns all products for a specified category.</span></span> <span data-ttu-id="60a7b-280">一个用户可能会转到页面并查看饮料，其中 `CategoryID` 为1。</span><span class="sxs-lookup"><span data-stu-id="60a7b-280">One user might come to the page and view beverages, which has a `CategoryID` of 1.</span></span> <span data-ttu-id="60a7b-281">如果 ObjectDataSource 缓存其结果，而不考虑 `SelectParameters` 值，当另一个用户进入页面查看调味品，而饮料产品在缓存中时，他们将看到缓存的饮料产品，而不是调味品。</span><span class="sxs-lookup"><span data-stu-id="60a7b-281">If the ObjectDataSource cached its results without regard for the `SelectParameters` values, when another user came to the page to view condiments while the beverages products were in the cache, they d see the cached beverage products rather than condiments.</span></span> <span data-ttu-id="60a7b-282">通过使用这些属性（包括 `SelectParameters`的值）来改变缓存键，ObjectDataSource 为饮料和调味品维护单独的缓存条目。</span><span class="sxs-lookup"><span data-stu-id="60a7b-282">By varying the cache key by these properties, which include the values of the `SelectParameters`, the ObjectDataSource maintains a separate cache entry for beverages and condiments.</span></span>

## <a name="stale-data-concerns"></a><span data-ttu-id="60a7b-283">陈旧数据问题</span><span class="sxs-lookup"><span data-stu-id="60a7b-283">Stale Data Concerns</span></span>

<span data-ttu-id="60a7b-284">当调用 `Insert`、`Update`或 `Delete` 方法中的任何一个时，ObjectDataSource 会自动从缓存中逐出其项。</span><span class="sxs-lookup"><span data-stu-id="60a7b-284">The ObjectDataSource automatically evicts its items from the cache when any one of its `Insert`, `Update`, or `Delete` methods is invoked.</span></span> <span data-ttu-id="60a7b-285">这可通过在通过页面修改数据时清除缓存条目来帮助防止陈旧数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-285">This helps protect against stale data by clearing out the cache entries when the data is modified through the page.</span></span> <span data-ttu-id="60a7b-286">但是，ObjectDataSource 使用缓存仍可显示过时数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-286">However, it is possible for an ObjectDataSource using caching to still display stale data.</span></span> <span data-ttu-id="60a7b-287">在最简单的情况下，这可能是因为数据直接在数据库中发生了变化。</span><span class="sxs-lookup"><span data-stu-id="60a7b-287">In the simplest case, it can be due to the data changing directly within the database.</span></span> <span data-ttu-id="60a7b-288">数据库管理员可能仅运行了修改数据库中的某些记录的脚本。</span><span class="sxs-lookup"><span data-stu-id="60a7b-288">Perhaps a database administrator just ran a script that modifies some of the records in the database.</span></span>

<span data-ttu-id="60a7b-289">此方案还可以更微妙地展开。</span><span class="sxs-lookup"><span data-stu-id="60a7b-289">This scenario could also unfold in a more subtle way.</span></span> <span data-ttu-id="60a7b-290">当 ObjectDataSource 在调用其数据修改方法之一时从缓存中逐出其项时，所移除的缓存项将适用于 ObjectDataSource 的属性值（`CacheDuration`、`TypeName`、`SelectMethod`等）的特定组合。</span><span class="sxs-lookup"><span data-stu-id="60a7b-290">While the ObjectDataSource evicts its items from the cache when one of its data modification methods is called, the cached items removed are for the ObjectDataSource s particular combination of property values (`CacheDuration`, `TypeName`, `SelectMethod`, and so on).</span></span> <span data-ttu-id="60a7b-291">如果有两个使用不同 `SelectMethods` 或 `SelectParameters`的 Objectdatasource，但仍可更新相同的数据，则一个 ObjectDataSource 可以更新行并使其自己的缓存条目失效，但仍将从缓存中为第二个 ObjectDataSource 提供相应的行。</span><span class="sxs-lookup"><span data-stu-id="60a7b-291">If you have two ObjectDataSources that use different `SelectMethods` or `SelectParameters`, but still can update the same data, then one ObjectDataSource may update a row and invalidate its own cache entries, but the corresponding row for the second ObjectDataSource will still be served from the cached.</span></span> <span data-ttu-id="60a7b-292">我鼓励您创建页面来展示这一功能。</span><span class="sxs-lookup"><span data-stu-id="60a7b-292">I encourage you to create pages to exhibit this functionality.</span></span> <span data-ttu-id="60a7b-293">创建一个页面，该页面显示可编辑的 GridView，该 GridView 从使用缓存的 ObjectDataSource 提取数据，并将其配置为从 `ProductsBLL` 类 `GetProducts()` 方法中获取数据。</span><span class="sxs-lookup"><span data-stu-id="60a7b-293">Create a page that displays an editable GridView that pulls its data from an ObjectDataSource that uses caching and is configured to get data from the `ProductsBLL` class s `GetProducts()` method.</span></span> <span data-ttu-id="60a7b-294">将另一个可编辑的 GridView 和 ObjectDataSource 添加到此页（或另一个），但对于此第二个 ObjectDataSource，使用 `GetProductsByCategoryID(categoryID)` 方法。</span><span class="sxs-lookup"><span data-stu-id="60a7b-294">Add another editable GridView and ObjectDataSource to this page (or another one), but for this second ObjectDataSource have it use the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="60a7b-295">由于两个 Objectdatasource `SelectMethod` 属性不同，因此每个属性都有其自己的缓存值。</span><span class="sxs-lookup"><span data-stu-id="60a7b-295">Since the two ObjectDataSources `SelectMethod` properties differ, they ll each have their own cached values.</span></span> <span data-ttu-id="60a7b-296">如果在一个网格中编辑某一产品，则下次将数据绑定回另一个网格（通过分页、排序等）时，它仍将为旧的缓存数据提供服务，而不反映从另一个网格进行的更改。</span><span class="sxs-lookup"><span data-stu-id="60a7b-296">If you edit a product in one grid, the next time you bind the data back to the other grid (by paging, sorting, and so forth), it will still serve the old, cached data and not reflect the change that was made from the other grid.</span></span>

<span data-ttu-id="60a7b-297">简而言之，只使用基于时间的 expiries，如果你愿意拥有过时数据的可能性，并且在数据的新鲜度非常重要的情况下使用较短的 expiries。</span><span class="sxs-lookup"><span data-stu-id="60a7b-297">In short, only use time-based expiries if you are willing to have the potential of stale data, and use shorter expiries for scenarios where the freshness of data is important.</span></span> <span data-ttu-id="60a7b-298">如果陈旧数据是不可接受的，则放弃缓存或使用 SQL 缓存依赖项（假定它是重新缓存的数据库数据）。</span><span class="sxs-lookup"><span data-stu-id="60a7b-298">If stale data is not acceptable, either forgo caching or use SQL cache dependencies (assuming it is database data you re caching).</span></span> <span data-ttu-id="60a7b-299">在将来的教程中，我们将探索 SQL 缓存依赖关系。</span><span class="sxs-lookup"><span data-stu-id="60a7b-299">We'll explore SQL cache dependencies in a future tutorial.</span></span>

## <a name="summary"></a><span data-ttu-id="60a7b-300">总结</span><span class="sxs-lookup"><span data-stu-id="60a7b-300">Summary</span></span>

<span data-ttu-id="60a7b-301">在本教程中，我们将探讨 ObjectDataSource 的内置缓存功能。</span><span class="sxs-lookup"><span data-stu-id="60a7b-301">In this tutorial we examined the ObjectDataSource s built-in caching capabilities.</span></span> <span data-ttu-id="60a7b-302">只需设置几个属性，就可以指示 ObjectDataSource 将指定 `SelectMethod` 返回的结果缓存到 ASP.NET 数据缓存中。</span><span class="sxs-lookup"><span data-stu-id="60a7b-302">By simply setting a few properties, we can instruct the ObjectDataSource to cache the results returned from the specified `SelectMethod` into the ASP.NET data cache.</span></span> <span data-ttu-id="60a7b-303">`CacheDuration` 和 `CacheExpirationPolicy` 属性指示项缓存的持续时间，以及它是绝对过期还是可调过期。</span><span class="sxs-lookup"><span data-stu-id="60a7b-303">The `CacheDuration` and `CacheExpirationPolicy` properties indicate the duration the item is cached and whether it is an absolute or sliding expiration.</span></span> <span data-ttu-id="60a7b-304">`CacheKeyDependency` 属性将所有 ObjectDataSource s 缓存条目与现有缓存依赖关系关联。</span><span class="sxs-lookup"><span data-stu-id="60a7b-304">The `CacheKeyDependency` property associates all of the ObjectDataSource s cache entries with an existing cache dependency.</span></span> <span data-ttu-id="60a7b-305">这可用于在达到基于时间的过期之前从缓存中逐出 ObjectDataSource 条目，并且通常用于 SQL 缓存依赖项。</span><span class="sxs-lookup"><span data-stu-id="60a7b-305">This can be used to evict the ObjectDataSource s entries from the cache before the time-based expiration is reached, and is typically used with SQL cache dependencies.</span></span>

<span data-ttu-id="60a7b-306">由于 ObjectDataSource 只是将其值缓存到数据缓存中，因此我们可以以编程方式复制 ObjectDataSource 的内置功能。</span><span class="sxs-lookup"><span data-stu-id="60a7b-306">Since the ObjectDataSource simply caches its values to the data cache, we could replicate the ObjectDataSource s built-in functionality programmatically.</span></span> <span data-ttu-id="60a7b-307">在表示层执行此操作并无意义，因为 ObjectDataSource 提供现成的功能，但可以在体系结构的一个单独的层中实现缓存功能。</span><span class="sxs-lookup"><span data-stu-id="60a7b-307">It doesn t make sense to do this at the Presentation Layer, since the ObjectDataSource offers this functionality out of the box, but we can implement caching capabilities in a separate layer of the architecture.</span></span> <span data-ttu-id="60a7b-308">为此，我们需要重复该 ObjectDataSource 使用的相同逻辑。</span><span class="sxs-lookup"><span data-stu-id="60a7b-308">To do so, we'll need to repeat the same logic used by the ObjectDataSource.</span></span> <span data-ttu-id="60a7b-309">我们将在下一教程中了解如何以编程方式在体系结构中使用数据缓存。</span><span class="sxs-lookup"><span data-stu-id="60a7b-309">We'll explore how to programmatically work with the data cache from within the architecture in our next tutorial.</span></span>

<span data-ttu-id="60a7b-310">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="60a7b-310">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="60a7b-311">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="60a7b-311">Further Reading</span></span>

<span data-ttu-id="60a7b-312">有关本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="60a7b-312">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="60a7b-313">ASP.NET 缓存：技术和最佳做法</span><span class="sxs-lookup"><span data-stu-id="60a7b-313">ASP.NET Caching: Techniques and Best Practices</span></span>](https://msdn.microsoft.com/library/aa478965.aspx)
- [<span data-ttu-id="60a7b-314">.NET Framework 应用程序的缓存体系结构指南</span><span class="sxs-lookup"><span data-stu-id="60a7b-314">Caching Architecture Guide for .NET Framework Applications</span></span>](https://msdn.microsoft.com/library/ee817645.aspx)
- [<span data-ttu-id="60a7b-315">ASP.NET 2.0 中的输出缓存</span><span class="sxs-lookup"><span data-stu-id="60a7b-315">Output Caching in ASP.NET 2.0</span></span>](http://aspnet.4guysfromrolla.com/articles/121306-1.aspx)

## <a name="about-the-author"></a><span data-ttu-id="60a7b-316">关于作者</span><span class="sxs-lookup"><span data-stu-id="60a7b-316">About the Author</span></span>

<span data-ttu-id="60a7b-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，创始人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已在使用 Microsoft Web 技术，自1998开始。</span><span class="sxs-lookup"><span data-stu-id="60a7b-317">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="60a7b-318">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="60a7b-318">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="60a7b-319">他的最新书籍是，[*在24小时内，sam ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="60a7b-319">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="60a7b-320">可以[mitchell@4GuysFromRolla.com访问。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="60a7b-320">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="60a7b-321">或通过他的博客，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="60a7b-321">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="60a7b-322">特别感谢</span><span class="sxs-lookup"><span data-stu-id="60a7b-322">Special Thanks To</span></span>

<span data-ttu-id="60a7b-323">此教程系列由许多有用的审阅者查看。</span><span class="sxs-lookup"><span data-stu-id="60a7b-323">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="60a7b-324">本教程的主管审查人员是 Teresa Murphy。</span><span class="sxs-lookup"><span data-stu-id="60a7b-324">Lead reviewer for this tutorial was Teresa Murphy.</span></span> <span data-ttu-id="60a7b-325">想要查看我即将发布的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="60a7b-325">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="60a7b-326">如果是这样，请在mitchell@4GuysFromRolla.com放置一行[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="60a7b-326">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="60a7b-327">[上一页](using-sql-cache-dependencies-cs.md)
> [下一页](caching-data-in-the-architecture-vb.md)</span><span class="sxs-lookup"><span data-stu-id="60a7b-327">[Previous](using-sql-cache-dependencies-cs.md)
[Next](caching-data-in-the-architecture-vb.md)</span></span>

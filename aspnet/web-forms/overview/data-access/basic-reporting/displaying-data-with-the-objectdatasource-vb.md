---
uid: web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-vb
title: 用 ObjectDataSource 显示数据（VB） |Microsoft Docs
author: rick-anderson
description: 本教程将使用此控件查看 ObjectDataSource 控件，可以绑定从上一教程中创建的 BLL 检索的数据，无需 havi 。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: d62c3a63-0940-4019-874e-4a4047df0c1c
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/displaying-data-with-the-objectdatasource-vb
msc.type: authoredcontent
ms.openlocfilehash: 754188352cbfb08e610027f5b7890a32bd88ae26
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2019
ms.locfileid: "74608883"
---
# <a name="displaying-data-with-the-objectdatasource-vb"></a><span data-ttu-id="63048-103">使用 ObjectDataSource 显示数据 (VB)</span><span class="sxs-lookup"><span data-stu-id="63048-103">Displaying Data With the ObjectDataSource (VB)</span></span>

<span data-ttu-id="63048-104">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="63048-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="63048-105">[下载示例应用](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_4_VB.exe)或[下载 PDF](displaying-data-with-the-objectdatasource-vb/_static/datatutorial04vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="63048-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_4_VB.exe) or [Download PDF](displaying-data-with-the-objectdatasource-vb/_static/datatutorial04vb1.pdf)</span></span>

> <span data-ttu-id="63048-106">本教程将使用此控件查看 ObjectDataSource 控件，可以绑定从上一教程中创建的 BLL 检索的数据，而无需编写代码行！</span><span class="sxs-lookup"><span data-stu-id="63048-106">This tutorial looks at the ObjectDataSource control Using this control you can bind data retrieved from the BLL created in the previous tutorial without having to write a line of code!</span></span>

## <a name="introduction"></a><span data-ttu-id="63048-107">简介</span><span class="sxs-lookup"><span data-stu-id="63048-107">Introduction</span></span>

<span data-ttu-id="63048-108">随着应用程序体系结构和网站页面布局的完成，我们已准备好开始探索如何完成各种常见的数据和与报表相关的任务。</span><span class="sxs-lookup"><span data-stu-id="63048-108">With our application architecture and website page layout complete, we're ready to start exploring how to accomplish a variety of common data- and reporting-related tasks.</span></span> <span data-ttu-id="63048-109">在前面的教程中，我们已了解如何以编程方式将来自 DAL 和 BLL 的数据绑定到 ASP.NET 页中的数据 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="63048-109">In the previous tutorials we've seen how to programmatically bind data from the DAL and BLL to a data Web control in an ASP.NET page.</span></span> <span data-ttu-id="63048-110">此语法将数据 Web 控件的 `DataSource` 属性分配给要显示的数据，然后调用该控件的 `DataBind()` 方法是 ASP.NET 1.x 应用程序中使用的模式，可以继续在2.0 应用程序中使用。</span><span class="sxs-lookup"><span data-stu-id="63048-110">This syntax assigning the data Web control's `DataSource` property to the data to display and then calling the control's `DataBind()` method was the pattern used in ASP.NET 1.x applications, and can continue to be used in your 2.0 applications.</span></span> <span data-ttu-id="63048-111">但是，ASP.NET 2.0 的新数据源控件提供了一种用于处理数据的声明性方式。</span><span class="sxs-lookup"><span data-stu-id="63048-111">However, ASP.NET 2.0's new data source controls offer a declarative way to work with data.</span></span> <span data-ttu-id="63048-112">使用这些控件，可以绑定从上一教程中创建的 BLL 检索的数据，而无需编写代码行！</span><span class="sxs-lookup"><span data-stu-id="63048-112">Using these controls you can bind data retrieved from the BLL created in the previous tutorial without having to write a line of code!</span></span>

<span data-ttu-id="63048-113">ASP.NET 2.0 随附了五个内置数据源控件[SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx)、 [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx)、 [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx)、 [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx)和[SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx) ，不过，如果需要，你可以构建自己的[自定义数据源控件](https://msdn.microsoft.com/library/default.asp?url=/library/dnvs05/html/DataSourceCon1.asp)。</span><span class="sxs-lookup"><span data-stu-id="63048-113">ASP.NET 2.0 ships with five built-in data source controls [SqlDataSource](https://msdn.microsoft.com/library/dz12d98w%28vs.80%29.aspx), [AccessDataSource](https://msdn.microsoft.com/library/8e5545e1.aspx), [ObjectDataSource](https://msdn.microsoft.com/library/9a4kyhcx.aspx), [XmlDataSource](https://msdn.microsoft.com/library/e8d8587a%28en-US,VS.80%29.aspx), and [SiteMapDataSource](https://msdn.microsoft.com/library/5ex9t96x%28en-US,VS.80%29.aspx) although you can build your own [custom data source controls](https://msdn.microsoft.com/library/default.asp?url=/library/dnvs05/html/DataSourceCon1.asp), if needed.</span></span> <span data-ttu-id="63048-114">由于我们已开发了一个适用于我们的教程应用程序的体系结构，我们将针对 BLL 类使用 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="63048-114">Since we have developed an architecture for our tutorial application, we'll be using the ObjectDataSource against our BLL classes.</span></span>

![ASP.NET 2.0 包括五个内置数据源控件](displaying-data-with-the-objectdatasource-vb/_static/image1.png)

<span data-ttu-id="63048-116">**图 1**： ASP.NET 2.0 包括五个内置数据源控件</span><span class="sxs-lookup"><span data-stu-id="63048-116">**Figure 1**: ASP.NET 2.0 Includes Five Built-In Data Source Controls</span></span>

<span data-ttu-id="63048-117">ObjectDataSource 充当用于处理其他某个对象的代理。</span><span class="sxs-lookup"><span data-stu-id="63048-117">The ObjectDataSource serves as a proxy for working with some other object.</span></span> <span data-ttu-id="63048-118">若要配置 ObjectDataSource，我们需要指定此基础对象，以及其方法是如何映射到 ObjectDataSource 的 `Select`、`Insert`、`Update`和 `Delete` 方法。</span><span class="sxs-lookup"><span data-stu-id="63048-118">To configure the ObjectDataSource we specify this underlying object and how its methods map to the ObjectDataSource's `Select`, `Insert`, `Update`, and `Delete` methods.</span></span> <span data-ttu-id="63048-119">指定此基础对象并将其方法映射到 ObjectDataSource 后，接下来我们可以将该 ObjectDataSource 绑定到数据 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="63048-119">Once this underlying object has been specified and its methods mapped to the ObjectDataSource's, we can then bind the ObjectDataSource to a data Web control.</span></span> <span data-ttu-id="63048-120">ASP.NET 附带了许多数据 Web 控件，其中包括 GridView、DetailsView、RadioButtonList 和 DropDownList 等。</span><span class="sxs-lookup"><span data-stu-id="63048-120">ASP.NET ships with many data Web controls, including the GridView, DetailsView, RadioButtonList, and DropDownList, among others.</span></span> <span data-ttu-id="63048-121">在页生命周期内，数据 Web 控件可能需要访问它所绑定到的数据，这将通过调用其 ObjectDataSource 的 `Select` 方法来实现;如果数据 Web 控件支持插入、更新或删除，则可以对其 ObjectDataSource 的 `Insert`、`Update`或 `Delete` 方法进行调用。</span><span class="sxs-lookup"><span data-stu-id="63048-121">During the page lifecycle, the data Web control may need to access the data it's bound to, which it will accomplish by invoking its ObjectDataSource's `Select` method; if the data Web control supports inserting, updating, or deleting, calls may be made to its ObjectDataSource's `Insert`, `Update`, or `Delete` methods.</span></span> <span data-ttu-id="63048-122">然后，ObjectDataSource 将这些调用路由到相应的基础对象的方法，如下图所示。</span><span class="sxs-lookup"><span data-stu-id="63048-122">These calls are then routed by the ObjectDataSource to the appropriate underlying object's methods as the following diagram illustrates.</span></span>

<span data-ttu-id="63048-123">[![ObjectDataSource 充当代理](displaying-data-with-the-objectdatasource-vb/_static/image3.png)](displaying-data-with-the-objectdatasource-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="63048-123">[![The ObjectDataSource Serves as a Proxy](displaying-data-with-the-objectdatasource-vb/_static/image3.png)](displaying-data-with-the-objectdatasource-vb/_static/image2.png)</span></span>

<span data-ttu-id="63048-124">**图 2**： ObjectDataSource 充当代理（[单击以查看完全大小的映像](displaying-data-with-the-objectdatasource-vb/_static/image4.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-124">**Figure 2**: The ObjectDataSource Serves as a Proxy ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image4.png))</span></span>

<span data-ttu-id="63048-125">尽管可以使用 ObjectDataSource 来调用用于插入、更新或删除数据的方法，但我们只需专注于返回数据;将来的教程将探讨如何使用用于修改数据的 ObjectDataSource 和数据 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="63048-125">While the ObjectDataSource can be used to invoke methods for inserting, updating, or deleting data, let's just focus on returning data; future tutorials will explore using the ObjectDataSource and data Web controls that modify data.</span></span>

## <a name="step-1-adding-and-configuring-the-objectdatasource-control"></a><span data-ttu-id="63048-126">步骤1：添加和配置 ObjectDataSource 控件</span><span class="sxs-lookup"><span data-stu-id="63048-126">Step 1: Adding and Configuring the ObjectDataSource Control</span></span>

<span data-ttu-id="63048-127">首先打开 `BasicReporting` 文件夹中的 "`SimpleDisplay.aspx`" 页，切换到设计视图，然后将 "ObjectDataSource" 控件从 "工具箱" 拖动到页面的设计图面上。</span><span class="sxs-lookup"><span data-stu-id="63048-127">Start by opening the `SimpleDisplay.aspx` page in the `BasicReporting` folder, switch to Design view, and then drag an ObjectDataSource control from the Toolbox onto the page's design surface.</span></span> <span data-ttu-id="63048-128">ObjectDataSource 在设计图面上显示为灰色框，因为它不生成任何标记;它只是通过从指定的对象调用方法来访问数据。</span><span class="sxs-lookup"><span data-stu-id="63048-128">The ObjectDataSource appears as a gray box on the design surface because it does not produce any markup; it simply accesses data by invoking a method from a specified object.</span></span> <span data-ttu-id="63048-129">ObjectDataSource 返回的数据可以通过数据 Web 控件显示，例如 GridView、DetailsView、FormView 等。</span><span class="sxs-lookup"><span data-stu-id="63048-129">The data returned by an ObjectDataSource can be displayed by a data Web control, such as the GridView, DetailsView, FormView, and so on.</span></span>

> [!NOTE]
> <span data-ttu-id="63048-130">或者，您可以首先将数据 Web 控件添加到页面，然后从其智能标记中，从下拉列表中选择 "&lt;新建数据源&gt;" 选项。</span><span class="sxs-lookup"><span data-stu-id="63048-130">Alternatively, you may first add the data Web control to the page and then, from its smart tag, choose the &lt;New data source&gt; option from the drop-down list.</span></span>

<span data-ttu-id="63048-131">若要指定 ObjectDataSource 的基础对象以及该对象的方法映射到 ObjectDataSource 的方式，请单击该 ObjectDataSource 的智能标记中的 "配置数据源" 链接。</span><span class="sxs-lookup"><span data-stu-id="63048-131">To specify the ObjectDataSource's underlying object and how that object's methods map to the ObjectDataSource's, click on the Configure Data Source link from the ObjectDataSource's smart tag.</span></span>

<span data-ttu-id="63048-132">[![单击智能标记中的 "配置数据源" 链接](displaying-data-with-the-objectdatasource-vb/_static/image6.png)](displaying-data-with-the-objectdatasource-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="63048-132">[![Click the Configure Data Source Link from the Smart Tag](displaying-data-with-the-objectdatasource-vb/_static/image6.png)](displaying-data-with-the-objectdatasource-vb/_static/image5.png)</span></span>

<span data-ttu-id="63048-133">**图 3**：从智能标记中单击 "配置数据源" 链接（[单击以查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image7.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-133">**Figure 3**: Click the Configure Data Source Link from the Smart Tag ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image7.png))</span></span>

<span data-ttu-id="63048-134">此时将打开 "配置数据源" 向导。</span><span class="sxs-lookup"><span data-stu-id="63048-134">This brings up the Configure Data Source wizard.</span></span> <span data-ttu-id="63048-135">首先，必须指定 ObjectDataSource 要使用的对象。</span><span class="sxs-lookup"><span data-stu-id="63048-135">First, we must specify the object the ObjectDataSource is to work with.</span></span> <span data-ttu-id="63048-136">如果选中了 "仅显示数据组件" 复选框，则此屏幕上的下拉列表将仅列出已使用 `DataObject` 特性修饰的对象。</span><span class="sxs-lookup"><span data-stu-id="63048-136">If the "Show only data components" checkbox is checked, the drop-down list on this screen lists only those objects that have been decorated with the `DataObject` attribute.</span></span> <span data-ttu-id="63048-137">目前，我们的列表包含在上一教程中创建的类型化数据集和 BLL 类中的 Tableadapter。</span><span class="sxs-lookup"><span data-stu-id="63048-137">Currently our list includes the TableAdapters in the Typed DataSet and the BLL classes we created in the previous tutorial.</span></span> <span data-ttu-id="63048-138">如果忘记将 `DataObject` 特性添加到业务逻辑层类，则不会在此列表中看到它们。</span><span class="sxs-lookup"><span data-stu-id="63048-138">If you forgot to add the `DataObject` attribute to the Business Logic Layer classes you won't see them in this list.</span></span> <span data-ttu-id="63048-139">在这种情况下，取消选中 "仅显示数据组件" 复选框，以查看所有对象，这些对象应包括 BLL 类（以及数据表、Datarow 等的类型化数据集中的其他类）。</span><span class="sxs-lookup"><span data-stu-id="63048-139">In that case, uncheck the "Show only data components" checkbox to view all objects, which should include the BLL classes (along with the other classes in the Typed DataSet the DataTables, DataRows, and so on).</span></span>

<span data-ttu-id="63048-140">在第一个屏幕中，从下拉列表中选择 `ProductsBLL` 类，然后单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="63048-140">From this first screen choose the `ProductsBLL` class from the drop-down list and click Next.</span></span>

<span data-ttu-id="63048-141">[![指定要用于 ObjectDataSource 控件的对象](displaying-data-with-the-objectdatasource-vb/_static/image9.png)](displaying-data-with-the-objectdatasource-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="63048-141">[![Specify the Object to Use with the ObjectDataSource Control](displaying-data-with-the-objectdatasource-vb/_static/image9.png)](displaying-data-with-the-objectdatasource-vb/_static/image8.png)</span></span>

<span data-ttu-id="63048-142">**图 4**：指定要用于 ObjectDataSource 控件的对象（[单击以查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-142">**Figure 4**: Specify the Object to Use with the ObjectDataSource Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image10.png))</span></span>

<span data-ttu-id="63048-143">向导中的下一个屏幕提示您选择 ObjectDataSource 应调用的方法。</span><span class="sxs-lookup"><span data-stu-id="63048-143">The next screen in the wizard prompts you to select what method the ObjectDataSource should invoke.</span></span> <span data-ttu-id="63048-144">下拉列表列出了返回从上一屏幕中选择的对象中的数据的方法。</span><span class="sxs-lookup"><span data-stu-id="63048-144">The drop-down lists those methods that return data in the object selected from the previous screen.</span></span> <span data-ttu-id="63048-145">在这里，我们将看到 `GetProductByProductID`、`GetProducts`、`GetProductsByCategoryID`和 `GetProductsBySupplierID`。</span><span class="sxs-lookup"><span data-stu-id="63048-145">Here we see `GetProductByProductID`, `GetProducts`, `GetProductsByCategoryID`, and `GetProductsBySupplierID`.</span></span> <span data-ttu-id="63048-146">从下拉列表中选择 `GetProducts` 方法，然后单击 "完成" （如果已将 `DataObjectMethodAttribute` 添加到 `ProductBLL`的方法（如前面的教程中所示），则默认情况下将选中此选项。</span><span class="sxs-lookup"><span data-stu-id="63048-146">Select the `GetProducts` method from the drop-down list and click Finish (if you added the `DataObjectMethodAttribute` to the `ProductBLL`'s methods as shown in the previous tutorial, this option will be selected by default).</span></span>

<span data-ttu-id="63048-147">[![从 "选择" 选项卡中选择返回数据的方法](displaying-data-with-the-objectdatasource-vb/_static/image12.png)](displaying-data-with-the-objectdatasource-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="63048-147">[![Choose the Method for Returning Data from the SELECT Tab](displaying-data-with-the-objectdatasource-vb/_static/image12.png)](displaying-data-with-the-objectdatasource-vb/_static/image11.png)</span></span>

<span data-ttu-id="63048-148">**图 5**：从 "选择" 选项卡中选择返回数据的方法（[单击查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image13.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-148">**Figure 5**: Choose the Method for Returning Data from the SELECT Tab ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image13.png))</span></span>

## <a name="configure-the-objectdatasource-manually"></a><span data-ttu-id="63048-149">手动配置 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="63048-149">Configure the ObjectDataSource Manually</span></span>

<span data-ttu-id="63048-150">ObjectDataSource 的 "配置数据源" 向导提供了一种快速方法来指定它使用的对象，并将调用对象的哪些方法关联起来。</span><span class="sxs-lookup"><span data-stu-id="63048-150">The ObjectDataSource's Configure Data Source wizard offers a quick way to specify the object it uses and to associate what methods of the object are invoked.</span></span> <span data-ttu-id="63048-151">但是，可以通过属性窗口或直接在声明性标记中，通过其属性配置 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="63048-151">You can, however, configure the ObjectDataSource through its properties, either through the Properties window or directly in the declarative markup.</span></span> <span data-ttu-id="63048-152">只需将 `TypeName` 属性设置为要使用的基础对象的类型，并将 `SelectMethod` 设置为在检索数据时要调用的方法。</span><span class="sxs-lookup"><span data-stu-id="63048-152">Simply set the `TypeName` property to the type of the underlying object to be used, and the `SelectMethod` to the method to invoke when retrieving data.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample1.aspx)]

<span data-ttu-id="63048-153">即使您更喜欢 "配置数据源" 向导，有时也可能需要手动配置 ObjectDataSource，因为向导仅列出开发人员创建的类。</span><span class="sxs-lookup"><span data-stu-id="63048-153">Even if you prefer the Configure Data Source wizard there may be times when you need to manually configure the ObjectDataSource, as the wizard only lists developer-created classes.</span></span> <span data-ttu-id="63048-154">如果要将 ObjectDataSource 绑定到 .NET Framework （例如[成员身份类](https://msdn.microsoft.com/library/system.web.security.membership.aspx)）中的类，若要访问用户帐户信息或[目录类](https://msdn.microsoft.com/library/system.io.directory.aspx)以使用文件系统信息，则需要手动设置 ObjectDataSource 的属性。</span><span class="sxs-lookup"><span data-stu-id="63048-154">If you want to bind the ObjectDataSource to a class in the .NET Framework such as the [Membership class](https://msdn.microsoft.com/library/system.web.security.membership.aspx), to access user account information, or the [Directory class](https://msdn.microsoft.com/library/system.io.directory.aspx) to work with file system information you'll need to manually set the ObjectDataSource's properties.</span></span>

## <a name="step-2-adding-a-data-web-control-and-binding-it-to-the-objectdatasource"></a><span data-ttu-id="63048-155">步骤2：添加数据 Web 控件并将其绑定到 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="63048-155">Step 2: Adding a Data Web Control and Binding it to the ObjectDataSource</span></span>

<span data-ttu-id="63048-156">一旦将 ObjectDataSource 添加到页面并进行了配置，就可以将数据 Web 控件添加到页面，以显示由 ObjectDataSource 的 `Select` 方法返回的数据。</span><span class="sxs-lookup"><span data-stu-id="63048-156">Once the ObjectDataSource has been added to the page and configured, we're ready to add data Web controls to the page to display the data returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="63048-157">任何数据 Web 控件都可以绑定到 ObjectDataSource;让我们看看如何在 GridView、DetailsView 和 FormView 中显示 ObjectDataSource 的数据。</span><span class="sxs-lookup"><span data-stu-id="63048-157">Any data Web control can be bound to an ObjectDataSource; let's look at displaying the ObjectDataSource's data in a GridView, DetailsView, and FormView.</span></span>

## <a name="binding-a-gridview-to-the-objectdatasource"></a><span data-ttu-id="63048-158">将 GridView 绑定到 ObjectDataSource</span><span class="sxs-lookup"><span data-stu-id="63048-158">Binding a GridView to the ObjectDataSource</span></span>

<span data-ttu-id="63048-159">将工具箱中的 GridView 控件添加到 `SimpleDisplay.aspx`的设计图面。</span><span class="sxs-lookup"><span data-stu-id="63048-159">Add a GridView control from the Toolbox to `SimpleDisplay.aspx`'s design surface.</span></span> <span data-ttu-id="63048-160">从 GridView 的智能标记中，选择在步骤1中添加的 ObjectDataSource 控件。</span><span class="sxs-lookup"><span data-stu-id="63048-160">From the GridView's smart tag, choose the ObjectDataSource control we added in Step 1.</span></span> <span data-ttu-id="63048-161">这会自动为 ObjectDataSource `Select` 方法（即 Products DataTable 定义的属性）中的数据返回的每个属性创建 BoundField。</span><span class="sxs-lookup"><span data-stu-id="63048-161">This will automatically create a BoundField in the GridView for each property returned by the data from the ObjectDataSource's `Select` method (namely, the properties defined by the Products DataTable).</span></span>

<span data-ttu-id="63048-162">[![已将 GridView 添加到页面并绑定到 ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image15.png)](displaying-data-with-the-objectdatasource-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="63048-162">[![A GridView Has Been Added to the Page and Bound to the ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image15.png)](displaying-data-with-the-objectdatasource-vb/_static/image14.png)</span></span>

<span data-ttu-id="63048-163">**图 6**：已将 GridView 添加到页面并绑定到 ObjectDataSource （[单击以查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image16.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-163">**Figure 6**: A GridView Has Been Added to the Page and Bound to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image16.png))</span></span>

<span data-ttu-id="63048-164">然后，可以通过从智能标记中单击 "编辑列" 选项来自定义、重新排列或删除 GridView 的 BoundFields。</span><span class="sxs-lookup"><span data-stu-id="63048-164">You can then customize, rearrange, or remove the GridView's BoundFields by clicking the Edit Columns option from the smart tag.</span></span>

<span data-ttu-id="63048-165">[![通过 "编辑列" 对话框管理 GridView 的 BoundFields](displaying-data-with-the-objectdatasource-vb/_static/image18.png)](displaying-data-with-the-objectdatasource-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="63048-165">[![Manage the GridView's BoundFields Through the Edit Columns Dialog Box](displaying-data-with-the-objectdatasource-vb/_static/image18.png)](displaying-data-with-the-objectdatasource-vb/_static/image17.png)</span></span>

<span data-ttu-id="63048-166">**图 7**：通过 "编辑列" 对话框管理 GridView 的 BoundFields （[单击以查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image19.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-166">**Figure 7**: Manage the GridView's BoundFields Through the Edit Columns Dialog Box ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image19.png))</span></span>

<span data-ttu-id="63048-167">花点时间修改 GridView 的 BoundFields，删除 `ProductID`、`SupplierID`、`CategoryID`、`QuantityPerUnit`、`UnitsInStock`、`UnitsOnOrder`和 `ReorderLevel` BoundFields。</span><span class="sxs-lookup"><span data-stu-id="63048-167">Take a moment to modify the GridView's BoundFields, removing the `ProductID`, `SupplierID`, `CategoryID`, `QuantityPerUnit`, `UnitsInStock`, `UnitsOnOrder`, and `ReorderLevel` BoundFields.</span></span> <span data-ttu-id="63048-168">只需从左下方的列表中选择 "BoundField"，然后单击 "删除" 按钮（红色 X）即可将其删除。</span><span class="sxs-lookup"><span data-stu-id="63048-168">Simply select the BoundField from the list in the bottom left and click the delete button (the red X) to remove them.</span></span> <span data-ttu-id="63048-169">接下来，重新排列 BoundFields，以便 `CategoryName` 和 `SupplierName` BoundFields 在 `UnitPrice` BoundField 之前，选择这些 BoundFields 并单击向上箭头。</span><span class="sxs-lookup"><span data-stu-id="63048-169">Next, Rearrange the BoundFields so that the `CategoryName` and `SupplierName` BoundFields precede the `UnitPrice` BoundField by selecting these BoundFields and clicking the up arrow.</span></span> <span data-ttu-id="63048-170">将剩余 BoundFields 的 `HeaderText` 属性分别设置为 "`Products`"、"`Category`"、"`Supplier`" 和 "`Price`"。</span><span class="sxs-lookup"><span data-stu-id="63048-170">Set the `HeaderText` properties of the remaining BoundFields to `Products`, `Category`, `Supplier`, and `Price`, respectively.</span></span> <span data-ttu-id="63048-171">接下来，通过将 BoundField 的 `HtmlEncode` 属性设置为 False，将 `Price` BoundField 的格式设置为 "False"，并将其 `DataFormatString` 属性设置为 "`{0:c}`"。</span><span class="sxs-lookup"><span data-stu-id="63048-171">Next, have the `Price` BoundField formatted as a currency by setting the BoundField's `HtmlEncode` property to False and its `DataFormatString` property to `{0:c}`.</span></span> <span data-ttu-id="63048-172">最后，在水平方向上将 `Price` 向右对齐，并通过 `ItemStyle`/`HorizontalAlign` 属性将中心 `Discontinued` 复选框水平对齐。</span><span class="sxs-lookup"><span data-stu-id="63048-172">Finally, horizontally align the `Price` to the right and the `Discontinued` checkbox in the center via the `ItemStyle`/`HorizontalAlign` property.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample2.aspx)]

<span data-ttu-id="63048-173">[已自定义 GridView BoundFields ![](displaying-data-with-the-objectdatasource-vb/_static/image21.png)](displaying-data-with-the-objectdatasource-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="63048-173">[![The GridView's BoundFields Have Been Customized](displaying-data-with-the-objectdatasource-vb/_static/image21.png)](displaying-data-with-the-objectdatasource-vb/_static/image20.png)</span></span>

<span data-ttu-id="63048-174">**图 8**：已经自定义了 GridView 的 BoundFields （[单击查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image22.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-174">**Figure 8**: The GridView's BoundFields Have Been Customized ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image22.png))</span></span>

## <a name="using-themes-for-a-consistent-look"></a><span data-ttu-id="63048-175">使用主题实现一致的外观</span><span class="sxs-lookup"><span data-stu-id="63048-175">Using Themes for a Consistent Look</span></span>

<span data-ttu-id="63048-176">这些教程尽力删除任何控件级样式设置，而不是尽可能使用外部文件中定义的级联样式表。</span><span class="sxs-lookup"><span data-stu-id="63048-176">These tutorials strive to remove any control-level style settings, instead using cascading style sheets defined in an external file whenever possible.</span></span> <span data-ttu-id="63048-177">`Styles.css` 文件包含 `DataWebControlStyle`、`HeaderStyle`、`RowStyle`和 `AlternatingRowStyle` CSS 类，它们应该用于决定这些教程中所使用的数据 Web 控件的外观。</span><span class="sxs-lookup"><span data-stu-id="63048-177">The `Styles.css` file contains `DataWebControlStyle`, `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` CSS classes that should be used to dictate the appearance of the data Web controls used in these tutorials.</span></span> <span data-ttu-id="63048-178">为实现此目的，我们可以将 GridView 的 `CssClass` 属性设置为 `DataWebControlStyle`，并相应地设置其 `HeaderStyle`、`RowStyle`和 `AlternatingRowStyle` 属性。</span><span class="sxs-lookup"><span data-stu-id="63048-178">To accomplish this, we could set the GridView's `CssClass` property to `DataWebControlStyle`, and its `HeaderStyle`, `RowStyle`, and `AlternatingRowStyle` properties' `CssClass` properties accordingly.</span></span>

<span data-ttu-id="63048-179">如果在 Web 控件中设置这些 `CssClass` 属性，我们需要记得为每个已添加到教程中的数据 Web 控件显式设置这些属性值。</span><span class="sxs-lookup"><span data-stu-id="63048-179">If we set these `CssClass` properties at the Web control we'd need to remember to explicitly set these property values for each and every data Web control added to our tutorials.</span></span> <span data-ttu-id="63048-180">更易于管理的方法是使用主题为 GridView、DetailsView 和 FormView 控件定义默认的与 CSS 相关的属性。</span><span class="sxs-lookup"><span data-stu-id="63048-180">A more manageable approach is to define the default CSS-related properties for the GridView, DetailsView, and FormView controls using a Theme.</span></span> <span data-ttu-id="63048-181">主题是可应用于站点中的页面以强制使用常见外观的控件级属性设置、图像和 CSS 类的集合。</span><span class="sxs-lookup"><span data-stu-id="63048-181">A Theme is a collection of control-level property settings, images, and CSS classes that can be applied to pages across a site to enforce a common look and feel.</span></span>

<span data-ttu-id="63048-182">本主题不包括任何图像或 CSS 文件（我们会在 web 应用程序的根文件夹中按原样 `Styles.css` 原样保留样式表，但将包括两个外观。</span><span class="sxs-lookup"><span data-stu-id="63048-182">Our Theme won't include any images or CSS files (we'll leave the stylesheet `Styles.css` as-is, defined in the root folder of the web application), but will include two Skins.</span></span> <span data-ttu-id="63048-183">外观是一个文件，用于定义 Web 控件的默认属性。</span><span class="sxs-lookup"><span data-stu-id="63048-183">A Skin is a file that defines the default properties for a Web control.</span></span> <span data-ttu-id="63048-184">具体而言，我们将有一个用于 GridView 和 DetailsView 控件的外观文件，用于指示默认 `CssClass`相关的属性。</span><span class="sxs-lookup"><span data-stu-id="63048-184">Specifically, we'll have a Skin file for the GridView and DetailsView controls, indicating the default `CssClass`-related properties.</span></span>

<span data-ttu-id="63048-185">首先，在解决方案资源管理器中右键单击项目名称，然后选择 "添加新项"，以将新的外观文件添加到名为 `GridView.skin` 的项目。</span><span class="sxs-lookup"><span data-stu-id="63048-185">Start by adding a new Skin File to your project named `GridView.skin` by right-clicking on the project name in the Solution Explorer and choosing Add New Item.</span></span>

<span data-ttu-id="63048-186">[![添加名为 GridView 的外观文件](displaying-data-with-the-objectdatasource-vb/_static/image24.png)](displaying-data-with-the-objectdatasource-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="63048-186">[![Add a Skin File Named GridView.skin](displaying-data-with-the-objectdatasource-vb/_static/image24.png)](displaying-data-with-the-objectdatasource-vb/_static/image23.png)</span></span>

<span data-ttu-id="63048-187">**图 9**：添加一个名为 `GridView.skin` 的外观文件（[单击以查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image25.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-187">**Figure 9**: Add a Skin File Named `GridView.skin` ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image25.png))</span></span>

<span data-ttu-id="63048-188">外观文件需要放在位于 `App_Themes` 文件夹中的主题中。</span><span class="sxs-lookup"><span data-stu-id="63048-188">Skin files need to be placed in a Theme, which are located in the `App_Themes` folder.</span></span> <span data-ttu-id="63048-189">由于我们还没有这样一个文件夹，因此，在添加第一个外观时，Visual Studio 将为我们创建一个。</span><span class="sxs-lookup"><span data-stu-id="63048-189">Since we don't yet have such a folder, Visual Studio will kindly offer to create one for us when adding our first Skin.</span></span> <span data-ttu-id="63048-190">单击 "是" 以创建 `App_Theme` 文件夹，然后将新的 `GridView.skin` 文件放在此处。</span><span class="sxs-lookup"><span data-stu-id="63048-190">Click Yes to create the `App_Theme` folder and place the new `GridView.skin` file there.</span></span>

<span data-ttu-id="63048-191">[![让 Visual Studio 创建 App_Theme 文件夹](displaying-data-with-the-objectdatasource-vb/_static/image27.png)](displaying-data-with-the-objectdatasource-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="63048-191">[![Let Visual Studio Create the App_Theme Folder](displaying-data-with-the-objectdatasource-vb/_static/image27.png)](displaying-data-with-the-objectdatasource-vb/_static/image26.png)</span></span>

<span data-ttu-id="63048-192">**图 10**：让 Visual Studio 创建 `App_Theme` 文件夹（[单击查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image28.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-192">**Figure 10**: Let Visual Studio Create the `App_Theme` Folder ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image28.png))</span></span>

<span data-ttu-id="63048-193">这会在名为 GridView 的 `App_Themes` 文件夹中创建一个新主题，并 `GridView.skin`外观文件。</span><span class="sxs-lookup"><span data-stu-id="63048-193">This will create a new Theme in the `App_Themes` folder named GridView with the Skin file `GridView.skin`.</span></span>

![GridView 主题已添加到 App_Theme 文件夹](displaying-data-with-the-objectdatasource-vb/_static/image29.png)

<span data-ttu-id="63048-195">**图 11**： GridView 主题已添加到 `App_Theme` 文件夹</span><span class="sxs-lookup"><span data-stu-id="63048-195">**Figure 11**: The GridView Theme has Been Added to the `App_Theme` Folder</span></span>

<span data-ttu-id="63048-196">将 GridView 主题重命名为 "DataWebControls" （右键单击 `App_Theme` 文件夹中的 GridView 文件夹，然后选择 "重命名"）。</span><span class="sxs-lookup"><span data-stu-id="63048-196">Rename the GridView Theme to DataWebControls (right-click on the GridView folder in the `App_Theme` folder and choose Rename).</span></span> <span data-ttu-id="63048-197">接下来，将以下标记输入到 `GridView.skin` 文件中：</span><span class="sxs-lookup"><span data-stu-id="63048-197">Next, enter the following markup into the `GridView.skin` file:</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample3.aspx)]

<span data-ttu-id="63048-198">这将为任何使用 DataWebControls 主题的页面中的任何 GridView 定义与 `CssClass`相关的属性的默认属性。</span><span class="sxs-lookup"><span data-stu-id="63048-198">This defines the default properties for the `CssClass`-related properties for any GridView in any page that uses the DataWebControls Theme.</span></span> <span data-ttu-id="63048-199">接下来，我们将为 DetailsView 添加另一个外观，这是我们稍后将使用的数据 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="63048-199">Let's add another Skin for the DetailsView, a data Web control that we'll be using shortly.</span></span> <span data-ttu-id="63048-200">将新外观添加到名为 `DetailsView.skin` 的 DataWebControls 主题，并添加以下标记：</span><span class="sxs-lookup"><span data-stu-id="63048-200">Add a new Skin to the DataWebControls Theme named `DetailsView.skin` and add the following markup:</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample4.aspx)]

<span data-ttu-id="63048-201">定义主题后，最后一步是将主题应用于我们的 ASP.NET 页面。</span><span class="sxs-lookup"><span data-stu-id="63048-201">With our Theme defined, the last step is to apply the Theme to our ASP.NET page.</span></span> <span data-ttu-id="63048-202">主题可以逐页应用，也可以针对网站中的所有页面应用。</span><span class="sxs-lookup"><span data-stu-id="63048-202">A Theme can be applied on a page-by-page basis or for all pages in a website.</span></span> <span data-ttu-id="63048-203">让我们为网站中的所有页面使用此主题。</span><span class="sxs-lookup"><span data-stu-id="63048-203">Let's use this theme for all pages in the website.</span></span> <span data-ttu-id="63048-204">若要实现此目的，请将以下标记添加到 `Web.config`的 `<system.web>` 部分：</span><span class="sxs-lookup"><span data-stu-id="63048-204">To accomplish this, add the following markup to `Web.config`'s `<system.web>` section:</span></span>

[!code-xml[Main](displaying-data-with-the-objectdatasource-vb/samples/sample5.xml)]

<span data-ttu-id="63048-205">就这么简单！</span><span class="sxs-lookup"><span data-stu-id="63048-205">That's all there is to it!</span></span> <span data-ttu-id="63048-206">`styleSheetTheme` 设置指示主题中指定的属性*不*应重写在控件级别指定的属性。</span><span class="sxs-lookup"><span data-stu-id="63048-206">The `styleSheetTheme` setting indicates that the properties specified in the Theme should *not* override the properties specified at the control level.</span></span> <span data-ttu-id="63048-207">若要指定主题设置应王牌控制设置，请使用 `theme` 特性代替 `styleSheetTheme`;遗憾的是，主题设置不会出现在 Visual Studio 设计视图中。</span><span class="sxs-lookup"><span data-stu-id="63048-207">To specify that Theme settings should trump control settings, use the `theme` attribute in place of `styleSheetTheme`; unfortunately, Theme settings do not appear in the Visual Studio Design view.</span></span> <span data-ttu-id="63048-208">有关主题和外观的详细信息，请参阅[ASP.NET 主题和外观概述](https://msdn.microsoft.com/library/ykzx33wh.aspx)和[服务器端样式](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx)。有关将页配置为使用主题的详细信息，请参阅[如何：应用 ASP.NET 主题](https://msdn.microsoft.com/library/0yy5hxdk%28VS.80%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="63048-208">Refer to [ASP.NET Themes and Skins Overview](https://msdn.microsoft.com/library/ykzx33wh.aspx) and [Server-Side Styles Using Themes](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx) for more information on Themes and Skins; see [How To: Apply ASP.NET Themes](https://msdn.microsoft.com/library/0yy5hxdk%28VS.80%29.aspx) for more on configuring a page to use a theme.</span></span>

<span data-ttu-id="63048-209">[![GridView 显示产品的名称、类别、供应商、价格和废止信息](displaying-data-with-the-objectdatasource-vb/_static/image31.png)](displaying-data-with-the-objectdatasource-vb/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="63048-209">[![The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information](displaying-data-with-the-objectdatasource-vb/_static/image31.png)](displaying-data-with-the-objectdatasource-vb/_static/image30.png)</span></span>

<span data-ttu-id="63048-210">**图 12**： GridView 显示产品的名称、类别、供应商、价格和废止信息（[单击查看全尺寸图像](displaying-data-with-the-objectdatasource-vb/_static/image32.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-210">**Figure 12**: The GridView Displays the Product's Name, Category, Supplier, Price, and Discontinued Information ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image32.png))</span></span>

## <a name="displaying-one-record-at-a-time-in-the-detailsview"></a><span data-ttu-id="63048-211">在 DetailsView 中一次显示一条记录</span><span class="sxs-lookup"><span data-stu-id="63048-211">Displaying One Record at a Time in the DetailsView</span></span>

<span data-ttu-id="63048-212">GridView 为其绑定的数据源控件返回的每个记录显示一行。</span><span class="sxs-lookup"><span data-stu-id="63048-212">The GridView displays one row for each record returned by the data source control to which it's bound.</span></span> <span data-ttu-id="63048-213">但有时，我们可能希望一次只显示一个记录或一条记录。</span><span class="sxs-lookup"><span data-stu-id="63048-213">There are times, however, when we may want to display a sole record or just one record at a time.</span></span> <span data-ttu-id="63048-214">[DetailsView 控件](https://msdn.microsoft.com/library/s3w1w7t4.aspx)提供此功能，呈现为 HTML `<table>`，其中包含两列，每个绑定到控件的列或属性占一行。</span><span class="sxs-lookup"><span data-stu-id="63048-214">The [DetailsView control](https://msdn.microsoft.com/library/s3w1w7t4.aspx) offers this functionality, rendering as an HTML `<table>` with two columns and one row for each column or property bound to the control.</span></span> <span data-ttu-id="63048-215">您可以将 DetailsView 看作是一条记录旋转了90度的 GridView。</span><span class="sxs-lookup"><span data-stu-id="63048-215">You can think of the DetailsView as a GridView with a single record rotated 90 degrees.</span></span>

<span data-ttu-id="63048-216">首先在 `SimpleDisplay.aspx`中的 GridView*上方*添加一个 DetailsView 控件。</span><span class="sxs-lookup"><span data-stu-id="63048-216">Start by adding a DetailsView control *above* the GridView in `SimpleDisplay.aspx`.</span></span> <span data-ttu-id="63048-217">接下来，将其绑定到作为 GridView 的相同 ObjectDataSource 控件。</span><span class="sxs-lookup"><span data-stu-id="63048-217">Next, bind it to the same ObjectDataSource control as the GridView.</span></span> <span data-ttu-id="63048-218">与 GridView 一样，对于由 ObjectDataSource `Select` 方法返回的对象中的每个属性，都将向 DetailsView 添加一个 BoundField。</span><span class="sxs-lookup"><span data-stu-id="63048-218">Like with the GridView, a BoundField will be added to the DetailsView for each property in the object returned by the ObjectDataSource's `Select` method.</span></span> <span data-ttu-id="63048-219">唯一的区别是，DetailsView 的 BoundFields 水平布局，而不是垂直布局。</span><span class="sxs-lookup"><span data-stu-id="63048-219">The only difference is that the DetailsView's BoundFields are laid out horizontally rather than vertically.</span></span>

<span data-ttu-id="63048-220">[![向页面添加 DetailsView 并将其绑定到 ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image34.png)](displaying-data-with-the-objectdatasource-vb/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="63048-220">[![Add a DetailsView to the Page and Bind it to the ObjectDataSource](displaying-data-with-the-objectdatasource-vb/_static/image34.png)](displaying-data-with-the-objectdatasource-vb/_static/image33.png)</span></span>

<span data-ttu-id="63048-221">**图 13**：将 DetailsView 添加到页面并将其绑定到 ObjectDataSource （[单击以查看完全大小的映像](displaying-data-with-the-objectdatasource-vb/_static/image35.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-221">**Figure 13**: Add a DetailsView to the Page and Bind it to the ObjectDataSource ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image35.png))</span></span>

<span data-ttu-id="63048-222">与 GridView 一样，DetailsView 的 BoundFields 可以调整，以提供对 ObjectDataSource 返回的数据的更自定义显示。</span><span class="sxs-lookup"><span data-stu-id="63048-222">Like the GridView, the DetailsView's BoundFields can be tweaked to provide a more customized display of the data returned by the ObjectDataSource.</span></span> <span data-ttu-id="63048-223">图14显示了在其 BoundFields 和 `CssClass` 属性已配置为使其外观类似于 GridView 示例后的 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="63048-223">Figure 14 shows the DetailsView after its BoundFields and `CssClass` properties have been configured to make its appearance similar to the GridView example.</span></span>

<span data-ttu-id="63048-224">[![DetailsView 显示单个记录](displaying-data-with-the-objectdatasource-vb/_static/image37.png)](displaying-data-with-the-objectdatasource-vb/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="63048-224">[![The DetailsView Shows a Single Record](displaying-data-with-the-objectdatasource-vb/_static/image37.png)](displaying-data-with-the-objectdatasource-vb/_static/image36.png)</span></span>

<span data-ttu-id="63048-225">**图 14**： DetailsView 显示单个记录（[单击查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image38.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-225">**Figure 14**: The DetailsView Shows a Single Record ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image38.png))</span></span>

<span data-ttu-id="63048-226">请注意，DetailsView 只显示其数据源返回的第一条记录。</span><span class="sxs-lookup"><span data-stu-id="63048-226">Note that the DetailsView only displays the first record returned by its data source.</span></span> <span data-ttu-id="63048-227">若要允许用户单步执行所有记录，必须为 DetailsView 启用分页。</span><span class="sxs-lookup"><span data-stu-id="63048-227">To allow the user to step through all of the records, one at a time, we must enable paging for the DetailsView.</span></span> <span data-ttu-id="63048-228">为此，请返回到 Visual Studio 并选中 DetailsView 的智能标记中的 "启用分页" 复选框。</span><span class="sxs-lookup"><span data-stu-id="63048-228">To do so, return to Visual Studio and check the Enable Paging checkbox in the DetailsView's smart tag.</span></span>

<span data-ttu-id="63048-229">[![在 DetailsView 控件中启用分页](displaying-data-with-the-objectdatasource-vb/_static/image40.png)](displaying-data-with-the-objectdatasource-vb/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="63048-229">[![Enable Paging in the DetailsView Control](displaying-data-with-the-objectdatasource-vb/_static/image40.png)](displaying-data-with-the-objectdatasource-vb/_static/image39.png)</span></span>

<span data-ttu-id="63048-230">**图 15**：在 DetailsView 控件中启用分页（[单击以查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image41.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-230">**Figure 15**: Enable Paging in the DetailsView Control ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image41.png))</span></span>

<span data-ttu-id="63048-231">[![启用了分页，DetailsView 允许用户查看任何产品](displaying-data-with-the-objectdatasource-vb/_static/image43.png)](displaying-data-with-the-objectdatasource-vb/_static/image42.png)</span><span class="sxs-lookup"><span data-stu-id="63048-231">[![With Paging Enabled, the DetailsView Allows the User to View Any of the Products](displaying-data-with-the-objectdatasource-vb/_static/image43.png)](displaying-data-with-the-objectdatasource-vb/_static/image42.png)</span></span>

<span data-ttu-id="63048-232">**图 16**：启用分页后，DetailsView 允许用户查看任何产品（[单击查看完全尺寸的图像](displaying-data-with-the-objectdatasource-vb/_static/image44.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-232">**Figure 16**: With Paging Enabled, the DetailsView Allows the User to View Any of the Products ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image44.png))</span></span>

<span data-ttu-id="63048-233">在将来的教程中，我们将详细介绍分页。</span><span class="sxs-lookup"><span data-stu-id="63048-233">We'll talk more about paging in future tutorials.</span></span>

## <a name="a-more-flexible-layout-for-showing-one-record-at-a-time"></a><span data-ttu-id="63048-234">一次显示一条记录的更灵活的布局</span><span class="sxs-lookup"><span data-stu-id="63048-234">A More Flexible Layout for Showing One Record at a Time</span></span>

<span data-ttu-id="63048-235">DetailsView 在显示从 ObjectDataSource 返回的每条记录的方式上非常严格。</span><span class="sxs-lookup"><span data-stu-id="63048-235">The DetailsView is pretty rigid in how it displays each record returned from the ObjectDataSource.</span></span> <span data-ttu-id="63048-236">我们可能需要更灵活的数据视图。</span><span class="sxs-lookup"><span data-stu-id="63048-236">We may want a more flexible view of the data.</span></span> <span data-ttu-id="63048-237">例如，我们可能需要在一个 `<h4>` 标题中显示产品名称和价格，而不是在单独的行中显示产品名称、类别、供应商、价格和废止信息，而是以较小字体大小显示在名称和价格下面的类别和供应商信息。</span><span class="sxs-lookup"><span data-stu-id="63048-237">For example, rather than showing the product's name, category, supplier, price, and discontinued information each on a separate row, we may want to show the product name and price in an `<h4>` heading, with the category and supplier information appearing below the name and price in a smaller font size.</span></span> <span data-ttu-id="63048-238">我们可能不介意在值旁显示属性名称（产品、类别等）。</span><span class="sxs-lookup"><span data-stu-id="63048-238">And we may not care to show the property names (Product, Category, and so on) next to the values.</span></span>

<span data-ttu-id="63048-239">[FormView 控件](https://msdn.microsoft.com/library/fyf1dk77.aspx)可提供此级别的自定义。</span><span class="sxs-lookup"><span data-stu-id="63048-239">The [FormView control](https://msdn.microsoft.com/library/fyf1dk77.aspx) provides this level of customization.</span></span> <span data-ttu-id="63048-240">FormView 使用模板，这些模板允许混合使用 Web 控件、静态 HTML 和[数据绑定语法](http://www.15seconds.com/issue/040630.htm)，而不是使用字段（如 GridView 和 DetailsView 这样做）。</span><span class="sxs-lookup"><span data-stu-id="63048-240">Rather than using fields (like the GridView and DetailsView do), the FormView uses templates, which allow for a mix of Web controls, static HTML, and [databinding syntax](http://www.15seconds.com/issue/040630.htm).</span></span> <span data-ttu-id="63048-241">如果你熟悉 ASP.NET 1.x 中的中继器控件，可以将 FormView 视为用于显示单个记录的中继器。</span><span class="sxs-lookup"><span data-stu-id="63048-241">If you are familiar with the Repeater control from ASP.NET 1.x, you can think of the FormView as the Repeater for showing a single record.</span></span>

<span data-ttu-id="63048-242">将 FormView 控件添加到 `SimpleDisplay.aspx` 页面的设计图面。</span><span class="sxs-lookup"><span data-stu-id="63048-242">Add a FormView control to the `SimpleDisplay.aspx` page's design surface.</span></span> <span data-ttu-id="63048-243">最初，FormView 以灰色块显示，告知我们需要至少提供控件的 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="63048-243">Initially the FormView displays as a gray block, informing us that we need to provide, at minimum, the control's `ItemTemplate`.</span></span>

<span data-ttu-id="63048-244">[![FormView 必须包含 ItemTemplate](displaying-data-with-the-objectdatasource-vb/_static/image46.png)](displaying-data-with-the-objectdatasource-vb/_static/image45.png)</span><span class="sxs-lookup"><span data-stu-id="63048-244">[![The FormView Must Include an ItemTemplate](displaying-data-with-the-objectdatasource-vb/_static/image46.png)](displaying-data-with-the-objectdatasource-vb/_static/image45.png)</span></span>

<span data-ttu-id="63048-245">**图 17**： FormView 必须包含 `ItemTemplate` （[单击查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image47.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-245">**Figure 17**: The FormView Must Include an `ItemTemplate` ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image47.png))</span></span>

<span data-ttu-id="63048-246">您可以通过 FormView 的智能标记将 FormView 直接绑定到数据源控件，这将自动创建默认 `ItemTemplate` （连同 `EditItemTemplate` 和 `InsertItemTemplate`，如果 ObjectDataSource 控件的 `InsertMethod` 和 `UpdateMethod` 属性已设置）。</span><span class="sxs-lookup"><span data-stu-id="63048-246">You can bind the FormView directly to a data source control through the FormView's smart tag, which will create a default `ItemTemplate` automatically (along with an `EditItemTemplate` and `InsertItemTemplate`, if the ObjectDataSource control's `InsertMethod` and `UpdateMethod` properties are set).</span></span> <span data-ttu-id="63048-247">但是，在此示例中，我们将数据绑定到 FormView，并手动指定其 `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="63048-247">However, for this example let's bind the data to the FormView and specify its `ItemTemplate` manually.</span></span> <span data-ttu-id="63048-248">首先将 FormView 的 `DataSourceID` 属性设置为 ObjectDataSource 控件的 `ID`，`ObjectDataSource1`。</span><span class="sxs-lookup"><span data-stu-id="63048-248">Start by setting the FormView's `DataSourceID` property to the `ID` of the ObjectDataSource control, `ObjectDataSource1`.</span></span> <span data-ttu-id="63048-249">接下来，创建 `ItemTemplate`，使其在 `<h4>` 元素中显示产品的名称和价格，并将其下的类别和货主名称显示为较小的字号。</span><span class="sxs-lookup"><span data-stu-id="63048-249">Next, create the `ItemTemplate` so that it displays the product's name and price in an `<h4>` element and the category and shipper names beneath that in a smaller font size.</span></span>

[!code-aspx[Main](displaying-data-with-the-objectdatasource-vb/samples/sample6.aspx)]

<span data-ttu-id="63048-250">[![第一个产品（Chai）以自定义格式显示](displaying-data-with-the-objectdatasource-vb/_static/image49.png)](displaying-data-with-the-objectdatasource-vb/_static/image48.png)</span><span class="sxs-lookup"><span data-stu-id="63048-250">[![The First Product (Chai) is Displayed in a Custom Format](displaying-data-with-the-objectdatasource-vb/_static/image49.png)](displaying-data-with-the-objectdatasource-vb/_static/image48.png)</span></span>

<span data-ttu-id="63048-251">**图 18**：第一个产品（Chai）以自定义格式显示（[单击以查看完全大小的图像](displaying-data-with-the-objectdatasource-vb/_static/image50.png)）</span><span class="sxs-lookup"><span data-stu-id="63048-251">**Figure 18**: The First Product (Chai) is Displayed in a Custom Format ([Click to view full-size image](displaying-data-with-the-objectdatasource-vb/_static/image50.png))</span></span>

<span data-ttu-id="63048-252">`<%# Eval(propertyName) %>` 是数据绑定语法。</span><span class="sxs-lookup"><span data-stu-id="63048-252">The `<%# Eval(propertyName) %>` is the databinding syntax.</span></span> <span data-ttu-id="63048-253">`Eval` 方法返回当前正在绑定到 FormView 控件的对象的指定属性的值。</span><span class="sxs-lookup"><span data-stu-id="63048-253">The `Eval` method returns the value of the specified property for the current object being bound to the FormView control.</span></span> <span data-ttu-id="63048-254">有关数据绑定的详细信息，请参阅 Alex Homer 的文章： [ASP.NET 2.0 中的简化和扩展的数据绑定语法](http://www.15seconds.com/issue/040630.htm)。</span><span class="sxs-lookup"><span data-stu-id="63048-254">Check out Alex Homer's article [Simplified and Extended Data Binding Syntax in ASP.NET 2.0](http://www.15seconds.com/issue/040630.htm) for more information on the ins and outs of databinding.</span></span>

<span data-ttu-id="63048-255">与 DetailsView 一样，FormView 只显示从 ObjectDataSource 返回的第一条记录。</span><span class="sxs-lookup"><span data-stu-id="63048-255">Like the DetailsView, the FormView only shows the first record returned from the ObjectDataSource.</span></span> <span data-ttu-id="63048-256">可以在 FormView 中启用分页，以允许访问者一次单步执行一次产品。</span><span class="sxs-lookup"><span data-stu-id="63048-256">You can enable paging in the FormView to allow visitors to step through the products one at a time.</span></span>

## <a name="summary"></a><span data-ttu-id="63048-257">总结</span><span class="sxs-lookup"><span data-stu-id="63048-257">Summary</span></span>

<span data-ttu-id="63048-258">无需编写代码，就可以在不编写代码的情况下，访问和显示业务逻辑层中的数据，而无需编写代码。</span><span class="sxs-lookup"><span data-stu-id="63048-258">Accessing and displaying data from a Business Logic Layer can be accomplished without writing a line of code thanks to ASP.NET 2.0's ObjectDataSource control.</span></span> <span data-ttu-id="63048-259">ObjectDataSource 调用类的指定方法并返回结果。</span><span class="sxs-lookup"><span data-stu-id="63048-259">The ObjectDataSource invokes a specified method of a class and returns the results.</span></span> <span data-ttu-id="63048-260">这些结果可以显示在绑定到 ObjectDataSource 的数据 Web 控件中。</span><span class="sxs-lookup"><span data-stu-id="63048-260">These results can be displayed in a data Web control that's bound to the ObjectDataSource.</span></span> <span data-ttu-id="63048-261">在本教程中，我们将介绍如何将 GridView、DetailsView 和 FormView 控件绑定到 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="63048-261">In this tutorial we looked at binding the GridView, DetailsView, and FormView controls to the ObjectDataSource.</span></span>

<span data-ttu-id="63048-262">到目前为止，我们仅了解了如何使用 ObjectDataSource 调用无参数的方法，但如果我们想要调用需要输入参数的方法（如 `ProductBLL` 类的 `GetProductsByCategoryID(categoryID)`），该怎么办？</span><span class="sxs-lookup"><span data-stu-id="63048-262">So far we've only seen how to use the ObjectDataSource to invoke a parameter-less method, but what if we want to invoke a method that expects input parameters, such as the `ProductBLL` class's `GetProductsByCategoryID(categoryID)`?</span></span> <span data-ttu-id="63048-263">为了调用需要一个或多个参数的方法，必须将 ObjectDataSource 配置为指定这些参数的值。</span><span class="sxs-lookup"><span data-stu-id="63048-263">In order to call a method that expects one or more parameters we must configure the ObjectDataSource to specify the values for these parameters.</span></span> <span data-ttu-id="63048-264">我们将在[下一教程](declarative-parameters-vb.md)中了解如何实现此目的。</span><span class="sxs-lookup"><span data-stu-id="63048-264">We'll see how to accomplish this in our [next tutorial](declarative-parameters-vb.md).</span></span>

<span data-ttu-id="63048-265">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="63048-265">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="63048-266">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="63048-266">Further Reading</span></span>

<span data-ttu-id="63048-267">有关本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="63048-267">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="63048-268">创建自己的数据源控件</span><span class="sxs-lookup"><span data-stu-id="63048-268">Create Your Own Data Source Controls</span></span>](https://msdn.microsoft.com/library/ms364049.aspx)
- [<span data-ttu-id="63048-269">ASP.NET 2.0 的 GridView 示例</span><span class="sxs-lookup"><span data-stu-id="63048-269">GridView Examples for ASP.NET 2.0</span></span>](https://msdn.microsoft.com/library/aa479339.aspx)
- [<span data-ttu-id="63048-270">ASP.NET 2.0 中的简化和扩展的数据绑定语法</span><span class="sxs-lookup"><span data-stu-id="63048-270">Simplified and Extended Data Binding Syntax in ASP.NET 2.0</span></span>](http://www.15seconds.com/issue/040630.htm)
- [<span data-ttu-id="63048-271">ASP.NET 2.0 中的主题</span><span class="sxs-lookup"><span data-stu-id="63048-271">Themes in ASP.NET 2.0</span></span>](http://www.odetocode.com/Articles/423.aspx)
- [<span data-ttu-id="63048-272">使用主题的服务器端样式</span><span class="sxs-lookup"><span data-stu-id="63048-272">Server-Side Styles Using Themes</span></span>](https://quickstarts.asp.net/quickstartv20/aspnet/doc/themes/stylesheettheme.aspx)
- [<span data-ttu-id="63048-273">如何：以编程方式应用 ASP.NET 主题</span><span class="sxs-lookup"><span data-stu-id="63048-273">How To: Apply ASP.NET Themes Programmatically</span></span>](https://msdn.microsoft.com/library/tx35bd89.aspx)

## <a name="about-the-author"></a><span data-ttu-id="63048-274">关于作者</span><span class="sxs-lookup"><span data-stu-id="63048-274">About the Author</span></span>

<span data-ttu-id="63048-275">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，创始人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已在使用 Microsoft Web 技术，自1998开始。</span><span class="sxs-lookup"><span data-stu-id="63048-275">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="63048-276">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="63048-276">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="63048-277">他的最新书籍是，[*在24小时内，sam ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="63048-277">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="63048-278">可以[mitchell@4GuysFromRolla.com访问。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="63048-278">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="63048-279">或通过他的博客，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="63048-279">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="63048-280">特别感谢</span><span class="sxs-lookup"><span data-stu-id="63048-280">Special Thanks To</span></span>

<span data-ttu-id="63048-281">此教程系列由许多有用的审阅者查看。</span><span class="sxs-lookup"><span data-stu-id="63048-281">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="63048-282">本教程的主管审查人员是 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="63048-282">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="63048-283">想要查看我即将发布的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="63048-283">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="63048-284">如果是这样，请在mitchell@4GuysFromRolla.com放置一行[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="63048-284">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="63048-285">[上一页](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)
> [下一页](declarative-parameters-vb.md)</span><span class="sxs-lookup"><span data-stu-id="63048-285">[Previous](programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)
[Next](declarative-parameters-vb.md)</span></span>

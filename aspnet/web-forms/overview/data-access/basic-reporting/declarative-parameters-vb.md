---
uid: web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
title: 声明性参数（VB） |Microsoft Docs
author: rick-anderson
description: 在本教程中，我们将演示如何使用设置为硬编码值的参数，以选择要在 DetailsView 控件中显示的数据。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: dc1234a3-114f-4c9a-8d25-50ca03cc8e8e
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/declarative-parameters-vb
msc.type: authoredcontent
ms.openlocfilehash: cdc42752fc78d18366af037a81fe4ebe5a1646ef
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2019
ms.locfileid: "74612900"
---
# <a name="declarative-parameters-vb"></a><span data-ttu-id="ae6fc-103">声明性参数 (VB)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-103">Declarative Parameters (VB)</span></span>

<span data-ttu-id="ae6fc-104">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="ae6fc-105">[下载示例应用](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe)或[下载 PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-105">[Download Sample App](https://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_5_VB.exe) or [Download PDF](declarative-parameters-vb/_static/datatutorial05vb1.pdf)</span></span>

> <span data-ttu-id="ae6fc-106">在本教程中，我们将演示如何使用设置为硬编码值的参数，以选择要在 DetailsView 控件中显示的数据。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-106">In this tutorial we'll illustrate how to use a parameter set to a hard-coded value to select the data to display in a DetailsView control.</span></span>

## <a name="introduction"></a><span data-ttu-id="ae6fc-107">简介</span><span class="sxs-lookup"><span data-stu-id="ae6fc-107">Introduction</span></span>

<span data-ttu-id="ae6fc-108">在[最后一个教程](displaying-data-with-the-objectdatasource-vb.md)中，我们将介绍如何使用与在 `ProductsBLL` 类中调用 `GetProducts()` 方法的 ObjectDataSource 控件绑定的 "GridView"、"DetailsView" 和 "FormView" 控件来显示数据。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-108">In the [last tutorial](displaying-data-with-the-objectdatasource-vb.md) we looked at displaying data with the GridView, DetailsView, and FormView controls bound to an ObjectDataSource control that invoked the `GetProducts()` method from the `ProductsBLL` class.</span></span> <span data-ttu-id="ae6fc-109">`GetProducts()` 方法返回强类型的 DataTable，其中填充了 Northwind 数据库的 `Products` 表中的所有记录。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-109">The `GetProducts()` method returns a strongly-typed DataTable populated with all of the records from the Northwind database's `Products` table.</span></span> <span data-ttu-id="ae6fc-110">`ProductsBLL` 类包含其他方法，用于仅返回部分产品-`GetProductByProductID(productID)`、`GetProductsByCategoryID(categoryID)`和 `GetProductsBySupplierID(supplierID)`。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-110">The `ProductsBLL` class contains additional methods for returning just subsets of the products - `GetProductByProductID(productID)`, `GetProductsByCategoryID(categoryID)`, and `GetProductsBySupplierID(supplierID)`.</span></span> <span data-ttu-id="ae6fc-111">这三种方法都需要一个输入参数，指示如何筛选返回的产品信息。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-111">These three methods expect an input parameter indicating how to filter the returned product information.</span></span>

<span data-ttu-id="ae6fc-112">ObjectDataSource 可用于调用需要输入参数的方法，但为了实现此目的，必须指定这些参数的值来自何处。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-112">The ObjectDataSource can be used to invoke methods that expect input parameters, but in order to do so we must specify where the values for these parameters come from.</span></span> <span data-ttu-id="ae6fc-113">参数值可以是硬编码的，也可以来自多种动态源，包括查询字符串值、会话变量、页面上 Web 控件的属性值或其他值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-113">The parameter values can be hard-coded or can come from a variety of dynamic sources, including: querystring values, Session variables, the property value of a Web control on the page, or others.</span></span>

<span data-ttu-id="ae6fc-114">对于本教程，我们首先演示如何使用设置为硬编码值的参数。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-114">For this tutorial let's start by illustrating how to use a parameter set to a hard-coded value.</span></span> <span data-ttu-id="ae6fc-115">具体来说，我们将介绍如何将 DetailsView 添加到页面，此页面显示有关特定产品的信息（即 Chef Anton 的 Gumbo Mix，其中 `ProductID` 为5）。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-115">Specifically, we'll look at adding a DetailsView to the page that displays information about a specific product, namely Chef Anton's Gumbo Mix, which has a `ProductID` of 5.</span></span> <span data-ttu-id="ae6fc-116">接下来，我们将了解如何基于 Web 控件设置参数值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-116">Next, we'll see how to set the parameter value based on a Web control.</span></span> <span data-ttu-id="ae6fc-117">具体而言，我们将使用 TextBox 使用户键入国家/地区，之后用户可以单击按钮以查看位于该国家/地区的供应商列表。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-117">In particular, we'll use a TextBox to let the user type in a country, after which they can click a Button to see the list of suppliers that reside in that country.</span></span>

## <a name="using-a-hard-coded-parameter-value"></a><span data-ttu-id="ae6fc-118">使用硬编码的参数值</span><span class="sxs-lookup"><span data-stu-id="ae6fc-118">Using a Hard-Coded Parameter Value</span></span>

<span data-ttu-id="ae6fc-119">在第一个示例中，首先将 "DetailsView" 控件添加到 `BasicReporting` 文件夹中的 "`DeclarativeParams.aspx`" 页。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-119">For the first example, start by adding a DetailsView control to the `DeclarativeParams.aspx` page in the `BasicReporting` folder.</span></span> <span data-ttu-id="ae6fc-120">从 DetailsView 的智能标记中，从下拉列表中选择 "&lt;新数据源"&gt;，并选择添加 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-120">From the DetailsView's smart tag, select &lt;New data source&gt; from the drop-down list and choose to add an ObjectDataSource.</span></span>

<span data-ttu-id="ae6fc-121">[![向页面添加 ObjectDataSource](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-121">[![Add an ObjectDataSource to the Page](declarative-parameters-vb/_static/image2.png)](declarative-parameters-vb/_static/image1.png)</span></span>

<span data-ttu-id="ae6fc-122">**图 1**：向页面添加 ObjectDataSource （[单击以查看完全大小的图像](declarative-parameters-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-122">**Figure 1**: Add an ObjectDataSource to the Page ([Click to view full-size image](declarative-parameters-vb/_static/image3.png))</span></span>

<span data-ttu-id="ae6fc-123">这会自动启动 ObjectDataSource 控件的 "选择数据源" 向导。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-123">This will automatically start the ObjectDataSource control's Choose Data Source wizard.</span></span> <span data-ttu-id="ae6fc-124">从向导的第一个屏幕中选择 `ProductsBLL` 类。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-124">Select the `ProductsBLL` class from the first screen of the wizard.</span></span>

<span data-ttu-id="ae6fc-125">[![选择 ProductsBLL 类](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-125">[![Select the ProductsBLL Class](declarative-parameters-vb/_static/image5.png)](declarative-parameters-vb/_static/image4.png)</span></span>

<span data-ttu-id="ae6fc-126">**图 2**：选择 `ProductsBLL` 类（[单击以查看完全大小的图像](declarative-parameters-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-126">**Figure 2**: Select the `ProductsBLL` Class ([Click to view full-size image](declarative-parameters-vb/_static/image6.png))</span></span>

<span data-ttu-id="ae6fc-127">由于我们希望显示有关特定产品的信息，因此我们想要使用 `GetProductByProductID(productID)` 方法。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-127">Since we want to display information about a particular product we want to use the `GetProductByProductID(productID)` method.</span></span>

<span data-ttu-id="ae6fc-128">[![选择 GetProductByProductID （productID）方法](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-128">[![Choose the GetProductByProductID(productID) method](declarative-parameters-vb/_static/image8.png)](declarative-parameters-vb/_static/image7.png)</span></span>

<span data-ttu-id="ae6fc-129">**图 3**：选择 `GetProductByProductID(productID)` 方法（[单击以查看完全大小的图像](declarative-parameters-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-129">**Figure 3**: Choose the `GetProductByProductID(productID)` method ([Click to view full-size image](declarative-parameters-vb/_static/image9.png))</span></span>

<span data-ttu-id="ae6fc-130">由于我们选择的方法包含一个参数，因此向导有一个屏幕，系统会要求你定义用于参数的值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-130">Since the method we selected includes a parameter, there's one more screen for the wizard, where we're asked to define the value to be used for the parameter.</span></span> <span data-ttu-id="ae6fc-131">左侧列表显示了所选方法的所有参数。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-131">The list on the left shows all of the parameters for the selected method.</span></span> <span data-ttu-id="ae6fc-132">对于 `GetProductByProductID(productID)` 只有一个 `productID`。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-132">For `GetProductByProductID(productID)` there's only one `productID`.</span></span> <span data-ttu-id="ae6fc-133">在右侧，可以指定所选参数的值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-133">On the right we can specify the value for the selected parameter.</span></span> <span data-ttu-id="ae6fc-134">"参数源" 下拉列表枚举参数值的各种可能的源。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-134">The parameter source drop-down list enumerates the various possible sources for the parameter value.</span></span> <span data-ttu-id="ae6fc-135">由于我们要将 `productID` 参数的硬编码值指定为5，请将参数源保留为 "无"，并在 "DefaultValue" 文本框中输入5。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-135">Since we want to specify a hard-coded value of 5 for the `productID` parameter, leave the Parameter source as None and enter 5 into the DefaultValue textbox.</span></span>

<span data-ttu-id="ae6fc-136">[![，将对 productID 参数使用硬编码参数值5](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-136">[![A Hard-Coded Parameter Value of 5 Will Be Used for the productID Parameter](declarative-parameters-vb/_static/image11.png)](declarative-parameters-vb/_static/image10.png)</span></span>

<span data-ttu-id="ae6fc-137">**图 4**：硬编码参数值5将用于 `productID` 参数（[单击以查看完全大小的图像](declarative-parameters-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-137">**Figure 4**: A Hard-Coded Parameter Value of 5 Will Be Used for the `productID` Parameter ([Click to view full-size image](declarative-parameters-vb/_static/image12.png))</span></span>

<span data-ttu-id="ae6fc-138">完成配置数据源向导后，ObjectDataSource 控件的声明性标记在 `SelectMethod` 属性中定义的方法所需的每个输入参数的 `SelectParameters` 集合中都包含一个 `Parameter` 对象。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-138">After completing the Configure Data Source wizard, the ObjectDataSource control's declarative markup includes a `Parameter` object in the `SelectParameters` collection for each of the input parameters expected by the method defined in the `SelectMethod` property.</span></span> <span data-ttu-id="ae6fc-139">由于本示例中使用的方法只需要一个输入参数 `parameterID`，因此这里只有一个条目。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-139">Since the method we're using in this example expects just a single input parameter, `parameterID`, there's only one entry here.</span></span> <span data-ttu-id="ae6fc-140">`SelectParameters` 集合可以包含从 `System.Web.UI.WebControls` 命名空间中的 `Parameter` 类派生的任何类。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-140">The `SelectParameters` collection can contain any class that derives from the `Parameter` class in the `System.Web.UI.WebControls` namespace.</span></span> <span data-ttu-id="ae6fc-141">对于硬编码的参数值，将使用基 `Parameter` 类，但对于其他参数源选项，使用派生 `Parameter` 类;如果需要，还可以创建自己的[自定义参数类型](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11)。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-141">For hard-coded parameter values the base `Parameter` class is used, but for the other parameter source options a derived `Parameter` class is used; you can also create your own [custom parameter types](http://www.leftslipper.com/ShowFaq.aspx?FaqId=11), if needed.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample1.aspx)]

> [!NOTE]
> <span data-ttu-id="ae6fc-142">如果你在自己的计算机上执行以下过程，此时你会看到的声明性标记可能包含 `InsertMethod`、`UpdateMethod`和 `DeleteMethod` 属性的值以及 `DeleteParameters`。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-142">If you're following along on your own computer the declarative markup you see at this point may include values for the `InsertMethod`, `UpdateMethod`, and `DeleteMethod` properties, as well as `DeleteParameters`.</span></span> <span data-ttu-id="ae6fc-143">ObjectDataSource 的 "选择数据源" 向导会自动指定 `ProductBLL` 中用于插入、更新和删除操作的方法，因此除非您显式清除这些方法，否则这些方法将包含在上述标记中。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-143">The ObjectDataSource's Choose Data Source wizard automatically specifies the methods from the `ProductBLL` to use for inserting, updating, and deleting, so unless you explicitly cleared those out, they'll be included in the markup above.</span></span>

<span data-ttu-id="ae6fc-144">访问此页时，数据 Web 控件将调用 ObjectDataSource 的 `Select` 方法，该方法将调用 `ProductsBLL` 类的 `GetProductByProductID(productID)` 方法，该方法将为 `productID` 输入参数使用硬编码的值5。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-144">When visiting this page, the data Web control will invoke the ObjectDataSource's `Select` method, which will call the `ProductsBLL` class's `GetProductByProductID(productID)` method using the hard-coded value of 5 for the `productID` input parameter.</span></span> <span data-ttu-id="ae6fc-145">方法将返回一个强类型 `ProductDataTable` 对象，该对象包含一个包含单个行的行，其中包含有关 Chef Anton 的 Gumbo 混合的信息（具有 `ProductID` 5 的产品）。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-145">The method will return a strongly-typed `ProductDataTable` object that contains a single row with information about Chef Anton's Gumbo Mix (the product with `ProductID` 5).</span></span>

<span data-ttu-id="ae6fc-146">[显示 Chef Anton 的 Gumbo 混合的 ![信息](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-146">[![Information About Chef Anton's Gumbo Mix are Displayed](declarative-parameters-vb/_static/image14.png)](declarative-parameters-vb/_static/image13.png)</span></span>

<span data-ttu-id="ae6fc-147">**图 5**：显示 Chef Anton 的 Gumbo 混合的相关信息（[单击以查看完全大小的图像](declarative-parameters-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-147">**Figure 5**: Information About Chef Anton's Gumbo Mix are Displayed ([Click to view full-size image](declarative-parameters-vb/_static/image15.png))</span></span>

## <a name="setting-the-parameter-value-to-the-property-value-of-a-web-control"></a><span data-ttu-id="ae6fc-148">将参数值设置为 Web 控件的属性值</span><span class="sxs-lookup"><span data-stu-id="ae6fc-148">Setting the Parameter Value to the Property Value of a Web Control</span></span>

<span data-ttu-id="ae6fc-149">还可以基于页面上 Web 控件的值设置 ObjectDataSource 的参数值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-149">The ObjectDataSource's parameter values can also be set based on the value of a Web control on the page.</span></span> <span data-ttu-id="ae6fc-150">为了说明这一点，让我们有一个 GridView，其中列出了位于用户指定的国家/地区的所有供应商。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-150">To illustrate this, let's have a GridView that lists all of the suppliers that are located in a country specified by the user.</span></span> <span data-ttu-id="ae6fc-151">为此，请将文本框添加到用户可在其中输入国家/地区名称的页面。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-151">To accomplish this start by adding a TextBox to the page into which the user can enter a country name.</span></span> <span data-ttu-id="ae6fc-152">将此 TextBox 控件的 `ID` 属性设置为 `CountryName`。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-152">Set this TextBox control's `ID` property to `CountryName`.</span></span> <span data-ttu-id="ae6fc-153">另外添加一个按钮 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-153">Also add a Button Web control.</span></span>

<span data-ttu-id="ae6fc-154">[![将文本框添加到 ID 为 CountryName 的页面](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-154">[![Add a TextBox to the Page with ID CountryName](declarative-parameters-vb/_static/image17.png)](declarative-parameters-vb/_static/image16.png)</span></span>

<span data-ttu-id="ae6fc-155">**图 6**：使用 `ID` `CountryName` 向页面添加文本框（[单击以查看完全大小的图像](declarative-parameters-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-155">**Figure 6**: Add a TextBox to the Page with `ID` `CountryName` ([Click to view full-size image](declarative-parameters-vb/_static/image18.png))</span></span>

<span data-ttu-id="ae6fc-156">接下来，将 GridView 添加到页面，然后从智能标记中选择添加新的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-156">Next, add a GridView to the page and, from the smart tag, choose to add a new ObjectDataSource.</span></span> <span data-ttu-id="ae6fc-157">由于我们要显示供应商信息，请从向导的第一个屏幕中选择 `SuppliersBLL` 类。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-157">Since we want to display supplier information select the `SuppliersBLL` class from the wizard's first screen.</span></span> <span data-ttu-id="ae6fc-158">在第二个屏幕上，选取 `GetSuppliersByCountry(country)` 方法。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-158">From the second screen, pick the `GetSuppliersByCountry(country)` method.</span></span>

<span data-ttu-id="ae6fc-159">[![选择 GetSuppliersByCountry （国家/地区）方法](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-159">[![Choose the GetSuppliersByCountry(country) Method](declarative-parameters-vb/_static/image20.png)](declarative-parameters-vb/_static/image19.png)</span></span>

<span data-ttu-id="ae6fc-160">**图 7**：选择 `GetSuppliersByCountry(country)` 方法（[单击以查看完全大小的图像](declarative-parameters-vb/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-160">**Figure 7**: Choose the `GetSuppliersByCountry(country)` Method ([Click to view full-size image](declarative-parameters-vb/_static/image21.png))</span></span>

<span data-ttu-id="ae6fc-161">由于 `GetSuppliersByCountry(country)` 方法具有输入参数，因此向导再次包含用于选择参数值的最终屏幕。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-161">Since the `GetSuppliersByCountry(country)` method has an input parameter, the wizard once again includes a final screen for choosing the parameter value.</span></span> <span data-ttu-id="ae6fc-162">此时，将参数源设置为 "控件"。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-162">This time, set the Parameter source to Control.</span></span> <span data-ttu-id="ae6fc-163">这会将 ControlID 下拉列表填充到页面上的控件的名称;从列表中选择 `CountryName` 控件。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-163">This will populate the ControlID drop-down list with the names of the controls on the page; select the `CountryName` control from the list.</span></span> <span data-ttu-id="ae6fc-164">首次访问页面时，`CountryName` TextBox 将为空，因此不会返回任何结果，也不会显示任何内容。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-164">When the page is first visited the `CountryName` TextBox will be blank, so no results are returned and nothing is displayed.</span></span> <span data-ttu-id="ae6fc-165">如果希望在默认情况下显示某些结果，请相应地设置 "默认值" 文本框。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-165">If you want to display some results by default, set the DefaultValue textbox accordingly.</span></span>

<span data-ttu-id="ae6fc-166">[![将参数值设置为 CountryName 控件值](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-166">[![Set the Parameter Value to the CountryName Control Value](declarative-parameters-vb/_static/image23.png)](declarative-parameters-vb/_static/image22.png)</span></span>

<span data-ttu-id="ae6fc-167">**图 8**：将参数值设置为 `CountryName` 控制值（[单击以查看完全大小的图像](declarative-parameters-vb/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-167">**Figure 8**: Set the Parameter Value to the `CountryName` Control Value ([Click to view full-size image](declarative-parameters-vb/_static/image24.png))</span></span>

<span data-ttu-id="ae6fc-168">使用[ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx)而不是标准 `Parameter` 对象，ObjectDataSource 的声明性标记与第一个示例略有不同。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-168">The ObjectDataSource's declarative markup differs slightly from our first example, using a [ControlParameter](https://msdn.microsoft.com/library/system.web.ui.webcontrols.controlparameter.aspx) instead of the standard `Parameter` object.</span></span> <span data-ttu-id="ae6fc-169">`ControlParameter` 包含用于指定 Web 控件的 `ID` 的附加属性和用于参数的属性值（`PropertyName`）。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-169">A `ControlParameter` has additional properties to specify the `ID` of the Web control and the property value to use for the parameter (`PropertyName`).</span></span> <span data-ttu-id="ae6fc-170">"配置数据源" 向导的智能足以确定对于文本框，我们可能希望使用参数值的 `Text` 属性。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-170">The Configure Data Source wizard was smart enough to determine that, for a TextBox, we'll likely want to use the `Text` property for the parameter value.</span></span> <span data-ttu-id="ae6fc-171">但是，如果您想要使用 Web 控件中的不同属性值，则可以在此处更改 `PropertyName` 值，或者单击向导中的 "显示高级属性" 链接。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-171">If, however, you want to use a different property value from the Web control you can change the `PropertyName` value here or by clicking the "Show advanced properties" link in the wizard.</span></span>

[!code-aspx[Main](declarative-parameters-vb/samples/sample2.aspx)]

<span data-ttu-id="ae6fc-172">首次访问页面时，`CountryName` TextBox 为空。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-172">When visiting the page for the first time the `CountryName` TextBox is empty.</span></span> <span data-ttu-id="ae6fc-173">此 ObjectDataSource 的 `Select` 方法仍由 GridView 调用，但是 `Nothing` 的值会传递到 `GetSuppliersByCountry(country)` 方法。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-173">The ObjectDataSource's `Select` method is still invoked by the GridView, but a value of `Nothing` is passed into the `GetSuppliersByCountry(country)` method.</span></span> <span data-ttu-id="ae6fc-174">TableAdapter 将 `Nothing` 转换为数据库 `NULL` 值（`DBNull.Value`），但 `GetSuppliersByCountry(country)` 方法使用的查询将被写入，以便在为 `NULL` 参数指定 `@CategoryID` 值时不返回任何值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-174">The TableAdapter converts the `Nothing` into a database `NULL` value (`DBNull.Value`), but the query used by the `GetSuppliersByCountry(country)` method is written such that it doesn't return any values when a `NULL` value is specified for the `@CategoryID` parameter.</span></span> <span data-ttu-id="ae6fc-175">简而言之，不返回任何供应商。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-175">In short, no suppliers are returned.</span></span>

<span data-ttu-id="ae6fc-176">但一旦访问者进入国家/地区，并单击 "显示供应商" 按钮来导致回发，则 ObjectDataSource 的 `Select` 方法将被重新查询，并传入 TextBox 控件的 `Text` 值作为 `country` 参数。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-176">Once the visitor enters in a country, however, and clicks the Show Suppliers button to cause a postback, the ObjectDataSource's `Select` method is requeried, passing in the TextBox control's `Text` value as the `country` parameter.</span></span>

<span data-ttu-id="ae6fc-177">[![显示来自加拿大的供应商](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-177">[![Those Suppliers from Canada are Shown](declarative-parameters-vb/_static/image26.png)](declarative-parameters-vb/_static/image25.png)</span></span>

<span data-ttu-id="ae6fc-178">**图 9**：显示了加拿大的供应商（[单击以查看完全大小的图像](declarative-parameters-vb/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-178">**Figure 9**: Those Suppliers from Canada are Shown ([Click to view full-size image](declarative-parameters-vb/_static/image27.png))</span></span>

## <a name="showing-all-suppliers-by-default"></a><span data-ttu-id="ae6fc-179">默认情况下显示所有供应商</span><span class="sxs-lookup"><span data-stu-id="ae6fc-179">Showing All Suppliers By Default</span></span>

<span data-ttu-id="ae6fc-180">在第一次查看页面时不显示任何供应商，我们可能希望首先显示*所有*供应商，从而允许用户通过在文本框中输入国家/地区名称削减列表。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-180">Rather than show none of the suppliers when first viewing the page we may want to show *all* suppliers at first, allowing the user to pare down the list by entering a country name in the TextBox.</span></span> <span data-ttu-id="ae6fc-181">当 TextBox 为空时，`SuppliersBLL` 类的 `GetSuppliersByCountry(country)` 方法将传入 *`country`* 输入参数的 `Nothing` 中。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-181">When the TextBox is empty, the `SuppliersBLL` class's `GetSuppliersByCountry(country)` method is passed in `Nothing` for its *`country`* input parameter.</span></span> <span data-ttu-id="ae6fc-182">然后，将此 `Nothing` 值向下传递到 DAL 的 `GetSupplierByCountry(country)` 方法，在此方法中，会将该值转换为数据库 `NULL` 以下查询中的 `@Country` 参数值：</span><span class="sxs-lookup"><span data-stu-id="ae6fc-182">This `Nothing` value is then passed down into the DAL's `GetSupplierByCountry(country)` method, where it's translated to a database `NULL` value for the `@Country` parameter in the following query:</span></span>

[!code-sql[Main](declarative-parameters-vb/samples/sample3.sql)]

<span data-ttu-id="ae6fc-183">即使 `Country` 列具有 `NULL` 值的记录，表达式 `Country = NULL` 始终返回 False;因此，不会返回任何记录。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-183">The expression `Country = NULL` always returns False, even for records whose `Country` column has a `NULL` value; therefore, no records are returned.</span></span>

<span data-ttu-id="ae6fc-184">若要在 "国家/地区" 文本框为空时返回*所有*供应商，我们可以在 BLL 中增加 `GetSuppliersByCountry(country)` 方法，以便在其国家/地区参数 `Nothing` 时调用 `GetSuppliers()` 方法，否则调用 DAL 的 `GetSuppliersByCountry(country)` 方法。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-184">To return *all* suppliers when the country TextBox is empty, we can augment the `GetSuppliersByCountry(country)` method in the BLL to invoke the `GetSuppliers()` method when its country parameter is `Nothing` and to call the DAL's `GetSuppliersByCountry(country)` method otherwise.</span></span> <span data-ttu-id="ae6fc-185">当未指定国家/地区时，这将具有返回所有供应商的效果，以及在包括国家/地区参数时返回的供应商子集。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-185">This will have the effect of returning all suppliers when no country is specified and the appropriate subset of suppliers when the country parameter is included.</span></span>

<span data-ttu-id="ae6fc-186">将 `SuppliersBLL` 类中的 `GetSuppliersByCountry(country)` 方法更改为以下内容：</span><span class="sxs-lookup"><span data-stu-id="ae6fc-186">Change the `GetSuppliersByCountry(country)` method in the `SuppliersBLL` class to the following:</span></span>

[!code-vb[Main](declarative-parameters-vb/samples/sample4.vb)]

<span data-ttu-id="ae6fc-187">进行此更改后，"`DeclarativeParams.aspx`" 页将显示第一次访问时的所有供应商（或只要 `CountryName` 的文本框为空）。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-187">With this change the `DeclarativeParams.aspx` page shows all of the suppliers when first visited (or whenever the `CountryName` TextBox is empty).</span></span>

<span data-ttu-id="ae6fc-188">[默认情况下，![所有供应商现在显示](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-188">[![All Suppliers are Now Shown by Default](declarative-parameters-vb/_static/image29.png)](declarative-parameters-vb/_static/image28.png)</span></span>

<span data-ttu-id="ae6fc-189">**图 10**：默认情况下，所有供应商都显示（[单击以查看完全大小的图像](declarative-parameters-vb/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="ae6fc-189">**Figure 10**: All Suppliers are Now Shown by Default ([Click to view full-size image](declarative-parameters-vb/_static/image30.png))</span></span>

## <a name="summary"></a><span data-ttu-id="ae6fc-190">总结</span><span class="sxs-lookup"><span data-stu-id="ae6fc-190">Summary</span></span>

<span data-ttu-id="ae6fc-191">为了将方法用于输入参数，我们需要在 ObjectDataSource 的 `SelectParameters` 集合中指定参数的值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-191">In order to use methods with input parameters, we need to specify the values for the parameters in the ObjectDataSource's `SelectParameters` collection.</span></span> <span data-ttu-id="ae6fc-192">不同类型的参数允许从不同的源中获取参数值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-192">Different types of parameters allow for the parameter value to be obtained from different sources.</span></span> <span data-ttu-id="ae6fc-193">默认参数类型使用硬编码值，但与从查询字符串、会话变量、cookie，甚至是用户输入的值一样，可以从页上的 Web 控件获取参数值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-193">The default parameter type uses a hard-coded value, but just as easily (and without a line of code) parameter values can be obtained from the querystring, Session variables, cookies, and even user-entered values from Web controls on the page.</span></span>

<span data-ttu-id="ae6fc-194">本教程中所述的示例演示了如何使用声明性参数值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-194">The examples we looked at in this tutorial illustrated how to use declarative parameter values.</span></span> <span data-ttu-id="ae6fc-195">但是，有时可能需要使用不可用的参数源，例如当前日期和时间，或者，如果我们的站点正在使用成员身份，则可能是访问者的用户 ID。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-195">However, there may be times when we need to use a parameter source that's not available, such as the current date and time, or, if our site was using Membership, the User ID of the visitor.</span></span> <span data-ttu-id="ae6fc-196">对于这种情况，我们可以在 ObjectDataSource 调用其基础对象的方法之前以编程方式设置参数值。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-196">For such scenarios we can set the parameter values programmatically prior to the ObjectDataSource invoking its underlying object's method.</span></span> <span data-ttu-id="ae6fc-197">[下一教程](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)将介绍如何实现此目的。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-197">We'll see how to accomplish this in the [next tutorial](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md).</span></span>

<span data-ttu-id="ae6fc-198">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="ae6fc-198">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="ae6fc-199">关于作者</span><span class="sxs-lookup"><span data-stu-id="ae6fc-199">About the Author</span></span>

<span data-ttu-id="ae6fc-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，创始人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已在使用 Microsoft Web 技术，自1998开始。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-200">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="ae6fc-201">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-201">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="ae6fc-202">他的最新书籍是，[*在24小时内，sam ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-202">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="ae6fc-203">可以[mitchell@4GuysFromRolla.com访问。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-203">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="ae6fc-204">或通过他的博客，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-204">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="ae6fc-205">特别感谢</span><span class="sxs-lookup"><span data-stu-id="ae6fc-205">Special Thanks To</span></span>

<span data-ttu-id="ae6fc-206">此教程系列由许多有用的审阅者查看。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-206">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="ae6fc-207">本教程的主管审查人员是 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="ae6fc-207">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="ae6fc-208">想要查看我即将发布的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="ae6fc-208">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="ae6fc-209">如果是这样，请在mitchell@4GuysFromRolla.com放置一行[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-209">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="ae6fc-210">[上一页](displaying-data-with-the-objectdatasource-vb.md)
> [下一页](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span><span class="sxs-lookup"><span data-stu-id="ae6fc-210">[Previous](displaying-data-with-the-objectdatasource-vb.md)
[Next](programmatically-setting-the-objectdatasource-s-parameter-values-vb.md)</span></span>

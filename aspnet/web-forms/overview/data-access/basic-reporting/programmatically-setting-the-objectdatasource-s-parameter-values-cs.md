---
uid: web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
title: 以编程方式设置 ObjectDataSource 的参数值C#（） |Microsoft Docs
author: rick-anderson
description: 在本教程中，我们将介绍如何将方法添加到可接受单个输入参数并返回数据的 DAL 和 BLL。 此示例将设置此参数 。
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 1c4588bb-255d-4088-b319-5208da756f4d
msc.legacyurl: /web-forms/overview/data-access/basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs
msc.type: authoredcontent
ms.openlocfilehash: 8aa57172abcfc779fa74b128ad76d42c41dc5b98
ms.sourcegitcommit: 22fbd8863672c4ad6693b8388ad5c8e753fb41a2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 11/28/2019
ms.locfileid: "74602318"
---
# <a name="programmatically-setting-the-objectdatasources-parameter-values-c"></a><span data-ttu-id="2c41d-104">以编程方式设置 ObjectDataSource 的参数值 (C#)</span><span class="sxs-lookup"><span data-stu-id="2c41d-104">Programmatically Setting the ObjectDataSource's Parameter Values (C#)</span></span>

<span data-ttu-id="2c41d-105">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2c41d-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2c41d-106">[下载示例应用](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe)或[下载 PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2c41d-106">[Download Sample App](https://download.microsoft.com/download/4/6/3/463cf87c-4724-4cbc-b7b5-3f866f43ba50/ASPNET_Data_Tutorial_6_CS.exe) or [Download PDF](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/datatutorial06cs1.pdf)</span></span>

> <span data-ttu-id="2c41d-107">在本教程中，我们将介绍如何将方法添加到可接受单个输入参数并返回数据的 DAL 和 BLL。</span><span class="sxs-lookup"><span data-stu-id="2c41d-107">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter and returns data.</span></span> <span data-ttu-id="2c41d-108">该示例将以编程方式设置此参数。</span><span class="sxs-lookup"><span data-stu-id="2c41d-108">The example will set this parameter programmatically.</span></span>

## <a name="introduction"></a><span data-ttu-id="2c41d-109">简介</span><span class="sxs-lookup"><span data-stu-id="2c41d-109">Introduction</span></span>

<span data-ttu-id="2c41d-110">正如在[上一教程](declarative-parameters-cs.md)中所看到的，有许多选项可用于以声明方式将参数值传递给 ObjectDataSource 的方法。</span><span class="sxs-lookup"><span data-stu-id="2c41d-110">As we saw in the [previous tutorial](declarative-parameters-cs.md), a number of options are available for declaratively passing parameter values to the ObjectDataSource's methods.</span></span> <span data-ttu-id="2c41d-111">如果参数值是硬编码的，则来自页面上的 Web 控件，或来自数据源 `Parameter` 对象可读取的任何其他源，例如，该值可以绑定到输入参数而无需编写代码行。</span><span class="sxs-lookup"><span data-stu-id="2c41d-111">If the parameter value is hard-coded, comes from a Web control on the page, or is in any other source that is readable by a data source `Parameter` object, for example, that value can be bound to the input parameter without writing a line of code.</span></span>

<span data-ttu-id="2c41d-112">但有时，当参数值来自某个内置数据源（`Parameter` 对象）未考虑的某些源时。</span><span class="sxs-lookup"><span data-stu-id="2c41d-112">There may be times, however, when the parameter value comes from some source not already accounted for by one of the built-in data source `Parameter` objects.</span></span> <span data-ttu-id="2c41d-113">如果我们的站点支持的用户帐户，我们可能希望基于当前登录的访问者用户 ID 来设置参数。</span><span class="sxs-lookup"><span data-stu-id="2c41d-113">If our site supported user accounts we might want to set the parameter based on the currently logged in visitor's User ID.</span></span> <span data-ttu-id="2c41d-114">或者，可能需要在将参数值发送到 ObjectDataSource 的基础对象的方法之前，对其进行自定义。</span><span class="sxs-lookup"><span data-stu-id="2c41d-114">Or we may need to customize the parameter value before sending it along to the ObjectDataSource's underlying object's method.</span></span>

<span data-ttu-id="2c41d-115">每当调用 ObjectDataSource 的 `Select` 方法时，ObjectDataSource 首先引发其[选择事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx)。</span><span class="sxs-lookup"><span data-stu-id="2c41d-115">Whenever the ObjectDataSource's `Select` method is invoked the ObjectDataSource first raises its [Selecting event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selecting%28VS.80%29.aspx).</span></span> <span data-ttu-id="2c41d-116">然后调用 ObjectDataSource 的基础对象的方法。</span><span class="sxs-lookup"><span data-stu-id="2c41d-116">The ObjectDataSource's underlying object's method is then invoked.</span></span> <span data-ttu-id="2c41d-117">完成后，将引发 ObjectDataSource 的[选定事件](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx)（图1说明此事件序列）。</span><span class="sxs-lookup"><span data-stu-id="2c41d-117">Once that completes the ObjectDataSource's [Selected event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.selected%28VS.80%29.aspx) fires (Figure 1 illustrates this sequence of events).</span></span> <span data-ttu-id="2c41d-118">可以在事件处理程序中为 `Selecting` 事件的事件处理程序设置或自定义传入 ObjectDataSource 的基础对象的方法的参数值。</span><span class="sxs-lookup"><span data-stu-id="2c41d-118">The parameter values passed into the ObjectDataSource's underlying object's method can be set or customized in an event handler for the `Selecting` event.</span></span>

<span data-ttu-id="2c41d-119">[![所选的 ObjectDataSource，并选择在调用其基础对象的方法之前和之后激发的事件](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2c41d-119">[![The ObjectDataSource's Selected and Selecting Events Fire Before and After Its Underlying Object's Method is Invoked](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image2.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image1.png)</span></span>

<span data-ttu-id="2c41d-120">**图 1**： ObjectDataSource 的 `Selected` 和 `Selecting` 事件会在其基础对象的方法被调用之前和之后激发（[单击以查看完全大小的图像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="2c41d-120">**Figure 1**: The ObjectDataSource's `Selected` and `Selecting` Events Fire Before and After Its Underlying Object's Method is Invoked ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image3.png))</span></span>

<span data-ttu-id="2c41d-121">在本教程中，我们将介绍如何将方法添加到 DAL 和 BLL，这些方法接受 `int` 类型的单个输入参数 `Month`，并返回一个 `EmployeesDataTable` 对象，该对象以在指定 `Month`中具有录用周年的员工填充。</span><span class="sxs-lookup"><span data-stu-id="2c41d-121">In this tutorial we'll look at adding a method to our DAL and BLL that accepts a single input parameter `Month`, of type `int` and returns an `EmployeesDataTable` object populated with those employees that have their hiring anniversary in the specified `Month`.</span></span> <span data-ttu-id="2c41d-122">本示例将基于当前月份以编程方式设置此参数，并显示 "本月员工周年纪念日" 列表。</span><span class="sxs-lookup"><span data-stu-id="2c41d-122">Our example will set this parameter programmatically based on the current month, showing a list of "Employee Anniversaries This Month."</span></span>

<span data-ttu-id="2c41d-123">让我们进入正题！</span><span class="sxs-lookup"><span data-stu-id="2c41d-123">Let's get started!</span></span>

## <a name="step-1-adding-a-method-toemployeestableadapter"></a><span data-ttu-id="2c41d-124">步骤1：将方法添加到`EmployeesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="2c41d-124">Step 1: Adding a Method to`EmployeesTableAdapter`</span></span>

<span data-ttu-id="2c41d-125">对于我们的第一个示例，我们需要添加一个方法来检索 `HireDate` 在指定月份发生的雇员。</span><span class="sxs-lookup"><span data-stu-id="2c41d-125">For our first example we need to add a means to retrieve those employees whose `HireDate` occurred in a specified month.</span></span> <span data-ttu-id="2c41d-126">若要根据体系结构提供此功能，我们需要先在 `EmployeesTableAdapter` 中创建一个映射到正确 SQL 语句的方法。</span><span class="sxs-lookup"><span data-stu-id="2c41d-126">To provide this functionality in accordance with our architecture we need to first create a method in `EmployeesTableAdapter` that maps to the proper SQL statement.</span></span> <span data-ttu-id="2c41d-127">若要实现此目的，请首先打开 Northwind 类型化数据集。</span><span class="sxs-lookup"><span data-stu-id="2c41d-127">To accomplish this, start by opening the Northwind Typed DataSet.</span></span> <span data-ttu-id="2c41d-128">右键单击 "`EmployeesTableAdapter`" 标签，然后选择 "添加查询"。</span><span class="sxs-lookup"><span data-stu-id="2c41d-128">Right-click on the `EmployeesTableAdapter` label and choose Add Query.</span></span>

<span data-ttu-id="2c41d-129">[![向 EmployeesTableAdapter 中添加新查询](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2c41d-129">[![Add a New Query to the EmployeesTableAdapter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image5.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image4.png)</span></span>

<span data-ttu-id="2c41d-130">**图 2**：向 `EmployeesTableAdapter` 中添加新查询（[单击查看完全大小的图像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="2c41d-130">**Figure 2**: Add a New Query to the `EmployeesTableAdapter` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image6.png))</span></span>

<span data-ttu-id="2c41d-131">选择添加返回行的 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="2c41d-131">Choose to add a SQL statement that returns rows.</span></span> <span data-ttu-id="2c41d-132">到达 "指定 `SELECT` 语句" 屏幕时，`EmployeesTableAdapter` 的默认 `SELECT` 语句将被加载。</span><span class="sxs-lookup"><span data-stu-id="2c41d-132">When you reach the Specify a `SELECT` Statement screen the default `SELECT` statement for the `EmployeesTableAdapter` will already be loaded.</span></span> <span data-ttu-id="2c41d-133">只需在 `WHERE` 子句中添加： `WHERE DATEPART(m, HireDate) = @Month`。</span><span class="sxs-lookup"><span data-stu-id="2c41d-133">Simply add in the `WHERE` clause: `WHERE DATEPART(m, HireDate) = @Month`.</span></span> <span data-ttu-id="2c41d-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx)是一个 t-sql 函数，该函数返回 `datetime` 类型的特定日期部分;在此示例中，我们使用 `DATEPART` 返回 `HireDate` 列的月份。</span><span class="sxs-lookup"><span data-stu-id="2c41d-134">[DATEPART](https://msdn.microsoft.com/library/ms174420.aspx) is a T-SQL function that returns a particular date portion of a `datetime` type; in this case we're using `DATEPART` to return the month of the `HireDate` column.</span></span>

<span data-ttu-id="2c41d-135">[![仅返回雇佣日期列小于或等于 @HiredBeforeDate 参数的行](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2c41d-135">[![Return Only Those Rows Where the HireDate Column is Less Than or Equal to the @HiredBeforeDate Parameter](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image8.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image7.png)</span></span>

<span data-ttu-id="2c41d-136">**图 3**：仅返回 `HireDate` 列小于或等于 `@HiredBeforeDate` 参数的行（[单击以查看完全大小的图像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="2c41d-136">**Figure 3**: Return Only Those Rows Where the `HireDate` Column is Less Than or Equal to the `@HiredBeforeDate` Parameter ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image9.png))</span></span>

<span data-ttu-id="2c41d-137">最后，将 `FillBy` 和 `GetDataBy` 方法名称分别更改为 `FillByHiredDateMonth` 和 `GetEmployeesByHiredDateMonth`。</span><span class="sxs-lookup"><span data-stu-id="2c41d-137">Finally, change the `FillBy` and `GetDataBy` method names to `FillByHiredDateMonth` and `GetEmployeesByHiredDateMonth`, respectively.</span></span>

<span data-ttu-id="2c41d-138">[![选择更适合的方法名称，而不是 FillBy 和 GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2c41d-138">[![Choose More Appropriate Method Names Than FillBy and GetDataBy](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image11.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image10.png)</span></span>

<span data-ttu-id="2c41d-139">**图 4**：选择更适合的方法名称，而不是 `FillBy` 和 `GetDataBy` （[单击查看完全大小的图像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="2c41d-139">**Figure 4**: Choose More Appropriate Method Names Than `FillBy` and `GetDataBy` ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image12.png))</span></span>

<span data-ttu-id="2c41d-140">单击 "完成" 以完成向导并返回到数据集的设计图面。</span><span class="sxs-lookup"><span data-stu-id="2c41d-140">Click Finish to complete the wizard and return to the DataSet's design surface.</span></span> <span data-ttu-id="2c41d-141">`EmployeesTableAdapter` 现在应包含一组新方法用于访问在指定月份雇用的员工。</span><span class="sxs-lookup"><span data-stu-id="2c41d-141">The `EmployeesTableAdapter` should now include a new set of methods for accessing employees hired in a specified month.</span></span>

<span data-ttu-id="2c41d-142">[![新方法将出现在数据集的 Design Surface 中](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2c41d-142">[![The New Methods Appear in the DataSet's Design Surface](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image14.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image13.png)</span></span>

<span data-ttu-id="2c41d-143">**图 5**：新方法出现在数据集的 Design Surface 中（[单击查看完全大小的图像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="2c41d-143">**Figure 5**: The New Methods Appear in the DataSet's Design Surface ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image15.png))</span></span>

## <a name="step-2-adding-thegetemployeesbyhireddatemonthmonthmethod-to-the-business-logic-layer"></a><span data-ttu-id="2c41d-144">步骤2：将`GetEmployeesByHiredDateMonth(month)`方法添加到业务逻辑层</span><span class="sxs-lookup"><span data-stu-id="2c41d-144">Step 2: Adding the`GetEmployeesByHiredDateMonth(month)`Method to the Business Logic Layer</span></span>

<span data-ttu-id="2c41d-145">由于我们的应用程序体系结构为业务逻辑和数据访问逻辑使用了单独的层，因此需要向向下调用 DAL 的 BLL 添加一个方法，用于检索在指定日期之前雇用的员工。</span><span class="sxs-lookup"><span data-stu-id="2c41d-145">Since our application architecture uses a separate layer for the business logic and data access logic, we need to add a method to our BLL that calls down to the DAL to retrieve employees hired before a specified date.</span></span> <span data-ttu-id="2c41d-146">打开 `EmployeesBLL.cs` 文件并添加以下方法：</span><span class="sxs-lookup"><span data-stu-id="2c41d-146">Open the `EmployeesBLL.cs` file and add the following method:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample1.cs)]

<span data-ttu-id="2c41d-147">与此类中的其他方法一样，`GetEmployeesByHiredDateMonth(month)` 只需向下调用 DAL 并返回结果。</span><span class="sxs-lookup"><span data-stu-id="2c41d-147">As with our other methods in this class, `GetEmployeesByHiredDateMonth(month)` simply calls down into the DAL and returns the results.</span></span>

## <a name="step-3-displaying-employees-whose-hiring-anniversary-is-this-month"></a><span data-ttu-id="2c41d-148">步骤3：显示招聘周年纪念本月的雇员</span><span class="sxs-lookup"><span data-stu-id="2c41d-148">Step 3: Displaying Employees Whose Hiring Anniversary Is This Month</span></span>

<span data-ttu-id="2c41d-149">此示例的最后一步是显示招聘周年为本月的雇员。</span><span class="sxs-lookup"><span data-stu-id="2c41d-149">Our final step for this example is to display those employees whose hiring anniversary is this month.</span></span> <span data-ttu-id="2c41d-150">首先，将 GridView 添加到 `BasicReporting` 文件夹中的 "`ProgrammaticParams.aspx`" 页，然后添加一个新的 ObjectDataSource 作为其数据源。</span><span class="sxs-lookup"><span data-stu-id="2c41d-150">Start by adding a GridView to the `ProgrammaticParams.aspx` page in the `BasicReporting` folder and add a new ObjectDataSource as its data source.</span></span> <span data-ttu-id="2c41d-151">将 ObjectDataSource 配置为使用 `EmployeesBLL` 类，将 `SelectMethod` 设置为 "`GetEmployeesByHiredDateMonth(month)`"。</span><span class="sxs-lookup"><span data-stu-id="2c41d-151">Configure the ObjectDataSource to use the `EmployeesBLL` class with the `SelectMethod` set to `GetEmployeesByHiredDateMonth(month)`.</span></span>

<span data-ttu-id="2c41d-152">[![使用 EmployeesBLL 类](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="2c41d-152">[![Use the EmployeesBLL Class](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image17.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image16.png)</span></span>

<span data-ttu-id="2c41d-153">**图 6**：使用 `EmployeesBLL` 类（[单击以查看完全大小的图像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="2c41d-153">**Figure 6**: Use the `EmployeesBLL` Class ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image18.png))</span></span>

<span data-ttu-id="2c41d-154">[从 GetEmployeesByHiredDateMonth （月）方法中选择 ![](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="2c41d-154">[![Select From the GetEmployeesByHiredDateMonth(month) method](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image20.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image19.png)</span></span>

<span data-ttu-id="2c41d-155">**图 7**：从 `GetEmployeesByHiredDateMonth(month)` 方法中进行选择（[单击以查看完全大小的图像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="2c41d-155">**Figure 7**: Select From the `GetEmployeesByHiredDateMonth(month)` method ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image21.png))</span></span>

<span data-ttu-id="2c41d-156">最终屏幕会要求我们提供 `month` 参数值的源。</span><span class="sxs-lookup"><span data-stu-id="2c41d-156">The final screen asks us to provide the `month` parameter value's source.</span></span> <span data-ttu-id="2c41d-157">由于我们将以编程方式设置此值，因此，将参数源设置为默认值 "无"，然后单击 "完成"。</span><span class="sxs-lookup"><span data-stu-id="2c41d-157">Since we'll set this value programmatically, leave the Parameter source set to the default None option and click Finish.</span></span>

<span data-ttu-id="2c41d-158">[![将参数源设置为 "无"](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="2c41d-158">[![Leave the Parameter Source Set to None](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image23.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image22.png)</span></span>

<span data-ttu-id="2c41d-159">**图 8**：将参数 "源" 设置为 "无" （[单击查看完全大小的图像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="2c41d-159">**Figure 8**: Leave the Parameter Source Set to None ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image24.png))</span></span>

<span data-ttu-id="2c41d-160">这将在 ObjectDataSource 的 `SelectParameters` 集合中创建一个未指定值的 `Parameter` 对象。</span><span class="sxs-lookup"><span data-stu-id="2c41d-160">This will create a `Parameter` object in the ObjectDataSource's `SelectParameters` collection that does not have a value specified.</span></span>

[!code-aspx[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample2.aspx)]

<span data-ttu-id="2c41d-161">若要以编程方式设置此值，需要为 ObjectDataSource 的 `Selecting` 事件创建事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="2c41d-161">To set this value programmatically, we need to create an event handler for the ObjectDataSource's `Selecting` event.</span></span> <span data-ttu-id="2c41d-162">若要实现此目的，请跳到设计视图，然后双击 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="2c41d-162">To accomplish this, go to the Design view and double-click the ObjectDataSource.</span></span> <span data-ttu-id="2c41d-163">或者，选择 "ObjectDataSource"，中转到 "属性窗口"，然后单击闪电形图标。</span><span class="sxs-lookup"><span data-stu-id="2c41d-163">Alternatively, select the ObjectDataSource, go to the Properties window, and click the lightning bolt icon.</span></span> <span data-ttu-id="2c41d-164">接下来，双击 "`Selecting`" 事件旁边的文本框，或键入要使用的事件处理程序的名称。</span><span class="sxs-lookup"><span data-stu-id="2c41d-164">Next, either double-click in the textbox next to the `Selecting` event or type in the name of the event handler you want to use.</span></span>

![单击 "属性" 窗口中的闪电形图标以列出 Web 控件的事件](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image25.png)

<span data-ttu-id="2c41d-166">**图 9**：单击 "属性" 窗口中的闪电形图标以列出 Web 控件的事件</span><span class="sxs-lookup"><span data-stu-id="2c41d-166">**Figure 9**: Click on the Lightning Bolt Icon in the Properties Window to List a Web Control's Events</span></span>

<span data-ttu-id="2c41d-167">这两种方法都会向页面的代码隐藏类添加 ObjectDataSource `Selecting` 事件的新事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="2c41d-167">Both approaches add a new event handler for the ObjectDataSource's `Selecting` event to the page's code-behind class.</span></span> <span data-ttu-id="2c41d-168">在此事件处理程序中，我们可以使用 `e.InputParameters[parameterName]`读取和写入参数值，其中 *`parameterName`* 是 `<asp:Parameter>` 标记中 `Name` 特性的值（`InputParameters` 集合也可以按序号）。</span><span class="sxs-lookup"><span data-stu-id="2c41d-168">In this event handler we can read and write to the parameter values using `e.InputParameters[parameterName]`, where *`parameterName`* is the value of the `Name` attribute in the `<asp:Parameter>` tag (the `InputParameters` collection can also be indexed ordinally, as in `e.InputParameters[index]`).</span></span> <span data-ttu-id="2c41d-169">若要将 `month` 参数设置为当月，请将以下内容添加到 `Selecting` 事件处理程序中：</span><span class="sxs-lookup"><span data-stu-id="2c41d-169">To set the `month` parameter to the current month, add the following to the `Selecting` event handler:</span></span>

[!code-csharp[Main](programmatically-setting-the-objectdatasource-s-parameter-values-cs/samples/sample3.cs)]

<span data-ttu-id="2c41d-170">通过浏览器访问此页时，可以看到，在本月（3月），她只聘用了一名员工，因为1994，她在该公司的 Callahan。</span><span class="sxs-lookup"><span data-stu-id="2c41d-170">When visiting this page through a browser we can see that only one employee was hired this month (March) Laura Callahan, who's been with the company since 1994.</span></span>

<span data-ttu-id="2c41d-171">[![显示此月周年纪念的员工](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="2c41d-171">[![Those Employees Whose Anniversaries This Month Are Shown](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image27.png)](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image26.png)</span></span>

<span data-ttu-id="2c41d-172">**图 10**：显示本月周年纪念的员工（[单击查看全尺寸图像](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png)）</span><span class="sxs-lookup"><span data-stu-id="2c41d-172">**Figure 10**: Those Employees Whose Anniversaries This Month Are Shown ([Click to view full-size image](programmatically-setting-the-objectdatasource-s-parameter-values-cs/_static/image28.png))</span></span>

## <a name="summary"></a><span data-ttu-id="2c41d-173">总结</span><span class="sxs-lookup"><span data-stu-id="2c41d-173">Summary</span></span>

<span data-ttu-id="2c41d-174">尽管 ObjectDataSource 的参数值通常可以通过声明方式进行设置，而无需编写代码行，但可以通过编程方式轻松地设置参数值。</span><span class="sxs-lookup"><span data-stu-id="2c41d-174">While the ObjectDataSource's parameters' values can typically be set declaratively, without requiring a line of code, it's easy to set the parameter values programmatically.</span></span> <span data-ttu-id="2c41d-175">我们需要做的就是为 ObjectDataSource 的 `Selecting` 事件创建事件处理程序，该事件处理程序在调用基础对象的方法之前激发，并通过 `InputParameters` 集合手动设置一个或多个参数的值。</span><span class="sxs-lookup"><span data-stu-id="2c41d-175">All we need to do is create an event handler for the ObjectDataSource's `Selecting` event, which fires before the underlying object's method is invoked, and manually set the values for one or more parameters via the `InputParameters` collection.</span></span>

<span data-ttu-id="2c41d-176">本教程介绍了基本报表部分。</span><span class="sxs-lookup"><span data-stu-id="2c41d-176">This tutorial concludes the Basic Reporting section.</span></span> <span data-ttu-id="2c41d-177">[下一教程](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md)将介绍如何使用 "筛选和主要-详细方案" 部分，其中介绍了允许访问者筛选数据以及从主报表向下钻取到详细信息报表的方法。</span><span class="sxs-lookup"><span data-stu-id="2c41d-177">The [next tutorial](../masterdetail/master-detail-filtering-with-a-dropdownlist-cs.md) kicks off the Filtering and Master-Details Scenarios section, in which we'll look at techniques for allowing the visitor to filter data and drill down from a master report into a details report.</span></span>

<span data-ttu-id="2c41d-178">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="2c41d-178">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2c41d-179">关于作者</span><span class="sxs-lookup"><span data-stu-id="2c41d-179">About the Author</span></span>

<span data-ttu-id="2c41d-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，创始人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已在使用 Microsoft Web 技术，自1998开始。</span><span class="sxs-lookup"><span data-stu-id="2c41d-180">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2c41d-181">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="2c41d-181">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2c41d-182">他的最新书籍是，[*在24小时内，sam ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="2c41d-182">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2c41d-183">可以[mitchell@4GuysFromRolla.com访问。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2c41d-183">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2c41d-184">或通过他的博客，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="2c41d-184">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2c41d-185">特别感谢</span><span class="sxs-lookup"><span data-stu-id="2c41d-185">Special Thanks To</span></span>

<span data-ttu-id="2c41d-186">此教程系列由许多有用的审阅者查看。</span><span class="sxs-lookup"><span data-stu-id="2c41d-186">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2c41d-187">本教程的主管审查人员是 Hilton Giesenow。</span><span class="sxs-lookup"><span data-stu-id="2c41d-187">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="2c41d-188">想要查看我即将发布的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="2c41d-188">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2c41d-189">如果是这样，请在mitchell@4GuysFromRolla.com放置一行[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2c41d-189">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2c41d-190">[上一页](declarative-parameters-cs.md)
> [下一页](displaying-data-with-the-objectdatasource-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2c41d-190">[Previous](declarative-parameters-cs.md)
[Next](displaying-data-with-the-objectdatasource-vb.md)</span></span>

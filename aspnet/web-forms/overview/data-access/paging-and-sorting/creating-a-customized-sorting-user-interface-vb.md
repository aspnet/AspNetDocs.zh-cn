---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: 创建自定义的排序用户界面（VB） |Microsoft Docs
author: rick-anderson
description: 显示已排序数据的长列表时，通过引入分隔符行对相关数据进行分组非常有用。 在本教程中，我们将了解如何凭据
ms.author: riande
ms.date: 08/15/2006
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 66127630560141cd795beb15f525a7fba85f3993
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2020
ms.locfileid: "78502646"
---
# <a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="cab26-104">创建自定义的排序用户界面 (VB)</span><span class="sxs-lookup"><span data-stu-id="cab26-104">Creating a Customized Sorting User Interface (VB)</span></span>

<span data-ttu-id="cab26-105">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cab26-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cab26-106">[下载示例应用](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe)或[下载 PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cab26-106">[Download Sample App](https://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="cab26-107">显示已排序数据的长列表时，通过引入分隔符行对相关数据进行分组非常有用。</span><span class="sxs-lookup"><span data-stu-id="cab26-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="cab26-108">在本教程中，我们将了解如何创建此类排序用户界面。</span><span class="sxs-lookup"><span data-stu-id="cab26-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="introduction"></a><span data-ttu-id="cab26-109">简介</span><span class="sxs-lookup"><span data-stu-id="cab26-109">Introduction</span></span>

<span data-ttu-id="cab26-110">当在已排序的列中显示仅有少量不同值的已排序数据的长列表时，最终用户可能会发现很难识别差异边界的确切位置。</span><span class="sxs-lookup"><span data-stu-id="cab26-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="cab26-111">例如，数据库中有81个产品，但仅有九个不同的类别选项（8个唯一类别加上 `NULL` 选项）。</span><span class="sxs-lookup"><span data-stu-id="cab26-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="cab26-112">假设有兴趣检查 "海鲜" 类别下的产品的用户。</span><span class="sxs-lookup"><span data-stu-id="cab26-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="cab26-113">从列出单个 GridView 中*所有*产品的页面中，用户可能会决定，最佳做法是按类别对结果进行排序，这会将所有海鲜产品组合在一起。</span><span class="sxs-lookup"><span data-stu-id="cab26-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="cab26-114">按类别排序后，用户需要通读列表，寻找海鲜分组的产品开始和结束的位置。</span><span class="sxs-lookup"><span data-stu-id="cab26-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="cab26-115">由于结果按类别名称的字母顺序排序，查找海鲜产品并不困难，但仍需要密切扫描网格中的项目列表。</span><span class="sxs-lookup"><span data-stu-id="cab26-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="cab26-116">为了帮助突出显示已排序组之间的边界，许多网站使用在此类组之间添加分隔符的用户界面。</span><span class="sxs-lookup"><span data-stu-id="cab26-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="cab26-117">类似于图1所示的分隔符使用户能够更快地查找特定组并标识其边界，还可以确定数据中存在哪些不同的组。</span><span class="sxs-lookup"><span data-stu-id="cab26-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>

<span data-ttu-id="cab26-118">[明确标识每个类别组 ![](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="cab26-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="cab26-119">**图 1**：清楚地确定每个类别组（[单击以查看完全大小的图像](creating-a-customized-sorting-user-interface-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="cab26-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>

<span data-ttu-id="cab26-120">在本教程中，我们将了解如何创建此类排序用户界面。</span><span class="sxs-lookup"><span data-stu-id="cab26-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="cab26-121">步骤1：创建标准的可排序 GridView</span><span class="sxs-lookup"><span data-stu-id="cab26-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="cab26-122">在了解如何增强 GridView 来提供增强的排序界面之前，首先请创建一个列出产品的标准、可排序的 GridView。</span><span class="sxs-lookup"><span data-stu-id="cab26-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="cab26-123">首先打开 `PagingAndSorting` 文件夹中的 "`CustomSortingUI.aspx`" 页。</span><span class="sxs-lookup"><span data-stu-id="cab26-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="cab26-124">将 GridView 添加到页面，将其 `ID` 属性设置为 `ProductList`，并将其绑定到新的 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="cab26-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="cab26-125">将 ObjectDataSource 配置为使用 `ProductsBLL` 类 `GetProducts()` 方法来选择记录。</span><span class="sxs-lookup"><span data-stu-id="cab26-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="cab26-126">接下来，配置 GridView，使其仅包含 `ProductName`、`CategoryName`、`SupplierName`和 `UnitPrice` BoundFields 以及中止的 CheckBoxField。</span><span class="sxs-lookup"><span data-stu-id="cab26-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="cab26-127">最后，通过选中 GridView s 智能标记（或通过将其 `AllowSorting` 属性设置为 `true`）中的 "启用排序" 复选框来配置 GridView，以支持排序。</span><span class="sxs-lookup"><span data-stu-id="cab26-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="cab26-128">将这些添加到 `CustomSortingUI.aspx` 页后，声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="cab26-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="cab26-129">花点时间在浏览器中查看进度。</span><span class="sxs-lookup"><span data-stu-id="cab26-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="cab26-130">图2显示了按类别（按字母顺序）对其数据进行排序时可排序的 GridView。</span><span class="sxs-lookup"><span data-stu-id="cab26-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>

<span data-ttu-id="cab26-131">[![可排序的 GridView s 数据按类别排序](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="cab26-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="cab26-132">**图 2**：可排序的 GridView 数据按类别排序（[单击以查看完全大小的图像](creating-a-customized-sorting-user-interface-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="cab26-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>

## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="cab26-133">步骤2：探索用于添加分隔符行的技术</span><span class="sxs-lookup"><span data-stu-id="cab26-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="cab26-134">一般的可排序 GridView 完成后，剩下的就是能够在 GridView 中的每个唯一排序组之前添加分隔行。</span><span class="sxs-lookup"><span data-stu-id="cab26-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="cab26-135">但如何将此类行注入到 GridView 中呢？</span><span class="sxs-lookup"><span data-stu-id="cab26-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="cab26-136">实质上，我们需要遍历 GridView 的行，确定排序列中的值之间的差异，然后添加相应的分隔符行。</span><span class="sxs-lookup"><span data-stu-id="cab26-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="cab26-137">在考虑此问题时，解决方案似乎很自然 `RowDataBound` 事件处理程序中的某个位置。</span><span class="sxs-lookup"><span data-stu-id="cab26-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="cab26-138">如我们在[基于数据的自定义格式设置](../custom-formatting/custom-formatting-based-upon-data-vb.md)教程中所述，此事件处理程序通常在基于行的数据应用行级格式设置时使用。</span><span class="sxs-lookup"><span data-stu-id="cab26-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="cab26-139">但 `RowDataBound` 事件处理程序并不是解决方案，因为不能通过此事件处理程序以编程方式向 GridView 添加行。</span><span class="sxs-lookup"><span data-stu-id="cab26-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="cab26-140">实际上，GridView `Rows` 集合为只读。</span><span class="sxs-lookup"><span data-stu-id="cab26-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="cab26-141">若要将其他行添加到 GridView，我们有三个选择：</span><span class="sxs-lookup"><span data-stu-id="cab26-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="cab26-142">将这些元数据分隔符行添加到绑定到 GridView 的实际数据</span><span class="sxs-lookup"><span data-stu-id="cab26-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="cab26-143">将 GridView 绑定到数据后，将其他 `TableRow` 实例添加到 GridView s 控件集合</span><span class="sxs-lookup"><span data-stu-id="cab26-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="cab26-144">创建一个自定义服务器控件，该控件扩展 GridView 控件并替代负责构造 GridView s 结构的方法</span><span class="sxs-lookup"><span data-stu-id="cab26-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="cab26-145">如果需要在多个网页上或在多个网站上使用此功能，则创建自定义服务器控件将是最佳方法。</span><span class="sxs-lookup"><span data-stu-id="cab26-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="cab26-146">不过，它会执行相当多的代码，并全面探索 GridView 内部工作原理的深度。</span><span class="sxs-lookup"><span data-stu-id="cab26-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="cab26-147">因此，在本教程中，我们不会考虑该选项。</span><span class="sxs-lookup"><span data-stu-id="cab26-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="cab26-148">其他两个选项可将分隔符行添加到要绑定到 GridView 的实际数据，并在其绑定后操作 GridView s 控制集合。</span><span class="sxs-lookup"><span data-stu-id="cab26-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="cab26-149">向 GridView 绑定的数据中添加行</span><span class="sxs-lookup"><span data-stu-id="cab26-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="cab26-150">当 GridView 绑定到数据源时，它将为数据源返回的每个记录创建一个 `GridViewRow`。</span><span class="sxs-lookup"><span data-stu-id="cab26-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="cab26-151">因此，可以在将分隔符记录到 GridView 之前，通过在数据源中添加分隔符记录来注入所需的分隔行。</span><span class="sxs-lookup"><span data-stu-id="cab26-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="cab26-152">图3说明了这一概念。</span><span class="sxs-lookup"><span data-stu-id="cab26-152">Figure 3 illustrates this concept.</span></span>

![一种方法是向数据源添加分隔行](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="cab26-154">**图 3**：其中一项技术涉及到将分隔符行添加到数据源</span><span class="sxs-lookup"><span data-stu-id="cab26-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>

<span data-ttu-id="cab26-155">我在引号中使用术语分隔符记录，因为没有特殊的分隔符记录;相反，我们必须将数据源中的特定记录作为分隔符而不是普通数据行来标记。</span><span class="sxs-lookup"><span data-stu-id="cab26-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="cab26-156">对于我们的示例，我们将 `ProductsDataTable` 实例绑定到由 `ProductRows`组成的 GridView。</span><span class="sxs-lookup"><span data-stu-id="cab26-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="cab26-157">我们可能会将记录标记为分隔符行，方法是将其 `CategoryID` 属性设置为 `-1` （因为这样的值无法正常存在）。</span><span class="sxs-lookup"><span data-stu-id="cab26-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn't exist normally).</span></span>

<span data-ttu-id="cab26-158">若要利用此方法，我们需要执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="cab26-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="cab26-159">以编程方式检索要绑定到 GridView 的数据（`ProductsDataTable` 实例）</span><span class="sxs-lookup"><span data-stu-id="cab26-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="cab26-160">基于 GridView `SortExpression` 和 `SortDirection` 属性对数据进行排序</span><span class="sxs-lookup"><span data-stu-id="cab26-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="cab26-161">遍历 `ProductsDataTable`中的 `ProductsRows`，查找排序列中的差异的位置</span><span class="sxs-lookup"><span data-stu-id="cab26-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="cab26-162">在每个组边界，将分隔符记录 `ProductsRow` 实例插入到 DataTable 中，其中一个 `CategoryID` 设置为 `-1` （或决定将记录标记为分隔符记录的任何指定）</span><span class="sxs-lookup"><span data-stu-id="cab26-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="cab26-163">注入分隔符行后，以编程方式将数据绑定到 GridView</span><span class="sxs-lookup"><span data-stu-id="cab26-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="cab26-164">除了这五个步骤，我们还需要为 GridView `RowDataBound` 事件提供事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="cab26-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="cab26-165">在这里，我们将检查每个 `DataRow`，并确定它是否是一个 `CategoryID` 设置 `-1`的分隔行。</span><span class="sxs-lookup"><span data-stu-id="cab26-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="cab26-166">如果是这样，则 d 可能需要调整其格式或单元格中显示的文本。</span><span class="sxs-lookup"><span data-stu-id="cab26-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="cab26-167">使用此方法注入排序组边界需要的工作比上面所述的更多，因为还需要为 GridView `Sorting` 事件提供事件处理程序，并跟踪 `SortExpression` 和 `SortDirection` 值。</span><span class="sxs-lookup"><span data-stu-id="cab26-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="cab26-168">在数据绑定后操作 GridView s 控件集合</span><span class="sxs-lookup"><span data-stu-id="cab26-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="cab26-169">在将数据绑定到 GridView 之前，我们可以添加*分隔符行，* 而不是将数据绑定到 gridview。</span><span class="sxs-lookup"><span data-stu-id="cab26-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="cab26-170">数据绑定过程构建 GridView s 控件层次结构，实际上只是一个由行集合组成的 `Table` 实例，其中每个行都由一个单元集合组成。</span><span class="sxs-lookup"><span data-stu-id="cab26-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="cab26-171">具体而言，GridView s 控件集合在其根上包含一个 `Table` 对象，对绑定到 GridView 的 `DataSource` 中的每个记录都包含一个 `GridViewRow` （派生自 `TableRow` 类），在 `TableCell` 中的每个数据字段的每个 `GridViewRow` 实例中包含一个 `DataSource`对象。</span><span class="sxs-lookup"><span data-stu-id="cab26-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="cab26-172">若要在每个排序组之间添加分隔行，可以在创建此控件层次结构后直接对其进行操作。</span><span class="sxs-lookup"><span data-stu-id="cab26-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="cab26-173">我们可以确信在呈现页面的时间上最后一次创建了 GridView s 控件层次结构。</span><span class="sxs-lookup"><span data-stu-id="cab26-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="cab26-174">因此，此方法会重写 `Page` 类的 `Render` 方法，此时将对 GridView s final 控件层次结构进行更新，以包括所需的分隔符行。</span><span class="sxs-lookup"><span data-stu-id="cab26-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="cab26-175">图4说明了此过程。</span><span class="sxs-lookup"><span data-stu-id="cab26-175">Figure 4 illustrates this process.</span></span>

<span data-ttu-id="cab26-176">[![一种替代方法，操作 GridView 的控件层次结构](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="cab26-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span></span>

<span data-ttu-id="cab26-177">**图 4**：一种替代方法，操作 GridView s 控件层次结构（[单击以查看完全大小的图像](creating-a-customized-sorting-user-interface-vb/_static/image10.png)）</span><span class="sxs-lookup"><span data-stu-id="cab26-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>

<span data-ttu-id="cab26-178">对于本教程，我们将使用后一种方法自定义排序用户体验。</span><span class="sxs-lookup"><span data-stu-id="cab26-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="cab26-179">本教程中所示的代码是基于[Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s 博客文章中提供的示例，[使用 GridView 排序分组](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx)。</span><span class="sxs-lookup"><span data-stu-id="cab26-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>

## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="cab26-180">步骤3：将分隔符行添加到 GridView s 控件层次结构</span><span class="sxs-lookup"><span data-stu-id="cab26-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="cab26-181">由于我们只想在创建了控件层次结构并为其创建了控件层次结构后，才需要将分隔符行添加到 GridView s 控件层次结构中，因此我们希望在页面生命周期结束时执行此添加，但在实际 GridView c 之前执行此添加控制层次结构已呈现为 HTML。</span><span class="sxs-lookup"><span data-stu-id="cab26-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="cab26-182">可以完成此操作的最新可能点是 `Page` 类 `Render` 事件，可以使用以下方法签名在代码隐藏类中重写：</span><span class="sxs-lookup"><span data-stu-id="cab26-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="cab26-183">当调用 `Page` 类的原始 `Render` 方法时 `base.Render(writer)` 将呈现该页中的每个控件，并根据控件层次结构生成标记。</span><span class="sxs-lookup"><span data-stu-id="cab26-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="cab26-184">因此，我们必须调用 `base.Render(writer)`，以便呈现页面，并在调用 `base.Render(writer)`之前操作 GridView s 控件层次结构，以便在呈现后将分隔符行添加到 GridView s 控制层次结构中。</span><span class="sxs-lookup"><span data-stu-id="cab26-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="cab26-185">若要注入排序组标题，首先需要确保用户已请求对数据进行排序。</span><span class="sxs-lookup"><span data-stu-id="cab26-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="cab26-186">默认情况下，GridView 的内容不会进行排序，因此，我们不需要输入任何组排序标头。</span><span class="sxs-lookup"><span data-stu-id="cab26-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="cab26-187">如果希望在第一次加载页面时按特定列对 GridView 进行排序，请在第一页上调用 GridView s `Sort` 方法（而不是在后续回发上）。</span><span class="sxs-lookup"><span data-stu-id="cab26-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="cab26-188">若要实现此目的，请将此调用添加到 `if (!Page.IsPostBack)` 条件下的 `Page_Load` 事件处理程序中。</span><span class="sxs-lookup"><span data-stu-id="cab26-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="cab26-189">有关 `Sort` 方法的详细信息，请参阅查看[分页和排序报表数据](paging-and-sorting-report-data-vb.md)教程信息。</span><span class="sxs-lookup"><span data-stu-id="cab26-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>

<span data-ttu-id="cab26-190">假设数据已排序，下一项任务是确定数据排序所依据的列，然后扫描行以查找该列的值之间的差异。</span><span class="sxs-lookup"><span data-stu-id="cab26-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="cab26-191">下面的代码可确保数据已排序，并找到数据排序所依据的列：</span><span class="sxs-lookup"><span data-stu-id="cab26-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="cab26-192">如果 GridView 尚未进行排序，则将不会设置 GridView 的 `SortExpression` 属性。</span><span class="sxs-lookup"><span data-stu-id="cab26-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="cab26-193">因此，仅当此属性有一些值时，才需要添加分隔行。</span><span class="sxs-lookup"><span data-stu-id="cab26-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="cab26-194">如果是这样，接下来需要确定数据排序所依据的列的索引。</span><span class="sxs-lookup"><span data-stu-id="cab26-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="cab26-195">这是通过以下方式实现的：遍历 GridView `Columns` 集合，搜索其 `SortExpression` 属性等于 GridView `SortExpression` 属性的列。</span><span class="sxs-lookup"><span data-stu-id="cab26-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="cab26-196">除了列 s 索引外，我们还获取 `HeaderText` 属性，该属性在显示分隔符行时使用。</span><span class="sxs-lookup"><span data-stu-id="cab26-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="cab26-197">通过对数据进行排序所依据的列的索引，最后一步是枚举 GridView 的行。</span><span class="sxs-lookup"><span data-stu-id="cab26-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="cab26-198">对于每一行，我们需要确定已排序的列的值是否与上一行的排序列值不同。</span><span class="sxs-lookup"><span data-stu-id="cab26-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="cab26-199">如果是这样，则需要将新的 `GridViewRow` 实例注入到控件层次结构中。</span><span class="sxs-lookup"><span data-stu-id="cab26-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="cab26-200">这是通过以下代码完成的：</span><span class="sxs-lookup"><span data-stu-id="cab26-200">This is accomplished with the following code:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="cab26-201">此代码首先以编程方式引用在 GridView s 控件层次结构的根中找到的 `Table` 对象，并创建一个名为 `lastValue`的字符串变量。</span><span class="sxs-lookup"><span data-stu-id="cab26-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="cab26-202">`lastValue` 用于将当前行的已排序列值与上一行的值进行比较。</span><span class="sxs-lookup"><span data-stu-id="cab26-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="cab26-203">接下来，将对 GridView `Rows` 集合进行枚举，并为每行存储已排序的列的值，并将其存储在 `currentValue` 变量中。</span><span class="sxs-lookup"><span data-stu-id="cab26-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="cab26-204">若要确定特定行的排序列值，请使用 cell `Text` 属性。</span><span class="sxs-lookup"><span data-stu-id="cab26-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="cab26-205">这适用于 BoundFields，但不会按所需的 Templatefield、CheckBoxFields 等方式工作。</span><span class="sxs-lookup"><span data-stu-id="cab26-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="cab26-206">接下来，我们将介绍如何考虑备用 GridView 字段。</span><span class="sxs-lookup"><span data-stu-id="cab26-206">We'll look at how to account for alternate GridView fields shortly.</span></span>

<span data-ttu-id="cab26-207">然后，比较 `currentValue` 和 `lastValue` 变量。</span><span class="sxs-lookup"><span data-stu-id="cab26-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="cab26-208">如果它们不同，我们需要向控件层次结构中添加一个新的分隔行。</span><span class="sxs-lookup"><span data-stu-id="cab26-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="cab26-209">这是通过以下方式实现的：确定 `Table` 对象 s `Rows` 集合中 `GridViewRow` 的索引，创建新的 `GridViewRow` 和 `TableCell` 实例，然后将 `TableCell` 和 `GridViewRow` 添加到控件层次结构。</span><span class="sxs-lookup"><span data-stu-id="cab26-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="cab26-210">请注意，分隔符行 `TableCell` 的格式设置为跨越整个 GridView 的宽度，并使用 `SortHeaderRowStyle` CSS 类进行格式化，并具有其 `Text` 属性，使其显示排序组名称（如类别）和组 s 值（如饮料）。</span><span class="sxs-lookup"><span data-stu-id="cab26-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="cab26-211">最后，`lastValue` 更新为 `currentValue`的值。</span><span class="sxs-lookup"><span data-stu-id="cab26-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="cab26-212">用于设置排序组标题行格式的 CSS 类 `SortHeaderRowStyle` 需要在 `Styles.css` 文件中指定。</span><span class="sxs-lookup"><span data-stu-id="cab26-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="cab26-213">可随意使用任何喜欢的样式设置;我使用了以下内容：</span><span class="sxs-lookup"><span data-stu-id="cab26-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>

[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="cab26-214">使用当前代码时，排序接口会在按任何 BoundField 进行排序时添加排序组标头（请参阅图5，其中显示按供应商进行排序时的屏幕截图）。</span><span class="sxs-lookup"><span data-stu-id="cab26-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="cab26-215">但是，如果按任何其他字段类型（如 CheckBoxField 或 TemplateField）进行排序，则不会找到排序组标头（见图6）。</span><span class="sxs-lookup"><span data-stu-id="cab26-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>

<span data-ttu-id="cab26-216">[![排序接口在按 BoundFields 排序时包括排序组标头](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="cab26-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span></span>

<span data-ttu-id="cab26-217">**图 5**：按 BoundFields 排序时，排序接口包括排序组标头（[单击以查看完全大小的图像](creating-a-customized-sorting-user-interface-vb/_static/image13.png)）</span><span class="sxs-lookup"><span data-stu-id="cab26-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>

<span data-ttu-id="cab26-218">[排序 CheckBoxField 时，缺少排序组标头 ![](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="cab26-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span></span>

<span data-ttu-id="cab26-219">**图 6**：对 CheckBoxField 进行排序时排序组标头缺失（[单击以查看完全大小的图像](creating-a-customized-sorting-user-interface-vb/_static/image16.png)）</span><span class="sxs-lookup"><span data-stu-id="cab26-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>

<span data-ttu-id="cab26-220">当 CheckBoxField 进行排序时，排序组标头缺失是因为代码当前只使用 `TableCell` s `Text` 属性来确定每行的已排序列的值。</span><span class="sxs-lookup"><span data-stu-id="cab26-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="cab26-221">对于 CheckBoxFields，`TableCell` s `Text` 属性为空字符串;值可通过位于 `TableCell` `Controls` 集合中的复选框 Web 控件来使用。</span><span class="sxs-lookup"><span data-stu-id="cab26-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="cab26-222">若要处理 BoundFields 以外的字段类型，我们需要增加指定 `currentValue` 变量的代码，以检查 `TableCell` s `Controls` 集合中是否存在复选框。</span><span class="sxs-lookup"><span data-stu-id="cab26-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="cab26-223">将此代码替换为以下代码，而不是使用 `currentValue = gvr.Cells(sortColumnIndex).Text`：</span><span class="sxs-lookup"><span data-stu-id="cab26-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>

[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="cab26-224">此代码检查当前行的已排序列 `TableCell`，以确定 `Controls` 集合中是否有任何控件。</span><span class="sxs-lookup"><span data-stu-id="cab26-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="cab26-225">如果有，并且第一个控件为复选框，则 `currentValue` 变量将设置为 "是" 或 "否"，具体取决于 `Checked` 属性的复选框。</span><span class="sxs-lookup"><span data-stu-id="cab26-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="cab26-226">否则，将从 `TableCell` s `Text` 属性获取值。</span><span class="sxs-lookup"><span data-stu-id="cab26-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="cab26-227">可以复制此逻辑来处理 GridView 中可能存在的任何 Templatefield 的排序。</span><span class="sxs-lookup"><span data-stu-id="cab26-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="cab26-228">如果使用上面的代码添加，排序组标头将在按中止的 CheckBoxField 排序时立即存在（请参见图7）。</span><span class="sxs-lookup"><span data-stu-id="cab26-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>

<span data-ttu-id="cab26-229">[![排序 CheckBoxField 时，排序组标头现在存在](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="cab26-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span></span>

<span data-ttu-id="cab26-230">**图 7**：对 CheckBoxField 进行排序时，排序组标题现在存在（[单击以查看完全大小的图像](creating-a-customized-sorting-user-interface-vb/_static/image19.png)）</span><span class="sxs-lookup"><span data-stu-id="cab26-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>

> [!NOTE]
> <span data-ttu-id="cab26-231">如果产品具有 `CategoryID`、`SupplierID`或 `UnitPrice` 字段的 `NULL` 数据库值，则默认情况下，这些值将在 GridView 中显示为空字符串，这意味着，具有 `NULL` 值的产品的分隔符行 s 将按如下所示读取：（也就是说，Category 后没有名称，如 category：饮料）。</span><span class="sxs-lookup"><span data-stu-id="cab26-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="cab26-232">如果需要此处显示的值，可以将 BoundFields [`NullDisplayText` 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx)设置为要显示的文本，或者可以在将 `currentValue` 分配给分隔符行 s `Text` 属性时，在 Render 方法中添加条件语句。</span><span class="sxs-lookup"><span data-stu-id="cab26-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>

## <a name="summary"></a><span data-ttu-id="cab26-233">摘要</span><span class="sxs-lookup"><span data-stu-id="cab26-233">Summary</span></span>

<span data-ttu-id="cab26-234">GridView 不包含用于自定义排序界面的许多内置选项。</span><span class="sxs-lookup"><span data-stu-id="cab26-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="cab26-235">但是，在很多低级别的代码中，可以调整 GridView s 控制层次结构，以创建更多的自定义界面。</span><span class="sxs-lookup"><span data-stu-id="cab26-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="cab26-236">在本教程中，我们介绍了如何为可排序的 GridView 添加排序组分隔符行，以便更轻松地识别不同组和这些组边界。</span><span class="sxs-lookup"><span data-stu-id="cab26-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="cab26-237">有关自定义排序接口的其他示例，请查看[Scott Guthrie](https://weblogs.asp.net/scottgu/) s [ASP.NET 2.0 GridView 排序提示和技巧](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx)博客条目。</span><span class="sxs-lookup"><span data-stu-id="cab26-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="cab26-238">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="cab26-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="cab26-239">关于作者</span><span class="sxs-lookup"><span data-stu-id="cab26-239">About the Author</span></span>

<span data-ttu-id="cab26-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，创始人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已在使用 Microsoft Web 技术，自1998开始。</span><span class="sxs-lookup"><span data-stu-id="cab26-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cab26-241">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="cab26-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cab26-242">他的最新书籍是，[*在24小时内，sam ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="cab26-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cab26-243">可以[mitchell@4GuysFromRolla.com访问。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cab26-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="cab26-244">或通过他的博客，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="cab26-244">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="cab26-245">上一页</span><span class="sxs-lookup"><span data-stu-id="cab26-245">Previous</span></span>](sorting-custom-paged-data-vb.md)

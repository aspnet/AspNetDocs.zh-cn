---
uid: web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
title: 创建自定义的排序用户界面 (VB) |Microsoft Docs
author: rick-anderson
description: 显示一长串的已排序数据，它可以是非常有帮助通过引入分隔符行组相关的数据。 在本教程中我们将了解如何创建...
ms.author: riande
ms.date: 08/15/2006
ms.assetid: f3897a74-cc6a-4032-8f68-465f155e296a
msc.legacyurl: /web-forms/overview/data-access/paging-and-sorting/creating-a-customized-sorting-user-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: b12baa5075b4e67018d8a98a92e807d1778737c8
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/01/2019
ms.locfileid: "57054694"
---
<a name="creating-a-customized-sorting-user-interface-vb"></a><span data-ttu-id="b061a-104">创建自定义的排序用户界面 (VB)</span><span class="sxs-lookup"><span data-stu-id="b061a-104">Creating a Customized Sorting User Interface (VB)</span></span>
====================
<span data-ttu-id="b061a-105">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="b061a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="b061a-106">[下载示例应用程序](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe)或[下载 PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="b061a-106">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_27_VB.exe) or [Download PDF](creating-a-customized-sorting-user-interface-vb/_static/datatutorial27vb1.pdf)</span></span>

> <span data-ttu-id="b061a-107">显示一长串的已排序数据，它可以是非常有帮助通过引入分隔符行组相关的数据。</span><span class="sxs-lookup"><span data-stu-id="b061a-107">When displaying a long list of sorted data, it can be very helpful to group related data by introducing separator rows.</span></span> <span data-ttu-id="b061a-108">在本教程中我们将了解如何创建此类的排序用户界面。</span><span class="sxs-lookup"><span data-stu-id="b061a-108">In this tutorial we'll see how to create such a sorting user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="b061a-109">介绍</span><span class="sxs-lookup"><span data-stu-id="b061a-109">Introduction</span></span>

<span data-ttu-id="b061a-110">当显示一长串的已排序数据有少量的已排序的列中的不同值，最终用户可能会发现很难识别，确实如此，区别边界发生。</span><span class="sxs-lookup"><span data-stu-id="b061a-110">When displaying a long list of sorted data where there are only a handful of different values in the sorted column, an end user might find it hard to discern where, exactly, the difference boundaries occur.</span></span> <span data-ttu-id="b061a-111">例如，有在数据库中，但仅有九个不同的类别选项 81 产品 (八个唯一类别以及`NULL`选项)。</span><span class="sxs-lookup"><span data-stu-id="b061a-111">For example, there are 81 products in the database, but only nine different category choices (eight unique categories plus the `NULL` option).</span></span> <span data-ttu-id="b061a-112">请考虑有兴趣查看属于 Seafood 类别的产品的用户的情况。</span><span class="sxs-lookup"><span data-stu-id="b061a-112">Consider the case of a user who is interested in examining the products that fall under the Seafood category.</span></span> <span data-ttu-id="b061a-113">从列出的页面*所有*单一 GridView 中的产品，用户可能会决定其最好的方法就是对结果进行排序的类别，将组合在一起的所有 Seafood 产品组合在一起。</span><span class="sxs-lookup"><span data-stu-id="b061a-113">From a page that lists *all* of the products in a single GridView, the user might decide her best bet is to sort the results by category, which will group together all of the Seafood products together.</span></span> <span data-ttu-id="b061a-114">按类别进行排序后, 用户然后需要 hunt 整个列表，寻找 Seafood 分组产品开始和结束的位置。</span><span class="sxs-lookup"><span data-stu-id="b061a-114">After sorting by category, the user then needs to hunt through the list, looking for where the Seafood-grouped products start and end.</span></span> <span data-ttu-id="b061a-115">由于对结果进行按字母顺序排序的查找 Seafood 产品类别名称并不困难，但它仍需要仔细扫描中网格项的列表。</span><span class="sxs-lookup"><span data-stu-id="b061a-115">Since the results are ordered alphabetically by the category name finding the Seafood products is not difficult, but it still requires closely scanning the list of items in the grid.</span></span>

<span data-ttu-id="b061a-116">为了突出显示已排序组之间的边界，很多网站，请使用一个用户界面，将添加此类组之间的分隔符。</span><span class="sxs-lookup"><span data-stu-id="b061a-116">To help highlight the boundaries between sorted groups, many websites employ a user interface that adds a separator between such groups.</span></span> <span data-ttu-id="b061a-117">图 1 所示类似的分隔符使用户能够更快地查找特定组和标识其边界，以及确定在数据中存在哪些不同的组。</span><span class="sxs-lookup"><span data-stu-id="b061a-117">Separators like the ones shown in Figure 1 enables a user to more quickly find a particular group and identify its boundaries, as well as ascertain what distinct groups exist in the data.</span></span>


<span data-ttu-id="b061a-118">[![每个类别组是明确标识](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="b061a-118">[![Each Category Group is Clearly Identified](creating-a-customized-sorting-user-interface-vb/_static/image2.png)](creating-a-customized-sorting-user-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="b061a-119">**图 1**:每个类别组是明确标识 ([单击此项可查看原尺寸图像](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="b061a-119">**Figure 1**: Each Category Group is Clearly Identified ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image3.png))</span></span>


<span data-ttu-id="b061a-120">在本教程中我们将了解如何创建此类的排序用户界面。</span><span class="sxs-lookup"><span data-stu-id="b061a-120">In this tutorial we'll see how to create such a sorting user interface.</span></span>

## <a name="step-1-creating-a-standard-sortable-gridview"></a><span data-ttu-id="b061a-121">步骤 1：创建标准的可排序的 GridView</span><span class="sxs-lookup"><span data-stu-id="b061a-121">Step 1: Creating a Standard, Sortable GridView</span></span>

<span data-ttu-id="b061a-122">我们将探讨如何增强 GridView 来提供增强的排序接口之前，让我们来首先创建一个标准的可排序的 GridView，列出的产品。</span><span class="sxs-lookup"><span data-stu-id="b061a-122">Before we explore how to augment the GridView to provide the enhanced sorting interface, let s first create a standard, sortable GridView that lists the products.</span></span> <span data-ttu-id="b061a-123">首先打开`CustomSortingUI.aspx`页中`PagingAndSorting`文件夹。</span><span class="sxs-lookup"><span data-stu-id="b061a-123">Start by opening the `CustomSortingUI.aspx` page in the `PagingAndSorting` folder.</span></span> <span data-ttu-id="b061a-124">向页面添加一个 GridView，设置其`ID`属性设置为`ProductList`，并将其绑定到新对象数据源。</span><span class="sxs-lookup"><span data-stu-id="b061a-124">Add a GridView to the page, set its `ID` property to `ProductList`, and bind it to a new ObjectDataSource.</span></span> <span data-ttu-id="b061a-125">配置要使用 ObjectDataSource`ProductsBLL`类的`GetProducts()`用于选择记录的方法。</span><span class="sxs-lookup"><span data-stu-id="b061a-125">Configure the ObjectDataSource to use the `ProductsBLL` class s `GetProducts()` method for selecting records.</span></span>

<span data-ttu-id="b061a-126">接下来，以便它仅包含配置 GridView `ProductName`， `CategoryName`， `SupplierName`，和`UnitPrice`BoundFields 和停用 CheckBoxField。</span><span class="sxs-lookup"><span data-stu-id="b061a-126">Next, configure the GridView such that it only contains the `ProductName`, `CategoryName`, `SupplierName`, and `UnitPrice` BoundFields and the Discontinued CheckBoxField.</span></span> <span data-ttu-id="b061a-127">最后，配置 GridView 支持排序 GridView s 智能标记中的启用排序复选框 (或通过设置其`AllowSorting`属性设置为`true`)。</span><span class="sxs-lookup"><span data-stu-id="b061a-127">Finally, configure the GridView to support sorting by checking the Enable Sorting checkbox in the GridView s smart tag (or by setting its `AllowSorting` property to `true`).</span></span> <span data-ttu-id="b061a-128">建立到这些新增功能后`CustomSortingUI.aspx`页上，在声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="b061a-128">After making these additions to the `CustomSortingUI.aspx` page, the declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](creating-a-customized-sorting-user-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="b061a-129">请花费片刻时间为止的浏览器中查看我们的进度。</span><span class="sxs-lookup"><span data-stu-id="b061a-129">Take a moment to view our progress thus far in a browser.</span></span> <span data-ttu-id="b061a-130">图 2 显示了可排序的 GridView，其数据按类别按字母顺序进行排序时。</span><span class="sxs-lookup"><span data-stu-id="b061a-130">Figure 2 shows the sortable GridView when its data is sorted by category in alphabetical order.</span></span>


<span data-ttu-id="b061a-131">[![可排序的 GridView s 数据按类别排序](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="b061a-131">[![The Sortable GridView s Data is Ordered by Category](creating-a-customized-sorting-user-interface-vb/_static/image5.png)](creating-a-customized-sorting-user-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="b061a-132">**图 2**:按类别排序数据的可排序的 GridView s ([单击此项可查看原尺寸图像](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="b061a-132">**Figure 2**: The Sortable GridView s Data is Ordered by Category ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-exploring-techniques-for-adding-the-separator-rows"></a><span data-ttu-id="b061a-133">步骤 2：探索用于添加分隔符行的技术</span><span class="sxs-lookup"><span data-stu-id="b061a-133">Step 2: Exploring Techniques for Adding the Separator Rows</span></span>

<span data-ttu-id="b061a-134">使用通用的可排序 GridView 中完成，所有的就是为了能够在每个唯一的已排序组之前 GridView 中添加分隔符行。</span><span class="sxs-lookup"><span data-stu-id="b061a-134">With the generic, sortable GridView complete, all that remains is to be able to add the separator rows in the GridView before each unique sorted group.</span></span> <span data-ttu-id="b061a-135">但如何可以这样的行注入到 GridView？</span><span class="sxs-lookup"><span data-stu-id="b061a-135">But how can such rows be injected into the GridView?</span></span> <span data-ttu-id="b061a-136">从根本上来说，我们需要进行循环访问，GridView 的行，确定已排序的列的值之间的差异的发生位置，然后添加适当的分隔符行。</span><span class="sxs-lookup"><span data-stu-id="b061a-136">Essentially, we need to iterate through the GridView s rows, determine where the differences occur between the values in the sorted column, and then add the appropriate separator row.</span></span> <span data-ttu-id="b061a-137">当考虑此问题，人们似乎很自然的解决方案处于某个位置中的 GridView 的`RowDataBound`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="b061a-137">When thinking about this problem, it seems natural that the solution lies somewhere in the GridView s `RowDataBound` event handler.</span></span> <span data-ttu-id="b061a-138">如中所述[自定义格式设置基于数据的](../custom-formatting/custom-formatting-based-upon-data-vb.md)教程中，应用行级别格式基于行的数据时，通常使用此事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="b061a-138">As we discussed in the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial, this event handler is commonly used when applying row-level formatting based on the row s data.</span></span> <span data-ttu-id="b061a-139">但是，`RowDataBound`事件处理程序不在这里，该解决方案，因为行不能添加到 GridView 以编程方式从此事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="b061a-139">However, the `RowDataBound` event handler is not the solution here, as rows cannot be added to the GridView programmatically from this event handler.</span></span> <span data-ttu-id="b061a-140">GridView 的`Rows`集合，实际上，是只读的。</span><span class="sxs-lookup"><span data-stu-id="b061a-140">The GridView s `Rows` collection, in fact, is read-only.</span></span>

<span data-ttu-id="b061a-141">若要将其他行添加到 GridView 我们有三个选择：</span><span class="sxs-lookup"><span data-stu-id="b061a-141">To add additional rows to the GridView we have three choices:</span></span>

- <span data-ttu-id="b061a-142">将这些元数据分隔符行添加到绑定到 GridView 的实际数据</span><span class="sxs-lookup"><span data-stu-id="b061a-142">Add these metadata separator rows to the actual data that is bound to the GridView</span></span>
- <span data-ttu-id="b061a-143">GridView 已绑定到数据后，将添加其他`TableRow`实例到 GridView s 控制集合</span><span class="sxs-lookup"><span data-stu-id="b061a-143">After the GridView has been bound to the data, add additional `TableRow` instances to the GridView s control collection</span></span>
- <span data-ttu-id="b061a-144">创建扩展了 GridView 控件并重写这些方法负责构造 GridView 的结构的自定义服务器控件</span><span class="sxs-lookup"><span data-stu-id="b061a-144">Create a custom server control that extends the GridView control and overrides those methods responsible for constructing the GridView s structure</span></span>

<span data-ttu-id="b061a-145">创建自定义服务器控件将是最好的方法，此功能需要多个网页上或跨多个网站。</span><span class="sxs-lookup"><span data-stu-id="b061a-145">Creating a custom server control would be the best approach if this functionality was needed on many web pages or across several websites.</span></span> <span data-ttu-id="b061a-146">但是，它将需要一小段代码和到探索的全面探讨，GridView s 内部工作原理。</span><span class="sxs-lookup"><span data-stu-id="b061a-146">However, it would entail quite a bit of code and a thorough exploration into the depths of the GridView s internal workings.</span></span> <span data-ttu-id="b061a-147">因此，我们将不考虑该选项对于本教程。</span><span class="sxs-lookup"><span data-stu-id="b061a-147">Therefore, we'll not consider that option for this tutorial.</span></span>

<span data-ttu-id="b061a-148">其他两种选项添加分隔符行的实际数据被绑定到 GridView 和 GridView 的控件集合后操作其已绑定-以不同方式攻击问题，值得讨论。</span><span class="sxs-lookup"><span data-stu-id="b061a-148">The other two options adding separator rows to the actual data being bound to the GridView and manipulating the GridView s control collection after its been bound - attack the problem differently and merit a discussion.</span></span>

## <a name="adding-rows-to-the-data-bound-to-the-gridview"></a><span data-ttu-id="b061a-149">将行添加到数据绑定到 GridView</span><span class="sxs-lookup"><span data-stu-id="b061a-149">Adding Rows to the Data Bound to the GridView</span></span>

<span data-ttu-id="b061a-150">在 GridView 绑定到数据源，它会创建`GridViewRow`为数据源返回每个记录。</span><span class="sxs-lookup"><span data-stu-id="b061a-150">When the GridView is bound to a data source, it creates a `GridViewRow` for each record returned by the data source.</span></span> <span data-ttu-id="b061a-151">因此，我们可以通过添加分隔符记录到数据源绑定到 GridView 之前插入所需的分隔符行。</span><span class="sxs-lookup"><span data-stu-id="b061a-151">Therefore, we can inject the needed separator rows by adding separator records to the data source before binding it to the GridView.</span></span> <span data-ttu-id="b061a-152">图 3 说明了这一概念。</span><span class="sxs-lookup"><span data-stu-id="b061a-152">Figure 3 illustrates this concept.</span></span>


![一种方法涉及将分隔符行添加到数据源](creating-a-customized-sorting-user-interface-vb/_static/image7.png)

<span data-ttu-id="b061a-154">**图 3**:一种方法涉及将分隔符行添加到数据源</span><span class="sxs-lookup"><span data-stu-id="b061a-154">**Figure 3**: One Technique Involves Adding Separator Rows to the Data Source</span></span>


<span data-ttu-id="b061a-155">我在引号中使用术语分隔符记录，因为没有特殊的分隔符记录;相反，我们必须以某种方式的标记中的数据源的特定记录用作分隔符，而不是普通的数据行。</span><span class="sxs-lookup"><span data-stu-id="b061a-155">I use the term separator records in quotes because there is no special separator record; rather, we must somehow flag that a particular record in the data source serves as a separator rather than a normal data row.</span></span> <span data-ttu-id="b061a-156">有关我们的示例，我们重新绑定`ProductsDataTable`实例与 GridView，由组成`ProductRows`。</span><span class="sxs-lookup"><span data-stu-id="b061a-156">For our examples, we re binding a `ProductsDataTable` instance to the GridView, which is composed of `ProductRows`.</span></span> <span data-ttu-id="b061a-157">我们可能会通过设置一条记录标记为一个分隔符行及其`CategoryID`属性设置为`-1`（因为通常情况下存在一个此类值无法 t）。</span><span class="sxs-lookup"><span data-stu-id="b061a-157">We might flag a record as a separator row by setting its `CategoryID` property to `-1` (since such a value couldn t exist normally).</span></span>

<span data-ttu-id="b061a-158">若要利用此技术 d 我们需要执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="b061a-158">To utilize this technique we d need to perform the following steps:</span></span>

1. <span data-ttu-id="b061a-159">以编程方式检索的数据绑定到 GridView (`ProductsDataTable`实例)</span><span class="sxs-lookup"><span data-stu-id="b061a-159">Programmatically retrieve the data to bind to the GridView (a `ProductsDataTable` instance)</span></span>
2. <span data-ttu-id="b061a-160">基于 GridView s 上的数据进行排序`SortExpression`和`SortDirection`属性</span><span class="sxs-lookup"><span data-stu-id="b061a-160">Sort the data based on the GridView s `SortExpression` and `SortDirection` properties</span></span>
3. <span data-ttu-id="b061a-161">循环访问`ProductsRows`在`ProductsDataTable`，他们寻求在已排序的列中的差异的存在位置</span><span class="sxs-lookup"><span data-stu-id="b061a-161">Iterate through the `ProductsRows` in the `ProductsDataTable`, looking for where the differences in the sorted column lie</span></span>
4. <span data-ttu-id="b061a-162">在每个组边界注入分隔符记录`ProductsRow`实例到 DataTable，它具有 s`CategoryID`设置为`-1`（或任何指定决定时将标记作为分隔符记录一条记录）</span><span class="sxs-lookup"><span data-stu-id="b061a-162">At each group boundary, inject a separator record `ProductsRow` instance into the DataTable, one that has it s `CategoryID` set to `-1` (or whatever designation was decided upon to mark a record as a separator record )</span></span>
5. <span data-ttu-id="b061a-163">插入分隔符行之后, 以编程方式将数据绑定到 GridView</span><span class="sxs-lookup"><span data-stu-id="b061a-163">After injecting the separator rows, programmatically bind the data to the GridView</span></span>

<span data-ttu-id="b061a-164">除了上述五个步骤 d 我们还需要提供事件处理程序的 GridView s`RowDataBound`事件。</span><span class="sxs-lookup"><span data-stu-id="b061a-164">In addition to these five steps, we d also need to provide an event handler for the GridView s `RowDataBound` event.</span></span> <span data-ttu-id="b061a-165">在这里，我们 d 检查每个`DataRow`并确定它是一个分隔符行，其中一个其`CategoryID`设置的`-1`。</span><span class="sxs-lookup"><span data-stu-id="b061a-165">Here, we d check each `DataRow` and determine if it was a separator row, one whose `CategoryID` setting was `-1`.</span></span> <span data-ttu-id="b061a-166">如果是这样，我们 d 可能想要调整其格式设置或单元中显示的文本。</span><span class="sxs-lookup"><span data-stu-id="b061a-166">If so, we d probably want to adjust its formatting or the text displayed in the cell(s).</span></span>

<span data-ttu-id="b061a-167">使用此方法，因为您需要一个事件处理程序还为 GridView s 注入排序组边界需要多做一些工作不是，上面所述`Sorting`的跟踪事件并保留`SortExpression`和`SortDirection`值。</span><span class="sxs-lookup"><span data-stu-id="b061a-167">Using this technique for injecting the sorting group boundaries requires a bit more work than outlined above, as you need to also provide an event handler for the GridView s `Sorting` event and keep track of the `SortExpression` and `SortDirection` values.</span></span>

## <a name="manipulating-the-gridview-s-control-collection-after-it-s-been-databound"></a><span data-ttu-id="b061a-168">操作 GridView s s 控制其后集合被数据绑定</span><span class="sxs-lookup"><span data-stu-id="b061a-168">Manipulating the GridView s Control Collection After It s Been Databound</span></span>

<span data-ttu-id="b061a-169">而不是消息之前将其绑定到 GridView 数据，我们可以添加分隔符行*后*数据绑定到 GridView。</span><span class="sxs-lookup"><span data-stu-id="b061a-169">Rather than messaging the data before binding it to the GridView, we can add the separator rows *after* the data has been bound to the GridView.</span></span> <span data-ttu-id="b061a-170">GridView 的控件层次结构，这实际上是生成的数据绑定过程只需`Table`实例组成的行，其中每个由单元格的集合的集合。</span><span class="sxs-lookup"><span data-stu-id="b061a-170">The process of data binding builds up the GridView s control hierarchy, which in reality is simply a `Table` instance composed of a collection of rows, each of which is composed of a collection of cells.</span></span> <span data-ttu-id="b061a-171">具体而言，GridView 的控件集合包含`Table`对象在其根目录`GridViewRow`(它派生自`TableRow`类) 中每个记录`DataSource`绑定到 GridView，和一个`TableCell`中每个对象`GridViewRow`实例中每个数据字段`DataSource`。</span><span class="sxs-lookup"><span data-stu-id="b061a-171">Specifically, the GridView s control collection contains a `Table` object at its root, a `GridViewRow` (which is derived from the `TableRow` class) for each record in the `DataSource` bound to the GridView, and a `TableCell` object in each `GridViewRow` instance for each data field in the `DataSource`.</span></span>

<span data-ttu-id="b061a-172">若要添加每个排序组之间的分隔符行，我们可以直接操作此控件层次结构后已创建。</span><span class="sxs-lookup"><span data-stu-id="b061a-172">To add separator rows between each sorting group, we can directly manipulate this control hierarchy once it has been created.</span></span> <span data-ttu-id="b061a-173">我们可以确信 GridView 的控件层次结构已创建最后一次通过呈现页面时的时间。</span><span class="sxs-lookup"><span data-stu-id="b061a-173">We can be confident that the GridView s control hierarchy has been created for the last time by the time the page is being rendered.</span></span> <span data-ttu-id="b061a-174">因此，这种方法都会重写`Page`类的`Render`方法，此时 GridView s 最终的控件层次结构更新以包含所需的分隔符的行。</span><span class="sxs-lookup"><span data-stu-id="b061a-174">Therefore, this approach overrides the `Page` class s `Render` method, at which point the GridView s final control hierarchy is updated to include the needed separator rows.</span></span> <span data-ttu-id="b061a-175">图 4 说明了此过程。</span><span class="sxs-lookup"><span data-stu-id="b061a-175">Figure 4 illustrates this process.</span></span>


<span data-ttu-id="b061a-176">[![一种替代方式操作 GridView 的控件层次结构](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span><span class="sxs-lookup"><span data-stu-id="b061a-176">[![An Alternate Technique Manipulates the GridView s Control Hierarchy](creating-a-customized-sorting-user-interface-vb/_static/image9.png)](creating-a-customized-sorting-user-interface-vb/_static/image8.png)</span></span>

<span data-ttu-id="b061a-177">**图 4**:一种替代方式操作 GridView 的控件层次结构 ([单击此项可查看原尺寸图像](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="b061a-177">**Figure 4**: An Alternate Technique Manipulates the GridView s Control Hierarchy ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image10.png))</span></span>


<span data-ttu-id="b061a-178">对于本教程，我们将使用此后一种方法自定义排序的用户体验。</span><span class="sxs-lookup"><span data-stu-id="b061a-178">For this tutorial, we'll use this latter approach to customize the sorting user experience.</span></span>

> [!NOTE]
> <span data-ttu-id="b061a-179">代码我在本教程中的 m 呈现基于中提供的示例[Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx)的博客条目[播放与 GridView 排序分组位](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx)。</span><span class="sxs-lookup"><span data-stu-id="b061a-179">The code I m presenting in this tutorial is based on the example provided in [Teemu Keiski](http://aspadvice.com/blogs/joteke/default.aspx) s blog entry, [Playing a Bit with GridView Sort Grouping](http://aspadvice.com/blogs/joteke/archive/2006/02/11/15130.aspx).</span></span>


## <a name="step-3-adding-the-separator-rows-to-the-gridview-s-control-hierarchy"></a><span data-ttu-id="b061a-180">步骤 3：将分隔符行添加到 GridView 的控件层次结构</span><span class="sxs-lookup"><span data-stu-id="b061a-180">Step 3: Adding the Separator Rows to the GridView s Control Hierarchy</span></span>

<span data-ttu-id="b061a-181">由于我们只想要将分隔符行添加到 GridView 的控件层次结构，被创建并在该页面，请访问最后一次创建其控件层次结构后，我们希望执行结束时此添加的页面生命周期，但在实际的 GridView c 之前管理下层次结构已呈现为 HTML。</span><span class="sxs-lookup"><span data-stu-id="b061a-181">Since we only want to add the separator rows to the GridView s control hierarchy after its control hierarchy has been created and created for the last time on that page visit, we want to perform this addition at the end of the page lifecycle, but before the actual GridView control hierarchy has been rendered into HTML.</span></span> <span data-ttu-id="b061a-182">此时我们可以实现此目的的最新可能点是`Page`类的`Render`事件，我们可以在我们使用以下方法签名的代码隐藏类中重写：</span><span class="sxs-lookup"><span data-stu-id="b061a-182">The latest possible point at which we can accomplish this is the `Page` class s `Render` event, which we can override in our code-behind class using the following method signature:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample2.vb)]

<span data-ttu-id="b061a-183">当`Page`类 s 原始`Render`方法调用`base.Render(writer)`每个页面中控件将呈现，生成基于其控件层次结构的标记。</span><span class="sxs-lookup"><span data-stu-id="b061a-183">When the `Page` class s original `Render` method is invoked `base.Render(writer)` each of the controls in the page will be rendered, generating the markup based on their control hierarchy.</span></span> <span data-ttu-id="b061a-184">因此，它是命令性，我们都调用`base.Render(writer)`，以便呈现页面时，和我们处理的 GridView s 控件层次结构在调用之前`base.Render(writer)`，以便分隔符行已添加到之前的 GridView 的控件层次结构s 已呈现。</span><span class="sxs-lookup"><span data-stu-id="b061a-184">Therefore it is imperative that we both call `base.Render(writer)`, so that the page is rendered, and that we manipulate the GridView s control hierarchy prior to calling `base.Render(writer)`, so that the separator rows have been added to the GridView s control hierarchy before it s been rendered.</span></span>

<span data-ttu-id="b061a-185">若要插入排序组标头我们首先需要确保用户已请求对数据进行排序。</span><span class="sxs-lookup"><span data-stu-id="b061a-185">To inject the sort group headers we first need to ensure that the user has requested that the data be sorted.</span></span> <span data-ttu-id="b061a-186">默认情况下，未排序的 GridView 的内容，并因此我们不需要输入任何组排序标头。</span><span class="sxs-lookup"><span data-stu-id="b061a-186">By default, the GridView s contents are not sorted, and therefore we don t need to enter any group sorting headers.</span></span>

> [!NOTE]
> <span data-ttu-id="b061a-187">如果你想 GridView，其中首次加载页面时按特定列进行排序，调用 GridView 的`Sort`方法上第一次的页面访问 （但不是在后续回发）。</span><span class="sxs-lookup"><span data-stu-id="b061a-187">If you want the GridView to be sorted by a particular column when the page is first loaded, call the GridView s `Sort` method on the first page visit (but not on subsequent postbacks).</span></span> <span data-ttu-id="b061a-188">若要完成此操作，添加此调用中的`Page_Load`事件处理程序内的`if (!Page.IsPostBack)`条件。</span><span class="sxs-lookup"><span data-stu-id="b061a-188">To accomplish this, add this call in the `Page_Load` event handler within an `if (!Page.IsPostBack)` conditional.</span></span> <span data-ttu-id="b061a-189">回头[分页和排序报表数据](paging-and-sorting-report-data-vb.md)有关的详细信息的教程信息`Sort`方法。</span><span class="sxs-lookup"><span data-stu-id="b061a-189">Refer back to the [Paging and Sorting Report Data](paging-and-sorting-report-data-vb.md) tutorial information for more on the `Sort` method.</span></span>


<span data-ttu-id="b061a-190">假设数据已排序，我们的下一个任务是确定哪些列的数据已按排序，然后扫描查找差异 s，该列中的行值。</span><span class="sxs-lookup"><span data-stu-id="b061a-190">Assuming that the data has been sorted, our next task is to determine what column the data was sorted by and then to scan the rows looking for differences in that column s values.</span></span> <span data-ttu-id="b061a-191">下面的代码可确保数据已排序和查找数据已排序所依据的列：</span><span class="sxs-lookup"><span data-stu-id="b061a-191">The following code ensures that the data has been sorted and finds the column by which the data has been sorted:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample3.vb)]

<span data-ttu-id="b061a-192">如果这个 GridView 有尚未为排序，GridView 的`SortExpression`属性将不设置。</span><span class="sxs-lookup"><span data-stu-id="b061a-192">If the GridView has yet to be sorted, the GridView s `SortExpression` property will not have been set.</span></span> <span data-ttu-id="b061a-193">因此，我们只想添加分隔符行，如果此属性具有某个值。</span><span class="sxs-lookup"><span data-stu-id="b061a-193">Therefore, we only want to add the separator rows if this property has some value.</span></span> <span data-ttu-id="b061a-194">如果是这样，我们接下来需要确定的数据已排序所依据的列的索引。</span><span class="sxs-lookup"><span data-stu-id="b061a-194">If it does, we next need to determine the index of the column by which the data was sorted.</span></span> <span data-ttu-id="b061a-195">这通过循环遍历 GridView s 实现`Columns`集合，它的搜索列`SortExpression`属性等于 GridView 的`SortExpression`属性。</span><span class="sxs-lookup"><span data-stu-id="b061a-195">This is accomplished by looping through the GridView s `Columns` collection, searching for the column whose `SortExpression` property equals the GridView s `SortExpression` property.</span></span> <span data-ttu-id="b061a-196">除了列的索引中，我们还获取`HeaderText`显示分隔符行时使用的属性。</span><span class="sxs-lookup"><span data-stu-id="b061a-196">In addition to the column s index, we also grab the `HeaderText` property, which is used when displaying the separator rows.</span></span>

<span data-ttu-id="b061a-197">对数据进行排序所依据的索引，最后一步是列的要枚举的 GridView 行。</span><span class="sxs-lookup"><span data-stu-id="b061a-197">With the index of the column by which the data is sorted, the final step is to enumerate the rows of the GridView.</span></span> <span data-ttu-id="b061a-198">每个行，我们需要确定是否已排序的列的值与以前的行排序的 s 列的值不同。</span><span class="sxs-lookup"><span data-stu-id="b061a-198">For each row we need to determine whether the sorted column s value differs from the previous row s sorted column s value.</span></span> <span data-ttu-id="b061a-199">因此，我们需要将一个新如果`GridViewRow`在控件层次结构的实例。</span><span class="sxs-lookup"><span data-stu-id="b061a-199">If so, we need to inject a new `GridViewRow` instance into the control hierarchy.</span></span> <span data-ttu-id="b061a-200">这是使用以下代码来实现：</span><span class="sxs-lookup"><span data-stu-id="b061a-200">This is accomplished with the following code:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample4.vb)]

<span data-ttu-id="b061a-201">此代码以编程方式引用`Table`对象的 GridView 的控件层次结构的根位置找到并创建一个名为的字符串变量`lastValue`。</span><span class="sxs-lookup"><span data-stu-id="b061a-201">This code starts by programmatically referencing the `Table` object found at the root of the GridView s control hierarchy and creating a string variable named `lastValue`.</span></span> <span data-ttu-id="b061a-202">`lastValue` 用于当前行排序的 s 列值与上一个行的值进行比较。</span><span class="sxs-lookup"><span data-stu-id="b061a-202">`lastValue` is used to compare the current row s sorted column value with the previous row s value.</span></span> <span data-ttu-id="b061a-203">下一步，GridView s`Rows`枚举集合和每个行的已排序的列的值存储在`currentValue`变量。</span><span class="sxs-lookup"><span data-stu-id="b061a-203">Next, the GridView s `Rows` collection is enumerated and for each row the value of the sorted column is stored in the `currentValue` variable.</span></span>

> [!NOTE]
> <span data-ttu-id="b061a-204">若要确定特定行排序的 s 列的值，我使用的单元格的`Text`属性。</span><span class="sxs-lookup"><span data-stu-id="b061a-204">To determine the value of the particular row s sorted column I use the cell s `Text` property.</span></span> <span data-ttu-id="b061a-205">这非常适合 BoundFields，但将不按预期方式工作的 Templatefield，CheckBoxFields，等等。</span><span class="sxs-lookup"><span data-stu-id="b061a-205">This works well for BoundFields, but will not work as desired for TemplateFields, CheckBoxFields, and so on.</span></span> <span data-ttu-id="b061a-206">我们将介绍如何立即考虑备用 GridView 字段。</span><span class="sxs-lookup"><span data-stu-id="b061a-206">We'll look at how to account for alternate GridView fields shortly.</span></span>


<span data-ttu-id="b061a-207">`currentValue`和`lastValue`变量然后进行比较。</span><span class="sxs-lookup"><span data-stu-id="b061a-207">The `currentValue` and `lastValue` variables are then compared.</span></span> <span data-ttu-id="b061a-208">如果它们不同，我们需要将一个新的分隔符行添加到的控件层次结构。</span><span class="sxs-lookup"><span data-stu-id="b061a-208">If they differ we need to add a new separator row to the control hierarchy.</span></span> <span data-ttu-id="b061a-209">这通过确定的索引来实现`GridViewRow`中`Table`对象 s`Rows`集合中，创建新`GridViewRow`并`TableCell`实例，并添加`TableCell`和`GridViewRow`到控件层次结构。</span><span class="sxs-lookup"><span data-stu-id="b061a-209">This is accomplished by determining the index of the `GridViewRow` in the `Table` object s `Rows` collection, creating new `GridViewRow` and `TableCell` instances, and then adding the `TableCell` and `GridViewRow` to the control hierarchy.</span></span>

<span data-ttu-id="b061a-210">注意分隔符行 s 单独`TableCell`的格式设置该视图所跨越整个宽度的 GridView 中，使用格式化`SortHeaderRowStyle`CSS 类，并具有其`Text`属性等，其中显示这两个组的排序名称 （如类别） 和组 s 的值 （如饮料）。</span><span class="sxs-lookup"><span data-stu-id="b061a-210">Note that the separator row s lone `TableCell` is formatted such that it spans the entire width of the GridView, is formatted using the `SortHeaderRowStyle` CSS class, and has its `Text` property such that it shows both the sort group name (such as Category ) and the group s value (such as Beverages ).</span></span> <span data-ttu-id="b061a-211">最后，`lastValue`将更新的值为`currentValue`。</span><span class="sxs-lookup"><span data-stu-id="b061a-211">Finally, `lastValue` is updated to the value of `currentValue`.</span></span>

<span data-ttu-id="b061a-212">用于设置格式的排序的组头行的 CSS 类`SortHeaderRowStyle`需要在指定`Styles.css`文件。</span><span class="sxs-lookup"><span data-stu-id="b061a-212">The CSS class used to format the sorting group header row `SortHeaderRowStyle` needs to be specified in the `Styles.css` file.</span></span> <span data-ttu-id="b061a-213">可随意使用任何样式设置有吸引力;我使用了以下程序：</span><span class="sxs-lookup"><span data-stu-id="b061a-213">Feel free to use whatever style settings appeal to you; I used the following:</span></span>


[!code-css[Main](creating-a-customized-sorting-user-interface-vb/samples/sample5.css)]

<span data-ttu-id="b061a-214">当前代码的排序接口添加排序组标头，通过任何 BoundField 进行排序时 （请参阅图 5 中，其中显示了屏幕截图，供应商进行排序时）。</span><span class="sxs-lookup"><span data-stu-id="b061a-214">With the current code, the sorting interface adds sort group headers when sorting by any BoundField (see Figure 5, which shows a screenshot when sorting by supplier).</span></span> <span data-ttu-id="b061a-215">但是，按任何其他字段类型 （如 CheckBoxField 或 TemplateField） 进行排序，排序组标头时，却找不到 （见图 6）。</span><span class="sxs-lookup"><span data-stu-id="b061a-215">However, when sorting by any other field type (such as a CheckBoxField or TemplateField), the sort group headers are nowhere to be found (see Figure 6).</span></span>


<span data-ttu-id="b061a-216">[![排序接口通过 BoundFields 进行排序时包含对组排序标头](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="b061a-216">[![The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields](creating-a-customized-sorting-user-interface-vb/_static/image12.png)](creating-a-customized-sorting-user-interface-vb/_static/image11.png)</span></span>

<span data-ttu-id="b061a-217">**图 5**:排序接口包括排序组标头时排序 BoundFields ([单击此项可查看原尺寸图像](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span><span class="sxs-lookup"><span data-stu-id="b061a-217">**Figure 5**: The Sorting Interface Includes Sort Group Headers When Sorting by BoundFields ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image13.png))</span></span>


<span data-ttu-id="b061a-218">[![排序组标头是缺少时排序 CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span><span class="sxs-lookup"><span data-stu-id="b061a-218">[![The Sort Group Headers are Missing When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image15.png)](creating-a-customized-sorting-user-interface-vb/_static/image14.png)</span></span>

<span data-ttu-id="b061a-219">**图 6**:排序组标头是缺少时排序 CheckBoxField ([单击此项可查看原尺寸图像](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="b061a-219">**Figure 6**: The Sort Group Headers are Missing When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image16.png))</span></span>


<span data-ttu-id="b061a-220">通过 CheckBoxField 进行排序时，排序组标头会缺失的原因在于，代码当前只需使用`TableCell`s`Text`属性来确定已排序的列的每一行的值。</span><span class="sxs-lookup"><span data-stu-id="b061a-220">The reason the sort group headers are missing when sorting by a CheckBoxField is because the code currently uses just the `TableCell` s `Text` property to determine the value of the sorted column for each row.</span></span> <span data-ttu-id="b061a-221">CheckBoxFields，对于`TableCell`s`Text`属性为空字符串; 相反，值是可通过位于内的复选框 Web 控件`TableCell`s`Controls`集合。</span><span class="sxs-lookup"><span data-stu-id="b061a-221">For CheckBoxFields, the `TableCell` s `Text` property is an empty string; instead, the value is available through a CheckBox Web control that resides within the `TableCell` s `Controls` collection.</span></span>

<span data-ttu-id="b061a-222">若要处理 BoundFields 以外的字段类型，我们需要扩充代码位置`currentValue`变量赋值来检查是否存在中的复选框`TableCell`s`Controls`集合。</span><span class="sxs-lookup"><span data-stu-id="b061a-222">To handle field types other than BoundFields, we need to augment the code where the `currentValue` variable is assigned to check for the existence of a CheckBox in the `TableCell` s `Controls` collection.</span></span> <span data-ttu-id="b061a-223">而不是使用`currentValue = gvr.Cells(sortColumnIndex).Text`，此代码替换为以下代码：</span><span class="sxs-lookup"><span data-stu-id="b061a-223">Instead of using `currentValue = gvr.Cells(sortColumnIndex).Text`, replace this code with the following:</span></span>


[!code-vb[Main](creating-a-customized-sorting-user-interface-vb/samples/sample6.vb)]

<span data-ttu-id="b061a-224">此代码会检查已排序的列`TableCell`确定是否有任何控件中的当前行`Controls`集合。</span><span class="sxs-lookup"><span data-stu-id="b061a-224">This code examines the sorted column `TableCell` for the current row to determine if there are any controls in the `Controls` collection.</span></span> <span data-ttu-id="b061a-225">如果有，并且第一个控件是一个复选框`currentValue`变量设置为是或否，具体取决于复选框的`Checked`属性。</span><span class="sxs-lookup"><span data-stu-id="b061a-225">If there are, and the first control is a CheckBox, the `currentValue` variable is set to Yes or No, depending on the CheckBox s `Checked` property.</span></span> <span data-ttu-id="b061a-226">否则，值取自`TableCell`s`Text`属性。</span><span class="sxs-lookup"><span data-stu-id="b061a-226">Otherwise, the value is taken from the `TableCell` s `Text` property.</span></span> <span data-ttu-id="b061a-227">可以复制此逻辑以处理对 GridView 中可能存在任何 Templatefield 进行排序。</span><span class="sxs-lookup"><span data-stu-id="b061a-227">This logic can be replicated to handle sorting for any TemplateFields that may exist in the GridView.</span></span>

<span data-ttu-id="b061a-228">上面的代码添加，现通过停止使用 CheckBoxField 进行排序时存在排序组标头 （请参阅图 7）。</span><span class="sxs-lookup"><span data-stu-id="b061a-228">With the above code addition, the sort group headers are now present when sorting by the Discontinued CheckBoxField (see Figure 7).</span></span>


<span data-ttu-id="b061a-229">[![排序组标头是现在存在时排序 CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="b061a-229">[![The Sort Group Headers are Now Present When Sorting a CheckBoxField](creating-a-customized-sorting-user-interface-vb/_static/image18.png)](creating-a-customized-sorting-user-interface-vb/_static/image17.png)</span></span>

<span data-ttu-id="b061a-230">**图 7**:排序组标头是现在存在时排序 CheckBoxField ([单击此项可查看原尺寸图像](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span><span class="sxs-lookup"><span data-stu-id="b061a-230">**Figure 7**: The Sort Group Headers are Now Present When Sorting a CheckBoxField ([Click to view full-size image](creating-a-customized-sorting-user-interface-vb/_static/image19.png))</span></span>


> [!NOTE]
> <span data-ttu-id="b061a-231">如果使用的产品`NULL`数据库的值`CategoryID`， `SupplierID`，或`UnitPrice`字段，这些值将显示为 GridView 中的空字符串默认情况下，这分隔符行的文本意味着与这些产品`NULL`值将读取为类似类别: (即，有 s 类别之后没有名称： 喜欢个类别：饮料）。</span><span class="sxs-lookup"><span data-stu-id="b061a-231">If you have products with `NULL` database values for the `CategoryID`, `SupplierID`, or `UnitPrice` fields, those values will appear as empty strings in the GridView by default, meaning the separator row s text for those products with `NULL` values will read like Category: (that is, there s no name after Category: like with Category: Beverages ).</span></span> <span data-ttu-id="b061a-232">如果你想在此处显示的值可以设置 BoundFields [ `NullDisplayText`属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx)于文本要显示或分配时，可以在 Render 方法中添加一个条件语句`currentValue`为分隔符行的`Text`属性。</span><span class="sxs-lookup"><span data-stu-id="b061a-232">If you want a value displayed here you can either set the BoundFields [`NullDisplayText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.boundfield.nulldisplaytext.aspx) to the text you want displayed or you can add a conditional statement in the Render method when assigning the `currentValue` to the separator row s `Text` property.</span></span>


## <a name="summary"></a><span data-ttu-id="b061a-233">总结</span><span class="sxs-lookup"><span data-stu-id="b061a-233">Summary</span></span>

<span data-ttu-id="b061a-234">GridView 不包括用于自定义排序接口的多个内置选项。</span><span class="sxs-lookup"><span data-stu-id="b061a-234">The GridView does not include many built-in options for customizing the sorting interface.</span></span> <span data-ttu-id="b061a-235">但是，对于一些低级别代码，它可以调整 GridView 的控件层次结构，以创建更多自定义的接口。</span><span class="sxs-lookup"><span data-stu-id="b061a-235">However, with a bit of low-level code, it s possible to tweak the GridView s control hierarchy to create a more customized interface.</span></span> <span data-ttu-id="b061a-236">在本教程中我们已了解如何为一个可排序的 GridView，更轻松地标识不同的组和这些组边界添加排序组分隔符行。</span><span class="sxs-lookup"><span data-stu-id="b061a-236">In this tutorial we saw how to add a sort group separator row for a sortable GridView, which more easily identifies the distinct groups and those groups boundaries.</span></span> <span data-ttu-id="b061a-237">有关自定义排序接口的其他示例，请参阅[Scott Guthrie](https://weblogs.asp.net/scottgu/) s[几个 ASP.NET 2.0 GridView 排序提示和技巧](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx)博客文章。</span><span class="sxs-lookup"><span data-stu-id="b061a-237">For additional examples of customized sorting interfaces, check out [Scott Guthrie](https://weblogs.asp.net/scottgu/) s [A Few ASP.NET 2.0 GridView Sorting Tips and Tricks](https://weblogs.asp.net/scottgu/archive/2006/02/11/437995.aspx) blog entry.</span></span>

<span data-ttu-id="b061a-238">快乐编程 ！</span><span class="sxs-lookup"><span data-stu-id="b061a-238">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="b061a-239">关于作者</span><span class="sxs-lookup"><span data-stu-id="b061a-239">About the Author</span></span>

<span data-ttu-id="b061a-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)的七个部 asp/ASP.NET 书籍并创办了作者[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年以来一直致力于 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="b061a-240">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="b061a-241">Scott 是独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="b061a-241">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="b061a-242">他最新著作是[ *Sams Teach 自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="b061a-242">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="b061a-243">他可以到达[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="b061a-243">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="b061a-244">或通过他的博客，其中，请参阅[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="b061a-244">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="b061a-245">上一篇</span><span class="sxs-lookup"><span data-stu-id="b061a-245">Previous</span></span>](sorting-custom-paged-data-vb.md)

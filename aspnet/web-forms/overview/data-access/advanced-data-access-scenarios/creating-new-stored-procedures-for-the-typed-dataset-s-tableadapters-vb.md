---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
title: 为类型化数据集的 Tableadapter 创建新的存储过程（VB） |Microsoft Docs
author: rick-anderson
description: 在前面的教程中，我们在代码中创建了 SQL 语句，并将语句传递到要执行的数据库。 另一种方法是使用 。
ms.author: riande
ms.date: 07/18/2007
ms.assetid: a5a4a9ba-d18d-489a-a6b0-a3c26d6b0274
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
msc.type: authoredcontent
ms.openlocfilehash: a7cc890038e5bb4eb61c7c3b808154c196ab2423
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2020
ms.locfileid: "78428708"
---
# <a name="creating-new-stored-procedures-for-the-typed-datasets-tableadapters-vb"></a><span data-ttu-id="2cfc3-104">新建适用于类型化数据集的 TableAdapter 的存储过程 (VB)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-104">Creating New Stored Procedures for the Typed DataSet's TableAdapters (VB)</span></span>

<span data-ttu-id="2cfc3-105">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2cfc3-106">[下载代码](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_67_VB.zip)或[下载 PDF](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial67vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_67_VB.zip) or [Download PDF](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial67vb1.pdf)</span></span>

> <span data-ttu-id="2cfc3-107">在前面的教程中，我们在代码中创建了 SQL 语句，并将语句传递到要执行的数据库。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-107">In earlier tutorials we have created SQL statements in our code and passed the statements to the database to be executed.</span></span> <span data-ttu-id="2cfc3-108">另一种方法是使用存储过程，在数据库中预定义 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-108">An alternative approach is to use stored procedures, where the SQL statements are pre-defined at the database.</span></span> <span data-ttu-id="2cfc3-109">在本教程中，我们将了解如何让 TableAdapter 向导为我们生成新的存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-109">In this tutorial we learn how to have the TableAdapter Wizard generate new stored procedures for us.</span></span>

## <a name="introduction"></a><span data-ttu-id="2cfc3-110">简介</span><span class="sxs-lookup"><span data-stu-id="2cfc3-110">Introduction</span></span>

<span data-ttu-id="2cfc3-111">这些教程的数据访问层（DAL）使用类型化数据集。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-111">The Data Access Layer (DAL) for these tutorials uses Typed DataSets.</span></span> <span data-ttu-id="2cfc3-112">如[创建数据访问层](../introduction/creating-a-data-access-layer-vb.md)教程中所述，类型化数据集由强类型的数据表和 tableadapter 组成。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-112">As discussed in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial, Typed DataSets consist of strongly-typed DataTables and TableAdapters.</span></span> <span data-ttu-id="2cfc3-113">数据表表示系统中的逻辑实体，同时 Tableadapter 接口与基础数据库一起执行数据访问。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-113">The DataTables represent the logical entities in the system while the TableAdapters interface with the underlying database to perform the data access work.</span></span> <span data-ttu-id="2cfc3-114">这包括：用数据填充数据表，执行返回标量数据的查询，以及插入、更新和删除数据库中的记录。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-114">This includes populating the DataTables with data, executing queries that return scalar data, and inserting, updating, and deleting records from the database.</span></span>

<span data-ttu-id="2cfc3-115">Tableadapter 执行的 SQL 命令可以是即席 SQL 语句，如 `SELECT columnList FROM TableName`或存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-115">The SQL commands executed by the TableAdapters can be either ad-hoc SQL statements, such as `SELECT columnList FROM TableName`, or stored procedures.</span></span> <span data-ttu-id="2cfc3-116">体系结构中的 Tableadapter 使用即席 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-116">The TableAdapters in our architecture use ad-hoc SQL statements.</span></span> <span data-ttu-id="2cfc3-117">然而，许多开发人员和数据库管理员都倾向于即席 SQL 语句的存储过程，以提高安全性、可维护性和可更新性。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-117">Many developers and database administrators, however, prefer stored procedures over ad-hoc SQL statements for security, maintainability, and updatability reasons.</span></span> <span data-ttu-id="2cfc3-118">其他 ardently 更喜欢使用即席 SQL 语句来实现灵活性。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-118">Others ardently prefer ad-hoc SQL statements for their flexibility.</span></span> <span data-ttu-id="2cfc3-119">在我自己的工作中，我对即席 SQL 语句使用存储过程，但选择使用即席 SQL 语句来简化前面的教程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-119">In my own work I favor stored procedures over ad-hoc SQL statements, but chose to use ad-hoc SQL statements to simplify the earlier tutorials.</span></span>

<span data-ttu-id="2cfc3-120">定义 TableAdapter 或添加新方法时，TableAdapter s 向导使得创建新的存储过程或使用现有的存储过程与使用即席 SQL 语句一样简单。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-120">When defining a TableAdapter or adding new methods, the TableAdapter s wizard makes it just as easy to create new stored procedures or use existing stored procedures as it does to use ad-hoc SQL statements.</span></span> <span data-ttu-id="2cfc3-121">在本教程中，我们将检查如何使 TableAdapter s 向导自动生成存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-121">In this tutorial we'll examine how to have the TableAdapter s wizard auto-generate stored procedures.</span></span> <span data-ttu-id="2cfc3-122">在下一教程中，我们将介绍如何配置 TableAdapter s 方法以使用现有存储过程或手动创建的存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-122">In the next tutorial we will look at how to configure the TableAdapter s methods to use existing or manually-created stored procedures.</span></span>

> [!NOTE]
> <span data-ttu-id="2cfc3-123">请参阅 "Howard" 的博客文章["尚不要使用存储过程？" 和 "](http://grokable.com/2003/11/dont-use-stored-procedures-yet-must-be-suffering-from-nihs-not-invented-here-syndrome/) [Frans Bouma](https://weblogs.asp.net/fbouma/) s" 博客条目[存储过程是错误的，M Kay？对于生动，请](https://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx)参阅存储过程和即席 SQL 的优缺点。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-123">See Rob Howard's blog entry [Don t Use Stored Procedures Yet?](http://grokable.com/2003/11/dont-use-stored-procedures-yet-must-be-suffering-from-nihs-not-invented-here-syndrome/) and [Frans Bouma](https://weblogs.asp.net/fbouma/) s blog entry [Stored Procedures are Bad, M Kay?](https://weblogs.asp.net/fbouma/archive/2003/11/18/38178.aspx) for a lively debate on the pros and cons of stored procedures and ad-hoc SQL.</span></span>

## <a name="stored-procedure-basics"></a><span data-ttu-id="2cfc3-124">存储过程基本知识</span><span class="sxs-lookup"><span data-stu-id="2cfc3-124">Stored Procedure Basics</span></span>

<span data-ttu-id="2cfc3-125">函数是所有编程语言通用的构造。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-125">Functions are a construct common to all programming languages.</span></span> <span data-ttu-id="2cfc3-126">函数是在调用函数时执行的语句的集合。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-126">A function is a collection of statements that are executed when the function is called.</span></span> <span data-ttu-id="2cfc3-127">函数可以接受输入参数，还可以选择返回值。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-127">Functions can accept input parameters and may optionally return a value.</span></span> <span data-ttu-id="2cfc3-128">*[存储过程](http://en.wikipedia.org/wiki/Stored_procedure)* 是与编程语言中的函数共享许多相似之处的数据库构造。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-128">*[Stored procedures](http://en.wikipedia.org/wiki/Stored_procedure)* are database constructs that share many similarities with functions in programming languages.</span></span> <span data-ttu-id="2cfc3-129">存储过程由一组在调用存储过程时执行的 T-sql 语句组成。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-129">A stored procedure is made up of a set of T-SQL statements that are executed when the stored procedure is called.</span></span> <span data-ttu-id="2cfc3-130">存储过程可以接受零个到多个输入参数，并可以从 `SELECT` 查询返回标量值、输出参数或最常见的结果集。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-130">A stored procedure may accept zero to many input parameters and can return scalar values, output parameters, or, most commonly, result sets from `SELECT` queries.</span></span>

> [!NOTE]
> <span data-ttu-id="2cfc3-131">存储过程经常称为 sprocs 或 Sp。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-131">Stored procedures are oftentimes referred to as sprocs or SPs .</span></span>

<span data-ttu-id="2cfc3-132">存储过程是使用[`CREATE PROCEDURE`](https://msdn.microsoft.com/library/aa258259(SQL.80).aspx) t-sql 语句创建的。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-132">Stored procedures are created using the [`CREATE PROCEDURE`](https://msdn.microsoft.com/library/aa258259(SQL.80).aspx) T-SQL statement.</span></span> <span data-ttu-id="2cfc3-133">例如，以下 T-sql 脚本将创建一个名为 `GetProductsByCategoryID` 的存储过程，该存储过程采用一个名为 `@CategoryID` 的参数，并返回 `UnitPrice`表中这些列的 `ProductID`、`ProductName`、`Discontinued` 和 `Products` 字段，它们具有匹配的 `CategoryID` 值：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-133">For example, the following T-SQL script creates a stored procedure named `GetProductsByCategoryID` that takes in a single parameter named `@CategoryID` and returns the `ProductID`, `ProductName`, `UnitPrice`, and `Discontinued` fields of those columns in the `Products` table that have a matching `CategoryID` value:</span></span>

[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample1.sql)]

<span data-ttu-id="2cfc3-134">创建此存储过程后，可以使用以下语法来调用它：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-134">Once this stored procedure has been created, it can be called using the following syntax:</span></span>

[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample2.sql)]

> [!NOTE]
> <span data-ttu-id="2cfc3-135">在下一教程中，我们将通过 Visual Studio IDE 来检查创建存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-135">In the next tutorial we will examine creating stored procedures through the Visual Studio IDE.</span></span> <span data-ttu-id="2cfc3-136">但对于本教程，我们将让 TableAdapter 向导自动生成存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-136">For this tutorial, however, we are going to let the TableAdapter wizard automatically generate the stored procedures for us.</span></span>

<span data-ttu-id="2cfc3-137">除了只返回数据以外，存储过程通常还用于在单个事务的范围内执行多个数据库命令。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-137">In addition to simply returning data, stored procedures are often used to perform multiple database commands within the scope of a single transaction.</span></span> <span data-ttu-id="2cfc3-138">例如，名为 `DeleteCategory`的存储过程可能采用 `@CategoryID` 参数，并执行两个 `DELETE` 语句：第一个语句，删除相关产品，另一个语句删除指定的类别。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-138">A stored procedure named `DeleteCategory`, for example, might take in a `@CategoryID` parameter and perform two `DELETE` statements: first, one to delete the related products and a second one deleting the specified category.</span></span> <span data-ttu-id="2cfc3-139">存储过程中的多个语句*不*会自动包装在事务中。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-139">Multiple statements within a stored procedure are *not* automatically wrapped within a transaction.</span></span> <span data-ttu-id="2cfc3-140">需要发出其他 T-sql 命令，以确保将存储过程多个命令视为原子操作。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-140">Additional T-SQL commands need to be issued to ensure the stored procedure s multiple commands are treated as an atomic operation.</span></span> <span data-ttu-id="2cfc3-141">在后续教程中，我们将了解如何将存储过程的命令包装在事务范围内。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-141">We'll see how to wrap a stored procedure s commands within the scope of a transaction in the subsequent tutorial.</span></span>

<span data-ttu-id="2cfc3-142">在体系结构中使用存储过程时，数据访问层的方法将调用特定的存储过程，而不是发出即席 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-142">When using stored procedures within an architecture, the Data Access Layer s methods invoke a particular stored procedure rather than issuing an ad-hoc SQL statement.</span></span> <span data-ttu-id="2cfc3-143">这将集中执行的 SQL 语句的位置（在数据库上），而不是在应用程序体系结构中定义它。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-143">This centralizes the location of the SQL statements executed (on the database) rather than having it defined within the application s architecture.</span></span> <span data-ttu-id="2cfc3-144">这种集中的功能可以更轻松地查找、分析和优化查询，并提供与数据库的使用位置和使用方式更清晰的图像。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-144">This centralization arguably makes it easier to find, analyze, and tune the queries and provides a much clearer picture as to where and how the database is being used.</span></span>

<span data-ttu-id="2cfc3-145">有关存储过程基础知识的详细信息，请参阅本教程末尾的进一步阅读部分中的资源。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-145">For more information on stored procedure fundamentals, consult the resources in the Further Reading section at the end of this tutorial.</span></span>

## <a name="step-1-creating-the-advanced-data-access-layer-scenarios-web-pages"></a><span data-ttu-id="2cfc3-146">步骤1：创建高级数据访问层方案网页</span><span class="sxs-lookup"><span data-stu-id="2cfc3-146">Step 1: Creating the Advanced Data Access Layer Scenarios Web Pages</span></span>

<span data-ttu-id="2cfc3-147">在开始介绍如何使用存储过程创建 DAL 之前，首先请花点时间在我们的网站项目中创建 ASP.NET 页面，我们将在本网站中创建这些页面，接下来的几个教程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-147">Before we start our discussion on creating a DAL using stored procedures, let s first take a moment to create the ASP.NET pages in our website project that we will need for this and the next several tutorials.</span></span> <span data-ttu-id="2cfc3-148">首先添加一个名为 `AdvancedDAL`的新文件夹。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-148">Start by adding a new folder named `AdvancedDAL`.</span></span> <span data-ttu-id="2cfc3-149">接下来，将以下 ASP.NET 页面添加到该文件夹，并确保将每个页面与 `Site.master` 母版页关联：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-149">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `NewSprocs.aspx`
- `ExistingSprocs.aspx`
- `JOINs.aspx`
- `AddingColumns.aspx`
- `ComputedColumns.aspx`
- `EncryptingConfigSections.aspx`
- `ManagedFunctionsAndSprocs.aspx`

![为高级数据访问层方案教程添加 ASP.NET 页](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)

<span data-ttu-id="2cfc3-151">**图 1**：添加高级数据访问层方案教程的 ASP.NET 页</span><span class="sxs-lookup"><span data-stu-id="2cfc3-151">**Figure 1**: Add the ASP.NET Pages for the Advanced Data Access Layer Scenarios Tutorials</span></span>

<span data-ttu-id="2cfc3-152">与在其他文件夹中一样，`AdvancedDAL` 文件夹中的 `Default.aspx` 会在其部分列出教程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-152">Like in the other folders, `Default.aspx` in the `AdvancedDAL` folder will list the tutorials in its section.</span></span> <span data-ttu-id="2cfc3-153">请记住，`SectionLevelTutorialListing.ascx` 用户控件提供此功能。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-153">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="2cfc3-154">因此，通过将此用户控件从解决方案资源管理器拖到页面 s 设计视图，将该用户控件添加到 `Default.aspx`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-154">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>

<span data-ttu-id="2cfc3-155">[![将 SectionLevelTutorialListing 用户控件添加到 default.aspx](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-155">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)</span></span>

<span data-ttu-id="2cfc3-156">**图 2**：将 `SectionLevelTutorialListing.ascx` 用户控件添加到 `Default.aspx` （[单击以查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-156">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png))</span></span>

<span data-ttu-id="2cfc3-157">最后，将这些页面作为条目添加到 `Web.sitemap` 文件中。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-157">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="2cfc3-158">具体而言，请在使用批量数据 `<siteMapNode>`之后添加以下标记：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-158">Specifically, add the following markup after the Working with Batched Data `<siteMapNode>`:</span></span>

[!code-xml[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample3.xml)]

<span data-ttu-id="2cfc3-159">更新 `Web.sitemap`后，请花点时间通过浏览器查看教程网站。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-159">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="2cfc3-160">左侧的菜单中包括高级 DAL 方案教程中的项。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-160">The menu on the left now includes items for the advanced DAL scenarios tutorials.</span></span>

![站点映射现在包含高级 DAL 方案教程的条目](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)

<span data-ttu-id="2cfc3-162">**图 3**：站点地图现在包含高级 DAL 方案教程的条目</span><span class="sxs-lookup"><span data-stu-id="2cfc3-162">**Figure 3**: The Site Map Now Includes Entries for the Advanced DAL Scenarios Tutorials</span></span>

## <a name="step-2-configuring-a-tableadapter-to-create-new-stored-procedures"></a><span data-ttu-id="2cfc3-163">步骤2：配置 TableAdapter 以创建新的存储过程</span><span class="sxs-lookup"><span data-stu-id="2cfc3-163">Step 2: Configuring a TableAdapter to Create New Stored Procedures</span></span>

<span data-ttu-id="2cfc3-164">若要演示如何创建使用存储过程而不是即席 SQL 语句的数据访问层，请在名为 `NorthwindWithSprocs.xsd`的 `~/App_Code/DAL` 文件夹中创建新的类型化数据集。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-164">To demonstrate creating a Data Access Layer that uses stored procedures instead of ad-hoc SQL statements, let s create a new Typed DataSet in the `~/App_Code/DAL` folder named `NorthwindWithSprocs.xsd`.</span></span> <span data-ttu-id="2cfc3-165">由于我们已在前面的教程中详细介绍了此过程，因此我们将通过此处的步骤快速完成。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-165">Since we have stepped through this process in detail in previous tutorials, we will proceed quickly through the steps here.</span></span> <span data-ttu-id="2cfc3-166">如果在创建和配置类型化数据集时遇到问题，或者需要进一步的分步说明，请参阅[创建数据访问层](../introduction/creating-a-data-access-layer-vb.md)教程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-166">If you get stuck or need further step-by-step instructions in creating and configuring a Typed DataSet, refer back to the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial.</span></span>

<span data-ttu-id="2cfc3-167">右键单击 "`DAL`" 文件夹，选择 "添加新项"，然后选择数据集模板（如图4所示），将一个新数据集添加到项目。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-167">Add a new DataSet to the project by right-clicking on the `DAL` folder, choosing Add New Item, and selecting the DataSet template as shown in Figure 4.</span></span>

<span data-ttu-id="2cfc3-168">[![将新的类型化数据集添加到名为 NorthwindWithSprocs 的项目](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-168">[![Add a New Typed DataSet to the Project Named NorthwindWithSprocs.xsd](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png)</span></span>

<span data-ttu-id="2cfc3-169">**图 4**：将新的类型化数据集添加到名为 `NorthwindWithSprocs.xsd` 的项目（[单击查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-169">**Figure 4**: Add a New Typed DataSet to the Project Named `NorthwindWithSprocs.xsd` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png))</span></span>

<span data-ttu-id="2cfc3-170">这会创建新的类型化数据集，打开其设计器，创建新的 TableAdapter，并启动 TableAdapter 配置向导。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-170">This will create the new Typed DataSet, open its Designer, create a new TableAdapter, and launch the TableAdapter Configuration Wizard.</span></span> <span data-ttu-id="2cfc3-171">TableAdapter 配置向导的第一个步骤要求我们选择要使用的数据库。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-171">The TableAdapter Configuration Wizard s first step asks us to select the database to work with.</span></span> <span data-ttu-id="2cfc3-172">应在下拉列表中列出 Northwind 数据库的连接字符串。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-172">The connection string to the Northwind database should be listed in the drop-down list.</span></span> <span data-ttu-id="2cfc3-173">选择此，然后单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-173">Select this and click Next.</span></span>

<span data-ttu-id="2cfc3-174">在下一个屏幕中，我们可以选择 TableAdapter 应如何访问数据库。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-174">From this next screen we can choose how the TableAdapter should access the database.</span></span> <span data-ttu-id="2cfc3-175">在前面的教程中，我们选择了第一个选项 "使用 SQL 语句"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-175">In previous tutorials, we selected the first option, Use SQL statements.</span></span> <span data-ttu-id="2cfc3-176">对于本教程，请选择第二个选项 "创建新存储过程"，然后单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-176">For this tutorial, select the second option, Create new stored procedures, and click Next.</span></span>

<span data-ttu-id="2cfc3-177">[![指示 TableAdapter 创建新的存储过程](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-177">[![Instruct the TableAdapter to Create New Stored Procedures](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png)</span></span>

<span data-ttu-id="2cfc3-178">**图 5**：指示 TableAdapter 创建新的存储过程（[单击以查看完全大小的映像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-178">**Figure 5**: Instruct the TableAdapter to Create New Stored Procedures ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png))</span></span>

<span data-ttu-id="2cfc3-179">就像使用即席 SQL 语句一样，在下面的步骤中，我们将要求提供用于 TableAdapter s 主查询的 `SELECT` 语句。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-179">Just like with using ad-hoc SQL statements, in the following step we are asked to provide the `SELECT` statement for the TableAdapter s main query.</span></span> <span data-ttu-id="2cfc3-180">但是，TableAdapter s 向导将创建包含此 `SELECT` 查询的存储过程，而不是使用此处输入的 `SELECT` 语句直接执行即席查询。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-180">But instead of using the `SELECT` statement entered here to perform an ad-hoc query directly, the TableAdapter s wizard will create a stored procedure that contains this `SELECT` query.</span></span>

<span data-ttu-id="2cfc3-181">对此 TableAdapter 使用以下 `SELECT` 查询：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-181">Use the following `SELECT` query for this TableAdapter:</span></span>

[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample4.sql)]

<span data-ttu-id="2cfc3-182">[![输入 SELECT 查询](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-182">[![Enter the SELECT Query](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png)</span></span>

<span data-ttu-id="2cfc3-183">**图 6**：输入 `SELECT` 查询（[单击以查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-183">**Figure 6**: Enter the `SELECT` Query ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png))</span></span>

> [!NOTE]
> <span data-ttu-id="2cfc3-184">上面的查询与 `Northwind` 类型化数据集中的 `ProductsTableAdapter` 的主查询略有不同。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-184">The query above differs slightly from the main query of the `ProductsTableAdapter` in the `Northwind` Typed DataSet.</span></span> <span data-ttu-id="2cfc3-185">请记住，`Northwind` 类型化数据集中的 `ProductsTableAdapter` 包括两个相关子查询，分别用于返回每个产品类别和供应商的类别名称和公司名称。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-185">Recall that the `ProductsTableAdapter` in the `Northwind` Typed DataSet includes two correlated subqueries to bring back the category name and company name for each product s category and supplier.</span></span> <span data-ttu-id="2cfc3-186">在即将[更新 TableAdapter 以使用 join](updating-the-tableadapter-to-use-joins-vb.md)教程中，我们将了解如何将此相关数据添加到此 TableAdapter。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-186">In the upcoming [Updating the TableAdapter to Use JOINs](updating-the-tableadapter-to-use-joins-vb.md) tutorial we will look at adding this related data to this TableAdapter.</span></span>

<span data-ttu-id="2cfc3-187">请花点时间单击 "高级选项" 按钮。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-187">Take a moment to click the Advanced Options button.</span></span> <span data-ttu-id="2cfc3-188">从这里，我们可以指定该向导是否还应为 TableAdapter 生成 insert、update 和 delete 语句，是否使用乐观并发性，以及在插入和更新后是否应刷新数据表。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-188">From here we can specify whether the wizard should also generate insert, update, and delete statements for the TableAdapter, whether to use optimistic concurrency, and whether the data table should be refreshed after inserts and updates.</span></span> <span data-ttu-id="2cfc3-189">默认情况下，将选中 "生成 Insert、Update 和 Delete 语句" 选项。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-189">The Generate Insert, Update and Delete statements option is checked by default.</span></span> <span data-ttu-id="2cfc3-190">保持选中状态。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-190">Leave it checked.</span></span> <span data-ttu-id="2cfc3-191">对于本教程，请保留未选中 "使用开放式并发选项"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-191">For this tutorial, leave the Use optimistic concurrency options unchecked.</span></span>

<span data-ttu-id="2cfc3-192">当使用 TableAdapter 向导自动创建存储过程时，将出现 "刷新数据表" 选项。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-192">When having the stored procedures automatically created by the TableAdapter wizard, it appears that the Refresh the data table option is ignored.</span></span> <span data-ttu-id="2cfc3-193">不管是否选中此复选框，生成的 insert 和 update 存储过程都将检索刚刚插入的或仅更新的记录，如步骤3中所示。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-193">Regardless of whether this checkbox is checked, the resulting insert and update stored procedures retrieve the just-inserted or just-updated record, as we will see in Step 3.</span></span>

![选中 "生成 Insert、Update 和 Delete 语句" 选项](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png)

<span data-ttu-id="2cfc3-195">**图 7**：选中 "生成 Insert、Update 和 Delete 语句" 选项</span><span class="sxs-lookup"><span data-stu-id="2cfc3-195">**Figure 7**: Leave the Generate Insert, Update and Delete statements Option Checked</span></span>

> [!NOTE]
> <span data-ttu-id="2cfc3-196">如果选中了 "使用开放式并发" 选项，则向导将向 `WHERE` 子句添加其他条件，以防止在其他字段中发生更改时更新数据。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-196">If the Use optimistic concurrency option is checked, the wizard will add additional conditions to the `WHERE` clause that prevent data from being updated if there were changes in other fields.</span></span> <span data-ttu-id="2cfc3-197">有关使用 TableAdapter 的内置开放式并发控制功能的详细信息，请参阅[执行开放式并发](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md)教程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-197">Refer back to the [Implementing Optimistic Concurrency](../editing-inserting-and-deleting-data/implementing-optimistic-concurrency-vb.md) tutorial for more information on using the TableAdapter s built-in optimistic concurrency control feature.</span></span>

<span data-ttu-id="2cfc3-198">输入 `SELECT` 查询并确认是否选中了 "生成 Insert、Update 和 Delete 语句" 选项后，单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-198">After entering the `SELECT` query and confirming that the Generate Insert, Update and Delete statements option is checked, click Next.</span></span> <span data-ttu-id="2cfc3-199">下一个屏幕（如图8所示）将提示输入向导为选择、插入、更新和删除数据而创建的存储过程的名称。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-199">This next screen, shown in Figure 8, prompts for the names of the stored procedures the wizard will create for selecting, inserting, updating, and deleting data.</span></span> <span data-ttu-id="2cfc3-200">将这些存储过程的名称更改为 `Products_Select`、`Products_Insert`、`Products_Update`和 `Products_Delete`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-200">Change these stored procedures names to `Products_Select`, `Products_Insert`, `Products_Update`, and `Products_Delete`.</span></span>

<span data-ttu-id="2cfc3-201">[![重命名存储过程](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-201">[![Rename the Stored Procedures](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span></span>

<span data-ttu-id="2cfc3-202">**图 8**：重命名存储过程（[单击以查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-202">**Figure 8**: Rename the Stored Procedures ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span></span>

<span data-ttu-id="2cfc3-203">若要查看 TableAdapter 向导将用于创建四个存储过程的 T-sql，请单击 "预览 SQL 脚本" 按钮。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-203">To see the T-SQL the TableAdapter wizard will use to create the four stored procedures, click the Preview SQL Script button.</span></span> <span data-ttu-id="2cfc3-204">从 "预览 SQL 脚本" 对话框中，您可以将脚本保存到文件或将其复制到剪贴板。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-204">From the Preview SQL Script dialog box you may save the script to a file or copy it to the clipboard.</span></span>

![预览用于生成存储过程的 SQL 脚本](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)

<span data-ttu-id="2cfc3-206">**图 9**：预览用于生成存储过程的 SQL 脚本</span><span class="sxs-lookup"><span data-stu-id="2cfc3-206">**Figure 9**: Preview the SQL Script Used to Generate the Stored Procedures</span></span>

<span data-ttu-id="2cfc3-207">命名存储过程后，单击 "下一步" 以命名 TableAdapter 的相应方法。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-207">After naming the stored procedures, click Next to name the TableAdapter s corresponding methods.</span></span> <span data-ttu-id="2cfc3-208">就像使用即席 SQL 语句一样，可以创建填充现有 DataTable 或返回新 DataTable 的方法。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-208">Just like when using ad-hoc SQL statements, we can create methods that fill an existing DataTable or return a new one.</span></span> <span data-ttu-id="2cfc3-209">还可以指定 TableAdapter 是否应包括用于插入、更新和删除记录的 DB 直通模式。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-209">We can also specify whether the TableAdapter should include the DB-Direct pattern for inserting, updating, and deleting records.</span></span> <span data-ttu-id="2cfc3-210">选中所有三个复选框，但将 "返回 DataTable" 方法重命名为 `GetProducts` （如图10所示）。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-210">Leave all three checkboxes checked, but rename the Return a DataTable method to `GetProducts` (as shown in Figure 10).</span></span>

<span data-ttu-id="2cfc3-211">[![命名方法 Fill 和 GetProducts](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-211">[![Name the Methods Fill and GetProducts](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)</span></span>

<span data-ttu-id="2cfc3-212">**图 10**：将方法命名 `Fill` 和 `GetProducts` （[单击以查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-212">**Figure 10**: Name the Methods `Fill` and `GetProducts` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png))</span></span>

<span data-ttu-id="2cfc3-213">单击 "下一步" 查看向导将执行的步骤摘要。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-213">Click Next to see a summary of the steps the wizard will perform.</span></span> <span data-ttu-id="2cfc3-214">通过单击 "完成" 按钮完成向导。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-214">Complete the wizard by clicking the Finish button.</span></span> <span data-ttu-id="2cfc3-215">向导完成后，您将返回到数据集设计器，此时应包括 `ProductsDataTable`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-215">Once the wizard completes, you will be returned to the DataSet s Designer, which should now include the `ProductsDataTable`.</span></span>

<span data-ttu-id="2cfc3-216">[![数据集的设计器将显示新添加的 ProductsDataTable](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-216">[![The DataSet s Designer Shows the Newly Added ProductsDataTable](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)</span></span>

<span data-ttu-id="2cfc3-217">**图 11**：数据集设计器显示新添加的 `ProductsDataTable` （[单击以查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-217">**Figure 11**: The DataSet s Designer Shows the Newly Added `ProductsDataTable` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png))</span></span>

## <a name="step-3-examining-the-newly-created-stored-procedures"></a><span data-ttu-id="2cfc3-218">步骤3：检查新创建的存储过程</span><span class="sxs-lookup"><span data-stu-id="2cfc3-218">Step 3: Examining the Newly Created Stored Procedures</span></span>

<span data-ttu-id="2cfc3-219">步骤2中使用的 TableAdapter 向导会自动创建用于选择、插入、更新和删除数据的存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-219">The TableAdapter wizard used in Step 2 automatically created the stored procedures for selecting, inserting, updating, and deleting data.</span></span> <span data-ttu-id="2cfc3-220">这些存储过程可通过 Visual Studio 进行查看或修改，方法是转到服务器资源管理器并向下钻取到数据库的 "存储过程" 文件夹。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-220">These stored procedures can be viewed or modified through Visual Studio by going to the Server Explorer and drilling down into the database s Stored Procedures folder.</span></span> <span data-ttu-id="2cfc3-221">如图12所示，Northwind 数据库包含四个新的存储过程： `Products_Delete`、`Products_Insert`、`Products_Select`和 `Products_Update`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-221">As Figure 12 shows, the Northwind database contains four new stored procedures: `Products_Delete`, `Products_Insert`, `Products_Select`, and `Products_Update`.</span></span>

![在第2步中创建的四个存储过程可在数据库的 "存储过程" 文件夹中找到](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)

<span data-ttu-id="2cfc3-223">**图 12**：在第2步中创建的四个存储过程可在数据库的 "存储过程" 文件夹中找到</span><span class="sxs-lookup"><span data-stu-id="2cfc3-223">**Figure 12**: The Four Stored Procedures Created in Step 2 Can Be Found in the Database s Stored Procedures Folder</span></span>

> [!NOTE]
> <span data-ttu-id="2cfc3-224">如果看不到 "服务器资源管理器"，请访问 "查看" 菜单，然后选择 "服务器资源管理器" 选项。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-224">If you do not see the Server Explorer, go to the View menu and choose the Server Explorer option.</span></span> <span data-ttu-id="2cfc3-225">如果看不到从步骤2中添加的与产品相关的存储过程，请尝试右键单击 "存储过程" 文件夹，然后选择 "刷新"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-225">If you do not see the product-related stored procedures added from Step 2, try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>

<span data-ttu-id="2cfc3-226">若要查看或修改存储过程，请在服务器资源管理器中双击其名称，或者右键单击该存储过程，然后选择 "打开"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-226">To view or modify a stored procedure, double-click its name in the Server Explorer or, alternatively, right-click on the stored procedure and choose Open.</span></span> <span data-ttu-id="2cfc3-227">图13显示了打开的 `Products_Delete` 存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-227">Figure 13 shows the `Products_Delete` stored procedure, when opened.</span></span>

<span data-ttu-id="2cfc3-228">[可在 Visual Studio 中打开和修改 ![存储过程](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-228">[![Stored Procedures Can Be Opened and Modified From Within Visual Studio](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png)</span></span>

<span data-ttu-id="2cfc3-229">**图 13**：可以在 Visual Studio 中打开和修改存储过程（[单击以查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-229">**Figure 13**: Stored Procedures Can Be Opened and Modified From Within Visual Studio ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png))</span></span>

<span data-ttu-id="2cfc3-230">`Products_Delete` 和 `Products_Select` 存储过程的内容都非常简单。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-230">The contents of both the `Products_Delete` and `Products_Select` stored procedures are quite straightforward.</span></span> <span data-ttu-id="2cfc3-231">另一方面，`Products_Insert` 和 `Products_Update` 存储过程都一定要进行更仔细的检查，因为在其 `INSERT` 和 `UPDATE` 语句后它们都执行 `SELECT` 语句。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-231">The `Products_Insert` and `Products_Update` stored procedures, on the other hand, warrant a closer inspection as they both perform a `SELECT` statement after their `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="2cfc3-232">例如，以下 SQL 组成 `Products_Insert` 存储过程：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-232">For example, the following SQL makes up the `Products_Insert` stored procedure:</span></span>

[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample5.sql)]

<span data-ttu-id="2cfc3-233">该存储过程接受由 TableAdapter s 向导中指定的 `SELECT` 查询所返回 `Products` 列作为输入参数，并在 `INSERT` 语句中使用这些值。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-233">The stored procedure accepts as input parameters the `Products` columns that were returned by the `SELECT` query specified in the TableAdapter s wizard and these values are used in an `INSERT` statement.</span></span> <span data-ttu-id="2cfc3-234">使用 `INSERT` 语句后，`SELECT` 查询将用于返回新添加的记录的 `Products` 列值（包括 `ProductID`）。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-234">Following the `INSERT` statement, a `SELECT` query is used to return the `Products` column values (including the `ProductID`) of the newly added record.</span></span> <span data-ttu-id="2cfc3-235">当使用批更新模式添加新记录时，此刷新功能非常有用，因为它会自动将新添加的 `ProductRow` 实例 `ProductID` 属性与数据库分配的自动递增的值进行更新。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-235">This refresh capability is useful when adding a new record using the Batch Update pattern as it automatically updates the newly added `ProductRow` instances `ProductID` properties with the auto-incremented values assigned by the database.</span></span>

<span data-ttu-id="2cfc3-236">下面的代码演示了此功能。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-236">The following code illustrates this feature.</span></span> <span data-ttu-id="2cfc3-237">它包含为 `NorthwindWithSprocs` 类型化数据集创建的 `ProductsTableAdapter` 和 `ProductsDataTable`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-237">It contains a `ProductsTableAdapter` and `ProductsDataTable` created for the `NorthwindWithSprocs` Typed DataSet.</span></span> <span data-ttu-id="2cfc3-238">通过创建一个 `ProductsRow` 实例，提供其值并调用 TableAdapter s `Update` 方法，并传入 `ProductsDataTable`，将新产品添加到数据库中。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-238">A new product is added to the database by creating a `ProductsRow` instance, supplying its values, and calling the TableAdapter s `Update` method, passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="2cfc3-239">在内部，TableAdapter s `Update` 方法枚举传入的 DataTable 中的 `ProductsRow` 实例（在本示例中，只有一个，我们刚刚添加了一个），并执行适当的 insert、update 或 delete 命令。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-239">Internally, the TableAdapter s `Update` method enumerates the `ProductsRow` instances in the passed-in DataTable (in this example there is only one - the one we just added), and performs the appropriate insert, update, or delete command.</span></span> <span data-ttu-id="2cfc3-240">在这种情况下，将执行 `Products_Insert` 存储过程，该过程将向 `Products` 表中添加一条新记录，并返回新添加的记录的详细信息。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-240">In this case, the `Products_Insert` stored procedure is executed, which adds a new record to the `Products` table and returns the details of the newly-added record.</span></span> <span data-ttu-id="2cfc3-241">然后更新 `ProductsRow` 实例的 `ProductID` 值。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-241">The `ProductsRow` instance s `ProductID` value is then updated.</span></span> <span data-ttu-id="2cfc3-242">`Update` 方法完成后，可以通过 `ProductsRow` `ProductID` 属性访问新添加的记录的 `ProductID` 值。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-242">After the `Update` method has completed, we can access the newly-added record s `ProductID` value through the `ProductsRow` s `ProductID` property.</span></span>

[!code-vb[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample6.vb)]

<span data-ttu-id="2cfc3-243">`Products_Update` 存储过程类似地在其 `UPDATE` 语句后面包含 `SELECT` 语句。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-243">The `Products_Update` stored procedure similarly includes a `SELECT` statement after its `UPDATE` statement.</span></span>

[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample7.sql)]

<span data-ttu-id="2cfc3-244">请注意，此存储过程包含两个用于 `ProductID`的输入参数： `@Original_ProductID` 和 `@ProductID`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-244">Note that this stored procedure includes two input parameters for `ProductID`: `@Original_ProductID` and `@ProductID`.</span></span> <span data-ttu-id="2cfc3-245">此功能可用于可能更改主键的情况。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-245">This functionality allows for scenarios where the primary key might be changed.</span></span> <span data-ttu-id="2cfc3-246">例如，在雇员数据库中，每个雇员记录可能使用员工的社会安全号码作为其主键。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-246">For example, in an employee database, each employee record might use the employee s social security number as their primary key.</span></span> <span data-ttu-id="2cfc3-247">若要更改现有员工的社会保障号，必须提供新的社会保险号和原始安全号码。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-247">In order to change an existing employee s social security number, both the new social security number and the original one must be supplied.</span></span> <span data-ttu-id="2cfc3-248">对于 `Products` 表，不需要此类功能，因为 `ProductID` 列为 `IDENTITY` 列，并且永远不应更改。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-248">For the `Products` table, such functionality is not needed because the `ProductID` column is an `IDENTITY` column and should never be changed.</span></span> <span data-ttu-id="2cfc3-249">事实上，`Products_Update` 存储过程中的 `UPDATE` 语句不会将 `ProductID` 列包含在其列列表中。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-249">In fact, the `UPDATE` statement in the `Products_Update` stored procedure doesn t include the `ProductID` column in its column list.</span></span> <span data-ttu-id="2cfc3-250">因此，虽然在 `UPDATE` 语句 s `WHERE` 子句中使用 `@Original_ProductID`，但它对于 `Products` 表来说是多余的，并且可以被 `@ProductID` 参数替换。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-250">So, while `@Original_ProductID` is used in the `UPDATE` statement s `WHERE` clause, it is superfluous for the `Products` table and could be replaced by the `@ProductID` parameter.</span></span> <span data-ttu-id="2cfc3-251">修改存储过程的参数时，还会更新使用该存储过程的 TableAdapter 方法，这一点很重要。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-251">When modifying a stored procedure s parameters it is important that the TableAdapter method(s) that use that stored procedure are also updated.</span></span>

## <a name="step-4-modifying-a-stored-procedure-s-parameters-and-updating-the-tableadapter"></a><span data-ttu-id="2cfc3-252">步骤4：修改存储过程的参数和更新 TableAdapter</span><span class="sxs-lookup"><span data-stu-id="2cfc3-252">Step 4: Modifying a Stored Procedure s Parameters and Updating the TableAdapter</span></span>

<span data-ttu-id="2cfc3-253">由于 `@Original_ProductID` 参数是多余的，因此让我们从 `Products_Update` 存储过程中删除它。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-253">Since the `@Original_ProductID` parameter is superfluous, let s remove it from the `Products_Update` stored procedure altogether.</span></span> <span data-ttu-id="2cfc3-254">打开 `Products_Update` 存储过程，删除 `@Original_ProductID` 参数，并在 `UPDATE` 语句的 `WHERE` 子句中将从 `@Original_ProductID` 使用的参数名称更改为 `@ProductID`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-254">Open the `Products_Update` stored procedure, delete the `@Original_ProductID` parameter, and, in the `WHERE` clause of the `UPDATE` statement, change the parameter name used from `@Original_ProductID` to `@ProductID`.</span></span> <span data-ttu-id="2cfc3-255">进行这些更改后，存储过程中的 T-sql 应该如下所示：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-255">After making these changes, the T-SQL within the stored procedure should look like the following:</span></span>

[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample8.sql)]

<span data-ttu-id="2cfc3-256">若要将这些更改保存到数据库，请单击工具栏中的 "保存" 图标或按 Ctrl + S。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-256">To save these changes to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="2cfc3-257">此时，`Products_Update` 存储过程不需要 `@Original_ProductID` 输入参数，但 TableAdapter 配置为通过此类参数。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-257">At this point, the `Products_Update` stored procedure does not expect an `@Original_ProductID` input parameter, but the TableAdapter is configured to pass such a parameter.</span></span> <span data-ttu-id="2cfc3-258">您可以通过在 "数据集设计器" 中选择 TableAdapter，转到属性窗口，然后单击 `UpdateCommand` s `Parameters` 集合中的省略号，来查看 TableAdapter 将发送到 `Products_Update` 存储过程的参数。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-258">You can see the parameters the TableAdapter will send to the `Products_Update` stored procedure by selecting the TableAdapter in the DataSet Designer, going to the Properties window, and clicking the ellipses in the `UpdateCommand` s `Parameters` collection.</span></span> <span data-ttu-id="2cfc3-259">此时将打开图14中显示的 "参数集合编辑器" 对话框。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-259">This brings up the Parameters Collection Editor dialog box shown in Figure 14.</span></span>

![参数集合编辑器列出了传递到 Products_Update 存储过程的参数](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png)

<span data-ttu-id="2cfc3-261">**图 14**：参数集合编辑器列出了传递到 `Products_Update` 存储过程的参数</span><span class="sxs-lookup"><span data-stu-id="2cfc3-261">**Figure 14**: The Parameters Collection Editor Lists the Parameters Used Passed to the `Products_Update` Stored Procedure</span></span>

<span data-ttu-id="2cfc3-262">只需从成员列表中选择 "`@Original_ProductID`" 参数并单击 "删除" 按钮，即可从此处删除此参数。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-262">You can remove this parameter from here by simply selecting the `@Original_ProductID` parameter from the list of members and clicking the Remove button.</span></span>

<span data-ttu-id="2cfc3-263">或者，您可以通过右键单击设计器中的 TableAdapter，然后选择 "配置"，来刷新用于所有方法的参数。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-263">Alternatively, you can refresh the parameters used for all of the methods by right-clicking on the TableAdapter in the Designer and choosing Configure.</span></span> <span data-ttu-id="2cfc3-264">这会显示 "TableAdapter 配置向导"，其中列出了用于选择、插入、更新和删除的存储过程，以及存储过程期望接收的参数。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-264">This will bring up the TableAdapter Configuration wizard, listing the stored procedures used for selecting, inserting, updating, and deleting, along with the parameters the stored procedures expect to receive.</span></span> <span data-ttu-id="2cfc3-265">如果单击 "更新" 下拉列表，则可以看到 `Products_Update` 的存储过程所需的输入参数，这些参数现在不再包括 `@Original_ProductID` （参见图15）。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-265">If you click on the Update drop-down list you can see the `Products_Update` stored procedures expected input parameters, which now no longer includes `@Original_ProductID` (see Figure 15).</span></span> <span data-ttu-id="2cfc3-266">只需单击 "完成" 即可自动更新由 TableAdapter 使用的参数集合。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-266">Simply click Finish to automatically update the parameter collection used by the TableAdapter.</span></span>

<span data-ttu-id="2cfc3-267">[![你也可以使用 TableAdapter s 配置向导来刷新其方法参数集合](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-267">[![You Can Alternatively Use the TableAdapter s Configuration Wizard to Refresh Its Methods Parameter Collections](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span></span>

<span data-ttu-id="2cfc3-268">**图 15**：你也可以使用 TableAdapter s 配置向导来刷新其方法参数集合（[单击查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-268">**Figure 15**: You Can Alternatively Use the TableAdapter s Configuration Wizard to Refresh Its Methods Parameter Collections ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span></span>

## <a name="step-5-adding-additional-tableadapter-methods"></a><span data-ttu-id="2cfc3-269">步骤5：添加其他 TableAdapter 方法</span><span class="sxs-lookup"><span data-stu-id="2cfc3-269">Step 5: Adding Additional TableAdapter Methods</span></span>

<span data-ttu-id="2cfc3-270">如步骤2所示，创建新的 TableAdapter 时，可以轻松地自动生成相应的存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-270">As Step 2 illustrated, when creating a new TableAdapter it is easy to have the corresponding stored procedures automatically generated.</span></span> <span data-ttu-id="2cfc3-271">向 TableAdapter 添加其他方法时，情况也是如此。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-271">The same is true when adding additional methods to a TableAdapter.</span></span> <span data-ttu-id="2cfc3-272">为了说明这一点，让我们将 `GetProductByProductID(productID)` 方法添加到步骤2中创建的 `ProductsTableAdapter`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-272">To illustrate this, let s add a `GetProductByProductID(productID)` method to the `ProductsTableAdapter` created in Step 2.</span></span> <span data-ttu-id="2cfc3-273">此方法会将 `ProductID` 值作为输入，并返回有关指定产品的详细信息。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-273">This method will take as input a `ProductID` value and return details about the specified product.</span></span>

<span data-ttu-id="2cfc3-274">首先右键单击 "TableAdapter"，然后从上下文菜单中选择 "添加查询"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-274">Start by right-clicking on the TableAdapter and choosing Add Query from the context menu.</span></span>

![向 TableAdapter 添加新查询](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)

<span data-ttu-id="2cfc3-276">**图 16**：向 TableAdapter 添加新查询</span><span class="sxs-lookup"><span data-stu-id="2cfc3-276">**Figure 16**: Add a New Query to the TableAdapter</span></span>

<span data-ttu-id="2cfc3-277">这将启动 "TableAdapter 查询配置向导"，该向导将首先提示 TableAdapter 应如何访问数据库。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-277">This will start the TableAdapter Query Configuration wizard, which first prompts for how the TableAdapter should access the database.</span></span> <span data-ttu-id="2cfc3-278">若要创建新的存储过程，请选择 "创建新存储过程" 选项，然后单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-278">To have a new stored procedure created, choose the Create a new stored procedure option and click Next.</span></span>

<span data-ttu-id="2cfc3-279">[![选择 "创建新存储过程" 选项](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-279">[![Choose the Create a new stored procedure Option](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)</span></span>

<span data-ttu-id="2cfc3-280">**图 17**：选择 "创建新存储过程" 选项（[单击以查看完全大小的映像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-280">**Figure 17**: Choose the Create a new stored procedure Option ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png))</span></span>

<span data-ttu-id="2cfc3-281">下一个屏幕会要求我们确定要执行的查询类型，是返回一组行还是单个标量值，或者执行 `UPDATE`、`INSERT`或 `DELETE` 语句。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-281">The next screen asks us to identify the type of query to execute, whether it will return a set of rows or a single scalar value, or perform an `UPDATE`, `INSERT`, or `DELETE` statement.</span></span> <span data-ttu-id="2cfc3-282">由于 `GetProductByProductID(productID)` 方法将返回一行，因此请保留选中 "返回行" 选项，然后单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-282">Since the `GetProductByProductID(productID)` method will return a row, leave the SELECT which returns row option selected and hit Next.</span></span>

<span data-ttu-id="2cfc3-283">[![选择 "选择返回行" 选项](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-283">[![Choose the SELECT which returns row Option](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)</span></span>

<span data-ttu-id="2cfc3-284">**图 18**：选择 "选择返回行" 选项（[单击以查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-284">**Figure 18**: Choose the SELECT which returns row Option ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png))</span></span>

<span data-ttu-id="2cfc3-285">下一屏幕将显示 TableAdapter s main query，其中只列出了存储过程的名称（`dbo.Products_Select`）。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-285">The next screen displays the TableAdapter s main query, which just lists the name of the stored procedure (`dbo.Products_Select`).</span></span> <span data-ttu-id="2cfc3-286">将存储过程名称替换为以下 `SELECT` 语句，该语句将返回指定产品的所有产品字段：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-286">Replace the stored procedure name with the following `SELECT` statement, which returns all of the product fields for a specified product:</span></span>

[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample9.sql)]

<span data-ttu-id="2cfc3-287">[![使用 SELECT 查询替换存储过程名称](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-287">[![Replace the Stored Procedure Name with a SELECT Query](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)</span></span>

<span data-ttu-id="2cfc3-288">**图 19**：使用 `SELECT` 查询替换存储过程名称（[单击查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-288">**Figure 19**: Replace the Stored Procedure Name with a `SELECT` Query ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png))</span></span>

<span data-ttu-id="2cfc3-289">接下来的屏幕将要求你命名要创建的存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-289">The subsequent screen asks you to name the stored procedure that will be created.</span></span> <span data-ttu-id="2cfc3-290">输入 `Products_SelectByProductID` 的名称，然后单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-290">Enter the name `Products_SelectByProductID` and click Next.</span></span>

<span data-ttu-id="2cfc3-291">[![命名新存储过程 Products_SelectByProductID](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image45.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-291">[![Name the New Stored Procedure Products_SelectByProductID](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image45.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)</span></span>

<span data-ttu-id="2cfc3-292">**图 20**：将新存储过程命名 `Products_SelectByProductID` （[单击以查看完全大小的映像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image46.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-292">**Figure 20**: Name the New Stored Procedure `Products_SelectByProductID` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image46.png))</span></span>

<span data-ttu-id="2cfc3-293">向导的最后一步允许更改生成的方法名称，并指示是使用 "填充 DataTable" 模式还是返回 DataTable 模式，或同时返回这两种模式。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-293">The final step of the wizard allows us to change the method names generated as well as indicate whether to use the Fill a DataTable pattern, Return a DataTable pattern, or both.</span></span> <span data-ttu-id="2cfc3-294">对于此方法，请将这两个选项保持选中状态，但将方法重命名为 `FillByProductID` 和 `GetProductByProductID`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-294">For this method, leave both options checked, but rename the methods to `FillByProductID` and `GetProductByProductID`.</span></span> <span data-ttu-id="2cfc3-295">单击 "下一步" 以查看向导将执行的步骤的摘要，然后单击 "完成" 以完成向导。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-295">Click Next to view a summary of the steps the wizard will perform and then click Finish to complete the wizard.</span></span>

<span data-ttu-id="2cfc3-296">[![重命名 TableAdapter s 方法到 FillByProductID 和 GetProductByProductID](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image48.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image47.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-296">[![Rename the TableAdapter s Methods to FillByProductID and GetProductByProductID](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image48.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image47.png)</span></span>

<span data-ttu-id="2cfc3-297">**图 21**：重命名 TableAdapter s 方法以便 `FillByProductID` 和 `GetProductByProductID` （[单击查看完全大小的映像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image49.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-297">**Figure 21**: Rename the TableAdapter s Methods to `FillByProductID` and `GetProductByProductID` ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image49.png))</span></span>

<span data-ttu-id="2cfc3-298">完成该向导后，TableAdapter 有一个新的可用方法，`GetProductByProductID(productID)` 调用该方法时，将执行刚刚创建的 `Products_SelectByProductID` 存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-298">After completing the wizard, the TableAdapter has a new method available, `GetProductByProductID(productID)` that, when invoked, will execute the `Products_SelectByProductID` stored procedure that was just created.</span></span> <span data-ttu-id="2cfc3-299">通过深化到 "存储过程" 文件夹并打开 `Products_SelectByProductID` （如果看不到它，右键单击 "存储过程" 文件夹并选择 "刷新"），从服务器资源管理器查看此新存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-299">Take a moment to view this new stored procedure from the Server Explorer by drilling into the Stored Procedures folder and opening `Products_SelectByProductID` (if you do not see it, right-click on the Stored Procedures folder and choose Refresh).</span></span>

<span data-ttu-id="2cfc3-300">请注意，`SelectByProductID` 存储过程采用 `@ProductID` 输入参数，并执行在向导中输入的 `SELECT` 语句。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-300">Note that the `SelectByProductID` stored procedure takes `@ProductID` as an input parameter and executes the `SELECT` statement that we entered in the wizard.</span></span>

[!code-sql[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample10.sql)]

## <a name="step-6-creating-a-business-logic-layer-class"></a><span data-ttu-id="2cfc3-301">步骤6：创建业务逻辑层类</span><span class="sxs-lookup"><span data-stu-id="2cfc3-301">Step 6: Creating a Business Logic Layer Class</span></span>

<span data-ttu-id="2cfc3-302">在整个教程系列中，我们已 strived 维护一个分层体系结构，在该体系结构中，表示层已对业务逻辑层（BLL）进行所有调用。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-302">Throughout the tutorial series we have strived to maintain a layered architecture in which the Presentation Layer made all of its calls to the Business Logic Layer (BLL).</span></span> <span data-ttu-id="2cfc3-303">为了遵守这一设计决策，首先需要为新的类型化数据集创建一个 BLL 类，然后才能从表示层访问产品数据。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-303">In order to adhere to this design decision, we first need to create a BLL class for the new Typed DataSet before we can access product data from the Presentation Layer.</span></span>

<span data-ttu-id="2cfc3-304">在 `~/App_Code/BLL` 文件夹中创建一个名为 `ProductsBLLWithSprocs.vb` 的新类文件，并向其中添加以下代码：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-304">Create a new class file named `ProductsBLLWithSprocs.vb` in the `~/App_Code/BLL` folder and add to it the following code:</span></span>

[!code-vb[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample11.vb)]

<span data-ttu-id="2cfc3-305">此类模拟前面教程中的 `ProductsBLL` 类语义，但使用 `NorthwindWithSprocs` 数据集中的 `ProductsTableAdapter` 和 `ProductsDataTable` 对象。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-305">This class mimics the `ProductsBLL` class semantics from earlier tutorials, but uses the `ProductsTableAdapter` and `ProductsDataTable` objects from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="2cfc3-306">例如，`ProductsBLLWithSprocs` 类使用 `Imports NorthwindWithSprocsTableAdapters`，而不是将类文件开头的 `Imports NorthwindTableAdapters` 语句作为 `ProductsBLL`。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-306">For example, rather than having a `Imports NorthwindTableAdapters` statement at the start of the class file as `ProductsBLL` does, the `ProductsBLLWithSprocs` class uses `Imports NorthwindWithSprocsTableAdapters`.</span></span> <span data-ttu-id="2cfc3-307">同样，此类中使用的 `ProductsDataTable` 和 `ProductsRow` 对象都带有 `NorthwindWithSprocs` 命名空间的前缀。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-307">Likewise, the `ProductsDataTable` and `ProductsRow` objects used in this class are prefixed with the `NorthwindWithSprocs` namespace.</span></span> <span data-ttu-id="2cfc3-308">`ProductsBLLWithSprocs` 类提供两种数据访问方法： `GetProducts` 和 `GetProductByProductID`，以及添加、更新和删除单个产品实例的方法。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-308">The `ProductsBLLWithSprocs` class provides two data access methods, `GetProducts` and `GetProductByProductID`, and methods to add, update, and delete a single product instance.</span></span>

## <a name="step-7-working-with-thenorthwindwithsprocsdataset-from-the-presentation-layer"></a><span data-ttu-id="2cfc3-309">步骤7：使用表示层中的`NorthwindWithSprocs`数据集</span><span class="sxs-lookup"><span data-stu-id="2cfc3-309">Step 7: Working with the`NorthwindWithSprocs`DataSet from the Presentation Layer</span></span>

<span data-ttu-id="2cfc3-310">此时，我们已创建一个使用存储过程访问和修改基础数据库数据的 DAL。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-310">At this point we have created a DAL that uses stored procedures to access and modify the underlying database data.</span></span> <span data-ttu-id="2cfc3-311">我们还构建了一个基本的 BLL，其中包含用于检索所有产品或特定产品的方法，以及用于添加、更新和删除产品的方法。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-311">We have also built a rudimentary BLL with methods to retrieve all products or a particular product along with methods for adding, updating, and deleting products.</span></span> <span data-ttu-id="2cfc3-312">若要将本教程舍入，请创建一个 ASP.NET 页，该页使用 BLL s `ProductsBLLWithSprocs` 类来显示、更新和删除记录。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-312">To round off this tutorial, let s create an ASP.NET page that uses the BLL s `ProductsBLLWithSprocs` class for displaying, updating, and deleting records.</span></span>

<span data-ttu-id="2cfc3-313">打开 `AdvancedDAL` 文件夹中的 "`NewSprocs.aspx`" 页，然后将 GridView 从工具箱拖动到设计器上，并将其命名为 "`Products`"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-313">Open the `NewSprocs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, naming it `Products`.</span></span> <span data-ttu-id="2cfc3-314">从 GridView s 智能标记中，选择将其绑定到名为 `ProductsDataSource`的新 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-314">From the GridView s smart tag choose to bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="2cfc3-315">将 ObjectDataSource 配置为使用 `ProductsBLLWithSprocs` 类，如图22所示。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-315">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class, as shown in Figure 22.</span></span>

<span data-ttu-id="2cfc3-316">[![将 ObjectDataSource 配置为使用 ProductsBLLWithSprocs 类](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image51.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image50.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-316">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image51.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image50.png)</span></span>

<span data-ttu-id="2cfc3-317">**图 22**：将 ObjectDataSource 配置为使用 `ProductsBLLWithSprocs` 类（[单击查看完全大小的映像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image52.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-317">**Figure 22**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image52.png))</span></span>

<span data-ttu-id="2cfc3-318">"选择" 选项卡中的下拉列表具有两个选项： "`GetProducts`" 和 "`GetProductByProductID`"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-318">The drop-down list in the SELECT tab has two options, `GetProducts` and `GetProductByProductID`.</span></span> <span data-ttu-id="2cfc3-319">由于我们要显示 GridView 中的所有产品，因此请选择 `GetProducts` 方法。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-319">Since we want to display all products in the GridView, choose the `GetProducts` method.</span></span> <span data-ttu-id="2cfc3-320">"更新"、"插入" 和 "删除" 选项卡中的下拉列表仅有一种方法。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-320">The drop-down lists in the UPDATE, INSERT, and DELETE tabs each only have one method.</span></span> <span data-ttu-id="2cfc3-321">确保每个下拉列表都选择了相应的方法，然后单击 "完成"。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-321">Ensure that each of these drop-down lists has its appropriate method selected and then click Finish.</span></span>

<span data-ttu-id="2cfc3-322">在 ObjectDataSource 向导完成后，Visual Studio 会将 BoundFields 和 CheckBoxField 添加到 "产品数据" 字段的 GridView。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-322">After the ObjectDataSource wizard has completed, Visual Studio will add BoundFields and a CheckBoxField to the GridView for the product data fields.</span></span> <span data-ttu-id="2cfc3-323">通过选中智能标记中提供的 "启用编辑和启用删除" 选项，打开 GridView 的内置编辑和删除功能。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-323">Turn on the GridView s built-in editing and deleting features by checking the Enable Editing and Enable Deleting options present in the smart tag.</span></span>

<span data-ttu-id="2cfc3-324">[![页面包含启用了编辑和删除支持的 GridView](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image54.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image53.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-324">[![The Page Contains a GridView with Editing and Deleting Support Enabled](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image54.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image53.png)</span></span>

<span data-ttu-id="2cfc3-325">**图 23**：页面包含启用了编辑和删除支持的 GridView （[单击以查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image55.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-325">**Figure 23**: The Page Contains a GridView with Editing and Deleting Support Enabled ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image55.png))</span></span>

<span data-ttu-id="2cfc3-326">如前面的教程中所述，在完成 ObjectDataSource 向导时，Visual Studio 会将 `OldValuesParameterFormatString` 属性设置为原始\_{0}。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-326">As we ve discussed in previous tutorials, at the completion of the ObjectDataSource s wizard, Visual Studio sets the `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="2cfc3-327">此操作需要恢复为其默认值 {0}，以使数据修改功能能够正常运行，前提是 BLL 中方法所需的参数。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-327">This needs to be reverted to its default value of {0} in order for the data modification features to work properly given the parameters expected by the methods in our BLL.</span></span> <span data-ttu-id="2cfc3-328">因此，请务必将 `OldValuesParameterFormatString` 属性设置为 {0} 或从声明性语法中删除属性。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-328">Therefore, be sure to set the `OldValuesParameterFormatString` property to {0} or remove the property altogether from the declarative syntax.</span></span>

<span data-ttu-id="2cfc3-329">完成 "配置数据源" 向导后，在 GridView 中启用编辑和删除支持，并将 ObjectDataSource `OldValuesParameterFormatString` 属性返回到其默认值后，页面的声明性标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-329">After completing the Configure Data Source wizard, turning on editing and deleting support in the GridView, and returning the ObjectDataSource s `OldValuesParameterFormatString` property to its default value, your page s declarative markup should look similar to the following:</span></span>

[!code-aspx[Main](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample12.aspx)]

<span data-ttu-id="2cfc3-330">此时，我们可以通过自定义编辑界面以包括验证，将 `CategoryID` 和 `SupplierID` 列呈现为 DropDownLists 等，来整理 GridView。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-330">At this point we could tidy up the GridView by customizing the editing interface to include validation, having the `CategoryID` and `SupplierID` columns render as DropDownLists, and so on.</span></span> <span data-ttu-id="2cfc3-331">我们还可以将客户端确认添加到 "删除" 按钮，并建议你花些时间来实现这些增强功能。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-331">We could also add a client-side confirmation to the Delete button, and I encourage you to take the time to implement these enhancements.</span></span> <span data-ttu-id="2cfc3-332">由于前面的教程中介绍了这些主题，因此我们不会在此处再次介绍这些主题。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-332">Since these topics have been covered in previous tutorials, however, we will not cover them again here.</span></span>

<span data-ttu-id="2cfc3-333">无论您是否增强 GridView，都可以在浏览器中测试页面的核心功能。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-333">Regardless of whether you enhance the GridView or not, test out the page s core features in a browser.</span></span> <span data-ttu-id="2cfc3-334">如图24所示，该页面列出了 GridView 中的产品，该产品提供按行编辑和删除功能。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-334">As Figure 24 shows, the page lists the products in a GridView that provides per-row editing and deleting capabilities.</span></span>

<span data-ttu-id="2cfc3-335">[![可以从 GridView 查看、编辑和删除产品](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image57.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image56.png)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-335">[![The Products Can Be Viewed, Edited, and Deleted from the GridView](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image57.png)](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image56.png)</span></span>

<span data-ttu-id="2cfc3-336">**图 24**：可以从 GridView 查看、编辑和删除产品（[单击以查看完全大小的图像](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image58.png)）</span><span class="sxs-lookup"><span data-stu-id="2cfc3-336">**Figure 24**: The Products Can Be Viewed, Edited, and Deleted from the GridView ([Click to view full-size image](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image58.png))</span></span>

## <a name="summary"></a><span data-ttu-id="2cfc3-337">摘要</span><span class="sxs-lookup"><span data-stu-id="2cfc3-337">Summary</span></span>

<span data-ttu-id="2cfc3-338">类型化数据集中的 Tableadapter 可以使用即席 SQL 语句或存储过程来访问数据库中的数据。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-338">The TableAdapters in a Typed DataSet can access data from the database using ad-hoc SQL statements or through stored procedures.</span></span> <span data-ttu-id="2cfc3-339">使用存储过程时，可以使用现有存储过程，也可以指示使用 TableAdapter 向导根据 `SELECT` 查询创建新的存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-339">When working with stored procedures, either existing stored procedures can be used or the TableAdapter wizard can be instructed to create new stored procedures based on a `SELECT` query.</span></span> <span data-ttu-id="2cfc3-340">在本教程中，我们探讨了如何为我们自动创建存储过程。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-340">In this tutorial we explored how to have the stored procedures automatically created for us.</span></span>

<span data-ttu-id="2cfc3-341">尽管自动生成的存储过程有助于节省时间，但在某些情况下，该向导创建的存储过程不会与我们自己创建的存储过程一致。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-341">While having the stored procedures auto-generated helps save time, there are certain cases where the stored procedure created by the wizard doesn t align with what we would have created on our own.</span></span> <span data-ttu-id="2cfc3-342">例如，`Products_Update` 存储过程，即使 `@Original_ProductID` 参数是多余的，也应同时需要 `@Original_ProductID` 和 `@ProductID` 输入参数。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-342">One example is the `Products_Update` stored procedure, which expected both `@Original_ProductID` and `@ProductID` input parameters even though the `@Original_ProductID` parameter was superfluous.</span></span>

<span data-ttu-id="2cfc3-343">在许多情况下，可能已创建了存储过程，或者我们需要手动生成它们，以便对存储过程的命令进行更精细的控制。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-343">In many scenarios, the stored procedures may already have been created, or we may want to build them manually so as to have a finer degree of control over the stored procedure s commands.</span></span> <span data-ttu-id="2cfc3-344">在任一情况下，我们都需要指示 TableAdapter 使用现有存储过程作为其方法。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-344">In either case, we would want to instruct the TableAdapter to use existing stored procedures for its methods.</span></span> <span data-ttu-id="2cfc3-345">下一教程将介绍如何实现此目的。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-345">We shall see how to accomplish this in the next tutorial.</span></span>

<span data-ttu-id="2cfc3-346">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="2cfc3-346">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="2cfc3-347">其他阅读材料</span><span class="sxs-lookup"><span data-stu-id="2cfc3-347">Further Reading</span></span>

<span data-ttu-id="2cfc3-348">有关本教程中讨论的主题的详细信息，请参阅以下资源：</span><span class="sxs-lookup"><span data-stu-id="2cfc3-348">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- <span data-ttu-id="2cfc3-349">[创建和维护存储过程](https://msdn.microsoft.com/library/aa214299(SQL.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-349">[Creating and Maintaining Stored Procedures](https://msdn.microsoft.com/library/aa214299(SQL.80).aspx)</span></span>
- [<span data-ttu-id="2cfc3-350">从存储过程中检索标量数据</span><span class="sxs-lookup"><span data-stu-id="2cfc3-350">Retrieving Scalar Data from a Stored Procedure</span></span>](http://aspnet.4guysfromrolla.com/articles/062905-1.aspx)
- [<span data-ttu-id="2cfc3-351">SQL Server 存储过程基础知识</span><span class="sxs-lookup"><span data-stu-id="2cfc3-351">SQL Server Stored Procedure Basics</span></span>](http://www.awprofessional.com/articles/article.asp?p=25288&amp;rl=1)
- [<span data-ttu-id="2cfc3-352">存储过程：概述</span><span class="sxs-lookup"><span data-stu-id="2cfc3-352">Stored Procedures: An Overview</span></span>](http://www.sqlteam.com/item.asp?ItemID=563)
- [<span data-ttu-id="2cfc3-353">编写存储过程</span><span class="sxs-lookup"><span data-stu-id="2cfc3-353">Writing a Stored Procedure</span></span>](http://www.4guysfromrolla.com/webtech/111499-1.shtml)

## <a name="about-the-author"></a><span data-ttu-id="2cfc3-354">关于作者</span><span class="sxs-lookup"><span data-stu-id="2cfc3-354">About the Author</span></span>

<span data-ttu-id="2cfc3-355">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，创始人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已在使用 Microsoft Web 技术，自1998开始。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-355">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2cfc3-356">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-356">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2cfc3-357">他的最新书籍是，[*在24小时内，sam ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-357">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2cfc3-358">可以[mitchell@4GuysFromRolla.com访问。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-358">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="2cfc3-359">或通过他的博客，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-359">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2cfc3-360">特别感谢</span><span class="sxs-lookup"><span data-stu-id="2cfc3-360">Special Thanks To</span></span>

<span data-ttu-id="2cfc3-361">此教程系列由许多有用的审阅者查看。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-361">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2cfc3-362">本教程的主管审查人员是 Hilton Geisenow。</span><span class="sxs-lookup"><span data-stu-id="2cfc3-362">Lead reviewer for this tutorial was Hilton Geisenow.</span></span> <span data-ttu-id="2cfc3-363">想要查看我即将发布的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="2cfc3-363">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2cfc3-364">如果是这样，请在mitchell@4GuysFromRolla.com放置一行[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-364">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2cfc3-365">[上一页](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)
> [下一页](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2cfc3-365">[Previous](creating-stored-procedures-and-user-defined-functions-with-managed-code-cs.md)
[Next](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)</span></span>

---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
title: 使用类型化数据集的 Tableadapter 的现有存储过程（VB） |Microsoft Docs
author: rick-anderson
description: 在上一教程中，我们学习了如何使用 TableAdapter 向导来生成新的存储过程。 在本教程中，我们将了解如何将同一 TableAdapter 。
ms.author: riande
ms.date: 07/18/2007
ms.assetid: 2da25f6a-757e-4e7b-a812-1575288d8f7a
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb
msc.type: authoredcontent
ms.openlocfilehash: e35c3d6a98516a07f6119e6cb9dbeb99bc28fe33
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2020
ms.locfileid: "78427124"
---
# <a name="using-existing-stored-procedures-for-the-typed-datasets-tableadapters-vb"></a><span data-ttu-id="7044c-104">使用适用于类型化数据集的 TableAdapter 的现有存储过程 (VB)</span><span class="sxs-lookup"><span data-stu-id="7044c-104">Using Existing Stored Procedures for the Typed DataSet's TableAdapters (VB)</span></span>

<span data-ttu-id="7044c-105">作者： [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="7044c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="7044c-106">[下载代码](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip)或[下载 PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="7044c-106">[Download Code](https://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_68_VB.zip) or [Download PDF](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/datatutorial68vb1.pdf)</span></span>

> <span data-ttu-id="7044c-107">在上一教程中，我们学习了如何使用 TableAdapter 向导来生成新的存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-107">In the previous tutorial we learned how to use the TableAdapter Wizard to generate new stored procedures.</span></span> <span data-ttu-id="7044c-108">在本教程中，我们将了解相同的 TableAdapter 向导如何处理现有的存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-108">In this tutorial we learn how the same TableAdapter Wizard can work with existing stored procedures.</span></span> <span data-ttu-id="7044c-109">我们还将了解如何将新存储过程手动添加到数据库中。</span><span class="sxs-lookup"><span data-stu-id="7044c-109">We also learn how to manually add new stored procedures to our database.</span></span>

## <a name="introduction"></a><span data-ttu-id="7044c-110">简介</span><span class="sxs-lookup"><span data-stu-id="7044c-110">Introduction</span></span>

<span data-ttu-id="7044c-111">在[前面的教程](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)中，我们看到了如何将类型化数据集 tableadapter 配置为使用存储过程来访问数据，而不是即席 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="7044c-111">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we saw how the Typed DataSet s TableAdapters could be configured to use stored procedures to access data rather than ad-hoc SQL statements.</span></span> <span data-ttu-id="7044c-112">具体而言，我们已经检查了如何让 TableAdapter 向导自动创建这些存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-112">In particular, we examined how to have the TableAdapter wizard automatically create these stored procedures.</span></span> <span data-ttu-id="7044c-113">将旧应用程序迁移到 ASP.NET 2.0 时，或围绕现有数据模型构建 ASP.NET 2.0 网站时，该数据库可能已包含我们所需的存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-113">When porting a legacy application to ASP.NET 2.0 or when building an ASP.NET 2.0 website around an existing data model, chances are that the database already contains the stored procedures we need.</span></span> <span data-ttu-id="7044c-114">或者，您可能更愿意手动或通过用于自动生成存储过程的 TableAdapter 向导以外的其他工具来创建存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-114">Alternatively, you may prefer to create your stored procedures by hand or through some tool other than the TableAdapter wizard that auto-generates your stored procedures.</span></span>

<span data-ttu-id="7044c-115">在本教程中，我们将介绍如何将 TableAdapter 配置为使用现有的存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-115">In this tutorial we will look at how to configure the TableAdapter to use existing stored procedures.</span></span> <span data-ttu-id="7044c-116">由于 Northwind 数据库只包含一小部分内置存储过程，因此，我们还将了解通过 Visual Studio 环境将新存储过程手动添加到数据库时所需的步骤。</span><span class="sxs-lookup"><span data-stu-id="7044c-116">Since the Northwind database only has a small set of built-in stored procedures, we will also look at the steps needed to manually add new stored procedures to the database through the Visual Studio environment.</span></span> <span data-ttu-id="7044c-117">让我们开始吧！</span><span class="sxs-lookup"><span data-stu-id="7044c-117">Let s get started!</span></span>

> [!NOTE]
> <span data-ttu-id="7044c-118">在[事务中包装数据库修改](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)教程中，我们向 TableAdapter 添加了一些方法，以支持事务（`BeginTransaction`、`CommitTransaction`等）。</span><span class="sxs-lookup"><span data-stu-id="7044c-118">In the [Wrapping Database Modifications within a Transaction](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorial we added methods to the TableAdapter to support transactions (`BeginTransaction`, `CommitTransaction`, and so on).</span></span> <span data-ttu-id="7044c-119">或者，可以完全在存储过程中管理事务，这无需修改数据访问层代码。</span><span class="sxs-lookup"><span data-stu-id="7044c-119">Alternatively, transactions can be managed entirely within a stored procedure, which requires no modifications to the Data Access Layer code.</span></span> <span data-ttu-id="7044c-120">在本教程中，我们将探讨用于在事务范围内执行存储过程语句的 T-sql 命令。</span><span class="sxs-lookup"><span data-stu-id="7044c-120">In this tutorial we'll explore the T-SQL commands used to execute a stored procedure s statements within the scope of a transaction.</span></span>

## <a name="step-1-adding-stored-procedures-to-the-northwind-database"></a><span data-ttu-id="7044c-121">步骤1：将存储过程添加到 Northwind 数据库</span><span class="sxs-lookup"><span data-stu-id="7044c-121">Step 1: Adding Stored Procedures to the Northwind Database</span></span>

<span data-ttu-id="7044c-122">使用 Visual Studio 可以轻松地向数据库添加新的存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-122">Visual Studio makes it easy to add new stored procedures to a database.</span></span> <span data-ttu-id="7044c-123">在 Northwind 数据库中添加一个新的存储过程，该存储过程将返回 `Products` 表中具有特定 `CategoryID` 值的所有列。</span><span class="sxs-lookup"><span data-stu-id="7044c-123">Let s add a new stored procedure to the Northwind database that returns all columns from the `Products` table for those that have a particular `CategoryID` value.</span></span> <span data-ttu-id="7044c-124">在 "服务器资源管理器" 窗口中，展开 Northwind 数据库，以便显示其文件夹-数据库关系图、表、视图等。</span><span class="sxs-lookup"><span data-stu-id="7044c-124">From the Server Explorer window, expand the Northwind database so that its folders - Database Diagrams, Tables, Views, and so forth - are displayed.</span></span> <span data-ttu-id="7044c-125">如前面的教程中所述，"存储过程" 文件夹包含数据库的现有存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-125">As we saw in the preceding tutorial, the Stored Procedures folder contains the database s existing stored procedures.</span></span> <span data-ttu-id="7044c-126">若要添加新的存储过程，只需右键单击 "存储过程" 文件夹，然后从上下文菜单中选择 "添加新存储过程" 选项。</span><span class="sxs-lookup"><span data-stu-id="7044c-126">To add a new stored procedure, simply right-click the Stored Procedures folder and choose the Add New Stored Procedure option from the context menu.</span></span>

<span data-ttu-id="7044c-127">[![右键单击 "存储过程" 文件夹并添加一个新的存储过程](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-127">[![Right-Click the Stored Procedures Folder and Add a New Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image2.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image1.png)</span></span>

<span data-ttu-id="7044c-128">**图 1**：右键单击 "存储过程" 文件夹并添加一个新的存储过程（[单击以查看完全大小的映像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-128">**Figure 1**: Right-Click the Stored Procedures Folder and Add a New Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image3.png))</span></span>

<span data-ttu-id="7044c-129">如图1所示，选择 "添加新存储过程" 选项将在 Visual Studio 中打开一个脚本窗口，其中包含创建存储过程所需的 SQL 脚本的大纲。</span><span class="sxs-lookup"><span data-stu-id="7044c-129">As Figure 1 shows, selecting the Add New Stored Procedure option opens a script window in Visual Studio with the outline of the SQL script needed to create the stored procedure.</span></span> <span data-ttu-id="7044c-130">我们的工作是增加此脚本并执行该脚本，此时将存储过程添加到数据库中。</span><span class="sxs-lookup"><span data-stu-id="7044c-130">It is our job to flesh out this script and execute it, at which point the stored procedure will be added to the database.</span></span>

<span data-ttu-id="7044c-131">输入以下脚本：</span><span class="sxs-lookup"><span data-stu-id="7044c-131">Enter the following script:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample1.sql)]

<span data-ttu-id="7044c-132">此脚本在执行时将向名为 `Products_SelectByCategoryID`的 Northwind 数据库添加一个新的存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-132">This script, when executed, will add a new stored procedure to the Northwind database named `Products_SelectByCategoryID`.</span></span> <span data-ttu-id="7044c-133">此存储过程接受一个输入参数（`@CategoryID``int`类型），并返回这些产品中具有匹配 `CategoryID` 值的所有字段。</span><span class="sxs-lookup"><span data-stu-id="7044c-133">This stored procedure accepts a single input parameter (`@CategoryID`, of type `int`) and it returns all of the fields for those products with a matching `CategoryID` value.</span></span>

<span data-ttu-id="7044c-134">若要执行此 `CREATE PROCEDURE` 脚本并将该存储过程添加到数据库，请单击工具栏中的 "保存" 图标，或按 Ctrl + S。</span><span class="sxs-lookup"><span data-stu-id="7044c-134">To execute this `CREATE PROCEDURE` script and add the stored procedure to the database, click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="7044c-135">完成此操作后，存储过程文件夹将刷新，并显示新创建的存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-135">After doing so, the Stored Procedures folder refreshes, showing the newly created stored procedure.</span></span> <span data-ttu-id="7044c-136">此外，此窗口中的脚本会将个很微妙从 `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` 更改为 `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`。</span><span class="sxs-lookup"><span data-stu-id="7044c-136">Also, the script in the window will change subtlety from `CREATE PROCEDURE dbo.Products_SelectProductByCategoryID` to `ALTER PROCEDURE` `dbo.Products_SelectProductByCategoryID`.</span></span> <span data-ttu-id="7044c-137">`CREATE PROCEDURE` 将新的存储过程添加到数据库，`ALTER PROCEDURE` 更新现有存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-137">`CREATE PROCEDURE` adds a new stored procedure to the database, while `ALTER PROCEDURE` updates an existing one.</span></span> <span data-ttu-id="7044c-138">由于脚本开始已更改为 `ALTER PROCEDURE`，因此更改存储过程输入参数或 SQL 语句并单击 "保存" 图标将用这些更改更新存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-138">Since the start of the script has changed to `ALTER PROCEDURE`, changing the stored procedures input parameters or SQL statements and clicking the Save icon will update the stored procedure with these changes.</span></span>

<span data-ttu-id="7044c-139">图2显示了 `Products_SelectByCategoryID` 存储过程保存后的 Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="7044c-139">Figure 2 shows Visual Studio after the `Products_SelectByCategoryID` stored procedure has been saved.</span></span>

<span data-ttu-id="7044c-140">[![存储过程 Products_SelectByCategoryID 已添加到数据库中](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-140">[![The Stored Procedure Products_SelectByCategoryID Has Been Added to the Database](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image5.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image4.png)</span></span>

<span data-ttu-id="7044c-141">**图 2**：存储过程 `Products_SelectByCategoryID` 已添加到数据库中（[单击查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-141">**Figure 2**: The Stored Procedure `Products_SelectByCategoryID` Has Been Added to the Database ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image6.png))</span></span>

## <a name="step-2-configuring-the-tableadapter-to-use-an-existing-stored-procedure"></a><span data-ttu-id="7044c-142">步骤2：配置 TableAdapter 以使用现有存储过程</span><span class="sxs-lookup"><span data-stu-id="7044c-142">Step 2: Configuring the TableAdapter to Use an Existing Stored Procedure</span></span>

<span data-ttu-id="7044c-143">`Products_SelectByCategoryID` 存储过程已添加到数据库中，我们可以将数据访问层配置为在调用它的方法之一时使用此存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-143">Now that the `Products_SelectByCategoryID` stored procedure has been added to the database, we can configure our Data Access Layer to use this stored procedure when one of its methods is invoked.</span></span> <span data-ttu-id="7044c-144">具体而言，我们会将 `GetProductsByCategoryID(<_i22_>categoryID)<!--_i22_-->` 方法添加到 `NorthwindWithSprocs` 类型化数据集中的 `ProductsTableAdapter`，该数据集调用我们刚刚创建的 `Products_SelectByCategoryID` 存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-144">In particular, we will add a `GetProductsByCategoryID(<_i22_>categoryID)<!--_i22_-->` method to the `ProductsTableAdapter` in the `NorthwindWithSprocs` Typed DataSet that calls the `Products_SelectByCategoryID` stored procedure we just created.</span></span>

<span data-ttu-id="7044c-145">首先打开 `NorthwindWithSprocs` 数据集。</span><span class="sxs-lookup"><span data-stu-id="7044c-145">Start by opening the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="7044c-146">右键单击 `ProductsTableAdapter`，然后选择 "添加查询" 以启动 "TableAdapter 查询配置向导"。</span><span class="sxs-lookup"><span data-stu-id="7044c-146">Right-click on the `ProductsTableAdapter` and choose Add Query to launch the TableAdapter Query Configuration wizard.</span></span> <span data-ttu-id="7044c-147">在[前面的教程](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)中，我们选择使用 TableAdapter 为我们创建一个新的存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-147">In the [preceding tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) we opted to have the TableAdapter create a new stored procedure for us.</span></span> <span data-ttu-id="7044c-148">但对于本教程，我们希望将新的 TableAdapter 方法连接到现有的 `Products_SelectByCategoryID` 存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-148">For this tutorial, however, we want to wire the new TableAdapter method to the existing `Products_SelectByCategoryID` stored procedure.</span></span> <span data-ttu-id="7044c-149">因此，请在向导的第一步中选择 "使用现有存储过程" 选项，然后单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="7044c-149">Therefore, choose the Use existing stored procedure option from the wizard s first step and then click Next.</span></span>

<span data-ttu-id="7044c-150">[![选择 "使用现有存储过程" 选项](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-150">[![Choose the Use existing stored procedure Option](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image8.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image7.png)</span></span>

<span data-ttu-id="7044c-151">**图 3**：选择 "使用现有存储过程" 选项（[单击以查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-151">**Figure 3**: Choose the Use existing stored procedure Option ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image9.png))</span></span>

<span data-ttu-id="7044c-152">以下屏幕提供了一个用数据库存储过程填充的下拉列表。</span><span class="sxs-lookup"><span data-stu-id="7044c-152">The following screen provides a drop-down list populated with the database s stored procedures.</span></span> <span data-ttu-id="7044c-153">选择存储过程将在左侧列出其输入参数，并在右侧列出返回的数据字段（如果有）。</span><span class="sxs-lookup"><span data-stu-id="7044c-153">Selecting a stored procedure lists its input parameters on the left and the data fields returned (if any) on the right.</span></span> <span data-ttu-id="7044c-154">从列表中选择 `Products_SelectByCategoryID` 存储过程，并单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="7044c-154">Choose the `Products_SelectByCategoryID` stored procedure from the list and click Next.</span></span>

<span data-ttu-id="7044c-155">[![选择 Products_SelectByCategoryID 存储过程](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-155">[![Pick the Products_SelectByCategoryID Stored Procedure](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image11.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image10.png)</span></span>

<span data-ttu-id="7044c-156">**图 4**：选择 `Products_SelectByCategoryID` 存储过程（[单击以查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-156">**Figure 4**: Pick the `Products_SelectByCategoryID` Stored Procedure ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image12.png))</span></span>

<span data-ttu-id="7044c-157">下一个屏幕会询问我们存储过程返回的数据类型，此处的答案决定了由 TableAdapter s 方法返回的类型。</span><span class="sxs-lookup"><span data-stu-id="7044c-157">The next screen asks us what kind of data is returned by the stored procedure and our answer here determines the type returned by the TableAdapter s method.</span></span> <span data-ttu-id="7044c-158">例如，如果我们指示返回表格数据，则该方法将返回使用存储过程返回的记录填充的 `ProductsDataTable` 实例。</span><span class="sxs-lookup"><span data-stu-id="7044c-158">For example, if we indicate that tabular data is returned, the method will return a `ProductsDataTable` instance populated with the records returned by the stored procedure.</span></span> <span data-ttu-id="7044c-159">与此相反，如果我们指出此存储过程返回单个值，则 TableAdapter 将返回一个 `Object`，该对象被分配到存储过程返回的第一个记录的第一列中的值。</span><span class="sxs-lookup"><span data-stu-id="7044c-159">In contrast, if we indicate that this stored procedure returns a single value the TableAdapter will return an `Object` that is assigned the value in the first column of the first record returned by the stored procedure.</span></span>

<span data-ttu-id="7044c-160">由于 `Products_SelectByCategoryID` 存储过程返回属于特定类别的所有产品，因此请选择第一个应答表格数据，并单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="7044c-160">Since the `Products_SelectByCategoryID` stored procedure returns all products that belong to a particular category, choose the first answer - Tabular data - and click Next.</span></span>

<span data-ttu-id="7044c-161">[![指示存储过程返回表格数据](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-161">[![Indicate that the Stored Procedure Returns Tabular Data](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image14.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image13.png)</span></span>

<span data-ttu-id="7044c-162">**图 5**：指示存储过程返回表格数据（[单击以查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-162">**Figure 5**: Indicate that the Stored Procedure Returns Tabular Data ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image15.png))</span></span>

<span data-ttu-id="7044c-163">剩下的就是指出要使用的方法模式，后跟这些方法的名称。</span><span class="sxs-lookup"><span data-stu-id="7044c-163">All that remains is to indicate what method patterns to use followed by the names for these methods.</span></span> <span data-ttu-id="7044c-164">保留 "填充 DataTable" 和 "返回 DataTable" 选项，但将方法重命名为 "`FillByCategoryID`" 和 "`GetProductsByCategoryID`"。</span><span class="sxs-lookup"><span data-stu-id="7044c-164">Leave both the Fill a DataTable and Return a DataTable options checked, but rename the methods to `FillByCategoryID` and `GetProductsByCategoryID`.</span></span> <span data-ttu-id="7044c-165">然后单击 "下一步" 以查看向导将执行的任务的摘要。</span><span class="sxs-lookup"><span data-stu-id="7044c-165">Then click Next to review a summary of the tasks the wizard will perform.</span></span> <span data-ttu-id="7044c-166">如果一切正常，请单击 "完成"。</span><span class="sxs-lookup"><span data-stu-id="7044c-166">If everything looks correct, click Finish.</span></span>

<span data-ttu-id="7044c-167">[![命名方法 FillByCategoryID 和 GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-167">[![Name the Methods FillByCategoryID and GetProductsByCategoryID](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image17.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image16.png)</span></span>

<span data-ttu-id="7044c-168">**图 6**： `FillByCategoryID` 和 `GetProductsByCategoryID` 命名方法（[单击以查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-168">**Figure 6**: Name the Methods `FillByCategoryID` and `GetProductsByCategoryID` ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image18.png))</span></span>

> [!NOTE]
> <span data-ttu-id="7044c-169">刚才创建的 TableAdapter 方法 `FillByCategoryID` 和 `GetProductsByCategoryID`需要 `Integer`类型的输入参数。</span><span class="sxs-lookup"><span data-stu-id="7044c-169">The TableAdapter methods we just created, `FillByCategoryID` and `GetProductsByCategoryID`, expect an input parameter of type `Integer`.</span></span> <span data-ttu-id="7044c-170">此输入参数值通过其 `@CategoryID` 参数传递到存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-170">This input parameter value is passed into the stored procedure via its `@CategoryID` parameter.</span></span> <span data-ttu-id="7044c-171">如果修改 `Products_SelectByCategory` 存储过程的参数，则还需要更新这些 TableAdapter 方法的参数。</span><span class="sxs-lookup"><span data-stu-id="7044c-171">If you modify the `Products_SelectByCategory` stored procedure s parameters, you'll need to also update the parameters for these TableAdapter methods.</span></span> <span data-ttu-id="7044c-172">如[前面的教程](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)中所述，可以通过以下两种方式之一完成此操作：通过手动添加或删除参数集合中的参数或通过重新运行 TableAdapter 向导来执行此操作。</span><span class="sxs-lookup"><span data-stu-id="7044c-172">As discussed in the [previous tutorial](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md), this can be done in one of two ways: by manually adding or removing parameters from the parameters collection or by rerunning the TableAdapter wizard.</span></span>

## <a name="step-3-adding-agetproductsbycategoryidcategoryidmethod-to-the-bll"></a><span data-ttu-id="7044c-173">步骤3：将`GetProductsByCategoryID(categoryID)`方法添加到 BLL</span><span class="sxs-lookup"><span data-stu-id="7044c-173">Step 3: Adding a`GetProductsByCategoryID(categoryID)`Method to the BLL</span></span>

<span data-ttu-id="7044c-174">`GetProductsByCategoryID` DAL 方法完成后，下一步就是在业务逻辑层中提供对此方法的访问。</span><span class="sxs-lookup"><span data-stu-id="7044c-174">With the `GetProductsByCategoryID` DAL method complete, the next step is to provide access to this method in the Business Logic Layer.</span></span> <span data-ttu-id="7044c-175">打开 `ProductsBLLWithSprocs` 类文件，并添加以下方法：</span><span class="sxs-lookup"><span data-stu-id="7044c-175">Open the `ProductsBLLWithSprocs` class file and add the following method:</span></span>

[!code-vb[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample2.vb)]

<span data-ttu-id="7044c-176">此 BLL 方法只返回从 `ProductsTableAdapter` s `GetProductsByCategoryID` 方法返回的 `ProductsDataTable`。</span><span class="sxs-lookup"><span data-stu-id="7044c-176">This BLL method simply returns the `ProductsDataTable` returned from the `ProductsTableAdapter` s `GetProductsByCategoryID` method.</span></span> <span data-ttu-id="7044c-177">`DataObjectMethodAttribute` 属性提供由 ObjectDataSource s 配置数据源向导使用的元数据。</span><span class="sxs-lookup"><span data-stu-id="7044c-177">The `DataObjectMethodAttribute` attribute provides metadata used by the ObjectDataSource s Configure Data Source wizard.</span></span> <span data-ttu-id="7044c-178">具体而言，此方法将出现在 "选择选项卡 s" 下拉列表中。</span><span class="sxs-lookup"><span data-stu-id="7044c-178">In particular, this method will appear in the SELECT tab s drop-down list.</span></span>

## <a name="step-4-displaying-products-by-category"></a><span data-ttu-id="7044c-179">步骤4：按类别显示产品</span><span class="sxs-lookup"><span data-stu-id="7044c-179">Step 4: Displaying Products by Category</span></span>

<span data-ttu-id="7044c-180">若要测试新添加的 `Products_SelectByCategoryID` 存储过程和相应的 DAL 和 BLL 方法，请创建包含 DropDownList 和 GridView 的 ASP.NET 页面。</span><span class="sxs-lookup"><span data-stu-id="7044c-180">To test the newly added `Products_SelectByCategoryID` stored procedure and the corresponding DAL and BLL methods, let s create an ASP.NET page that contains a DropDownList and a GridView.</span></span> <span data-ttu-id="7044c-181">DropDownList 将列出数据库中的所有类别，而 GridView 将显示属于所选类别的产品。</span><span class="sxs-lookup"><span data-stu-id="7044c-181">The DropDownList will list all of the categories in the database while the GridView will display the products belonging to the selected category.</span></span>

> [!NOTE]
> <span data-ttu-id="7044c-182">在前面的教程中，我们使用 DropDownLists 创建了 master/detail 接口。</span><span class="sxs-lookup"><span data-stu-id="7044c-182">We ve created master/detail interfaces using DropDownLists in previous tutorials.</span></span> <span data-ttu-id="7044c-183">若要深入了解如何实现此类主/详细信息报表，请参阅[使用 DropDownList 的大纲/详细信息筛选](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md)。</span><span class="sxs-lookup"><span data-stu-id="7044c-183">For a more in-depth look at implementing such a master/detail report, refer to the [Master/Detail Filtering With a DropDownList](../masterdetail/master-detail-filtering-with-a-dropdownlist-vb.md) tutorial.</span></span>

<span data-ttu-id="7044c-184">打开 `AdvancedDAL` 文件夹中的 "`ExistingSprocs.aspx`" 页，并将 "DropDownList" 从 "工具箱" 拖到设计器上。</span><span class="sxs-lookup"><span data-stu-id="7044c-184">Open the `ExistingSprocs.aspx` page in the `AdvancedDAL` folder and drag a DropDownList from the Toolbox onto the Designer.</span></span> <span data-ttu-id="7044c-185">将 DropDownList `ID` 属性设置为 "`Categories`"，并将其 `AutoPostBack` 属性设置为 "`True`"。</span><span class="sxs-lookup"><span data-stu-id="7044c-185">Set the DropDownList s `ID` property to `Categories` and its `AutoPostBack` property to `True`.</span></span> <span data-ttu-id="7044c-186">接下来，从其智能标记将 DropDownList 绑定到名为 `CategoriesDataSource`的新 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="7044c-186">Next, from its smart tag, bind the DropDownList to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="7044c-187">配置 ObjectDataSource，使其从 `CategoriesBLL` 类 `GetCategories` 方法检索其数据。</span><span class="sxs-lookup"><span data-stu-id="7044c-187">Configure the ObjectDataSource so that it retrieves its data from the `CategoriesBLL` class s `GetCategories` method.</span></span> <span data-ttu-id="7044c-188">将 "更新"、"插入" 和 "删除" 选项卡中的下拉列表设置为 "（无）"。</span><span class="sxs-lookup"><span data-stu-id="7044c-188">Set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>

<span data-ttu-id="7044c-189">[![从 CategoriesBLL 类 s GetCategories 方法检索数据](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-189">[![Retrieve Data from the CategoriesBLL Class s GetCategories Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image20.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image19.png)</span></span>

<span data-ttu-id="7044c-190">**图 7**：从 `CategoriesBLL` 类 `GetCategories` 方法检索数据（[单击以查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-190">**Figure 7**: Retrieve Data from the `CategoriesBLL` Class s `GetCategories` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image21.png))</span></span>

<span data-ttu-id="7044c-191">[![在 "更新"、"插入" 和 "删除" 选项卡中将下拉列表设置为 "（无）"](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-191">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image23.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image22.png)</span></span>

<span data-ttu-id="7044c-192">**图 8**：将 "更新"、"插入" 和 "删除" 选项卡中的下拉列表设置为 "（无）" （[单击查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-192">**Figure 8**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image24.png))</span></span>

<span data-ttu-id="7044c-193">完成 ObjectDataSource 向导后，将 DropDownList 配置为显示 `CategoryName` 数据字段，并使用 `CategoryID` 字段作为每个 `ListItem`的 `Value`。</span><span class="sxs-lookup"><span data-stu-id="7044c-193">After completing the ObjectDataSource wizard, configure the DropDownList to display the `CategoryName` data field and to use the `CategoryID` field as the `Value` for each `ListItem`.</span></span>

<span data-ttu-id="7044c-194">此时，DropDownList 和 ObjectDataSource 的声明性标记应类似于以下内容：</span><span class="sxs-lookup"><span data-stu-id="7044c-194">At this point, the DropDownList and ObjectDataSource s declarative markup should similar to the following:</span></span>

[!code-aspx[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample3.aspx)]

<span data-ttu-id="7044c-195">接下来，将一个 GridView 拖到设计器上，将其放在 DropDownList 下。</span><span class="sxs-lookup"><span data-stu-id="7044c-195">Next, drag a GridView onto the Designer, placing it beneath the DropDownList.</span></span> <span data-ttu-id="7044c-196">将 GridView `ID` 设置为 `ProductsByCategory`，并从其智能标记将其绑定到名为 `ProductsByCategoryDataSource`的新 ObjectDataSource。</span><span class="sxs-lookup"><span data-stu-id="7044c-196">Set the GridView s `ID` to `ProductsByCategory` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsByCategoryDataSource`.</span></span> <span data-ttu-id="7044c-197">将 `ProductsByCategoryDataSource` ObjectDataSource 配置为使用 `ProductsBLLWithSprocs` 类，使其能够使用 `GetProductsByCategoryID(categoryID)` 方法检索其数据。</span><span class="sxs-lookup"><span data-stu-id="7044c-197">Configure the `ProductsByCategoryDataSource` ObjectDataSource to use the `ProductsBLLWithSprocs` class, having it retrieve its data using the `GetProductsByCategoryID(categoryID)` method.</span></span> <span data-ttu-id="7044c-198">由于此 GridView 仅用于显示数据，因此请将 "更新"、"插入" 和 "删除" 选项卡中的下拉列表设置为 "（无）"，然后单击 "下一步"。</span><span class="sxs-lookup"><span data-stu-id="7044c-198">Since this GridView will only be used to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) and click Next.</span></span>

<span data-ttu-id="7044c-199">[![将 ObjectDataSource 配置为使用 ProductsBLLWithSprocs 类](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-199">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image26.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image25.png)</span></span>

<span data-ttu-id="7044c-200">**图 9**：将 ObjectDataSource 配置为使用 `ProductsBLLWithSprocs` 类（[单击以查看完全大小的映像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-200">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image27.png))</span></span>

<span data-ttu-id="7044c-201">[![从 GetProductsByCategoryID （类别 Id）方法检索数据](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-201">[![Retrieve Data from the GetProductsByCategoryID(categoryID) Method](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image29.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image28.png)</span></span>

<span data-ttu-id="7044c-202">**图 10**：从 `GetProductsByCategoryID(categoryID)` 方法检索数据（[单击以查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-202">**Figure 10**: Retrieve Data from the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image30.png))</span></span>

<span data-ttu-id="7044c-203">在 "选择" 选项卡中选择的方法需要参数，因此向导的最后一步会提示我们输入源参数。</span><span class="sxs-lookup"><span data-stu-id="7044c-203">The method chosen in the SELECT tab expects a parameter, so the final step of the wizard prompts us for the parameter s source.</span></span> <span data-ttu-id="7044c-204">设置要控制的 "参数源" 下拉列表，然后从 "ControlID" 下拉列表中选择 "`Categories`" 控件。</span><span class="sxs-lookup"><span data-stu-id="7044c-204">Set the Parameter source drop-down list to Control and choose the `Categories` control from the ControlID drop-down list.</span></span> <span data-ttu-id="7044c-205">单击“完成”按钮以完成向导。</span><span class="sxs-lookup"><span data-stu-id="7044c-205">Click Finish to complete the wizard.</span></span>

<span data-ttu-id="7044c-206">[![使用类别 DropDownList 作为类别 Id 参数的源](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-206">[![Use the Categories DropDownList as the Source of the categoryID Parameter](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image32.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image31.png)</span></span>

<span data-ttu-id="7044c-207">**图 11**：使用 `Categories` DropDownList 作为 `categoryID` 参数的源（[单击查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-207">**Figure 11**: Use the `Categories` DropDownList as the Source of the `categoryID` Parameter ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image33.png))</span></span>

<span data-ttu-id="7044c-208">完成 ObjectDataSource 向导后，Visual Studio 将为每个产品数据字段添加 BoundFields 和 CheckBoxField。</span><span class="sxs-lookup"><span data-stu-id="7044c-208">Upon completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for each of the product data fields.</span></span> <span data-ttu-id="7044c-209">您可以根据需要随意自定义这些字段。</span><span class="sxs-lookup"><span data-stu-id="7044c-209">Feel free to customize these fields as you see fit.</span></span>

<span data-ttu-id="7044c-210">通过浏览器访问此页。</span><span class="sxs-lookup"><span data-stu-id="7044c-210">Visit the page through a browser.</span></span> <span data-ttu-id="7044c-211">在访问该页面时，将选择 "饮料" 类别，并在网格中列出相应的产品。</span><span class="sxs-lookup"><span data-stu-id="7044c-211">When visiting the page the Beverages category is selected and the corresponding products listed in the grid.</span></span> <span data-ttu-id="7044c-212">如图12所示，将下拉列表更改为备用类别将导致回发，并使用新选定类别的产品重新加载网格。</span><span class="sxs-lookup"><span data-stu-id="7044c-212">Changing the drop-down list to an alternative category, as Figure 12 shows, causes a postback and reloads the grid with the products of the newly selected category.</span></span>

<span data-ttu-id="7044c-213">[显示 "生成" 类别中的产品 ![](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-213">[![The Products in the Produce Category are Displayed](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image35.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image34.png)</span></span>

<span data-ttu-id="7044c-214">**图 12**：显示 "生成" 类别中的产品（[单击以查看完全尺寸的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-214">**Figure 12**: The Products in the Produce Category are Displayed ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image36.png))</span></span>

## <a name="step-5-wrapping-a-stored-procedure-s-statements-within-the-scope-of-a-transaction"></a><span data-ttu-id="7044c-215">步骤5：在事务范围内包装存储过程语句</span><span class="sxs-lookup"><span data-stu-id="7044c-215">Step 5: Wrapping a Stored Procedure s Statements Within the Scope of a Transaction</span></span>

<span data-ttu-id="7044c-216">在[事务中包装数据库修改](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md)教程中，我们讨论了在事务范围内执行一系列数据库修改语句的方法。</span><span class="sxs-lookup"><span data-stu-id="7044c-216">In the [Wrapping Database Modifications within a Transaction](../working-with-batched-data/wrapping-database-modifications-within-a-transaction-vb.md) tutorial we discussed techniques for performing a series of database modification statements within the scope of a transaction.</span></span> <span data-ttu-id="7044c-217">回忆一下，在事务中执行的修改要么全部成功，要么全部失败，从而保证原子性。</span><span class="sxs-lookup"><span data-stu-id="7044c-217">Recall that the modifications performed under the umbrella of a transaction either all succeed or all fail, guaranteeing atomicity.</span></span> <span data-ttu-id="7044c-218">使用事务的方法包括：</span><span class="sxs-lookup"><span data-stu-id="7044c-218">Techniques for using transactions include:</span></span>

- <span data-ttu-id="7044c-219">使用 `System.Transactions` 命名空间中的类，</span><span class="sxs-lookup"><span data-stu-id="7044c-219">Using the classes in the `System.Transactions` namespace,</span></span>
- <span data-ttu-id="7044c-220">数据访问层使用 `SqlTransaction`等 ADO.NET 类，并</span><span class="sxs-lookup"><span data-stu-id="7044c-220">Having the Data Access Layer use ADO.NET classes like `SqlTransaction`, and</span></span>
- <span data-ttu-id="7044c-221">直接在存储过程中添加 T-sql transaction 命令</span><span class="sxs-lookup"><span data-stu-id="7044c-221">Adding the T-SQL transaction commands directly within the stored procedure</span></span>

<span data-ttu-id="7044c-222">*事务教程中的包装数据库修改*使用 DAL 中的 ADO.NET 类。</span><span class="sxs-lookup"><span data-stu-id="7044c-222">The *Wrapping Database Modifications within a Transaction* tutorial used the ADO.NET classes in the DAL.</span></span> <span data-ttu-id="7044c-223">本教程的其余部分将介绍如何使用存储过程中的 T-sql 命令来管理事务。</span><span class="sxs-lookup"><span data-stu-id="7044c-223">The remainder of this tutorial examines how to manage a transaction using T-SQL commands from within a stored procedure.</span></span>

<span data-ttu-id="7044c-224">用于手动启动、提交和回滚事务的三个关键 SQL 命令分别分别 `BEGIN TRANSACTION`、`COMMIT TRANSACTION`和 `ROLLBACK TRANSACTION`。</span><span class="sxs-lookup"><span data-stu-id="7044c-224">The three key SQL commands for manually starting, committing, and rolling back a transaction are `BEGIN TRANSACTION`, `COMMIT TRANSACTION`, and `ROLLBACK TRANSACTION`, respectively.</span></span> <span data-ttu-id="7044c-225">与 ADO.NET 方法一样，使用存储过程中的事务时，需要应用以下模式：</span><span class="sxs-lookup"><span data-stu-id="7044c-225">Like with the ADO.NET approach, when using transactions from within a stored procedure we need to apply the following pattern:</span></span>

1. <span data-ttu-id="7044c-226">指示事务的开始。</span><span class="sxs-lookup"><span data-stu-id="7044c-226">Indicate the start of a transaction.</span></span>
2. <span data-ttu-id="7044c-227">执行构成事务的 SQL 语句。</span><span class="sxs-lookup"><span data-stu-id="7044c-227">Execute the SQL statements that comprise the transaction.</span></span>
3. <span data-ttu-id="7044c-228">如果步骤2中的任何一个语句出错，则回滚事务。</span><span class="sxs-lookup"><span data-stu-id="7044c-228">If there is an error in any one of the statements from Step 2, rollback the transaction.</span></span>
4. <span data-ttu-id="7044c-229">如果步骤2中的所有语句都完成且没有错误，请提交该事务。</span><span class="sxs-lookup"><span data-stu-id="7044c-229">If all of the statements from Step 2 complete without error, commit the transaction.</span></span>

<span data-ttu-id="7044c-230">可使用以下模板在 T-sql 语法中实现此模式：</span><span class="sxs-lookup"><span data-stu-id="7044c-230">This pattern can be implemented in T-SQL syntax using the following template:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample4.sql)]

<span data-ttu-id="7044c-231">该模板首先定义一个 `TRY...CATCH` 块，即一个构造 SQL Server 2005 的新构造。</span><span class="sxs-lookup"><span data-stu-id="7044c-231">The template starts by defining a `TRY...CATCH` block, a construct new to SQL Server 2005.</span></span> <span data-ttu-id="7044c-232">与 Visual Basic 中 `Try...Catch` 块一样，SQL `TRY...CATCH` 块执行 `TRY` 块中的语句。</span><span class="sxs-lookup"><span data-stu-id="7044c-232">Like with `Try...Catch` blocks in Visual Basic, the SQL `TRY...CATCH` block executes the statements in the `TRY` block.</span></span> <span data-ttu-id="7044c-233">如果任何语句引发错误，控制将立即传输到 `CATCH` 块。</span><span class="sxs-lookup"><span data-stu-id="7044c-233">If any statement raises an error, control is immediately transferred to the `CATCH` block.</span></span>

<span data-ttu-id="7044c-234">如果在执行构成事务的 SQL 语句时没有错误，`COMMIT TRANSACTION` 语句将提交更改并完成该事务。</span><span class="sxs-lookup"><span data-stu-id="7044c-234">If there are no errors executing the SQL statements that makeup the transaction, the `COMMIT TRANSACTION` statement commits the changes and completes the transaction.</span></span> <span data-ttu-id="7044c-235">但是，如果其中一个语句导致错误，则 `CATCH` 块中的 `ROLLBACK TRANSACTION` 会将数据库恢复到事务开始之前的状态。</span><span class="sxs-lookup"><span data-stu-id="7044c-235">If, however, one of the statements results in an error, the `ROLLBACK TRANSACTION` in the `CATCH` block returns the database to its state prior to the start of the transaction.</span></span> <span data-ttu-id="7044c-236">该存储过程还使用[RAISERROR 命令](https://msdn.microsoft.com/library/ms178592.aspx)引发错误，这将导致应用程序中引发 `SqlException`。</span><span class="sxs-lookup"><span data-stu-id="7044c-236">The stored procedure also raises an error using the [RAISERROR command](https://msdn.microsoft.com/library/ms178592.aspx), which causes a `SqlException` to be raised in the application.</span></span>

> [!NOTE]
> <span data-ttu-id="7044c-237">由于 `TRY...CATCH` 块是 SQL Server 2005 的新手，因此，如果使用的是较旧版本的 Microsoft SQL Server，则上述模板将不起作用。</span><span class="sxs-lookup"><span data-stu-id="7044c-237">Since the `TRY...CATCH` block is new to SQL Server 2005, the above template will not work if you are using older versions of Microsoft SQL Server.</span></span> <span data-ttu-id="7044c-238">如果使用的不是 SQL Server 2005，请参阅在将与其他版本的 SQL Server 一起使用的模板的[SQL Server 存储过程中管理事务](http://www.4guysfromrolla.com/webtech/080305-1.shtml)。</span><span class="sxs-lookup"><span data-stu-id="7044c-238">If you are not using SQL Server 2005, consult [Managing Transactions in SQL Server Stored Procedures](http://www.4guysfromrolla.com/webtech/080305-1.shtml) for a template that will work with other versions of SQL Server.</span></span>

<span data-ttu-id="7044c-239">让我们看一个具体的示例。</span><span class="sxs-lookup"><span data-stu-id="7044c-239">Let s look at a concrete example.</span></span> <span data-ttu-id="7044c-240">`Categories` 和 `Products` 表之间存在外键约束，这意味着 `Products` 表中的每个 `CategoryID` 字段必须映射到 `CategoryID` 表中的 `Categories` 值。</span><span class="sxs-lookup"><span data-stu-id="7044c-240">A foreign key constraint exists between the `Categories` and `Products` tables, meaning that each `CategoryID` field in the `Products` table must map to a `CategoryID` value in the `Categories` table.</span></span> <span data-ttu-id="7044c-241">任何违反此约束的操作（例如，尝试删除具有关联产品的类别）都将导致外键约束冲突。</span><span class="sxs-lookup"><span data-stu-id="7044c-241">Any action that would violate this constraint, such as attempting to delete a category that has associated products, results in a foreign key constraint violation.</span></span> <span data-ttu-id="7044c-242">若要验证这一点，请在使用二进制数据部分（`~/BinaryData/UpdatingAndDeleting.aspx`）重新访问更新和删除现有的二进制数据示例。</span><span class="sxs-lookup"><span data-stu-id="7044c-242">To verify this, revisit the Updating and Deleting Existing Binary Data example in the Working with Binary Data section (`~/BinaryData/UpdatingAndDeleting.aspx`).</span></span> <span data-ttu-id="7044c-243">此页将列出系统中的每个类别以及 "编辑" 和 "删除" 按钮（见图13），但如果您尝试删除某个类别，其中包含关联的产品（如饮料），则删除由于外键约束冲突而失败（请参阅图14）。</span><span class="sxs-lookup"><span data-stu-id="7044c-243">This page lists each category in the system along with Edit and Delete buttons (see Figure 13), but if you attempt to delete a category that has associated products - such as Beverages - the delete fails due to a foreign key constraint violation (see Figure 14).</span></span>

<span data-ttu-id="7044c-244">[使用 "编辑" 和 "删除" 按钮在 GridView 中显示每个类别 ![](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-244">[![Each Category is Displayed in a GridView with Edit and Delete Buttons](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image38.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image37.png)</span></span>

<span data-ttu-id="7044c-245">**图 13**：按 "编辑" 和 "删除" 按钮在 GridView 中显示每个类别（[单击以查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-245">**Figure 13**: Each Category is Displayed in a GridView with Edit and Delete Buttons ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image39.png))</span></span>

<span data-ttu-id="7044c-246">[![无法删除现有产品的类别](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="7044c-246">[![You Cannot Delete a Category that has Existing Products](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image41.png)](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image40.png)</span></span>

<span data-ttu-id="7044c-247">**图 14**：无法删除现有产品的类别（[单击以查看完全大小的图像](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png)）</span><span class="sxs-lookup"><span data-stu-id="7044c-247">**Figure 14**: You Cannot Delete a Category that has Existing Products ([Click to view full-size image](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image42.png))</span></span>

<span data-ttu-id="7044c-248">不过，假设我们想要删除类别，而不考虑它们是否有关联的产品。</span><span class="sxs-lookup"><span data-stu-id="7044c-248">Imagine, though, that we want to allow categories to be deleted regardless of whether they have associated products.</span></span> <span data-ttu-id="7044c-249">如果要删除包含产品的类别，假设我们还想要删除其现有产品（不过，另一个选项是将其产品 `CategoryID` 值设置为 `NULL`）。</span><span class="sxs-lookup"><span data-stu-id="7044c-249">Should a category with products be deleted, imagine that we want to also delete its existing products (although another option would be to simply set its products `CategoryID` values to `NULL`).</span></span> <span data-ttu-id="7044c-250">可以通过 foreign key 约束的级联规则实现此功能。</span><span class="sxs-lookup"><span data-stu-id="7044c-250">This functionality could be implemented through the cascade rules of the foreign key constraint.</span></span> <span data-ttu-id="7044c-251">另外，我们还可以创建接受 `@CategoryID` 输入参数的存储过程，并在调用它时显式删除所有关联的产品和指定的类别。</span><span class="sxs-lookup"><span data-stu-id="7044c-251">Alternatively, we could create a stored procedure that accepts a `@CategoryID` input parameter and, when invoked, explicitly deletes all of the associated products and then the specified category.</span></span>

<span data-ttu-id="7044c-252">此类存储过程的第一次尝试可能如下所示：</span><span class="sxs-lookup"><span data-stu-id="7044c-252">Our first attempt at such a stored procedure might look like the following:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample5.sql)]

<span data-ttu-id="7044c-253">虽然这将会明确删除关联的产品和类别，但它不会在事务的涵盖下执行此操作。</span><span class="sxs-lookup"><span data-stu-id="7044c-253">While this will definitely delete the associated products and category, it does not do so under the umbrella of a transaction.</span></span> <span data-ttu-id="7044c-254">假设 `Categories` 上有一些其他 foreign key 约束禁止删除特定 `@CategoryID` 值。</span><span class="sxs-lookup"><span data-stu-id="7044c-254">Imagine that there is some other foreign key constraint on `Categories` that would prohibit the deletion of a particular `@CategoryID` value.</span></span> <span data-ttu-id="7044c-255">问题在于，在这种情况下，将在尝试删除类别之前删除所有产品。</span><span class="sxs-lookup"><span data-stu-id="7044c-255">The problem is that in such a case all of the products will be deleted before we attempt to delete the category.</span></span> <span data-ttu-id="7044c-256">最终结果是，对于这种类别，此存储过程将删除其所有产品，而类别仍保留，因为它仍在其他某个表中具有相关记录。</span><span class="sxs-lookup"><span data-stu-id="7044c-256">The net result is that for such a category, this stored procedure would remove all of its products while the category remained since it still has related records in some other table.</span></span>

<span data-ttu-id="7044c-257">但是，如果存储过程已包装在事务范围内，则会在 `Categories`删除失败时回滚到 `Products` 表的删除。</span><span class="sxs-lookup"><span data-stu-id="7044c-257">If the stored procedure were wrapped within the scope of a transaction, however, the deletes to the `Products` table would be rolled back in the face of a failed delete on `Categories`.</span></span> <span data-ttu-id="7044c-258">以下存储过程脚本使用事务来确保两个 `DELETE` 语句之间的原子性：</span><span class="sxs-lookup"><span data-stu-id="7044c-258">The following stored procedure script uses a transaction to assure atomicity between the two `DELETE` statements:</span></span>

[!code-sql[Main](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/samples/sample6.sql)]

<span data-ttu-id="7044c-259">请花点时间将 `Categories_Delete` 存储过程添加到 Northwind 数据库。</span><span class="sxs-lookup"><span data-stu-id="7044c-259">Take a moment to add the `Categories_Delete` stored procedure to the Northwind database.</span></span> <span data-ttu-id="7044c-260">有关将存储过程添加到数据库的说明，请参阅返回到步骤1。</span><span class="sxs-lookup"><span data-stu-id="7044c-260">Refer back to Step 1 for instructions on adding stored procedures to a database.</span></span>

## <a name="step-6-updating-thecategoriestableadapter"></a><span data-ttu-id="7044c-261">步骤6：更新`CategoriesTableAdapter`</span><span class="sxs-lookup"><span data-stu-id="7044c-261">Step 6: Updating the`CategoriesTableAdapter`</span></span>

<span data-ttu-id="7044c-262">虽然已将 `Categories_Delete` 存储过程添加到数据库中，但 DAL 当前配置为使用即席 SQL 语句执行删除操作。</span><span class="sxs-lookup"><span data-stu-id="7044c-262">While we ve added the `Categories_Delete` stored procedure to the database, the DAL is currently configured to use ad-hoc SQL statements to perform the delete.</span></span> <span data-ttu-id="7044c-263">我们需要更新 `CategoriesTableAdapter`，并将其指示为改用 `Categories_Delete` 存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-263">We need to update the `CategoriesTableAdapter` and instruct it to use the `Categories_Delete` stored procedure instead.</span></span>

> [!NOTE]
> <span data-ttu-id="7044c-264">在本教程的前面部分，我们使用的是 `NorthwindWithSprocs` 数据集。</span><span class="sxs-lookup"><span data-stu-id="7044c-264">Earlier in this tutorial we were working with the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="7044c-265">但该数据集仅有一个实体 `ProductsDataTable`，我们需要使用类别。</span><span class="sxs-lookup"><span data-stu-id="7044c-265">But that DataSet only has a single entity, `ProductsDataTable`, and we need to work with categories.</span></span> <span data-ttu-id="7044c-266">因此，在本教程的剩余部分中，我讨论了引用 `Northwind` 数据集的数据访问层，这是我们在[创建数据访问层](../introduction/creating-a-data-access-layer-vb.md)教程中的第一个创建的数据集。</span><span class="sxs-lookup"><span data-stu-id="7044c-266">Therefore, for the remainder of this tutorial when I talk about the Data Access Layer I m referring to the `Northwind` DataSet, the one that we first created in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial.</span></span>

<span data-ttu-id="7044c-267">打开 Northwind 数据集，选择 `CategoriesTableAdapter`，并中转到属性窗口。</span><span class="sxs-lookup"><span data-stu-id="7044c-267">Open the Northwind DataSet, select the `CategoriesTableAdapter`, and go to the Properties window.</span></span> <span data-ttu-id="7044c-268">属性窗口列出了 TableAdapter 使用的 `InsertCommand`、`UpdateCommand`、`DeleteCommand`和 `SelectCommand`，以及其名称和连接信息。</span><span class="sxs-lookup"><span data-stu-id="7044c-268">The Properties window lists the `InsertCommand`, `UpdateCommand`, `DeleteCommand`, and `SelectCommand` used by the TableAdapter, as well as its name and connection information.</span></span> <span data-ttu-id="7044c-269">展开 "`DeleteCommand`" 属性以查看其详细信息。</span><span class="sxs-lookup"><span data-stu-id="7044c-269">Expand the `DeleteCommand` property to see its details.</span></span> <span data-ttu-id="7044c-270">如图15所示，`DeleteCommand` s `CommandType` 属性设置为 Text，这指示它将 `CommandText` 属性中的文本作为即席 SQL 查询发送。</span><span class="sxs-lookup"><span data-stu-id="7044c-270">As Figure 15 shows, the `DeleteCommand` s `CommandType` property is set to Text, which instructs it to send the text in the `CommandText` property as an ad-hoc SQL query.</span></span>

![在设计器中选择 CategoriesTableAdapter，以在 "属性" 窗口中查看其属性。](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image43.png)

<span data-ttu-id="7044c-272">**图 15**：在设计器中选择 `CategoriesTableAdapter`，以在 "属性" 窗口中查看其属性</span><span class="sxs-lookup"><span data-stu-id="7044c-272">**Figure 15**: Select the `CategoriesTableAdapter` in the Designer to View Its Properties in the Properties Window</span></span>

<span data-ttu-id="7044c-273">若要更改这些设置，请在属性窗口中选择（DeleteCommand）文本，然后从下拉列表中选择 "（新建）"。</span><span class="sxs-lookup"><span data-stu-id="7044c-273">To change these settings, select the (DeleteCommand) text in the Properties window and choose (New) from the drop-down list.</span></span> <span data-ttu-id="7044c-274">这将清除 `CommandText`、`CommandType`和 `Parameters` 属性的设置。</span><span class="sxs-lookup"><span data-stu-id="7044c-274">This will clear out the settings for the `CommandText`, `CommandType`, and `Parameters` properties.</span></span> <span data-ttu-id="7044c-275">接下来，将 `CommandType` 属性设置为 `StoredProcedure`，然后键入 `CommandText` （`dbo.Categories_Delete`）的存储过程的名称。</span><span class="sxs-lookup"><span data-stu-id="7044c-275">Next, set the `CommandType` property to `StoredProcedure` and then type in the name of the stored procedure for the `CommandText` (`dbo.Categories_Delete`).</span></span> <span data-ttu-id="7044c-276">如果确保按此顺序输入属性-首先为 `CommandType`，然后 `CommandText`-Visual Studio 将自动填充参数集合。</span><span class="sxs-lookup"><span data-stu-id="7044c-276">If you make sure to enter the properties in this order - first the `CommandType` and then the `CommandText` - Visual Studio will automatically populate the Parameters collection.</span></span> <span data-ttu-id="7044c-277">如果未按此顺序输入这些属性，则必须通过 "参数集合编辑器" 手动添加参数。</span><span class="sxs-lookup"><span data-stu-id="7044c-277">If you do not enter these properties in this order, you will have to manually add the parameters through the Parameters Collection Editor.</span></span> <span data-ttu-id="7044c-278">在这两种情况下，在 "参数" 属性中单击省略号即可显示 "参数集合编辑器"，以验证是否进行了正确的参数设置更改（请参阅图16）。</span><span class="sxs-lookup"><span data-stu-id="7044c-278">In either case, it s prudent to click on the ellipses in the Parameters property to bring up the Parameters Collection Editor to verify that the correct parameter settings changes have been made (see Figure 16).</span></span> <span data-ttu-id="7044c-279">如果在对话框中看不到任何参数，请手动添加 `@CategoryID` 参数（不需要添加 `@RETURN_VALUE` 参数）。</span><span class="sxs-lookup"><span data-stu-id="7044c-279">If you do not see any parameters in the dialog box, add the `@CategoryID` parameter manually (you do not need to add the `@RETURN_VALUE` parameter).</span></span>

![确保参数设置正确](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb/_static/image44.png)

<span data-ttu-id="7044c-281">**图 16**：确保参数设置正确</span><span class="sxs-lookup"><span data-stu-id="7044c-281">**Figure 16**: Ensure That the Parameters Settings are Correct</span></span>

<span data-ttu-id="7044c-282">在对 DAL 进行更新后，删除类别将自动删除其所有关联的产品，并在事务的涵盖下执行此操作。</span><span class="sxs-lookup"><span data-stu-id="7044c-282">Once the DAL has been updated, deleting a category will automatically delete all of its associated products and do so under the umbrella of a transaction.</span></span> <span data-ttu-id="7044c-283">若要验证这一点，请返回到 "更新和删除现有的二进制数据" 页，然后单击其中一个类别的 "删除" 按钮。</span><span class="sxs-lookup"><span data-stu-id="7044c-283">To verify this, return to the Updating and Deleting Existing Binary Data page and click the Delete button for one of the categories.</span></span> <span data-ttu-id="7044c-284">只单击一次鼠标，就会删除类别及其所有关联的产品。</span><span class="sxs-lookup"><span data-stu-id="7044c-284">With one single click of the mouse, the category and all of its associated products will be deleted.</span></span>

> [!NOTE]
> <span data-ttu-id="7044c-285">在测试 `Categories_Delete` 存储过程之前，将删除多个产品以及所选的类别，因此，创建数据库的备份副本可能是明智的。</span><span class="sxs-lookup"><span data-stu-id="7044c-285">Before testing the `Categories_Delete` stored procedure, which will delete a number of products along with the selected category, it might be prudent to make a backup copy of your database.</span></span> <span data-ttu-id="7044c-286">如果在 `App_Data`中使用 `NORTHWND.MDF` 数据库，只需关闭 Visual Studio，并将 `App_Data` 中的 MDF 和 LDF 文件复制到其他文件夹。</span><span class="sxs-lookup"><span data-stu-id="7044c-286">If you are using the `NORTHWND.MDF` database in `App_Data`, simply close Visual Studio and copy the MDF and LDF files in `App_Data` to some other folder.</span></span> <span data-ttu-id="7044c-287">测试功能后，可以通过关闭 Visual Studio 并将 `App_Data` 中的当前 MDF 和 LDF 文件替换为备份副本来还原数据库。</span><span class="sxs-lookup"><span data-stu-id="7044c-287">After testing the functionality, you can restore the database by closing Visual Studio and replacing the current MDF and LDF files in `App_Data` with the backup copies.</span></span>

## <a name="summary"></a><span data-ttu-id="7044c-288">摘要</span><span class="sxs-lookup"><span data-stu-id="7044c-288">Summary</span></span>

<span data-ttu-id="7044c-289">尽管 TableAdapter 向导会自动生成存储过程，但有时我们可能已创建了此类存储过程，或者想要使用其他工具手动创建这些存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-289">While the TableAdapter s wizard will automatically generate stored procedures for us, there are times when we might already have such stored procedures created or want to create them manually or with other tools instead.</span></span> <span data-ttu-id="7044c-290">为了满足此类情况，还可以将 TableAdapter 配置为指向现有的存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-290">To accommodate such scenarios, the TableAdapter can also be configured to point to an existing stored procedure.</span></span> <span data-ttu-id="7044c-291">在本教程中，我们将介绍如何通过 Visual Studio 环境将存储过程手动添加到数据库，以及如何将 TableAdapter s 方法连接到这些存储过程。</span><span class="sxs-lookup"><span data-stu-id="7044c-291">In this tutorial we looked at how to manually add stored procedures to a database through the Visual Studio environment and how to wire the TableAdapter s methods to these stored procedures.</span></span> <span data-ttu-id="7044c-292">我们还在存储过程中检查了用于启动、提交和回滚事务的 T-sql 命令和脚本模式。</span><span class="sxs-lookup"><span data-stu-id="7044c-292">We also examined the T-SQL commands and script pattern used for starting, committing, and rolling back transactions from within a stored procedure.</span></span>

<span data-ttu-id="7044c-293">很高兴编程！</span><span class="sxs-lookup"><span data-stu-id="7044c-293">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="7044c-294">关于作者</span><span class="sxs-lookup"><span data-stu-id="7044c-294">About the Author</span></span>

<span data-ttu-id="7044c-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)，创始人的[4GuysFromRolla.com](http://www.4guysfromrolla.com)，已在使用 Microsoft Web 技术，自1998开始。</span><span class="sxs-lookup"><span data-stu-id="7044c-295">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="7044c-296">Scott 的工作方式是独立的顾问、培训师和撰稿人。</span><span class="sxs-lookup"><span data-stu-id="7044c-296">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="7044c-297">他的最新书籍是，[*在24小时内，sam ASP.NET 2.0*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="7044c-297">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="7044c-298">可以[mitchell@4GuysFromRolla.com访问。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7044c-298">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="7044c-299">或通过他的博客，可以在[http://ScottOnWriting.NET](http://ScottOnWriting.NET)找到。</span><span class="sxs-lookup"><span data-stu-id="7044c-299">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="7044c-300">特别感谢</span><span class="sxs-lookup"><span data-stu-id="7044c-300">Special Thanks To</span></span>

<span data-ttu-id="7044c-301">此教程系列由许多有用的审阅者查看。</span><span class="sxs-lookup"><span data-stu-id="7044c-301">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="7044c-302">本教程的主管评审者是 Hilton Geisenow、S ren Jacob Lauritsen 和 Teresa Murphy。</span><span class="sxs-lookup"><span data-stu-id="7044c-302">Lead reviewers for this tutorial were Hilton Geisenow, S ren Jacob Lauritsen, and Teresa Murphy.</span></span> <span data-ttu-id="7044c-303">想要查看我即将发布的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="7044c-303">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="7044c-304">如果是这样，请在mitchell@4GuysFromRolla.com放置一行[。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="7044c-304">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="7044c-305">[上一页](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
> [下一页](updating-the-tableadapter-to-use-joins-vb.md)</span><span class="sxs-lookup"><span data-stu-id="7044c-305">[Previous](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md)
[Next](updating-the-tableadapter-to-use-joins-vb.md)</span></span>

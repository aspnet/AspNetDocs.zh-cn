---
uid: web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs
title: 添加验证控件向编辑和插入界面 (C#) |Microsoft Docs
author: rick-anderson
description: 在本教程中我们将看到验证控件添加到 EditItemTemplate 和 InsertItemTemplate 数据 Web 控件，以便提供更是多么...
ms.author: riande
ms.date: 07/17/2006
ms.assetid: 2086cb1a-ab78-49ae-9c0b-03891c69776a
msc.legacyurl: /web-forms/overview/data-access/editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs
msc.type: authoredcontent
ms.openlocfilehash: 157a71c7b8a7b5e8e34c08957d0520dfb8da8db9
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/17/2019
ms.locfileid: "59391255"
---
# <a name="adding-validation-controls-to-the-editing-and-inserting-interfaces-c"></a><span data-ttu-id="04d21-103">向编辑和插入界面添加验证控件 (C#)</span><span class="sxs-lookup"><span data-stu-id="04d21-103">Adding Validation Controls to the Editing and Inserting Interfaces (C#)</span></span>

<span data-ttu-id="04d21-104">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="04d21-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="04d21-105">[下载示例应用程序](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_CS.exe)或[下载 PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/datatutorial19cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="04d21-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_19_CS.exe) or [Download PDF](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/datatutorial19cs1.pdf)</span></span>

> <span data-ttu-id="04d21-106">在本教程中我们将看到 EditItemTemplate 和 InsertItemTemplate 数据 Web 控件，以提供更能做到万无一失的用户界面添加验证控件是多么容易。</span><span class="sxs-lookup"><span data-stu-id="04d21-106">In this tutorial we'll see how easy it is to add validation controls to the EditItemTemplate and InsertItemTemplate of a data Web control, to provide a more foolproof user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="04d21-107">介绍</span><span class="sxs-lookup"><span data-stu-id="04d21-107">Introduction</span></span>

<span data-ttu-id="04d21-108">在示例中的 GridView 和 DetailsView 控件我们已经探讨了三个教程具有所有已 BoundFields 和组成 CheckBoxFields （字段类型绑定到数据源的 GridView 或 DetailsView 时由 Visual Studio 会自动添加在过去控制通过智能标记）。</span><span class="sxs-lookup"><span data-stu-id="04d21-108">The GridView and DetailsView controls in the examples we've explored over the past three tutorials have all been composed of BoundFields and CheckBoxFields (the field types automatically added by Visual Studio when binding a GridView or DetailsView to a data source control through the smart tag).</span></span> <span data-ttu-id="04d21-109">在编辑 GridView 或 DetailsView 中的行时，不是只读的这些 BoundFields 转换为文本框中，从该最终用户可以修改现有数据。</span><span class="sxs-lookup"><span data-stu-id="04d21-109">When editing a row in a GridView or DetailsView, those BoundFields that are not read-only are converted into textboxes, from which the end user can modify the existing data.</span></span> <span data-ttu-id="04d21-110">同样，当插入一个新记录到 DetailsView 控件，这些 BoundFields`InsertVisible`属性设置为`true`（默认值） 将呈现为空文本框中，用户可以在其中提供新记录的字段值。</span><span class="sxs-lookup"><span data-stu-id="04d21-110">Similarly, when inserting a new record into a DetailsView control, those BoundFields whose `InsertVisible` property is set to `true` (the default) are rendered as empty textboxes, into which the user can provide the new record's field values.</span></span> <span data-ttu-id="04d21-111">同样，CheckBoxFields，将禁用标准的、 只读的界面中，将转换为的编辑和插入界面中的已启用复选框。</span><span class="sxs-lookup"><span data-stu-id="04d21-111">Likewise, CheckBoxFields, which are disabled in the standard, read-only interface, are converted into enabled checkboxes in the editing and inserting interfaces.</span></span>

<span data-ttu-id="04d21-112">尽管默认编辑和插入界面 BoundField 和 CheckBoxField 可能很有帮助，接口中没有任何类型的验证。</span><span class="sxs-lookup"><span data-stu-id="04d21-112">While the default editing and inserting interfaces for the BoundField and CheckBoxField can be helpful, the interface lacks any sort of validation.</span></span> <span data-ttu-id="04d21-113">如果用户是犯了数据条目-例如省略`ProductName`字段或输入的值无效`UnitsInStock`（如-50) 将引发异常从应用程序体系结构的深度中。</span><span class="sxs-lookup"><span data-stu-id="04d21-113">If a user makes a data entry mistake - such as omitting the `ProductName` field or entering an invalid value for `UnitsInStock` (such as -50) an exception will be raised from within the depths of the application architecture.</span></span> <span data-ttu-id="04d21-114">虽然此异常可以正常处理中所示[前一篇教程](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)，理想情况下编辑或插入用户界面将包括验证控制，以防止用户输入此类中的无效数据第一个位置。</span><span class="sxs-lookup"><span data-stu-id="04d21-114">While this exception can be gracefully handled as demonstrated in the [previous tutorial](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md), ideally the editing or inserting user interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="04d21-115">为了提供自定义的编辑或插入的接口，我们需要使用 TemplateField 替换 BoundField 或 CheckBoxField。</span><span class="sxs-lookup"><span data-stu-id="04d21-115">In order to provide a customized editing or inserting interface, we need to replace the BoundField or CheckBoxField with a TemplateField.</span></span> <span data-ttu-id="04d21-116">Templatefield，所讨论的主题中[GridView 控件中使用 Templatefield](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md)并[DetailsView 控件中使用 Templatefield](../custom-formatting/using-templatefields-in-the-detailsview-control-cs.md)教程中，可以包含多个定义的模板将不同的行状态的接口。</span><span class="sxs-lookup"><span data-stu-id="04d21-116">TemplateFields, which were the topic of discussion in the [Using TemplateFields in the GridView Control](../custom-formatting/using-templatefields-in-the-gridview-control-cs.md) and [Using TemplateFields in the DetailsView Control](../custom-formatting/using-templatefields-in-the-detailsview-control-cs.md) tutorials, can consist of multiple templates defining separate interfaces for different row states.</span></span> <span data-ttu-id="04d21-117">TemplateField`ItemTemplate`而是用于呈现只读字段或 DetailsView 或 GridView 控件中的行时`EditItemTemplate`和`InsertItemTemplate`指示要用于编辑和插入模式下，分别使用的接口。</span><span class="sxs-lookup"><span data-stu-id="04d21-117">The TemplateField's `ItemTemplate` is used to when rendering read-only fields or rows in the DetailsView or GridView controls, whereas the `EditItemTemplate` and `InsertItemTemplate` indicate the interfaces to use for the editing and inserting modes, respectively.</span></span>

<span data-ttu-id="04d21-118">在本教程中我们将看到添加到 templatefield 进一步的验证控件是多么`EditItemTemplate`和`InsertItemTemplate`以提供更能做到万无一失的用户界面。</span><span class="sxs-lookup"><span data-stu-id="04d21-118">In this tutorial we'll see how easy it is to add validation controls to the TemplateField's `EditItemTemplate` and `InsertItemTemplate` to provide a more foolproof user interface.</span></span> <span data-ttu-id="04d21-119">具体而言，本教程会引导创建中的示例[检查与插入、 更新和删除的事件相关联](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)教程和增强的编辑和插入界面，可包括适当的验证。</span><span class="sxs-lookup"><span data-stu-id="04d21-119">Specifically, this tutorial takes the example created in the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial and augments the editing and inserting interfaces to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromexamining-the-events-associated-with-inserting-updating-and-deletingexamining-the-events-associated-with-inserting-updating-and-deleting-csmd"></a><span data-ttu-id="04d21-120">步骤 1：复制从示例[与插入、 更新和删除检查有关的事件相关联](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)</span><span class="sxs-lookup"><span data-stu-id="04d21-120">Step 1: Replicating the Example from[Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)</span></span>

<span data-ttu-id="04d21-121">在中[检查与插入、 更新和删除的事件相关联](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md)教程中，我们创建所列的名称和价格的可编辑的 GridView 中的产品页。</span><span class="sxs-lookup"><span data-stu-id="04d21-121">In the [Examining the Events Associated with Inserting, Updating, and Deleting](examining-the-events-associated-with-inserting-updating-and-deleting-cs.md) tutorial we created a page that listed the names and prices of the products in an editable GridView.</span></span> <span data-ttu-id="04d21-122">此外，页面包含 DetailsView 其`DefaultMode`属性设置为`Insert`，从而始终呈现在插入模式下。</span><span class="sxs-lookup"><span data-stu-id="04d21-122">Additionally, the page included a DetailsView whose `DefaultMode` property was set to `Insert`, thereby always rendering in insert mode.</span></span> <span data-ttu-id="04d21-123">此 DetailsView，从用户无法输入一个新的产品的名称和价格，单击插入，并将其添加到系统 （请参阅图 1）。</span><span class="sxs-lookup"><span data-stu-id="04d21-123">From this DetailsView, the user could enter the name and price for a new product, click Insert, and have it added to the system (see Figure 1).</span></span>


<span data-ttu-id="04d21-124">[![前面的示例，用户可以添加新产品并编辑现有的](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-124">[![The Previous Example Allows Users to Add New Products and Edit Existing Ones](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image2.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image1.png)</span></span>

<span data-ttu-id="04d21-125">**图 1**:上一示例允许用户以用于添加新的产品和编辑现有的 ([单击此项可查看原尺寸图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-125">**Figure 1**: The Previous Example Allows Users to Add New Products and Edit Existing Ones ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image3.png))</span></span>


<span data-ttu-id="04d21-126">对于本教程旨在扩充提供验证控件的 DetailsView 和 GridView。</span><span class="sxs-lookup"><span data-stu-id="04d21-126">Our goal for this tutorial is to augment the DetailsView and GridView to provide validation controls.</span></span> <span data-ttu-id="04d21-127">具体而言，我们验证逻辑将：</span><span class="sxs-lookup"><span data-stu-id="04d21-127">In particular, our validation logic will:</span></span>

- <span data-ttu-id="04d21-128">要求在插入或编辑产品时提供的名称</span><span class="sxs-lookup"><span data-stu-id="04d21-128">Require that the name be provided when inserting or editing a product</span></span>
- <span data-ttu-id="04d21-129">要求插入一条记录; 时提供的价格当编辑记录，我们仍需要价格，但编程逻辑将在 GridView 的`RowUpdating`从前面的教程中已存在的事件处理程序</span><span class="sxs-lookup"><span data-stu-id="04d21-129">Require that the price be provided when inserting a record; when editing a record, we will still require a price, but will use the programmatic logic in the GridView's `RowUpdating` event handler already present from the earlier tutorial</span></span>
- <span data-ttu-id="04d21-130">请确保输入的价格的值是一种有效的货币格式</span><span class="sxs-lookup"><span data-stu-id="04d21-130">Ensure that the value entered for the price is a valid currency format</span></span>

<span data-ttu-id="04d21-131">我们可以看看扩充一示例，包括验证之前，我们首先需要复制中的示例`DataModificationEvents.aspx`到本教程中的页的页`UIValidation.aspx`。</span><span class="sxs-lookup"><span data-stu-id="04d21-131">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `DataModificationEvents.aspx` page to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="04d21-132">若要完成此我们需要通过同时复制`DataModificationEvents.aspx`页面的声明性标记和其源代码。</span><span class="sxs-lookup"><span data-stu-id="04d21-132">To accomplish this we need to copy over both the `DataModificationEvents.aspx` page's declarative markup and its source code.</span></span> <span data-ttu-id="04d21-133">将复制的声明性标记，请执行以下步骤：</span><span class="sxs-lookup"><span data-stu-id="04d21-133">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="04d21-134">打开`DataModificationEvents.aspx`Visual Studio 中的页</span><span class="sxs-lookup"><span data-stu-id="04d21-134">Open the `DataModificationEvents.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="04d21-135">请转到页面的声明性标记 （在页面底部的源按钮单击）</span><span class="sxs-lookup"><span data-stu-id="04d21-135">Go to the page's declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="04d21-136">复制中的文本`<asp:Content>`和`</asp:Content>`标记 （3 至 44 行），图 2 中所示。</span><span class="sxs-lookup"><span data-stu-id="04d21-136">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 44), as shown in Figure 2.</span></span>


<span data-ttu-id="04d21-137">[![复制文本内&lt;asp: Content&gt;控件](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-137">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image5.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image4.png)</span></span>

<span data-ttu-id="04d21-138">**图 2**:复制文本内`<asp:Content>`控件 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-138">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image6.png))</span></span>


1. <span data-ttu-id="04d21-139">打开`UIValidation.aspx`页</span><span class="sxs-lookup"><span data-stu-id="04d21-139">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="04d21-140">请转到页面的声明性标记</span><span class="sxs-lookup"><span data-stu-id="04d21-140">Go to the page's declarative markup</span></span>
3. <span data-ttu-id="04d21-141">中的文本将粘贴`<asp:Content>`控件。</span><span class="sxs-lookup"><span data-stu-id="04d21-141">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="04d21-142">若要复制的源代码，请打开`DataModificationEvents.aspx.cs`页上，并将复制只是文本*内*`EditInsertDelete_DataModificationEvents`类。</span><span class="sxs-lookup"><span data-stu-id="04d21-142">To copy over the source code, open the `DataModificationEvents.aspx.cs` page and copy just the text *within* the `EditInsertDelete_DataModificationEvents` class.</span></span> <span data-ttu-id="04d21-143">将复制的三个事件处理程序 (`Page_Load`， `GridView1_RowUpdating`，并`ObjectDataSource1_Inserting`)，但不要**不**复制类声明或`using`语句。</span><span class="sxs-lookup"><span data-stu-id="04d21-143">Copy the three event handlers (`Page_Load`, `GridView1_RowUpdating`, and `ObjectDataSource1_Inserting`), but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="04d21-144">粘贴复制的文本*内*`EditInsertDelete_UIValidation`类中`UIValidation.aspx.cs`。</span><span class="sxs-lookup"><span data-stu-id="04d21-144">Paste the copied text *within* the `EditInsertDelete_UIValidation` class in `UIValidation.aspx.cs`.</span></span>

<span data-ttu-id="04d21-145">移动的内容和从代码转移后`DataModificationEvents.aspx`到`UIValidation.aspx`，花点时间来测试您的浏览器中的进度。</span><span class="sxs-lookup"><span data-stu-id="04d21-145">After moving over the content and code from `DataModificationEvents.aspx` to `UIValidation.aspx`, take a moment to test out your progress in a browser.</span></span> <span data-ttu-id="04d21-146">你应看到相同输出和体验每个这些两个页中相同的功能 (回头查看图 1 的屏幕截图的`DataModificationEvents.aspx`操作中)。</span><span class="sxs-lookup"><span data-stu-id="04d21-146">You should see the same output and experience the same functionality in each of these two pages (refer back to Figure 1 for a screen shot of `DataModificationEvents.aspx` in action).</span></span>

## <a name="step-2-converting-the-boundfields-into-templatefields"></a><span data-ttu-id="04d21-147">步骤 2：BoundFields 转换为 Templatefield</span><span class="sxs-lookup"><span data-stu-id="04d21-147">Step 2: Converting the BoundFields Into TemplateFields</span></span>

<span data-ttu-id="04d21-148">要向编辑和插入界面添加验证控件，需要将转换为 Templatefield BoundFields DetailsView 和 GridView 控件使用。</span><span class="sxs-lookup"><span data-stu-id="04d21-148">To add validation controls to the editing and inserting interfaces, the BoundFields used by the DetailsView and GridView controls need to be converted into TemplateFields.</span></span> <span data-ttu-id="04d21-149">若要实现此目的，单击编辑列和编辑字段中链接的 GridView 和 DetailsView 的智能标记，分别。</span><span class="sxs-lookup"><span data-stu-id="04d21-149">To achieve this, click on the Edit Columns and Edit Fields links in the GridView and DetailsView's smart tags, respectively.</span></span> <span data-ttu-id="04d21-150">选择每个 BoundFields 并单击"将此字段转换为 TemplateField"链接。</span><span class="sxs-lookup"><span data-stu-id="04d21-150">There, select each of the BoundFields and click the "Convert this field into a TemplateField" link.</span></span>


<span data-ttu-id="04d21-151">[![每个 DetailsView 的和 GridView 的 BoundFields 转换为 Templatefield](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-151">[![Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image8.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image7.png)</span></span>

<span data-ttu-id="04d21-152">**图 3**:转换每个 DetailsView 的和 GridView 的 BoundFields 到 Templatefield ([单击此项可查看原尺寸图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-152">**Figure 3**: Convert Each of the DetailsView's and GridView's BoundFields Into TemplateFields ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image9.png))</span></span>


<span data-ttu-id="04d21-153">BoundField 转换为 TemplateField 字段对话框通过生成 TemplateField 表现出作为 BoundField 本身相同的只读、 编辑以及插入接口。</span><span class="sxs-lookup"><span data-stu-id="04d21-153">Converting a BoundField into a TemplateField through the Fields dialog box generates a TemplateField that exhibits the same read-only, editing, and inserting interfaces as the BoundField itself.</span></span> <span data-ttu-id="04d21-154">以下标记显示的声明性语法`ProductName`字段中 DetailsView 转换转换为 TemplateField 后：</span><span class="sxs-lookup"><span data-stu-id="04d21-154">The following markup shows the declarative syntax for the `ProductName` field in the DetailsView after it has been converted into a TemplateField:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample1.aspx)]

<span data-ttu-id="04d21-155">请注意此 TemplateField 有三个模板自动创建`ItemTemplate`， `EditItemTemplate`，和`InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="04d21-155">Note that this TemplateField had three templates automatically created `ItemTemplate`, `EditItemTemplate`, and `InsertItemTemplate`.</span></span> <span data-ttu-id="04d21-156">`ItemTemplate`显示单个数据字段值 (`ProductName`) 使用标签 Web 控件，而`EditItemTemplate`并`InsertItemTemplate`将数据字段与文本框的相关联的文本框中 Web 控件中显示数据字段值`Text`使用双向数据绑定的属性。</span><span class="sxs-lookup"><span data-stu-id="04d21-156">The `ItemTemplate` displays a single data field value (`ProductName`) using a Label Web control, while the `EditItemTemplate` and `InsertItemTemplate` present the data field value in a TextBox Web control that associates the data field with the TextBox's `Text` property using two-way databinding.</span></span> <span data-ttu-id="04d21-157">由于我们只用于插入，在此页中使用 DetailsView，可能会删除`ItemTemplate`和`EditItemTemplate`从两个 Templatefield，尽管它们保留没有什么坏处。</span><span class="sxs-lookup"><span data-stu-id="04d21-157">Since we are only using the DetailsView in this page for inserting, you may remove the `ItemTemplate` and `EditItemTemplate` from the two TemplateFields, although there's no harm in leaving them.</span></span>

<span data-ttu-id="04d21-158">因为 GridView 不支持内置插入的 DetailsView 功能、 转换 GridView`ProductName`仅在结果字段转换为 TemplateField`ItemTemplate`和`EditItemTemplate`:</span><span class="sxs-lookup"><span data-stu-id="04d21-158">Since the GridView does not support the built-in inserting features of the DetailsView, converting the GridView's `ProductName` field into a TemplateField results in only an `ItemTemplate` and `EditItemTemplate`:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample2.aspx)]

<span data-ttu-id="04d21-159">通过单击"转换此字段转换为 TemplateField"，Visual Studio 创建的模板模拟的用户界面的已转换 BoundField TemplateField。</span><span class="sxs-lookup"><span data-stu-id="04d21-159">By clicking the "Convert this field into a TemplateField," Visual Studio has created a TemplateField whose templates mimic the user interface of the converted BoundField.</span></span> <span data-ttu-id="04d21-160">可以通过访问此页上的通过浏览器对此进行验证。</span><span class="sxs-lookup"><span data-stu-id="04d21-160">You can verify this by visiting this page through a browser.</span></span> <span data-ttu-id="04d21-161">您会发现的外观和行为的 Templatefield 是相同的体验 BoundFields 改为使用时。</span><span class="sxs-lookup"><span data-stu-id="04d21-161">You'll find that the appearance and behavior of the TemplateFields is identical to the experience when BoundFields were used instead.</span></span>

> [!NOTE]
> <span data-ttu-id="04d21-162">随意自定义中的模板，根据需要编辑的接口。</span><span class="sxs-lookup"><span data-stu-id="04d21-162">Feel free to customize the editing interfaces in the templates as needed.</span></span> <span data-ttu-id="04d21-163">例如，我们可能想要在文本框中`UnitPrice`Templatefield 呈现为较小文本框比`ProductName`文本框中。</span><span class="sxs-lookup"><span data-stu-id="04d21-163">For example, we may want to have the TextBox in the `UnitPrice` TemplateFields rendered as a smaller textbox than the `ProductName` textbox.</span></span> <span data-ttu-id="04d21-164">若要完成此操作可以设置文本框的`Columns`属性设置为适当的值或提供通过的绝对宽度`Width`属性。</span><span class="sxs-lookup"><span data-stu-id="04d21-164">To accomplish this you can set the TextBox's `Columns` property to an appropriate value or provide an absolute width via the `Width` property.</span></span> <span data-ttu-id="04d21-165">在下一教程中我们将了解如何通过 Web 控件的备用数据条目替换文本框中编辑界面完全自定义。</span><span class="sxs-lookup"><span data-stu-id="04d21-165">In the next tutorial we'll see how to completely customize the editing interface by replacing the TextBox with an alternate data entry Web control.</span></span>


## <a name="step-3-adding-the-validation-controls-to-the-gridviewsedititemtemplate-s"></a><span data-ttu-id="04d21-166">步骤 3：验证控件添加到 GridView 的`EditItemTemplate`s</span><span class="sxs-lookup"><span data-stu-id="04d21-166">Step 3: Adding the Validation Controls to the GridView's`EditItemTemplate` s</span></span>

<span data-ttu-id="04d21-167">在构造时数据输入窗体，务必用户输入所有必填的字段和所有提供的输入是合法的格式正确的值。</span><span class="sxs-lookup"><span data-stu-id="04d21-167">When constructing data entry forms, it is important that users enter any required fields and that all provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="04d21-168">若要帮助确保用户的输入有效，ASP.NET 提供了五个内置的验证控件旨在用于验证的输入控件的值：</span><span class="sxs-lookup"><span data-stu-id="04d21-168">To help ensure that a user's inputs are valid, ASP.NET provides five built-in validation controls that are designed to be used to validate the value of a single input control:</span></span>

- <span data-ttu-id="04d21-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx)可确保已提供一个值</span><span class="sxs-lookup"><span data-stu-id="04d21-169">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="04d21-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx)验证值与另一个 Web 控件值或常量的值，或确保值的格式是合法的指定的数据类型</span><span class="sxs-lookup"><span data-stu-id="04d21-170">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value's format is legal for a specified data type</span></span>
- <span data-ttu-id="04d21-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx)可确保一个值，值范围内</span><span class="sxs-lookup"><span data-stu-id="04d21-171">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="04d21-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx)来验证针对值[正则表达式](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="04d21-172">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="04d21-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx)验证值与自定义、 用户定义方法</span><span class="sxs-lookup"><span data-stu-id="04d21-173">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="04d21-174">有关这些五个控件的详细信息，请参阅[验证控件部分](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx)的[ASP.NET 快速入门教程](https://asp.net/QuickStart/aspnet/)。</span><span class="sxs-lookup"><span data-stu-id="04d21-174">For more information on these five controls, check out the [Validation Controls section](https://quickstarts.asp.net/quickstartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://asp.net/QuickStart/aspnet/).</span></span>

<span data-ttu-id="04d21-175">本教程中，我们将需要使用在 DetailsView 和 GridView 的 RequiredFieldValidator `ProductName` Templatefield 和 DetailsView 中的 RequiredFieldValidator `UnitPrice` TemplateField。</span><span class="sxs-lookup"><span data-stu-id="04d21-175">For our tutorial we'll need to use a RequiredFieldValidator in both the DetailsView and GridView's `ProductName` TemplateFields and a RequiredFieldValidator in the DetailsView's `UnitPrice` TemplateField.</span></span> <span data-ttu-id="04d21-176">此外，我们将需要为这两个控件的添加 CompareValidator `UnitPrice` Templatefield，以确保输入的价格的值大于或等于 0，并以一种有效的货币格式表示。</span><span class="sxs-lookup"><span data-stu-id="04d21-176">Furthermore, we'll need to add a CompareValidator to both controls' `UnitPrice` TemplateFields that ensures that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="04d21-177">尽管 ASP.NET 1.x 有这些相同的五个验证控件、 ASP.NET 2.0 增添了大量改进、 主两人是客户端侧脚本支持 Internet Explorer 以外的浏览器和分区到页面上的验证控件的功能验证组。</span><span class="sxs-lookup"><span data-stu-id="04d21-177">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers other than Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="04d21-178">有关 2.0 中新的验证控件功能的详细信息，请参阅[仔细分析 ASP.NET 2.0 中的验证控件](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx)。</span><span class="sxs-lookup"><span data-stu-id="04d21-178">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>


<span data-ttu-id="04d21-179">让我们首先，通过添加必要的验证控件到`EditItemTemplate`GridView 的 Templatefield。</span><span class="sxs-lookup"><span data-stu-id="04d21-179">Let's start by adding the necessary validation controls to the `EditItemTemplate` s in the GridView's TemplateFields.</span></span> <span data-ttu-id="04d21-180">若要完成此操作，单击 GridView 的智能标记，以显示模板编辑界面中的编辑模板链接。</span><span class="sxs-lookup"><span data-stu-id="04d21-180">To accomplish this, click on the Edit Templates link from the GridView's smart tag to bring up the template editing interface.</span></span> <span data-ttu-id="04d21-181">在这里，可以选择要从下拉列表中编辑的模板。</span><span class="sxs-lookup"><span data-stu-id="04d21-181">From here, you can select which template to edit from the drop-down list.</span></span> <span data-ttu-id="04d21-182">由于我们想要增强的编辑界面，因此我们需要验证将控件添加到`ProductName`并`UnitPrice`的`EditItemTemplate`s。</span><span class="sxs-lookup"><span data-stu-id="04d21-182">Since we want to augment the editing interface, we need to add validation controls to the `ProductName` and `UnitPrice`'s `EditItemTemplate` s.</span></span>


<span data-ttu-id="04d21-183">[![我们需要将产品名称和单价的 EditItemTemplates 扩展](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-183">[![We Need to Extend the ProductName and UnitPrice's EditItemTemplates](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image11.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image10.png)</span></span>

<span data-ttu-id="04d21-184">**图 4**:我们需要扩展`ProductName`并`UnitPrice`的`EditItemTemplate`s ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-184">**Figure 4**: We Need to Extend the `ProductName` and `UnitPrice`'s `EditItemTemplate` s ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image12.png))</span></span>


<span data-ttu-id="04d21-185">在中`ProductName` `EditItemTemplate`，通过从工具箱拖动到模板编辑界面中，添加一个 RequiredFieldValidator 放置后文本框中。</span><span class="sxs-lookup"><span data-stu-id="04d21-185">In the `ProductName` `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing after the TextBox.</span></span>


<span data-ttu-id="04d21-186">[![将一个 RequiredFieldValidator 添加到产品名称 EditItemTemplate](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-186">[![Add a RequiredFieldValidator to the ProductName EditItemTemplate](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image14.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image13.png)</span></span>

<span data-ttu-id="04d21-187">**图 5**:添加到一个 RequiredFieldValidator `ProductName` `EditItemTemplate` ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-187">**Figure 5**: Add a RequiredFieldValidator to the `ProductName` `EditItemTemplate` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image15.png))</span></span>


<span data-ttu-id="04d21-188">通过验证单个 ASP.NET Web 控件的输入处理的所有验证控件。</span><span class="sxs-lookup"><span data-stu-id="04d21-188">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="04d21-189">因此，我们需要指出我们刚添加的 RequiredFieldValidator 应验证中文本框`EditItemTemplate`; 这通过设置验证控件的实现[ControlToValidate 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx)到`ID`适当的 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="04d21-189">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the TextBox in the `EditItemTemplate`; this is accomplished by setting the validation control's [ControlToValidate property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control.</span></span> <span data-ttu-id="04d21-190">文本框中当前具有而不是无明显特征`ID`的`TextBox1`，但让我们将它更改为更合适。</span><span class="sxs-lookup"><span data-stu-id="04d21-190">The TextBox currently has the rather nondescript `ID` of `TextBox1`, but let's change it to something more appropriate.</span></span> <span data-ttu-id="04d21-191">单击该模板中的文本框，然后，从属性窗口中，更改`ID`从`TextBox1`到`EditProductName`。</span><span class="sxs-lookup"><span data-stu-id="04d21-191">Click on the TextBox in the template and then, from the Properties window, change the `ID` from `TextBox1` to `EditProductName`.</span></span>


<span data-ttu-id="04d21-192">[![将文本框的 ID 更改为 EditProductName](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-192">[![Change the TextBox's ID to EditProductName](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image17.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image16.png)</span></span>

<span data-ttu-id="04d21-193">**图 6**:更改文本框的`ID`到`EditProductName`([单击以查看实际尺寸的图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-193">**Figure 6**: Change the TextBox's `ID` to `EditProductName` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image18.png))</span></span>


<span data-ttu-id="04d21-194">接下来，设置 RequiredFieldValidator`ControlToValidate`属性设置为`EditProductName`。</span><span class="sxs-lookup"><span data-stu-id="04d21-194">Next, set the RequiredFieldValidator's `ControlToValidate` property to `EditProductName`.</span></span> <span data-ttu-id="04d21-195">最后，设置[ErrorMessage 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx)到"必须提供产品的名称"和[Text 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx)到"\*"。</span><span class="sxs-lookup"><span data-stu-id="04d21-195">Finally, set the [ErrorMessage property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to "You must provide the product's name" and the [Text property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to "\*".</span></span> <span data-ttu-id="04d21-196">`Text`属性值，如果提供，则如果验证失败的验证控件显示的文本。</span><span class="sxs-lookup"><span data-stu-id="04d21-196">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="04d21-197">`ErrorMessage`属性值，该值是必需的由 ValidationSummary 控件; 如果`Text`省略属性值，则`ErrorMessage`属性值也是无效的输入上的验证控件显示的文本。</span><span class="sxs-lookup"><span data-stu-id="04d21-197">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is also the text displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="04d21-198">在设置后 RequiredFieldValidator 这三个属性，您的屏幕应类似于图 7。</span><span class="sxs-lookup"><span data-stu-id="04d21-198">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 7.</span></span>


<span data-ttu-id="04d21-199">[![设置 RequiredFieldValidator 的 ControlToValidate、 错误消息和文本属性](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-199">[![Set the RequiredFieldValidator's ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image20.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image19.png)</span></span>

<span data-ttu-id="04d21-200">**图 7**:设置 RequiredFieldValidator `ControlToValidate`， `ErrorMessage`，并`Text`属性 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-200">**Figure 7**: Set the RequiredFieldValidator's `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image21.png))</span></span>


<span data-ttu-id="04d21-201">使用添加到 RequiredFieldValidator `ProductName` `EditItemTemplate`，则所有剩下是添加到需要验证`UnitPrice` `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="04d21-201">With the RequiredFieldValidator added to the `ProductName` `EditItemTemplate`, all that remains is to add the necessary validation to the `UnitPrice` `EditItemTemplate`.</span></span> <span data-ttu-id="04d21-202">由于我们已决定的此页上，为`UnitPrice`可选时，编辑记录，我们无需添加一个 RequiredFieldValidator。</span><span class="sxs-lookup"><span data-stu-id="04d21-202">Since we've decided that, for this page, the `UnitPrice` is optional when editing a record, we don't need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="04d21-203">我们执行操作，但是，需要添加 CompareValidator，确保`UnitPrice`，如果提供，作为一种货币格式正确，大于或等于 0。</span><span class="sxs-lookup"><span data-stu-id="04d21-203">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="04d21-204">我们将添加到 CompareValidator 之前`UnitPrice` `EditItemTemplate`，让我们首先将更改从 TextBox Web 控件的 ID`TextBox2`到`EditUnitPrice`。</span><span class="sxs-lookup"><span data-stu-id="04d21-204">Before we add the CompareValidator to the `UnitPrice` `EditItemTemplate`, let's first change the TextBox Web control's ID from `TextBox2` to `EditUnitPrice`.</span></span> <span data-ttu-id="04d21-205">此更改后，添加 CompareValidator，设置其`ControlToValidate`属性设置为`EditUnitPrice`，将其`ErrorMessage`属性设置为"价格必须大于或等于零，并且不能包含货币符号"并将其`Text`属性"\*".</span><span class="sxs-lookup"><span data-stu-id="04d21-205">After making this change, add the CompareValidator, setting its `ControlToValidate` property to `EditUnitPrice`, its `ErrorMessage` property to "The price must be greater than or equal to zero and cannot include the currency symbol", and its `Text` property to "\*".</span></span>

<span data-ttu-id="04d21-206">若要指示`UnitPrice`值必须是大于或等于 0，设置 CompareValidator[运算符属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx)到`GreaterThanEqual`，将其[ValueToCompare 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx)为"0"，并其[类型属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx)到`Currency`。</span><span class="sxs-lookup"><span data-stu-id="04d21-206">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator's [Operator property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [ValueToCompare property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to "0", and its [Type property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span> <span data-ttu-id="04d21-207">下面的声明性语法演示`UnitPrice`TemplateField 的`EditItemTemplate`在进行这些更改后：</span><span class="sxs-lookup"><span data-stu-id="04d21-207">The following declarative syntax shows the `UnitPrice` TemplateField's `EditItemTemplate` after these changes have been made:</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample3.aspx)]

<span data-ttu-id="04d21-208">进行这些更改后，在浏览器中打开的网页。</span><span class="sxs-lookup"><span data-stu-id="04d21-208">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="04d21-209">如果尝试省略名称或编辑产品时输入无效的价格值文本框旁边将出现一个星号。</span><span class="sxs-lookup"><span data-stu-id="04d21-209">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="04d21-210">如图 8 所示，包含货币符号，例如 19.95 美元的价格值将被视为无效。</span><span class="sxs-lookup"><span data-stu-id="04d21-210">As Figure 8 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="04d21-211">CompareValidator `Currency` `Type`允许数字分隔符 （如逗号或句点，具体取决于的区域性设置） 和前导加号或减号，但不*不*允许货币符号。</span><span class="sxs-lookup"><span data-stu-id="04d21-211">The CompareValidator's `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="04d21-212">此行为可能 perplex 用户编辑界面当前呈现`UnitPrice`使用货币格式。</span><span class="sxs-lookup"><span data-stu-id="04d21-212">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="04d21-213">回想一下，在*与插入、 更新和删除事件相关联*教程中，我们将设置 BoundField`DataFormatString`属性设置为`{0:c}`才能设置其格式为货币。</span><span class="sxs-lookup"><span data-stu-id="04d21-213">Recall that in the *Events Associated with Inserting, Updating, and Deleting* tutorial we set the BoundField's `DataFormatString` property to `{0:c}` in order to format it as a currency.</span></span> <span data-ttu-id="04d21-214">此外，我们将设置`ApplyFormatInEditMode`属性设为 true，从而导致 GridView 的编辑界面要设置格式`UnitPrice`作为一种货币。</span><span class="sxs-lookup"><span data-stu-id="04d21-214">Furthermore, we set the `ApplyFormatInEditMode` property to true, causing the GridView's editing interface to format the `UnitPrice` as a currency.</span></span> <span data-ttu-id="04d21-215">Visual Studio 将 BoundField 转换为 TemplateField，记下这些设置和格式的文本框`Text`属性设置为使用数据绑定语法货币`<%# Bind("UnitPrice", "{0:c}") %>`。</span><span class="sxs-lookup"><span data-stu-id="04d21-215">When converting the BoundField into a TemplateField, Visual Studio noted these settings and formatted the TextBox's `Text` property as a currency using the databinding syntax `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span>


<span data-ttu-id="04d21-216">[![使用无效的输入文本框旁边会显示一个星号](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-216">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image23.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image22.png)</span></span>

<span data-ttu-id="04d21-217">**图 8**:星号显示下一步使用无效的输入文本框 ([单击此项可查看原尺寸图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-217">**Figure 8**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image24.png))</span></span>


<span data-ttu-id="04d21-218">尽管验证可充当的是，用户必须手动编辑一个记录，这不是可接受时删除的货币符号。</span><span class="sxs-lookup"><span data-stu-id="04d21-218">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="04d21-219">若要解决此问题，我们有三个选项：</span><span class="sxs-lookup"><span data-stu-id="04d21-219">To remedy this, we have three options:</span></span>

1. <span data-ttu-id="04d21-220">配置`EditItemTemplate`，以便`UnitPrice`值未格式化为货币。</span><span class="sxs-lookup"><span data-stu-id="04d21-220">Configure the `EditItemTemplate` so that the `UnitPrice` value is not formatted as a currency.</span></span>
2. <span data-ttu-id="04d21-221">允许用户通过删除 CompareValidator 并将它替换为正确的格式正确的货币值检查 RegularExpressionValidator 输入货币符号。</span><span class="sxs-lookup"><span data-stu-id="04d21-221">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that properly checks for a properly formatted currency value.</span></span> <span data-ttu-id="04d21-222">此处的问题是，要验证的货币值的正则表达式不是漂亮，需要编写代码如果我们想要合并的区域性设置。</span><span class="sxs-lookup"><span data-stu-id="04d21-222">The problem here is that the regular expression to validate a currency value is not pretty and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="04d21-223">完全删除的验证控件和 GridView 中的服务器端验证逻辑依赖于`RowUpdating`事件处理程序。</span><span class="sxs-lookup"><span data-stu-id="04d21-223">Remove the validation control altogether and rely on server-side validation logic in the GridView's `RowUpdating` event handler.</span></span>

<span data-ttu-id="04d21-224">让我们使用选项 #1 对于此练习。</span><span class="sxs-lookup"><span data-stu-id="04d21-224">Let's go with option #1 for this exercise.</span></span> <span data-ttu-id="04d21-225">目前`UnitPrice`格式化为货币的文本框中的数据绑定表达式由于`EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`。</span><span class="sxs-lookup"><span data-stu-id="04d21-225">Currently the `UnitPrice` is formatted as a currency due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Bind("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="04d21-226">绑定将语句更改为`Bind("UnitPrice", "{0:n2}")`，其中将结果格式化为带两位数字的精度的数字。</span><span class="sxs-lookup"><span data-stu-id="04d21-226">Change the Bind statement to `Bind("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="04d21-227">这可以通过声明性语法直接或通过单击从编辑 DataBindings 链接`EditUnitPrice`文本框中的`UnitPrice`TemplateField 的`EditItemTemplate`（请参阅图 9 和 10）。</span><span class="sxs-lookup"><span data-stu-id="04d21-227">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `EditUnitPrice` TextBox in the `UnitPrice` TemplateField's `EditItemTemplate` (see Figures 9 and 10).</span></span>


<span data-ttu-id="04d21-228">[![单击文本框的编辑 DataBindings 链接](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-228">[![Click on the TextBox's Edit DataBindings link](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image26.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image25.png)</span></span>

<span data-ttu-id="04d21-229">**图 9**:单击文本框的编辑 DataBindings 链接 ([单击此项可查看原尺寸图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-229">**Figure 9**: Click on the TextBox's Edit DataBindings link ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image27.png))</span></span>


<span data-ttu-id="04d21-230">[![在绑定语句中指定的格式说明符](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-230">[![Specify the Format Specifier in the Bind Statement](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image29.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image28.png)</span></span>

<span data-ttu-id="04d21-231">**图 10**:指定在格式说明符`Bind`语句 ([单击以查看实际尺寸的图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-231">**Figure 10**: Specify the Format Specifier in the `Bind` Statement ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image30.png))</span></span>


<span data-ttu-id="04d21-232">进行此更改后，编辑界面中的格式化的价格包含组分隔符为逗号和句点作为小数分隔符，但哪儿货币符号。</span><span class="sxs-lookup"><span data-stu-id="04d21-232">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="04d21-233">`UnitPrice` `EditItemTemplate`不包括允许会随之发生回发和更新的逻辑，开始一个 RequiredFieldValidator。</span><span class="sxs-lookup"><span data-stu-id="04d21-233">The `UnitPrice` `EditItemTemplate` doesn't include a RequiredFieldValidator, allowing the postback to ensue and the updating logic to commence.</span></span> <span data-ttu-id="04d21-234">但是，`RowUpdating`事件处理程序从复制*检查与插入、 更新和删除的事件相关联*教程包括可确保以编程方式检查`UnitPrice`提供。</span><span class="sxs-lookup"><span data-stu-id="04d21-234">However, the `RowUpdating` event handler copied over from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial includes a programmatic check that ensures that the `UnitPrice` is provided.</span></span> <span data-ttu-id="04d21-235">随意删除此逻辑，请将其作为保留的或添加到一个 RequiredFieldValidator `UnitPrice` `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="04d21-235">Feel free to remove this logic, leave it in as-is, or add a RequiredFieldValidator to the `UnitPrice` `EditItemTemplate`.</span></span>


## <a name="step-4-summarizing-data-entry-problems"></a><span data-ttu-id="04d21-236">步骤 4：汇总数据输入问题</span><span class="sxs-lookup"><span data-stu-id="04d21-236">Step 4: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="04d21-237">ASP.NET 包括五个验证控件中，除了[ValidationSummary 控件](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx)，其中显示`ErrorMessage`s 检测到无效数据这些验证控件。</span><span class="sxs-lookup"><span data-stu-id="04d21-237">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="04d21-238">此摘要数据可以显示为文本在网页上或通过模式、 客户端的消息框。</span><span class="sxs-lookup"><span data-stu-id="04d21-238">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="04d21-239">让我们来改进此教程，包括汇总的任何验证问题的客户端的 messagebox。</span><span class="sxs-lookup"><span data-stu-id="04d21-239">Let's enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="04d21-240">若要实现此目的，请从工具箱拖到设计器拖动 ValidationSummary 控件。</span><span class="sxs-lookup"><span data-stu-id="04d21-240">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="04d21-241">验证控件的位置无关紧要，因为我们要将其配置为仅显示为一个消息框的摘要。</span><span class="sxs-lookup"><span data-stu-id="04d21-241">The location of the Validation control doesn't really matter, since we're going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="04d21-242">添加控件之后, 设置其[ShowSummary 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx)到`false`并将其[ShowMessageBox 属性](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx)到`true`。</span><span class="sxs-lookup"><span data-stu-id="04d21-242">After adding the control, set its [ShowSummary property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `false` and its [ShowMessageBox property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `true`.</span></span> <span data-ttu-id="04d21-243">添加此元素后，客户端的 messagebox 中总结了任何验证错误。</span><span class="sxs-lookup"><span data-stu-id="04d21-243">With this addition, any validation errors are summarized in a client-side messagebox.</span></span>


<span data-ttu-id="04d21-244">[![客户端的 Messagebox 中总结了验证错误](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-244">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image32.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image31.png)</span></span>

<span data-ttu-id="04d21-245">**图 11**:客户端的 Messagebox 中总结了验证错误 ([单击此项可查看原尺寸图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-245">**Figure 11**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image33.png))</span></span>


## <a name="step-5-adding-the-validation-controls-to-the-detailsviewsinsertitemtemplate"></a><span data-ttu-id="04d21-246">步骤 5：验证控件添加到 DetailsView`InsertItemTemplate`</span><span class="sxs-lookup"><span data-stu-id="04d21-246">Step 5: Adding the Validation Controls to the DetailsView's`InsertItemTemplate`</span></span>

<span data-ttu-id="04d21-247">所有的本教程中的就是向 DetailsView 插入界面添加验证控件。</span><span class="sxs-lookup"><span data-stu-id="04d21-247">All that remains for this tutorial is to add the validation controls to the DetailsView's inserting interface.</span></span> <span data-ttu-id="04d21-248">向 DetailsView 的模板添加验证控件的过程等同于检查在步骤 3; 的因此，我们将轻松处理通过此步骤中的任务。</span><span class="sxs-lookup"><span data-stu-id="04d21-248">The process of adding validation controls to the DetailsView's templates is identical to that examined in Step 3; therefore, we'll breeze through the task in this step.</span></span> <span data-ttu-id="04d21-249">正如我们做 gridview `EditItemTemplate` s，我建议您重命名`ID`s 从无明显特征文本框`TextBox1`和`TextBox2`到`InsertProductName`和`InsertUnitPrice`。</span><span class="sxs-lookup"><span data-stu-id="04d21-249">As we did with the GridView's `EditItemTemplate` s, I encourage you to rename the `ID` s of the TextBoxes from the nondescript `TextBox1` and `TextBox2` to `InsertProductName` and `InsertUnitPrice`.</span></span>

<span data-ttu-id="04d21-250">添加到一个 RequiredFieldValidator `ProductName` `InsertItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="04d21-250">Add a RequiredFieldValidator to the `ProductName` `InsertItemTemplate`.</span></span> <span data-ttu-id="04d21-251">设置`ControlToValidate`到`ID`在模板中，文本框的其`Text`属性设置为"\*"并将其`ErrorMessage`属性设置为"您必须提供产品的名称"。</span><span class="sxs-lookup"><span data-stu-id="04d21-251">Set the `ControlToValidate` to the `ID` of the TextBox in the template, its `Text` property to "\*" and its `ErrorMessage` property to "You must provide the product's name".</span></span>

<span data-ttu-id="04d21-252">由于`UnitPrice`是添加新记录时，所需的此页，添加到一个 RequiredFieldValidator `UnitPrice` `InsertItemTemplate`，并设置其`ControlToValidate`， `Text`，和`ErrorMessage`属性正确。</span><span class="sxs-lookup"><span data-stu-id="04d21-252">Since the `UnitPrice` is required for this page when adding a new record, add a RequiredFieldValidator to the `UnitPrice` `InsertItemTemplate`, setting its `ControlToValidate`, `Text`, and `ErrorMessage` properties appropriately.</span></span> <span data-ttu-id="04d21-253">最后，添加到 CompareValidator `UnitPrice` `InsertItemTemplate`以及配置其`ControlToValidate`， `Text`， `ErrorMessage`， `Type`， `Operator`，和`ValueToCompare`属性就像我们一样`UnitPrice`的 GridView 中的 CompareValidator `EditItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="04d21-253">Finally, add a CompareValidator to the `UnitPrice` `InsertItemTemplate` as well, configuring its `ControlToValidate`, `Text`, `ErrorMessage`, `Type`, `Operator`, and `ValueToCompare` properties just like we did with the `UnitPrice`'s CompareValidator in the GridView's `EditItemTemplate`.</span></span>

<span data-ttu-id="04d21-254">添加这些验证控件之后, 不能添加到系统中，如果未提供其名称或它的价格是负数或非法格式化新产品。</span><span class="sxs-lookup"><span data-stu-id="04d21-254">After adding these validation controls, a new product cannot be added to the system if its name is not supplied or if its price is a negative number or illegally formatted.</span></span>


<span data-ttu-id="04d21-255">[![验证逻辑已添加到 DetailsView 插入接口](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-255">[![Validation Logic has been Added to the DetailsView's Inserting Interface](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image35.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image34.png)</span></span>

<span data-ttu-id="04d21-256">**图 12**:验证逻辑已添加到 DetailsView 插入接口 ([单击此项可查看原尺寸图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-256">**Figure 12**: Validation Logic has been Added to the DetailsView's Inserting Interface ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image36.png))</span></span>


## <a name="step-6-partitioning-the-validation-controls-into-validation-groups"></a><span data-ttu-id="04d21-257">步骤 6：分区到验证组的验证控件</span><span class="sxs-lookup"><span data-stu-id="04d21-257">Step 6: Partitioning the Validation Controls Into Validation Groups</span></span>

<span data-ttu-id="04d21-258">我们的页面包含验证控件的两个逻辑上不同的集： 这些对应于 GridView 的编辑界面和那些与 DetailsView 相对应的插入接口。</span><span class="sxs-lookup"><span data-stu-id="04d21-258">Our page consists of two logically disparate sets of validation controls: those that correspond to the GridView's editing interface and those that correspond to the DetailsView's inserting interface.</span></span> <span data-ttu-id="04d21-259">默认情况下，为在回发发生时*所有*检查页上的验证控件。</span><span class="sxs-lookup"><span data-stu-id="04d21-259">By default, when a postback occurs *all* validation controls on the page are checked.</span></span> <span data-ttu-id="04d21-260">但是，编辑记录时我们不希望 DetailsView 插入接口的验证控件验证。</span><span class="sxs-lookup"><span data-stu-id="04d21-260">However, when editing a record we don't want the DetailsView's inserting interface's validation controls to validate.</span></span> <span data-ttu-id="04d21-261">图 13 说明了我们当前的难题，当用户编辑与完全合法值的产品，单击更新将导致验证错误，因为插入接口中的名称和价格值为空。</span><span class="sxs-lookup"><span data-stu-id="04d21-261">Figure 13 illustrates our current dilemma when a user is editing a product with perfectly legal values, clicking Update causes a validation error because the name and price values in the inserting interface are blank.</span></span>


<span data-ttu-id="04d21-262">[![正在更新产品用于引发导致插入接口的验证控件](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-262">[![Updating a Product Causes the Inserting Interface's Validation Controls to Fire](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image38.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image37.png)</span></span>

<span data-ttu-id="04d21-263">**图 13**:正在更新产品用于引发导致插入接口的验证控件 ([单击此项可查看原尺寸图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-263">**Figure 13**: Updating a Product Causes the Inserting Interface's Validation Controls to Fire ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image39.png))</span></span>


<span data-ttu-id="04d21-264">ASP.NET 2.0 中的验证控件可以分区为验证组通过其`ValidationGroup`属性。</span><span class="sxs-lookup"><span data-stu-id="04d21-264">The validation controls in ASP.NET 2.0 can be partitioned into validation groups through their `ValidationGroup` property.</span></span> <span data-ttu-id="04d21-265">若要将组中的验证控件的一组相关联，只需设置其`ValidationGroup`属性设置为相同的值。</span><span class="sxs-lookup"><span data-stu-id="04d21-265">To associate a set of validation controls in a group, simply set their `ValidationGroup` property to the same value.</span></span> <span data-ttu-id="04d21-266">对于本教程中，设置`ValidationGroup`GridView 的 Templatefield 到中的验证控件的属性`EditValidationControls`并`ValidationGroup`到 DetailsView Templatefield 属性`InsertValidationControls`。</span><span class="sxs-lookup"><span data-stu-id="04d21-266">For our tutorial, set the `ValidationGroup` properties of the validation controls in the GridView's TemplateFields to `EditValidationControls` and the `ValidationGroup` properties of the DetailsView's TemplateFields to `InsertValidationControls`.</span></span> <span data-ttu-id="04d21-267">这些更改可以在声明性标记中直接或通过属性窗口时使用设计器的编辑模板界面。</span><span class="sxs-lookup"><span data-stu-id="04d21-267">These changes can be done directly in the declarative markup or through the Properties window when using the Designer's edit template interface.</span></span>

<span data-ttu-id="04d21-268">除了验证控件、 按钮和按钮相关控件在 ASP.NET 2.0 中的还包含`ValidationGroup`属性。</span><span class="sxs-lookup"><span data-stu-id="04d21-268">In addition to the validation controls, the Button and Button-related controls in ASP.NET 2.0 also include a `ValidationGroup` property.</span></span> <span data-ttu-id="04d21-269">验证组的验证程序检查的有效性仅为在回发引起的具有相同的按钮`ValidationGroup`属性设置。</span><span class="sxs-lookup"><span data-stu-id="04d21-269">A validation group's validators are checked for validity only when a postback is induced by a Button that has the same `ValidationGroup` property setting.</span></span> <span data-ttu-id="04d21-270">例如，为了使 DetailsView 的插入按钮来触发`InsertValidationControls`验证组我们需要设置 CommandField`ValidationGroup`属性设置为`InsertValidationControls`（请参阅图 14）。</span><span class="sxs-lookup"><span data-stu-id="04d21-270">For example, in order for the DetailsView's Insert button to trigger the `InsertValidationControls` validation group we need to set the CommandField's `ValidationGroup` property to `InsertValidationControls` (see Figure 14).</span></span> <span data-ttu-id="04d21-271">此外，设置 GridView 的 CommandField 的`ValidationGroup`属性设置为`EditValidationControls`。</span><span class="sxs-lookup"><span data-stu-id="04d21-271">Additionally, set the GridView's CommandField's `ValidationGroup` property to `EditValidationControls`.</span></span>


<span data-ttu-id="04d21-272">[![集 DetailsView 的 InsertValidationControls CommandField 的 ValidationGroup 属性](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="04d21-272">[![Set the DetailsView's CommandField's ValidationGroup property to InsertValidationControls](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image41.png)](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image40.png)</span></span>

<span data-ttu-id="04d21-273">**图 14**:设置 DetailsView CommandField 的`ValidationGroup`属性设置为`InsertValidationControls`([单击以查看实际尺寸的图像](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="04d21-273">**Figure 14**: Set the DetailsView's CommandField's `ValidationGroup` property to `InsertValidationControls` ([Click to view full-size image](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/_static/image42.png))</span></span>


<span data-ttu-id="04d21-274">更改后，DetailsView 和 GridView 的 Templatefield 和命令应类似于下面：</span><span class="sxs-lookup"><span data-stu-id="04d21-274">After these changes, the DetailsView and GridView's TemplateFields and CommandFields should look similar to the following:</span></span>

<span data-ttu-id="04d21-275">DetailsView Templatefield 和 CommandField</span><span class="sxs-lookup"><span data-stu-id="04d21-275">The DetailsView's TemplateFields and CommandField</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample4.aspx)]

<span data-ttu-id="04d21-276">GridView CommandField 和 Templatefield</span><span class="sxs-lookup"><span data-stu-id="04d21-276">The GridView's CommandField and TemplateFields</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample5.aspx)]

<span data-ttu-id="04d21-277">现在编辑特定的验证控件激发仅在单击 GridView 的更新按钮时和特定于插入的验证控件即发即仅当单击 DetailsView 的插入按钮时，解决图 13 的突出显示了此问题时。</span><span class="sxs-lookup"><span data-stu-id="04d21-277">At this point the edit-specific validation controls fire only when the GridView's Update button is clicked and the insert-specific validation controls fire only when the DetailsView's Insert button is clicked, resolving the problem highlighted by Figure 13.</span></span> <span data-ttu-id="04d21-278">但是，进行此更改后我们 ValidationSummary 控件不再显示在输入无效数据时。</span><span class="sxs-lookup"><span data-stu-id="04d21-278">However, with this change our ValidationSummary control no longer displays when entering invalid data.</span></span> <span data-ttu-id="04d21-279">ValidationSummary 控件还包含`ValidationGroup`属性并仅显示这些验证控件在其验证组的摘要信息。</span><span class="sxs-lookup"><span data-stu-id="04d21-279">The ValidationSummary control also contains a `ValidationGroup` property and only shows summary information for those validation controls in its validation group.</span></span> <span data-ttu-id="04d21-280">因此，我们需要在此页中，一个用于具有两个验证控件`InsertValidationControls`验证组，另一个用于`EditValidationControls`。</span><span class="sxs-lookup"><span data-stu-id="04d21-280">Therefore, we need to have two validation controls in this page, one for the `InsertValidationControls` validation group and one for `EditValidationControls`.</span></span>

[!code-aspx[Main](adding-validation-controls-to-the-editing-and-inserting-interfaces-cs/samples/sample6.aspx)]

<span data-ttu-id="04d21-281">添加此元素在本教程中已完成 ！</span><span class="sxs-lookup"><span data-stu-id="04d21-281">With this addition our tutorial is complete!</span></span>

## <a name="summary"></a><span data-ttu-id="04d21-282">总结</span><span class="sxs-lookup"><span data-stu-id="04d21-282">Summary</span></span>

<span data-ttu-id="04d21-283">虽然 BoundFields 可以提供同时插入和编辑接口，该接口不是可自定义的。</span><span class="sxs-lookup"><span data-stu-id="04d21-283">While BoundFields can provide both an inserting and editing interface, the interface is not customizable.</span></span> <span data-ttu-id="04d21-284">通常情况下，我们想要将验证控件添加到的编辑和插入界面以确保用户在法律格式输入所需的输入。</span><span class="sxs-lookup"><span data-stu-id="04d21-284">Commonly, we want to add validation controls to the editing and inserting interface to ensure that the user enters required inputs in a legal format.</span></span> <span data-ttu-id="04d21-285">若要实现此目的我们必须 BoundFields 转换为 Templatefield 并将验证控件添加到合适的模板。</span><span class="sxs-lookup"><span data-stu-id="04d21-285">To accomplish this we must convert the BoundFields into TemplateFields and add the validation controls to the appropriate template(s).</span></span> <span data-ttu-id="04d21-286">在本教程中我们扩展中的示例*检查与插入、 更新和删除的事件相关联*教程中，为这两个 DetailsView 添加验证控件的插入接口和 GridView编辑界面。</span><span class="sxs-lookup"><span data-stu-id="04d21-286">In this tutorial we extended the example from the *Examining the Events Associated with Inserting, Updating, and Deleting* tutorial, adding validation controls to both the DetailsView's inserting interface and the GridView's editing interface.</span></span> <span data-ttu-id="04d21-287">此外，我们了解了如何显示验证摘要信息使用 ValidationSummary 控件以及如何进行分区的页上的验证控件为不同的验证组。</span><span class="sxs-lookup"><span data-stu-id="04d21-287">Moreover, we saw how to display summary validation information using the ValidationSummary control and how to partition the validation controls on the page into distinct validation groups.</span></span>

<span data-ttu-id="04d21-288">正如我们看到在本教程中，Templatefield 允许进行扩充以包括验证控件的编辑和插入的接口。</span><span class="sxs-lookup"><span data-stu-id="04d21-288">As we saw in this tutorial, TemplateFields allow the editing and inserting interfaces to be augmented to include validation controls.</span></span> <span data-ttu-id="04d21-289">Templatefield 还可以扩展以包括其他输入的 Web 控件，使文本框将替换为更适合的 Web 控件。</span><span class="sxs-lookup"><span data-stu-id="04d21-289">TemplateFields can also be extended to include additional input Web controls, enabling the TextBox to be replaced by a more suitable Web control.</span></span> <span data-ttu-id="04d21-290">在我们的下一个教程将介绍如何使用数据绑定 DropDownList 控件，这是很理想，编辑外键时替换 TextBox 控件 (如`CategoryID`或`SupplierID`中`Products`表)。</span><span class="sxs-lookup"><span data-stu-id="04d21-290">In our next tutorial we'll see how to replace the TextBox control with a data-bound DropDownList control, which is ideal when editing a foreign key (such as `CategoryID` or `SupplierID` in the `Products` table).</span></span>

<span data-ttu-id="04d21-291">快乐编程 ！</span><span class="sxs-lookup"><span data-stu-id="04d21-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="04d21-292">关于作者</span><span class="sxs-lookup"><span data-stu-id="04d21-292">About the Author</span></span>

<span data-ttu-id="04d21-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)的七个部 asp/ASP.NET 书籍并创办了作者[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年以来一直致力于 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="04d21-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="04d21-294">Scott 是独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="04d21-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="04d21-295">他最新著作是[ *Sams Teach 自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="04d21-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="04d21-296">他可以到达[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="04d21-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="04d21-297">或通过他的博客，其中，请参阅[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="04d21-297">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="04d21-298">特别感谢</span><span class="sxs-lookup"><span data-stu-id="04d21-298">Special Thanks To</span></span>

<span data-ttu-id="04d21-299">很多有用的审阅者已评审本系列教程。</span><span class="sxs-lookup"><span data-stu-id="04d21-299">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="04d21-300">本教程中的潜在顾客审阅者是 Liz Shulok 和 Zack Jones。</span><span class="sxs-lookup"><span data-stu-id="04d21-300">Lead reviewers for this tutorial were Liz Shulok and Zack Jones.</span></span> <span data-ttu-id="04d21-301">是否有兴趣查看我即将推出的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="04d21-301">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="04d21-302">如果是这样，给我在行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="04d21-302">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="04d21-303">[上一页](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)
> [下一页](customizing-the-data-modification-interface-cs.md)</span><span class="sxs-lookup"><span data-stu-id="04d21-303">[Previous](handling-bll-and-dal-level-exceptions-in-an-asp-net-page-cs.md)
[Next](customizing-the-data-modification-interface-cs.md)</span></span>

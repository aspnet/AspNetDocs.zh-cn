---
uid: web-forms/overview/data-access/custom-formatting/using-templatefields-in-the-detailsview-control-cs
title: 在 DetailsView 控件 (C#) 中使用 Templatefield |Microsoft Docs
author: rick-anderson
description: 使用 GridView 提供的相同 Templatefield 功能，还提供与 DetailsView 控件。 在本教程中我们将显示一个产品...
ms.author: riande
ms.date: 03/31/2010
ms.assetid: 83efb21f-b231-446e-9356-f4c6cbcc6713
msc.legacyurl: /web-forms/overview/data-access/custom-formatting/using-templatefields-in-the-detailsview-control-cs
msc.type: authoredcontent
ms.openlocfilehash: 47c486737a3320bea631605621baac54dc6d257a
ms.sourcegitcommit: 24b1f6decbb17bb22a45166e5fdb0845c65af498
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/01/2019
ms.locfileid: "57045704"
---
<a name="using-templatefields-in-the-detailsview-control-c"></a><span data-ttu-id="cc040-104">在 DetailsView 控件中使用 TemplateField (C#)</span><span class="sxs-lookup"><span data-stu-id="cc040-104">Using TemplateFields in the DetailsView Control (C#)</span></span>
====================
<span data-ttu-id="cc040-105">通过[Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="cc040-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="cc040-106">[下载示例应用程序](http://download.microsoft.com/download/9/6/9/969e5c94-dfb6-4e47-9570-d6d9e704c3c1/ASPNET_Data_Tutorial_13_CS.exe)或[下载 PDF](using-templatefields-in-the-detailsview-control-cs/_static/datatutorial13cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="cc040-106">[Download Sample App](http://download.microsoft.com/download/9/6/9/969e5c94-dfb6-4e47-9570-d6d9e704c3c1/ASPNET_Data_Tutorial_13_CS.exe) or [Download PDF](using-templatefields-in-the-detailsview-control-cs/_static/datatutorial13cs1.pdf)</span></span>

> <span data-ttu-id="cc040-107">使用 GridView 提供的相同 Templatefield 功能，还提供与 DetailsView 控件。</span><span class="sxs-lookup"><span data-stu-id="cc040-107">The same TemplateFields capabilities available with the GridView are also available with the DetailsView control.</span></span> <span data-ttu-id="cc040-108">在本教程中我们将使用包含 Templatefield DetailsView 一次显示一个产品。</span><span class="sxs-lookup"><span data-stu-id="cc040-108">In this tutorial we'll display one product at a time using a DetailsView containing TemplateFields.</span></span>


## <a name="introduction"></a><span data-ttu-id="cc040-109">介绍</span><span class="sxs-lookup"><span data-stu-id="cc040-109">Introduction</span></span>

<span data-ttu-id="cc040-110">Templatefield 进一步提供了比 BoundField、 CheckBoxField、 HyperLinkField 和其他数据字段控件更高程度的灵活地呈现数据。</span><span class="sxs-lookup"><span data-stu-id="cc040-110">The TemplateField offers a higher degree of flexibility in rendering data than the BoundField, CheckBoxField, HyperLinkField, and other data field controls.</span></span> <span data-ttu-id="cc040-111">在中[前一篇教程](using-templatefields-in-the-gridview-control-cs.md)我们了解了在 GridView 中使用 templatefield 进一步：</span><span class="sxs-lookup"><span data-stu-id="cc040-111">In the [previous tutorial](using-templatefields-in-the-gridview-control-cs.md) we looked at using the TemplateField in a GridView to:</span></span>

- <span data-ttu-id="cc040-112">在一列中显示多个数据字段值。</span><span class="sxs-lookup"><span data-stu-id="cc040-112">Display multiple data field values in one column.</span></span> <span data-ttu-id="cc040-113">具体而言，这两`FirstName`和`LastName`字段已合并为一个 GridView 列。</span><span class="sxs-lookup"><span data-stu-id="cc040-113">Specifically, both the `FirstName` and `LastName` fields were combined into one GridView column.</span></span>
- <span data-ttu-id="cc040-114">使用备用的 Web 控件表示数据字段值。</span><span class="sxs-lookup"><span data-stu-id="cc040-114">Use an alternate Web control to express a data field value.</span></span> <span data-ttu-id="cc040-115">我们已了解如何显示`HiredDate`值使用日历控件。</span><span class="sxs-lookup"><span data-stu-id="cc040-115">We saw how to show the `HiredDate` value using a Calendar control.</span></span>
- <span data-ttu-id="cc040-116">显示基于对基础数据的状态信息。</span><span class="sxs-lookup"><span data-stu-id="cc040-116">Show status information based on the underlying data.</span></span> <span data-ttu-id="cc040-117">虽然`Employees`表不包含的列，返回的员工已在该作业的天数，我们能够在 GridView 的示例中使用 templatefield 进一步和格式设置方法与前面的教程中显示此类信息。</span><span class="sxs-lookup"><span data-stu-id="cc040-117">While the `Employees` table does not contain a column that returns the number of days an employee has been on the job, we were able to display such information in the GridView example in the previous tutorial with the use of a TemplateField and formatting method.</span></span>

<span data-ttu-id="cc040-118">使用 GridView 提供的相同 Templatefield 功能，还提供与 DetailsView 控件。</span><span class="sxs-lookup"><span data-stu-id="cc040-118">The same TemplateFields capabilities available with the GridView are also available with the DetailsView control.</span></span> <span data-ttu-id="cc040-119">在本教程中我们将使用包含两个 Templatefield DetailsView 一次显示一个产品。</span><span class="sxs-lookup"><span data-stu-id="cc040-119">In this tutorial we'll display one product at a time using a DetailsView that contains two TemplateFields.</span></span> <span data-ttu-id="cc040-120">将合并第一个 TemplateField `UnitPrice`， `UnitsInStock`，和`UnitsOnOrder`到 DetailsView 一行的数据字段。</span><span class="sxs-lookup"><span data-stu-id="cc040-120">The first TemplateField will combine the `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` data fields into one DetailsView row.</span></span> <span data-ttu-id="cc040-121">值将显示第二个 TemplateField`Discontinued`字段，但将使用的格式设置方法以显示"是"如果`Discontinued`是`true`，否则"NO"。</span><span class="sxs-lookup"><span data-stu-id="cc040-121">The second TemplateField will display the value of the `Discontinued` field, but will use a formatting method to display "YES" if `Discontinued` is `true`, and "NO" otherwise.</span></span>


<span data-ttu-id="cc040-122">[![两个 Templatefield 用于自定义显示内容](using-templatefields-in-the-detailsview-control-cs/_static/image2.png)](using-templatefields-in-the-detailsview-control-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-122">[![Two TemplateFields are Used to Customize the Display](using-templatefields-in-the-detailsview-control-cs/_static/image2.png)](using-templatefields-in-the-detailsview-control-cs/_static/image1.png)</span></span>

<span data-ttu-id="cc040-123">**图 1**:两个 Templatefield 用于自定义显示 ([单击此项可查看原尺寸图像](using-templatefields-in-the-detailsview-control-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-123">**Figure 1**: Two TemplateFields are Used to Customize the Display ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image3.png))</span></span>


<span data-ttu-id="cc040-124">让我们进入正题！</span><span class="sxs-lookup"><span data-stu-id="cc040-124">Let's get started!</span></span>

## <a name="step-1-binding-the-data-to-the-detailsview"></a><span data-ttu-id="cc040-125">步骤 1：将数据绑定到 DetailsView</span><span class="sxs-lookup"><span data-stu-id="cc040-125">Step 1: Binding the Data to the DetailsView</span></span>

<span data-ttu-id="cc040-126">如所述在上一教程中使用的 Templatefield 通常是最简单的方法首先创建包含只 BoundFields 的 DetailsView 控件然后添加新 Templatefield 或将现有 BoundFields 转换为 Templatefield 作为时需要.</span><span class="sxs-lookup"><span data-stu-id="cc040-126">As discussed in the previous tutorial, when working with TemplateFields it's often easiest to start by creating the DetailsView control that contains just BoundFields and then add new TemplateFields or convert the existing BoundFields to TemplateFields as needed.</span></span> <span data-ttu-id="cc040-127">因此，通过将 DetailsView 添加到通过设计器页面并将其绑定到返回的产品列表 ObjectDataSource 开始本教程。</span><span class="sxs-lookup"><span data-stu-id="cc040-127">Therefore, start this tutorial by adding a DetailsView to the page through the Designer and binding it to an ObjectDataSource that returns the list of products.</span></span> <span data-ttu-id="cc040-128">这些步骤将为每个产品的非布尔值字段和一个布尔值字段 (Discontinued) CheckBoxField 与 BoundFields 创建 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="cc040-128">These steps will create a DetailsView with BoundFields for each of the product's non-Boolean value fields and a CheckBoxField for the one Boolean value field (Discontinued).</span></span>

<span data-ttu-id="cc040-129">打开`DetailsViewTemplateField.aspx`页上，将从工具箱拖到设计器的 DetailsView。</span><span class="sxs-lookup"><span data-stu-id="cc040-129">Open the `DetailsViewTemplateField.aspx` page and drag a DetailsView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="cc040-130">在 DetailsView 的智能标记选择添加新的 ObjectDataSource 控件，调用`ProductsBLL`类的`GetProducts()`方法。</span><span class="sxs-lookup"><span data-stu-id="cc040-130">From the DetailsView's smart tag choose to add a new ObjectDataSource control that invokes the `ProductsBLL` class's `GetProducts()` method.</span></span>


<span data-ttu-id="cc040-131">[![添加新的 ObjectDataSource 控件，它调用 GetProducts() 方法](using-templatefields-in-the-detailsview-control-cs/_static/image5.png)](using-templatefields-in-the-detailsview-control-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-131">[![Add a New ObjectDataSource Control that Invokes the GetProducts() Method](using-templatefields-in-the-detailsview-control-cs/_static/image5.png)](using-templatefields-in-the-detailsview-control-cs/_static/image4.png)</span></span>

<span data-ttu-id="cc040-132">**图 2**:添加新的 ObjectDataSource 控件的 Invoke`GetProducts()`方法 ([单击以查看实际尺寸的图像](using-templatefields-in-the-detailsview-control-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-132">**Figure 2**: Add a New ObjectDataSource Control that Invokes the `GetProducts()` Method ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image6.png))</span></span>


<span data-ttu-id="cc040-133">为此报表中删除`ProductID`， `SupplierID`， `CategoryID`，和`ReorderLevel`BoundFields。</span><span class="sxs-lookup"><span data-stu-id="cc040-133">For this report remove the `ProductID`, `SupplierID`, `CategoryID`, and `ReorderLevel` BoundFields.</span></span> <span data-ttu-id="cc040-134">接下来，对 BoundFields 重新排序，以便`CategoryName`并`SupplierName`BoundFields 紧跟`ProductName`BoundField。</span><span class="sxs-lookup"><span data-stu-id="cc040-134">Next, reorder the BoundFields so that the `CategoryName` and `SupplierName` BoundFields appear immediately after the `ProductName` BoundField.</span></span> <span data-ttu-id="cc040-135">可随意调整`HeaderText`属性和格式设置属性作为您 BoundFields 认为合适。</span><span class="sxs-lookup"><span data-stu-id="cc040-135">Feel free to adjust the `HeaderText` properties and formatting properties for the BoundFields as you see fit.</span></span> <span data-ttu-id="cc040-136">正如 gridview，通过字段对话框 （可通过单击 DetailsView 的智能标记中的编辑字段链接访问） 或通过声明性语法，可以执行这些 BoundField 级别编辑。</span><span class="sxs-lookup"><span data-stu-id="cc040-136">Like with the GridView, these BoundField-level edits can be performed through the Fields dialog box (accessible by clicking on the Edit Fields link in the DetailsView's smart tag) or through the declarative syntax.</span></span> <span data-ttu-id="cc040-137">最后，清除 DetailsView`Height`和`Width`属性值，以允许 DetailsView 控件以展开根据显示的数据，并检查智能标记中的启用分页复选框。</span><span class="sxs-lookup"><span data-stu-id="cc040-137">Lastly, clear out the DetailsView's `Height` and `Width` property values in order to allow the DetailsView control to expand based on the data displayed and check the Enable Paging checkbox in the smart tag.</span></span>

<span data-ttu-id="cc040-138">进行这些更改后，DetailsView 控件的声明性标记应类似于下面：</span><span class="sxs-lookup"><span data-stu-id="cc040-138">After making these changes, your DetailsView control's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](using-templatefields-in-the-detailsview-control-cs/samples/sample1.aspx)]

<span data-ttu-id="cc040-139">花点时间查看通过浏览器页面。</span><span class="sxs-lookup"><span data-stu-id="cc040-139">Take a moment to view the page through a browser.</span></span> <span data-ttu-id="cc040-140">此时应看到显示产品的名称、 类别、 供应商、 价格、 库存数量、 顺序上的单位和其已停止使用的状态行的一个产品列出 (Chai)。</span><span class="sxs-lookup"><span data-stu-id="cc040-140">At this point you should see a single product listed (Chai) with rows showing the product's name, category, supplier, price, units in stock, units on order, and its discontinued status.</span></span>


<span data-ttu-id="cc040-141">[![使用一系列 BoundFields 显示产品的详细信息](using-templatefields-in-the-detailsview-control-cs/_static/image8.png)](using-templatefields-in-the-detailsview-control-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-141">[![The Product's Details Are Shown Using a Series of BoundFields](using-templatefields-in-the-detailsview-control-cs/_static/image8.png)](using-templatefields-in-the-detailsview-control-cs/_static/image7.png)</span></span>

<span data-ttu-id="cc040-142">**图 3**:使用序列的 BoundFields 显示产品的详细信息 ([单击此项可查看原尺寸图像](using-templatefields-in-the-detailsview-control-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-142">**Figure 3**: The Product's Details Are Shown Using a Series of BoundFields ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image9.png))</span></span>


## <a name="step-2-combining-the-price-units-in-stock-and-units-on-order-into-one-row"></a><span data-ttu-id="cc040-143">步骤 2：将价格、 存货单位和订货量合并为一行</span><span class="sxs-lookup"><span data-stu-id="cc040-143">Step 2: Combining the Price, Units In Stock, and Units On Order Into One Row</span></span>

<span data-ttu-id="cc040-144">在 DetailsView 具有对应的行`UnitPrice`， `UnitsInStock`，和`UnitsOnOrder`字段。</span><span class="sxs-lookup"><span data-stu-id="cc040-144">The DetailsView has a row for the `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` fields.</span></span> <span data-ttu-id="cc040-145">我们可以将合并这些数据字段到单个行使用 TemplateField 通过添加新 TemplateField 或通过将一个现有转换`UnitPrice`， `UnitsInStock`，和`UnitsOnOrder`转换为 TemplateField BoundFields。</span><span class="sxs-lookup"><span data-stu-id="cc040-145">We can combine these data fields into a single row with a TemplateField either by adding a new TemplateField or by converting one of the existing `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` BoundFields into a TemplateField.</span></span> <span data-ttu-id="cc040-146">尽管我个人更偏爱转换现有 BoundFields，让我们通过添加新 TemplateField 练习。</span><span class="sxs-lookup"><span data-stu-id="cc040-146">While I personally prefer converting existing BoundFields, let's practice by adding a new TemplateField.</span></span>

<span data-ttu-id="cc040-147">通过单击 DetailsView 的智能标记，以打开字段对话框中的编辑字段链接启动。</span><span class="sxs-lookup"><span data-stu-id="cc040-147">Start by clicking on the Edit Fields link in the DetailsView's smart tag to bring up the Fields dialog box.</span></span> <span data-ttu-id="cc040-148">接下来，添加新 TemplateField 并设置其`HeaderText`属性设置为"价格和清单"并移动新 TemplateField 以便它位于上面`UnitPrice`BoundField。</span><span class="sxs-lookup"><span data-stu-id="cc040-148">Next, add a new TemplateField and set its `HeaderText` property to "Price and Inventory" and move the new TemplateField so that it is positioned above the `UnitPrice` BoundField.</span></span>


<span data-ttu-id="cc040-149">[![将新 TemplateField 添加到 DetailsView 控件](using-templatefields-in-the-detailsview-control-cs/_static/image11.png)](using-templatefields-in-the-detailsview-control-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-149">[![Add a New TemplateField to the DetailsView Control](using-templatefields-in-the-detailsview-control-cs/_static/image11.png)](using-templatefields-in-the-detailsview-control-cs/_static/image10.png)</span></span>

<span data-ttu-id="cc040-150">**图 4**:将新 TemplateField 添加到 DetailsView 控件 ([单击此项可查看原尺寸图像](using-templatefields-in-the-detailsview-control-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-150">**Figure 4**: Add a New TemplateField to the DetailsView Control ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image12.png))</span></span>


<span data-ttu-id="cc040-151">由于此新 templatefield 进一步将包含在当前显示的值`UnitPrice`， `UnitsInStock`，和`UnitsOnOrder`BoundFields，让我们将其删除。</span><span class="sxs-lookup"><span data-stu-id="cc040-151">Since this new TemplateField will contain the values currently displayed in the `UnitPrice`, `UnitsInStock`, and `UnitsOnOrder` BoundFields, let's remove them.</span></span>

<span data-ttu-id="cc040-152">此步骤中的最后一个任务是定义`ItemTemplate`的价格和库存 TemplateField，可以是标记来通过 DetailsView 的模板通过控件的声明性语法编辑接口在设计器或手动实现。</span><span class="sxs-lookup"><span data-stu-id="cc040-152">The last task for this step is to define the `ItemTemplate` markup for the Price and Inventory TemplateField, which can be accomplished either through the DetailsView's template editing interface in the Designer or by hand through the control's declarative syntax.</span></span> <span data-ttu-id="cc040-153">GridView、 DetailsView 的模板编辑界面可以访问通过单击智能标记中的编辑模板链接。</span><span class="sxs-lookup"><span data-stu-id="cc040-153">As with the GridView, the DetailsView's template editing interface can be accessed by clicking on the Edit Templates link in the smart tag.</span></span> <span data-ttu-id="cc040-154">从此处可以选择要编辑从下拉列表以及如何从工具箱将任何 Web 控件的模板。</span><span class="sxs-lookup"><span data-stu-id="cc040-154">From here you can select the template to edit from the drop-down list and then add any Web controls from the Toolbox.</span></span>

<span data-ttu-id="cc040-155">对于本教程中，首先将标签控件添加到的价格和库存 TemplateField `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="cc040-155">For this tutorial, start by adding a Label control to the Price and Inventory TemplateField's `ItemTemplate`.</span></span> <span data-ttu-id="cc040-156">接下来，单击编辑 DataBindings 链接从标签 Web 控件的智能标记并将绑定`Text`属性设置为`UnitPrice`字段。</span><span class="sxs-lookup"><span data-stu-id="cc040-156">Next, click on the Edit DataBindings link from the Label Web control's smart tag and bind the `Text` property to the `UnitPrice` field.</span></span>


<span data-ttu-id="cc040-157">[![将标签的 Text 属性绑定到单价数据字段](using-templatefields-in-the-detailsview-control-cs/_static/image14.png)](using-templatefields-in-the-detailsview-control-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-157">[![Bind the Label's Text Property to the UnitPrice Data Field](using-templatefields-in-the-detailsview-control-cs/_static/image14.png)](using-templatefields-in-the-detailsview-control-cs/_static/image13.png)</span></span>

<span data-ttu-id="cc040-158">**图 5**:绑定的标签`Text`属性设置为`UnitPrice`数据字段 ([单击以查看实际尺寸的图像](using-templatefields-in-the-detailsview-control-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-158">**Figure 5**: Bind the Label's `Text` Property to the `UnitPrice` Data Field ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image15.png))</span></span>


## <a name="formatting-the-price-as-a-currency"></a><span data-ttu-id="cc040-159">作为一种货币格式设置价格</span><span class="sxs-lookup"><span data-stu-id="cc040-159">Formatting the Price as a Currency</span></span>

<span data-ttu-id="cc040-160">添加此元素后，标签 Web 控件价格和库存 TemplateField 现在会显示仅所选产品的价格。</span><span class="sxs-lookup"><span data-stu-id="cc040-160">With this addition, the Label Web control Price and Inventory TemplateField will now display just the price for the selected product.</span></span> <span data-ttu-id="cc040-161">图 6 显示了我们的进度的屏幕截图为止时的浏览器查看。</span><span class="sxs-lookup"><span data-stu-id="cc040-161">Figure 6 shows a screen shot of our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="cc040-162">[![价格和库存 templatefield 进一步显示的价格](using-templatefields-in-the-detailsview-control-cs/_static/image17.png)](using-templatefields-in-the-detailsview-control-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-162">[![The Price and Inventory TemplateField Shows the Price](using-templatefields-in-the-detailsview-control-cs/_static/image17.png)](using-templatefields-in-the-detailsview-control-cs/_static/image16.png)</span></span>

<span data-ttu-id="cc040-163">**图 6**:价格和库存 templatefield 进一步显示的价格 ([单击此项可查看原尺寸图像](using-templatefields-in-the-detailsview-control-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-163">**Figure 6**: The Price and Inventory TemplateField Shows the Price ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image18.png))</span></span>


<span data-ttu-id="cc040-164">请注意该产品的价格未格式化为货币。</span><span class="sxs-lookup"><span data-stu-id="cc040-164">Note that the product's price is not formatted as a currency.</span></span> <span data-ttu-id="cc040-165">使用 BoundField 格式设置是可以通过设置`HtmlEncode`属性设置为`false`并`DataFormatString`属性设置为`{0:formatSpecifier}`。</span><span class="sxs-lookup"><span data-stu-id="cc040-165">With a BoundField, formatting is possible by setting the `HtmlEncode` property to `false` and the `DataFormatString` property to `{0:formatSpecifier}`.</span></span> <span data-ttu-id="cc040-166">对于 TemplateField，但是，格式设置的说明进行操作必须指定数据绑定语法中或通过使用应用程序的代码 （如 ASP.NET 页面的代码隐藏类） 中的某一位置定义的格式设置方法。</span><span class="sxs-lookup"><span data-stu-id="cc040-166">For a TemplateField, however, any formatting instructions must be specified in the databinding syntax or through the use of a formatting method defined somewhere within the application's code (such as in the ASP.NET page's code-behind class).</span></span>

<span data-ttu-id="cc040-167">若要指定标签 Web 控件中使用的数据绑定语法的格式设置，返回到数据绑定对话框中，通过单击标签的智能标记中的编辑 DataBindings 链接。</span><span class="sxs-lookup"><span data-stu-id="cc040-167">To specify the formatting for the databinding syntax used in the Label Web control, return to the DataBindings dialog box by clicking on the Edit DataBindings link from the Label's smart tag.</span></span> <span data-ttu-id="cc040-168">可以直接在格式下拉列表中键入的格式设置的说明进行操作，或选择一个定义的格式字符串。</span><span class="sxs-lookup"><span data-stu-id="cc040-168">You can type the formatting instructions directly in the Format drop-down list or select one of the defined format strings.</span></span> <span data-ttu-id="cc040-169">喜欢使用 BoundField`DataFormatString`属性，指定格式设置是使用`{0:formatSpecifier}`。</span><span class="sxs-lookup"><span data-stu-id="cc040-169">Like with the BoundField's `DataFormatString` property, the formatting is specified using `{0:formatSpecifier}`.</span></span>

<span data-ttu-id="cc040-170">有关`UnitPrice`字段的使用货币格式指定通过选择相应的下拉列表值或通过键入`{0:C}`手动。</span><span class="sxs-lookup"><span data-stu-id="cc040-170">For the `UnitPrice` field use the currency formatting specified either by selecting the appropriate drop-down list value or by typing in `{0:C}` by hand.</span></span>


<span data-ttu-id="cc040-171">[![设置价格的格式为货币](using-templatefields-in-the-detailsview-control-cs/_static/image20.png)](using-templatefields-in-the-detailsview-control-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-171">[![Format the Price as a Currency](using-templatefields-in-the-detailsview-control-cs/_static/image20.png)](using-templatefields-in-the-detailsview-control-cs/_static/image19.png)</span></span>

<span data-ttu-id="cc040-172">**图 7**:设置格式作为一种货币的价格 ([单击此项可查看原尺寸图像](using-templatefields-in-the-detailsview-control-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-172">**Figure 7**: Format the Price as a Currency ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image21.png))</span></span>


<span data-ttu-id="cc040-173">以声明方式，到第二个参数指示的格式规范`Bind`或`Eval`方法。</span><span class="sxs-lookup"><span data-stu-id="cc040-173">Declaratively, the formatting specification is indicated as a second parameter into the `Bind` or `Eval` methods.</span></span> <span data-ttu-id="cc040-174">只需通过声明性标记中的以下数据绑定表达式中的设计器结果所做的设置：</span><span class="sxs-lookup"><span data-stu-id="cc040-174">The settings just made through the Designer result in the following databinding expression in the declarative markup:</span></span>


[!code-aspx[Main](using-templatefields-in-the-detailsview-control-cs/samples/sample2.aspx)]

## <a name="adding-the-remaining-data-fields-to-the-templatefield"></a><span data-ttu-id="cc040-175">将其余数据字段添加到 TemplateField</span><span class="sxs-lookup"><span data-stu-id="cc040-175">Adding the Remaining Data Fields to the TemplateField</span></span>

<span data-ttu-id="cc040-176">我们在此处显示并格式化`UnitPrice`数据字段中的价格和库存 TemplateField，但仍需要显示`UnitsInStock`和`UnitsOnOrder`字段。</span><span class="sxs-lookup"><span data-stu-id="cc040-176">At this point we've displayed and formatted the `UnitPrice` data field in the Price and Inventory TemplateField, but still need to display the `UnitsInStock` and `UnitsOnOrder` fields.</span></span> <span data-ttu-id="cc040-177">让我们来显示这些行下面的价格，并在括号中。</span><span class="sxs-lookup"><span data-stu-id="cc040-177">Let's display these on a line below the price and in parentheses.</span></span> <span data-ttu-id="cc040-178">从设计器中的模板编辑界面，可以将此类标记添加模板中将光标并只需在要显示的文本中键入。</span><span class="sxs-lookup"><span data-stu-id="cc040-178">From the template editing interface in the Designer, such markup can be added by positioning your cursor within the template and simply typing in the text to be displayed.</span></span> <span data-ttu-id="cc040-179">或者，可以直接在声明性语法中输入此标记。</span><span class="sxs-lookup"><span data-stu-id="cc040-179">Alternatively, this markup can be entered directly in the declarative syntax.</span></span>

<span data-ttu-id="cc040-180">添加静态标记、 标签 Web 控件和数据绑定语法，以便价格和库存 templatefield 进一步显示的价格和库存信息如下所示：</span><span class="sxs-lookup"><span data-stu-id="cc040-180">Add the static markup, Label Web controls, and databinding syntax so that the Price and Inventory TemplateField displays the price and inventory information like so:</span></span>

<span data-ttu-id="cc040-181">*UnitPrice*</span><span class="sxs-lookup"><span data-stu-id="cc040-181">*UnitPrice*</span></span>  
<span data-ttu-id="cc040-182">(\**库存 / 订单：\*\*\*UnitsInStock* / *UnitsOnOrder*)</span><span class="sxs-lookup"><span data-stu-id="cc040-182">(**In Stock / On Order:** *UnitsInStock* / *UnitsOnOrder*)</span></span>

<span data-ttu-id="cc040-183">以后执行此任务 DetailsView 的声明性标记看起来应类似于下面：</span><span class="sxs-lookup"><span data-stu-id="cc040-183">After performing this task your DetailsView's declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](using-templatefields-in-the-detailsview-control-cs/samples/sample3.aspx)]

<span data-ttu-id="cc040-184">使用这些更改，我们已经合并到单个 DetailsView 行的价格和库存信息。</span><span class="sxs-lookup"><span data-stu-id="cc040-184">With these changes we've consolidated the price and inventory information into a single DetailsView row.</span></span>


<span data-ttu-id="cc040-185">[![在单行中显示的价格和清单信息](using-templatefields-in-the-detailsview-control-cs/_static/image23.png)](using-templatefields-in-the-detailsview-control-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-185">[![The Price and Inventory Information is Displayed in a Single Row](using-templatefields-in-the-detailsview-control-cs/_static/image23.png)](using-templatefields-in-the-detailsview-control-cs/_static/image22.png)</span></span>

<span data-ttu-id="cc040-186">**图 8**:价格和库存信息会显示在单个行 ([单击此项可查看原尺寸图像](using-templatefields-in-the-detailsview-control-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-186">**Figure 8**: The Price and Inventory Information is Displayed in a Single Row ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image24.png))</span></span>


## <a name="step-3-customizing-the-discontinued-field-information"></a><span data-ttu-id="cc040-187">步骤 3：自定义中断的字段信息</span><span class="sxs-lookup"><span data-stu-id="cc040-187">Step 3: Customizing the Discontinued Field Information</span></span>

<span data-ttu-id="cc040-188">`Products`表的`Discontinued`列是一个位值，指示是否已停止使用该产品。</span><span class="sxs-lookup"><span data-stu-id="cc040-188">The `Products` table's `Discontinued` column is a bit value that indicates whether the product has been discontinued.</span></span> <span data-ttu-id="cc040-189">布尔值字段中，当绑定到数据源控件的 DetailsView （或 GridView），如`Discontinued`，而非布尔值字段，如实现为 CheckBoxFields `ProductID`， `ProductName`，依此类推，作为实现BoundFields。</span><span class="sxs-lookup"><span data-stu-id="cc040-189">When binding a DetailsView (or GridView) to a data source control, the Boolean value fields, like `Discontinued`, are implemented as CheckBoxFields whereas non-Boolean value fields, like `ProductID`, `ProductName`, and so on, are implemented as BoundFields.</span></span> <span data-ttu-id="cc040-190">CheckBoxField 将呈现为一个已禁用的复选框，如果数据字段的值为 True，则取消选中否则检查。</span><span class="sxs-lookup"><span data-stu-id="cc040-190">The CheckBoxField renders as a disabled checkbox that is checked if the data field's value is True and unchecked otherwise.</span></span>

<span data-ttu-id="cc040-191">而不是显示 CheckBoxField 我们可能想要改为显示文本，该值指示已停止使用该产品。</span><span class="sxs-lookup"><span data-stu-id="cc040-191">Rather than display the CheckBoxField we may want to instead display text indicating whether or not the product is discontinued.</span></span> <span data-ttu-id="cc040-192">若要实现此目的我们无法从 DetailsView 删除 CheckBoxField，然后添加 BoundField 其`DataField`属性设置为`Discontinued`。</span><span class="sxs-lookup"><span data-stu-id="cc040-192">To accomplish this we could remove the CheckBoxField from the DetailsView and then add a BoundField whose `DataField` property was set to `Discontinued`.</span></span> <span data-ttu-id="cc040-193">请花费片刻时间来执行此操作。</span><span class="sxs-lookup"><span data-stu-id="cc040-193">Take a moment to do this.</span></span> <span data-ttu-id="cc040-194">此更改后 DetailsView 显示的文本"True"停产的产品和"False"仍处于活动状态的产品。</span><span class="sxs-lookup"><span data-stu-id="cc040-194">After this change the DetailsView shows the text "True" for discontinued products and "False" for products that are still active.</span></span>


<span data-ttu-id="cc040-195">[![字符串 True 和 False 用于显示已停止使用的状态](using-templatefields-in-the-detailsview-control-cs/_static/image26.png)](using-templatefields-in-the-detailsview-control-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-195">[![The Strings True and False Are Used to Display the Discontinued State](using-templatefields-in-the-detailsview-control-cs/_static/image26.png)](using-templatefields-in-the-detailsview-control-cs/_static/image25.png)</span></span>

<span data-ttu-id="cc040-196">**图 9**:字符串，则返回 True 和 False 来显示已中断状态 ([单击此项可查看原尺寸图像](using-templatefields-in-the-detailsview-control-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-196">**Figure 9**: The Strings True and False Are Used to Display the Discontinued State ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image27.png))</span></span>


<span data-ttu-id="cc040-197">想象我们不想要的字符串"True"或"False"改为使用，但"YES"和"NO"。</span><span class="sxs-lookup"><span data-stu-id="cc040-197">Imagine that we didn't want the strings "True" or "False" to be used, but "YES" and "NO", instead.</span></span> <span data-ttu-id="cc040-198">此类自定义可以借助 TemplateField 和格式设置方法的执行。</span><span class="sxs-lookup"><span data-stu-id="cc040-198">Such customization can be performed with the aid of a TemplateField and a formatting method.</span></span> <span data-ttu-id="cc040-199">格式设置方法可以采用任意数量的输入参数，但必须返回 HTML （作为字符串） 注入到模板。</span><span class="sxs-lookup"><span data-stu-id="cc040-199">A formatting method can take in any number of input parameters, but must return the HTML (as a string) to inject into the template.</span></span>

<span data-ttu-id="cc040-200">添加到的格式设置方法`DetailsViewTemplateField.aspx`页面的代码隐藏类名为`DisplayDiscontinuedAsYESorNO`的接受布尔值作为输入参数并返回一个字符串。</span><span class="sxs-lookup"><span data-stu-id="cc040-200">Add a formatting method to the `DetailsViewTemplateField.aspx` page's code-behind class named `DisplayDiscontinuedAsYESorNO` that accepts a Boolean as an input parameter and returns a string.</span></span> <span data-ttu-id="cc040-201">前面的教程，此方法中所述*必须*标记为`protected`或`public`以便可从该模板。</span><span class="sxs-lookup"><span data-stu-id="cc040-201">As discussed in the previous tutorial, this method *must* be marked as `protected` or `public` in order to be accessible from the template.</span></span>


[!code-csharp[Main](using-templatefields-in-the-detailsview-control-cs/samples/sample4.cs)]

<span data-ttu-id="cc040-202">此方法检查输入的参数 (`discontinued`)，并返回"YES"，如果它是`true`，否则为"否"。</span><span class="sxs-lookup"><span data-stu-id="cc040-202">This method checks the input parameter (`discontinued`) and returns "YES" if it is `true`, "NO" otherwise.</span></span>

> [!NOTE]
> <span data-ttu-id="cc040-203">在按以前的教程回想一下，我们也可能包含的数据字段会通过检查的格式设置方法`NULL`s，因此需要检查是否该雇员的`HiredDate`属性值有一个数据库`NULL`之前的值访问`EmployeesRow`的`HiredDate`属性。</span><span class="sxs-lookup"><span data-stu-id="cc040-203">In the formatting method examined in the previous tutorial recall that we were passing in a data field that might contain `NULL` s and therefore needed to check if the employee's `HiredDate` property value had a database `NULL` value before accessing the `EmployeesRow`'s `HiredDate` property.</span></span> <span data-ttu-id="cc040-204">此类检查不需要此处因为`Discontinued`列不能有数据库`NULL`分配的值。</span><span class="sxs-lookup"><span data-stu-id="cc040-204">Such a check is not needed here since the `Discontinued` column can never have database `NULL` values assigned.</span></span> <span data-ttu-id="cc040-205">此外，这就是原因的方法可以接受一个布尔值输入参数，而不是无需接受`ProductsRow`实例或类型参数的`object`。</span><span class="sxs-lookup"><span data-stu-id="cc040-205">Moreover, this is why the method can accept a Boolean input parameter rather than having to accept a `ProductsRow` instance or a parameter of type `object`.</span></span>


<span data-ttu-id="cc040-206">使用此格式设置方法完成，剩下的就是调用从 TemplateField `ItemTemplate`。</span><span class="sxs-lookup"><span data-stu-id="cc040-206">With this formatting method complete, all that remains is to call it from the TemplateField's `ItemTemplate`.</span></span> <span data-ttu-id="cc040-207">若要创建删除的 TemplateField `Discontinued` BoundField 和添加新 TemplateField 或转换`Discontinued`转换为 TemplateField BoundField。</span><span class="sxs-lookup"><span data-stu-id="cc040-207">To create the TemplateField either remove the `Discontinued` BoundField and add a new TemplateField or convert the `Discontinued` BoundField into a TemplateField.</span></span> <span data-ttu-id="cc040-208">然后，从声明性标记视图中，编辑 TemplateField，使其包含只需调用 ItemTemplate`DisplayDiscontinuedAsYESorNO`方法，传入的当前值`ProductRow`实例的`Discontinued`属性。</span><span class="sxs-lookup"><span data-stu-id="cc040-208">Then, from the declarative markup view, edit the TemplateField so that it contains just an ItemTemplate that invokes the `DisplayDiscontinuedAsYESorNO` method, passing in the value of the current `ProductRow` instance's `Discontinued` property.</span></span> <span data-ttu-id="cc040-209">这可以通过访问`Eval`方法。</span><span class="sxs-lookup"><span data-stu-id="cc040-209">This can be accessed via the `Eval` method.</span></span> <span data-ttu-id="cc040-210">具体而言，TemplateField 标记应如下所示：</span><span class="sxs-lookup"><span data-stu-id="cc040-210">Specifically, the TemplateField's markup should look like:</span></span>


[!code-aspx[Main](using-templatefields-in-the-detailsview-control-cs/samples/sample5.aspx)]

<span data-ttu-id="cc040-211">这将导致`DisplayDiscontinuedAsYESorNO`呈现 DetailsView 时要调用方法并传入`ProductRow`实例的`Discontinued`值。</span><span class="sxs-lookup"><span data-stu-id="cc040-211">This will cause the `DisplayDiscontinuedAsYESorNO` method to be invoked when rendering the DetailsView, passing in the `ProductRow` instance's `Discontinued` value.</span></span> <span data-ttu-id="cc040-212">由于`Eval`方法返回类型的值`object`，但`DisplayDiscontinuedAsYESorNO`方法需要输入的参数的类型`bool`，我们将强制转换`Eval`方法返回值为`bool`。</span><span class="sxs-lookup"><span data-stu-id="cc040-212">Since the `Eval` method returns a value of type `object`, but the `DisplayDiscontinuedAsYESorNO` method expects an input parameter of type `bool`, we cast the `Eval` methods return value to `bool`.</span></span> <span data-ttu-id="cc040-213">`DisplayDiscontinuedAsYESorNO`方法会返回"YES"或"否"根据值接收。</span><span class="sxs-lookup"><span data-stu-id="cc040-213">The `DisplayDiscontinuedAsYESorNO` method will then return "YES" or "NO" depending on the value it receives.</span></span> <span data-ttu-id="cc040-214">返回的值是此 DetailsView 中显示的内容行 （请参阅图 10）。</span><span class="sxs-lookup"><span data-stu-id="cc040-214">The returned value is what is displayed in this DetailsView row (see Figure 10).</span></span>


<span data-ttu-id="cc040-215">[![是或否的值为现在 Discontinued 行中所示](using-templatefields-in-the-detailsview-control-cs/_static/image29.png)](using-templatefields-in-the-detailsview-control-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="cc040-215">[![YES or NO Values are Now Shown in the Discontinued Row](using-templatefields-in-the-detailsview-control-cs/_static/image29.png)](using-templatefields-in-the-detailsview-control-cs/_static/image28.png)</span></span>

<span data-ttu-id="cc040-216">**图 10**:是或否的值为现在 Discontinued 行中所示 ([单击此项可查看原尺寸图像](using-templatefields-in-the-detailsview-control-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="cc040-216">**Figure 10**: YES or NO Values are Now Shown in the Discontinued Row ([Click to view full-size image](using-templatefields-in-the-detailsview-control-cs/_static/image30.png))</span></span>


## <a name="summary"></a><span data-ttu-id="cc040-217">总结</span><span class="sxs-lookup"><span data-stu-id="cc040-217">Summary</span></span>

<span data-ttu-id="cc040-218">在 DetailsView 控件中的 TemplateField 允许灵活地显示数据，不是可与其他字段控件，并且非常适合的情况下使用更高位置：</span><span class="sxs-lookup"><span data-stu-id="cc040-218">The TemplateField in the DetailsView control allows for a higher degree of flexibility in displaying data than is available with the other field controls and are ideal for situations where:</span></span>

- <span data-ttu-id="cc040-219">多个数据字段需要一个 GridView 列中显示</span><span class="sxs-lookup"><span data-stu-id="cc040-219">Multiple data fields need to be displayed in one GridView column</span></span>
- <span data-ttu-id="cc040-220">最好使用 Web 控件，而不是纯文本格式表示数据</span><span class="sxs-lookup"><span data-stu-id="cc040-220">The data is best expressed using a Web control rather than plain text</span></span>
- <span data-ttu-id="cc040-221">输出取决于基础数据，例如显示元数据或重新格式化数据</span><span class="sxs-lookup"><span data-stu-id="cc040-221">The output depends on the underlying data, such as displaying metadata or in reformatting the data</span></span>

<span data-ttu-id="cc040-222">Templatefield 所考虑的更高的灵活性在 DetailsView 的基础数据的呈现，DetailsView 输出仍让人感觉有点 boxy 每个字段呈现为 HTML 中的一行`<table>`。</span><span class="sxs-lookup"><span data-stu-id="cc040-222">While TemplateFields allow for a greater degree of flexibility in the rendering of the DetailsView's underlying data, the DetailsView output still feels a bit boxy as each field is rendered as a row in an HTML `<table>`.</span></span>

<span data-ttu-id="cc040-223">FormView 控件提供了更高的灵活地配置呈现的输出。</span><span class="sxs-lookup"><span data-stu-id="cc040-223">The FormView control offers a greater degree of flexibility in configuring the rendered output.</span></span> <span data-ttu-id="cc040-224">FormView 不包含字段，但而是一系列模板 (`ItemTemplate`， `EditItemTemplate`， `HeaderTemplate`，依此类推)。</span><span class="sxs-lookup"><span data-stu-id="cc040-224">The FormView does not contain fields but rather just a series of templates (`ItemTemplate`, `EditItemTemplate`, `HeaderTemplate`, and so on).</span></span> <span data-ttu-id="cc040-225">我们将了解如何使用 FormView 我们下一步的教程中实现更多控制的呈现的布局。</span><span class="sxs-lookup"><span data-stu-id="cc040-225">We'll see how to use the FormView to achieve even more control of the rendered layout in our next tutorial.</span></span>

<span data-ttu-id="cc040-226">快乐编程 ！</span><span class="sxs-lookup"><span data-stu-id="cc040-226">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="cc040-227">关于作者</span><span class="sxs-lookup"><span data-stu-id="cc040-227">About the Author</span></span>

<span data-ttu-id="cc040-228">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml)的七个部 asp/ASP.NET 书籍并创办了作者[4GuysFromRolla.com](http://www.4guysfromrolla.com)，自 1998 年以来一直致力于 Microsoft Web 技术。</span><span class="sxs-lookup"><span data-stu-id="cc040-228">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="cc040-229">Scott 是独立的顾问、 培训师和编写器。</span><span class="sxs-lookup"><span data-stu-id="cc040-229">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="cc040-230">他最新著作是[ *Sams Teach 自己 ASP.NET 2.0 24 小时内*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)。</span><span class="sxs-lookup"><span data-stu-id="cc040-230">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="cc040-231">他可以到达[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cc040-231">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span> <span data-ttu-id="cc040-232">或通过他的博客，其中，请参阅[ http://ScottOnWriting.NET ](http://ScottOnWriting.NET)。</span><span class="sxs-lookup"><span data-stu-id="cc040-232">or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="cc040-233">特别感谢</span><span class="sxs-lookup"><span data-stu-id="cc040-233">Special Thanks To</span></span>

<span data-ttu-id="cc040-234">很多有用的审阅者已评审本系列教程。</span><span class="sxs-lookup"><span data-stu-id="cc040-234">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="cc040-235">本教程中的潜在顾客审阅者已 Dan Jagers。</span><span class="sxs-lookup"><span data-stu-id="cc040-235">Lead reviewer for this tutorial was Dan Jagers.</span></span> <span data-ttu-id="cc040-236">是否有兴趣查看我即将推出的 MSDN 文章？</span><span class="sxs-lookup"><span data-stu-id="cc040-236">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="cc040-237">如果是这样，给我在行[ mitchell@4GuysFromRolla.com。](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="cc040-237">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cc040-238">[上一页](using-templatefields-in-the-gridview-control-cs.md)
> [下一页](using-the-formview-s-templates-cs.md)</span><span class="sxs-lookup"><span data-stu-id="cc040-238">[Previous](using-templatefields-in-the-gridview-control-cs.md)
[Next](using-the-formview-s-templates-cs.md)</span></span>

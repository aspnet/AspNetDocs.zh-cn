---
uid: web-forms/overview/moving-to-aspnet-20/data-bound-controls
title: 数据绑定控件 |Microsoft Docs
author: microsoft
description: 大多数 ASP.NET 应用程序依赖于某种程度的后端数据源中的数据表示。 数据绑定控件已被交互 w 的关键环节...
ms.author: riande
ms.date: 02/20/2005
ms.assetid: 0e23ff32-646d-43f3-8bec-6b2313d3abd6
msc.legacyurl: /web-forms/overview/moving-to-aspnet-20/data-bound-controls
msc.type: authoredcontent
ms.openlocfilehash: 1154b38e0fa3d9d56cb407ae659c3b0d69871fda
ms.sourcegitcommit: 51b01b6ff8edde57d8243e4da28c9f1e7f1962b2
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 05/06/2019
ms.locfileid: "65131093"
---
# <a name="data-bound-controls"></a>数据绑定控件

by [Microsoft](https://github.com/microsoft)

> 大多数 ASP.NET 应用程序依赖于某种程度的后端数据源中的数据表示。 数据绑定控件已与动态 Web 应用程序中的数据进行交互的关键环节。 ASP.NET 2.0 引入了数据绑定控件，包括新 BaseDataBoundControl 类和声明性语法对一些显著改进。

大多数 ASP.NET 应用程序依赖于某种程度的后端数据源中的数据表示。 数据绑定控件已与动态 Web 应用程序中的数据进行交互的关键环节。 ASP.NET 2.0 引入了数据绑定控件，包括新 BaseDataBoundControl 类和声明性语法对一些显著改进。

BaseDataBoundControl 充当 DataBoundControl 类和 HierarchicalDataBoundControl 类的基类。 在此模块中，我们将讨论以下从 DataBoundControl 派生的类：

- AdRotator
- 列表控件
- GridView
- FormView
- DetailsView

我们将讨论以下从 HierarchicalDataBoundControl 类派生的类：

- TreeView
- 菜单
- SiteMapPath

## <a name="databoundcontrol-class"></a>DataBoundControl 类

DataBoundControl 类是使用与表格进行交互的抽象类 （标记 MustInherit 在 VB 中的） 或列表型数据。 以下控件是一些从 DataBoundControl 派生的控件。

## <a name="adrotator"></a>AdRotator

AdRotator 控件，可链接到特定 URL 的网页上显示一个图形的横幅。 旋转的图形，显示使用控件的属性。 可以使用配置页上的特定 ad 显示的频率**印记**可以使用关键字筛选已筛选属性和广告。

AdRotator 控件在数据库中使用的 XML 文件或表的数据。 在 XML 文件中使用以下属性来配置 AdRotator 控件。

### <a name="imageurl"></a>ImageUrl
若要显示的广告的图像的 URL。

### <a name="navigateurl"></a>NavigateUrl
单击广告时用户应转到 URL。 这应该是 URL 编码。

### <a name="alternatetext"></a>AlternateText
显示在工具提示中并由屏幕读取器读取备用文本。 此外会显示所指定的 ImageUrl 图像不可用时。

### <a name="keyword"></a>关键字
定义了可以使用关键字筛选时使用的关键字。 如果指定，将显示与关键字筛选器匹配的关键字的这些广告。

### <a name="impressions"></a>印记
加权数值，以确定可能出现的特定 ad 何种频率。 它是相对于同一文件中的其他广告的印象。 XML 文件中的所有广告集体印象的最大值为 2,048,000,000 1。

### <a name="height"></a>高度
Ad 以像素为单位的高度。

### <a name="width"></a>宽度
Ad 以像素为单位的宽度。

> [!NOTE]
> 高度和宽度属性重写的高度和宽度 AdRotator 控件本身。

典型的 XML 文件可能如下所示：

[!code-xml[Main](data-bound-controls/samples/sample1.xml)]

在上述示例中，contoso ad 两次可能是由于印记属性的值显示为 ASP.NET 网站上的 ad。

若要显示上述 XML 文件中的广告，向页面添加 AdRotator 控件并设置**广告文件**属性以指向 XML 文件，如下所示：

[!code-aspx[Main](data-bound-controls/samples/sample2.aspx)]

如果您选择要作为数据源的数据库表用于 AdRotator 控件，您首先需要设置使用以下架构的数据库：

| **列名称** | **数据类型** | **说明** |
| --- | --- | --- |
| Id | int | 主键。 此列可以具有任何名称。 |
| ImageUrl | nvarchar(*length*) | 相对或绝对 URL 的图像的显示广告。 |
| NavigateUrl | nvarchar(*length*) | Ad 目标 URL。 如果未提供一个值，则广告不是一个超链接。 |
| AlternateText | nvarchar(*length*) | 如果找不到该图像显示的文本。 在某些浏览器，为工具提示显示的文本。 替换文字，还用于可访问性，以便用户无法看到图形可以听到大声读出的说明。 |
| 关键字 | nvarchar(*length*) | Ad 页中可以筛选所依据的类别。 |
| 印记 | int(4) | 一个数字，指示通常如何显示广告的可能性。 较大的数字越频繁显示广告。 XML 文件中的所有印记值的总和不能超过 2,048,000,000-1。 |
| 宽度 | int(4) | 以像素为单位的图像的宽度。 |
| 高度 | int(4) | 以像素为单位的图像的高度。 |

在已有具有不同架构的数据库的情况下，可以使用**AlternateTextField**， **ImageUrlField**，并**NavigateUrlField**属性以映射AdRotator 属性到你的现有数据库。 若要在 AdRotator 控件中显示数据库中的数据，将数据源控件添加到页、 配置数据源控件以指向你的数据库的连接字符串和设置 AdRotator 控件**DataSourceID**属性设置为数据源控件的 ID。 其中有需求以编程方式配置 AdRotator 广告的情况下，使用 AdCreated 事件。 AdCreated 事件采用两个参数;一个对象，以及其他 AdCreatedEventArgs 的实例。 AdCreatedEventArgs 是对为其创建的 ad 的引用。

下面的代码段 ImageUrl、 NavigateUrl 和 AlternateText ad 以编程方式设置：

[!code-csharp[Main](data-bound-controls/samples/sample3.cs)]

## <a name="list-controls"></a>列表控件

列表控件包含 ListBox、 DropDownList、 CheckBoxList、 RadioButtonList 和 BulletedList。 每个控件可以绑定到数据源的数据。 它们在数据源中的一个字段用作显示文本，并可以选择使用项的值作为第二个字段。 项还可以添加静态设计时，并且可以混合使用静态项和动态从数据源添加的项。

数据绑定列表控件，将数据源控件添加到页。 指定数据源控件的选择命令，然后将列表控件的 DataSourceID 属性设置为数据源控件的 ID。 使用**DataTextField**并**DataValueField**属性以定义的显示文本和控件的值。 此外，还可以使用**DataTextFormatString**属性来控制显示文本的外观，如下所示：

| **表达式** | **说明** |
| --- | --- |
| 价格： {0:C} | 对于数字/小数数据。 显示文本"价格:"跟以货币格式的数字。 货币格式取决于在 culture 特性中指定的区域性设置**页**指令或 Web.config 文件中。 |
| {0:D4} | 对于整数数据。 不能和小数一起使用。 为四个字符宽的零填充的字段中显示整数。 |
| {0:N2}% | 对于数值数据。 显示带 2 位的数字精度跟文字"%"。 |
| {0:000.0} | 对于数字/小数数据。 数字舍入为一个小数位。 不到三位的数字用零填充。 |
| {0:D} | 对于日期/时间数据。 显示长日期格式 ("Thursday，August 06，1996")。 日期格式取决于页面或 Web.config 文件的区域性设置。 |
| {0:d} | 对于日期/时间数据。 显示短日期格式 ("12/31/99")。 |
| {0:yy-MM-dd} | 对于日期/时间数据。 数字年-月-日格式 (96-08-06) 中显示日期 |

## <a name="gridview"></a>GridView

GridView 控件允许表格数据显示和编辑使用声明性方法，是 DataGrid 控件的后续版本。 GridView 控件中提供了以下功能。

- 绑定到数据源控件，例如 SqlDataSource。
- 内置排序功能。
- 内置的更新和删除功能。
- 内置的分页功能。
- 内置的行选择功能。
- 以编程方式访问 GridView 对象模型来动态地设置属性，处理事件，等等。
- 多个键字段。
- 超链接列的多个数据字段。
- 通过主题和样式的自定义外观。

**列字段**

在 GridView 控件中的每个列是通过 DataControlField 对象表示。 默认情况下，AutoGenerateColumns 属性设置为 **，则返回 true**，用于在数据源中创建的每个字段的 AutoGeneratedField 对象。 每个字段然后呈现为每个字段在数据源中出现的顺序中的 GridView 控件中的列。 您可以手动控制哪一列中将显示字段**GridView**通过设置控件**AutoGenerateColumns**属性设置为**false**然后定义您自己列字段集合。 不同的列字段类型确定在控件中列的行为。

下表列出了可以使用不同的列字段类型。

| **列字段类型** | **说明** |
| --- | --- |
| BoundField | 数据源中显示的字段的值。 这是 GridView 控件的默认列类型。 |
| ButtonField | 在 GridView 控件中显示的每个项的命令按钮。 这样，您可以创建自定义按钮控件，如添加或删除按钮的列。 |
| CheckBoxField | 在 GridView 控件中显示每个项的复选框。 此列字段类型通常用于显示具有一个布尔值的字段。 |
| CommandField | 显示预定义的命令按钮以执行选择、 编辑或删除操作。 |
| HyperLinkField | 数据源中字段的值显示为超链接。 此列字段类型，可将第二个字段绑定到超链接的 URL。 |
| ImageField | 在 GridView 控件中显示的每个项图像。 |
| TemplateField | 显示用户定义的内容根据指定的模板在 GridView 控件中每个项。 此列字段类型，可创建自定义列字段。 |

若要以声明方式定义列字段集合，应首先添加左括号和右**&lt;列&gt;** 开始和结束标记的 GridView 控件之间的标记。 接下来，列出你想要包括的开始和结束之间的列字段**&lt;列&gt;** 标记。 指定的列添加到列集合中列出的顺序。 **列**集合存储所有列在控件中的字段，并允许您以编程方式管理 GridView 控件中的列字段。

显式声明的列字段可以显示与自动生成的列字段结合使用。 同时使用时，显式声明的列字段自动生成的列字段后跟第一次，呈现。

## <a name="binding-to-data"></a>绑定到数据

GridView 控件可以绑定到数据源控件 (如**SqlDataSource**， **ObjectDataSource**，依此类推)，以及实现 System.Collections.IEnumerable 任何数据源接口 （如 System.Data.DataView、 System.Collections.ArrayList 或 System.Collections.Hashtable）。 使用以下方法之一将 GridView 控件绑定到相应的数据源类型：

- 若要绑定到数据源控件，将 GridView 控件的 DataSourceID 属性设置为数据源控件的 ID 值。 GridView 控件自动将绑定到指定的数据源控件，并可以利用数据源控件的功能来执行排序、 更新、 删除和分页功能。 这是要将绑定到数据的首选的方法。
- 若要绑定到数据源实现 System.Collections.IEnumerable 接口，以编程方式将 GridView 控件的 DataSource 属性设置为数据源，然后调用 DataBind 方法。 使用此方法时，GridView 控件不提供内置的排序、 更新、 删除和分页功能。 您需要自行提供此功能。

## <a name="data-operations"></a>数据操作

GridView 控件提供了许多内置功能，允许用户排序、 更新、 删除、 选择和分页控件中的项。 GridView 控件绑定到数据源控件，GridView 控件可以利用数据源控件的功能，并提供自动排序、 更新和删除功能。

> [!NOTE]
> GridView 控件可以提供支持的排序、 更新和删除与其他类型的数据源;但是，需要一个相应的事件处理程序提供的这些操作的实现。

排序允许用户通过单击列标题排序某个特定列的 GridView 控件中的项。 若要启用排序，请将 AllowSorting 属性设置为 **，则返回 true**。

中的按钮时启用自动更新、 删除和选择功能**ButtonField**或**TemplateField**列字段中的，命令名称为"编辑"、"删除"和"Select"，单击分别。 可以将自动添加 GridView 控件**CommandField**具有编辑、 删除或如果 AutoGenerateEditButton、 AutoGenerateDeleteButton 或 AutoGenerateSelectButton 属性设置为选择按钮的列字段 **，则返回 true**分别。

> [!NOTE]
> 将记录插入到数据源不直接支持通过 GridView 控件。 但是，就可以通过使用结合 DetailsView GridView 控件或 FormView 控件将插入记录。

而不是在数据源中显示的所有记录，同时，GridView 控件可以自动分成记录页。 若要启用分页，请将 AllowPaging 属性设置为 **，则返回 true**。

## <a name="customizing-the-user-interface"></a>自定义用户界面

通过设置控件的不同部分的样式属性，可以自定义 GridView 控件的外观。 下表列出了不同的样式属性。

| **样式属性** | **说明** |
| --- | --- |
| AlternatingRowStyle | 在 GridView 控件中的交替数据行的样式设置。 数据行时设置此属性，RowStyle 设置之间交替显示和**AlternatingRowStyle**设置。 |
| EditRowStyle | 在 GridView 控件中正在编辑的行的样式设置。 |
| EmptyDataRowStyle | 数据源不包含任何记录时 GridView 控件中显示的空数据行的样式设置。 |
| FooterStyle | GridView 控件的脚注行的样式设置。 |
| HeaderStyle | GridView 控件的标题行的样式设置。 |
| PagerStyle | GridView 控件的页导航行的样式设置。 |
| RowStyle | 在 GridView 控件中的数据行的样式设置。 当**AlternatingRowStyle**属性也设置，显示数据行之间交替**RowStyle**设置和**AlternatingRowStyle**设置。 |
| SelectedRowStyle | 在 GridView 控件中的所选行的样式设置。 |

您还可以显示或隐藏控件的不同部分。 下表列出了用于控制哪些部分是显示还是隐藏的属性。

| **Property** | **说明** |
| --- | --- |
| ShowFooter | 显示或隐藏的脚注部分的 GridView 控件。 |
| ShowHeader | 显示或隐藏 GridView 控件的页眉节。 |

### <a name="events"></a>事件

GridView 控件提供了几个事件，可以对其进行编程。 这样，您可以运行自定义的例程，每当发生的事件。 下表列出了 GridView 控件支持的事件。

| **Event** | **说明** |
| --- | --- |
| PageIndexChanged | 在单击某一页导航按钮时，但在 GridView 控件处理分页操作。 当您需要执行的任务后用户导航到该控件中的其他页时，通常使用此事件。 |
| PageIndexChanging | 当单击某一页导航按钮时，但之前 GridView 控件处理分页操作时发生。 此事件通常用于取消分页操作。 |
| RowCancelingEdit | 当单击某一行的取消按钮，但在 GridView 控件之前退出编辑模式时发生。 此事件通常用于停止正在取消操作。 |
| RowCommand | 在 GridView 控件中单击的按钮时发生。 此事件通常用于在控件中单击的按钮时执行的任务。 |
| RowCreated | 在 GridView 控件中创建一个新行时发生。 此事件通常用于创建该行时修改行的内容。 |
| RowDataBound | 数据行绑定到 GridView 控件中的数据时发生。 此事件通常用于行绑定到数据时修改行的内容。 |
| RowDeleted | 在单击某一行的删除按钮，但在 GridView 控件从数据源中删除记录。 此事件通常用于检查删除操作的结果。 |
| RowDeleting | 当单击某一行的删除按钮，但之前 GridView 控件中删除记录从数据源时发生。 此事件通常用于取消删除操作。 |
| RowEditing | 当单击某一行的编辑按钮，但之前 GridView 控件进入编辑模式时发生。 此事件通常用于取消编辑操作。 |
| RowUpdated | 在单击某一行的更新按钮，但在 GridView 控件对该行进行更新。 此事件通常用于检查更新操作的结果。 |
| RowUpdating | 当单击某一行的更新按钮，但之前 GridView 控件对该行进行更新时发生。 此事件通常用于取消更新操作。 |
| SelectedIndexChanged | 在单击某一行的选择按钮，但在 GridView 控件处理选择操作。 此事件通常用于在控件中选择一行后执行的任务。 |
| SelectedIndexChanging | 当单击某一行的选择按钮，但之前 GridView 控件处理选择操作时发生。 此事件通常用于取消了选择操作。 |
| 排序 | 在单击超链接列进行排序，但在 GridView 控件处理排序操作。 此事件通常用于执行某项任务后在用户单击超链接以便对列进行排序。 |
| 排序 | 单击超链接列进行排序，但之前 GridView 控件处理排序操作时发生。 若要取消排序操作或执行自定义排序例程，通常使用此事件。 |

## <a name="formview"></a>FormView

FormView 控件用于显示来自数据源的单个记录。 它相当于 DetailsView 控件中，只是它显示用户定义的模板，而不是行字段。 创建您自己的模板，可以更灵活地控制数据的显示方式。 FormView 控件支持以下功能：

- 绑定到数据源控件，例如 SqlDataSource 和 ObjectDataSource。
- 内置插入功能。
- 内置的更新和删除功能。
- 内置的分页功能。
- 以编程方式访问 FormView 对象模型来动态地设置属性，处理事件，等等。
- 通过用户定义的模板、 主题和样式的自定义外观。

## <a name="templates"></a>模板

FormView 控件来显示内容，您需要创建该控件的不同部分的模板。 大多数模板是可选的;但是，必须创建一个模板，用于在其中配置该控件的模式。 例如，支持插入记录的 FormView 控件必须具有定义的插入项模板。 下表列出了可以创建不同的模板。

| **模板类型** | **说明** |
| --- | --- |
| EditItemTemplate | FormView 控件处于编辑模式时定义的数据行的内容。 此模板通常包含输入的控件和与该用户可以编辑现有记录的命令按钮。 |
| EmptyDataTemplate | 定义当 FormView 控件绑定到不包含任何记录的数据源时，显示的空数据行的内容。 此模板通常包含内容来提醒用户数据源不包含任何记录。 |
| FooterTemplate | 定义页脚行的内容。 此模板通常包含你想要的页脚行中显示的任何其他内容。 或者，可以只需指定要通过 FooterText 属性设置的脚注行中显示的文本。 |
| HeaderTemplate | 定义标头行的内容。 此模板通常包含你想要的标头行中显示的任何其他内容。 或者，可以只需指定要通过 HeaderText 属性设置的标头行中显示的文本。 |
| ItemTemplate | 定义数据行的内容时 FormView 控件处于只读模式。 此模板通常包含内容显示现有记录的值。 |
| InsertItemTemplate | FormView 控件处于插入模式时定义的数据行的内容。 此模板通常包含输入的控件和用户可以使用该对话框添加新记录的命令按钮。 |
| PagerTemplate | 定义分页功能启用时显示的页导航行的内容 (如果 AllowPaging 属性设置为 **，则返回 true**)。 此模板通常包含与其用户可以导航到另一条记录的控件。 |

编辑项模板和插入项模板中的输入的控件可以绑定到数据源的字段中，使用双向绑定表达式。 这使得 FormView 控件可以自动提取更新的输入控件的值或插入操作。 双向绑定表达式还允许编辑项模板可自动显示的原始字段值中的输入的控件。

### <a name="binding-to-data"></a>绑定到数据

FormView 控件可以绑定到数据源控件 (如**SqlDataSource**，AccessDataSource， **ObjectDataSource** ，等等)，或实现任何数据源System.Collections.IEnumerable 接口 （如 System.Data.DataView、 System.Collections.ArrayList 和 System.Collections.Hashtable）。 使用以下方法之一将 FormView 控件绑定到相应的数据源类型：

- 若要绑定到数据源控件，将 FormView 控件的 DataSourceID 属性设置为数据源控件的 ID 值。 FormView 控件自动将绑定到指定的数据源控件，并且可以充分利用数据源控件的功能来执行插入、 更新、 删除和分页功能。 这是要将绑定到数据的首选的方法。
- 若要绑定到实现的数据源**System.Collections.IEnumerable**接口，以编程方式将 FormView 控件的 DataSource 属性设置为数据源，然后调用 DataBind 方法。 使用此方法时，FormView 控件不提供内置的插入、 更新、 删除和分页功能。 需要提供此功能通过使用相应的事件。

## <a name="data-operations"></a>数据操作

FormView 控件提供了许多内置功能，以允许用户更新、 删除、 插入和翻页查看控件中的项。 FormView 控件绑定到数据源控件，FormView 控件可以利用数据源控件的功能，并提供自动更新、 删除、 插入和分页功能。 FormView 控件可为 update、 delete、 insert 和分页操作与其他类型的数据源; 提供支持但是，你必须提供的这些操作的实现相应的事件处理程序。

FormView 控件使用模板，因为它不提供用于自动生成命令按钮以执行更新、 删除或插入操作的方法。 您必须手动将这些命令按钮包括在适当的模板。 FormView 控件可识别具有某些按钮及其**CommandName**属性设置为特定值。 下表列出了 FormView 控件可识别的命令按钮。

| **Button** | **Commandname 值** | **说明** |
| --- | --- | --- |
| 取消 | "取消" | 用于更新或插入操作中取消操作并放弃由用户输入的值。 FormView 控件然后返回到 DefaultMode 属性指定的模式。 |
| 删除 | “Delete” | 在删除操作中用于从数据源中删除所显示的记录。 引发的 ItemDeleting 和 ItemDeleted 事件。 |
| Edit | "编辑" | 在更新操作中使用 FormView 控件置于编辑模式。 中指定的内容**EditItemTemplate**属性显示数据行。 |
| Insert | "插入" | 用于在插入操作中尝试使用由用户提供的值在数据源中插入一条新记录。 触发 ItemInserting 和 ItemInserted 事件。 |
| 新建 | "New" | 在插入操作中使用 FormView 控件置于插入模式。 中指定的内容**InsertItemTemplate**属性显示数据行。 |
| 页面 | "Page" | 在分页操作中用于表示执行分页的页导航行中的按钮。 若要指定分页操作，设置**CommandArgument**该按钮的"下一步"、"上一步"、"First"、"最后"，或要导航到页的索引的属性。 触发 PageIndexChanging 和 PageIndexChanged 事件。 |
| 更新 | "更新" | 用于在更新操作中尝试使用用户提供的值更新数据源中显示的记录。 触发 ItemUpdating 和 ItemUpdated 事件。 |

与不同的删除按钮 （此操作所显示的记录立即），单击编辑或新建按钮时的 FormView 控件进入编辑模式或分别插入模式。 在编辑模式下，内容包含在**EditItemTemplate**属性显示为当前数据项。 通常情况下，编辑项模板被定义以便编辑按钮替换为更新和取消按钮。 适用于字段的数据类型 （如 TextBox 或复选框控件） 的输入的控件通常还显示与用户若要修改的字段的值。 单击更新按钮更新数据源中的记录，而单击取消按钮会放弃所有更改。

同样中, 包含的内容**InsertItemTemplate**当控件处于插入模式时要显示的数据项属性。 插入项模板通常定义，以便新建按钮将替换 Insert 和取消按钮，并且空输入的控件显示用户输入新记录的值。 单击插入按钮在数据源中插入记录，而单击取消按钮会放弃所有更改。

FormView 控件提供分页功能，这样用户就可以导航到数据源中的其他记录。 启用时，包含页导航控件在 FormView 控件中显示页导航行。 若要启用分页，请设置**AllowPaging**属性设置为**true**。 通过设置 PagerStyle 中包含的对象的属性和通常情况下，可以自定义的页导航行。 而不是使用内置的页导航行用户界面，可以通过创建自己的用户界面**PagerTemplate**属性。

## <a name="customizing-the-user-interface"></a>自定义用户界面

通过设置控件的不同部分的样式属性，可以自定义 FormView 控件的外观。 下表列出了不同的样式属性。

| **样式属性** | **说明** |
| --- | --- |
| EditRowStyle | 在 FormView 控件时的数据行的样式设置编辑模式。 |
| EmptyDataRowStyle | 数据源不包含任何记录时 FormView 控件中显示的空数据行的样式设置。 |
| FooterStyle | FormView 控件的脚注行的样式设置。 |
| HeaderStyle | FormView 控件的标头行的样式设置。 |
| InsertRowStyle | 在 FormView 控件时的数据行的样式设置插入模式。 |
| PagerStyle | 启用分页功能时 FormView 控件中显示的页导航行的样式设置。 |
| RowStyle | FormView 控件在只读模式下时的数据行的样式设置。 |

## <a name="events"></a>事件

FormView 控件提供了几个事件，可以对其进行编程。 这样，您可以运行自定义的例程，每当发生的事件。 下表列出了支持 FormView 控件的事件。

| **Event** | **说明** |
| --- | --- |
| ItemCommand | 在 FormView 控件内单击时发生。 此事件通常用于在控件中单击的按钮时执行的任务。 |
| ItemCreated | 在 FormView 控件中创建所有 FormViewRow 对象之后发生。 此事件通常用于显示之前修改的记录的值。 |
| ItemDeleted | 删除按钮时发生 (与按钮其**CommandName**属性设置为"删除") 单击后，但后 FormView 控件从数据源中删除记录。 此事件通常用于检查删除操作的结果。 |
| ItemDeleting | 单击删除按钮，但之前 FormView 控件中删除记录从数据源时发生。 此事件通常用于取消删除操作。 |
| ItemInserted | 插入按钮时，会发生 (与按钮其**CommandName**属性设置为"插入") 单击后，但在 FormView 控件在将记录插入。 此事件通常用于检查 insert 操作的结果。 |
| ItemInserting | 单击插入按钮，但之前 FormView 控件插入记录时发生。 此事件通常用于取消插入操作。 |
| ItemUpdated | 更新按钮时发生 (与按钮其**CommandName**属性设置为"更新") 单击后，但后 FormView 控件对该行进行更新。 此事件通常用于检查更新操作的结果。 |
| ItemUpdating | 单击更新按钮，但之前 FormView 控件更新的记录时发生。 此事件通常用于取消更新操作。 |
| ModeChanged | FormView 控件更改模式之后发生 （到编辑、 插入或只读模式下）。 此事件通常用于执行某项任务时 FormView 控件更改模式。 |
| ModeChanging | 在 FormView 控件更改模式之前发生 （到编辑、 插入或只读模式下）。 此事件通常用于取消模式更改。 |
| PageIndexChanged | 在单击某一页导航按钮时，但在 FormView 控件处理分页操作。 当您需要执行的任务后用户导航到该控件中的不同记录时，通常使用此事件。 |
| PageIndexChanging | 当单击某一页导航按钮时，但之前 FormView 控件处理分页操作时发生。 此事件通常用于取消分页操作。 |

## <a name="detailsview"></a>DetailsView

DetailsView 控件用于在表中，显示来自数据源的单个记录的记录的每个字段的表的行中的显示位置。 它可以用于与 GridView 控件结合使用主-从方案。 在 DetailsView 控件支持以下功能：

- 绑定到数据源控件，例如 SqlDataSource。
- 内置插入功能。
- 内置的更新和删除功能。
- 内置的分页功能。
- 以编程方式访问的 DetailsView 对象模型来动态地设置属性，处理事件，等等。
- 通过主题和样式的自定义外观。

## <a name="row-fields"></a>行字段

在 DetailsView 控件中的每个数据行创建的声明字段控件。 不同的行字段类型确定在控件中的行的行为。 字段控件派生自 DataControlField。 下表列出了可以使用不同的行字段类型。

| **列字段类型** | **说明** |
| --- | --- |
| BoundField | 数据源中字段的值显示为文本。 |
| ButtonField | 在 DetailsView 控件中显示命令按钮。 这样，您可以显示具有自定义按钮控件，例如添加或删除按钮的行。 |
| CheckBoxField | 在 DetailsView 控件中显示一个复选框。 此行字段类型通常用于显示具有一个布尔值的字段。 |
| CommandField | 显示内置命令按钮以执行编辑、 插入或删除 DetailsView 控件中的操作。 |
| HyperLinkField | 数据源中字段的值显示为超链接。 此行字段类型，可将第二个字段绑定到超链接的 URL。 |
| ImageField | 在 DetailsView 控件中显示图像。 |
| TemplateField | 显示用户定义的内容根据指定的模板，DetailsView 控件中的行。 此行字段类型，可创建自定义行字段。 |

默认情况下，AutoGenerateRows 属性设置为 **，则返回 true**，该数据源中自动生成的绑定的行字段对象的每个字段的可绑定的类型。 有效的可绑定类型是字符串、 DateTime、 Decimal、 Guid、 和的基元类型的集合。 然后将每个字段显示在一行中为文本，在每个字段在数据源中的显示的顺序。

自动生成行提供快速而简单的方式来显示记录中的每个字段。 但是，若要使用的 DetailsView 控件的高级的功能必须显式声明要包含在 DetailsView 控件中的行字段。 若要声明的行字段，请首先设置**AutoGenerateRows**属性设置为**false**。 接下来，添加左括号和右**&lt;字段&gt;** 开始和结束标记的 DetailsView 控件之间的标记。 最后，列出你想要包括的开始和结束之间的行字段**&lt;字段&gt;** 标记。 指定的行字段添加到所列顺序中的字段集合。 **字段**集合允许你以编程方式管理 DetailsView 控件中的行字段。

> [!NOTE]
> 自动生成的行字段不会添加到字段集合。

## <a name="binding-to-data"></a>绑定到数据

在 DetailsView 控件可以绑定到数据源控件，如**SqlDataSource**或 AccessDataSource，或实现 System.Collections.IEnumerable 接口，如 System.Data.DataView，任何数据源System.Collections.ArrayList 和 System.Collections.Hashtable。

使用以下方法之一将 DetailsView 控件绑定到相应的数据源类型：

- 若要绑定到数据源控件，将 DetailsView 控件的 DataSourceID 属性设置为数据源控件的 ID 值。 在 DetailsView 控件自动将绑定到指定的数据源控件。 这是要将绑定到数据的首选的方法。
- 若要绑定到实现的数据源**System.Collections.IEnumerable**接口，以编程方式将 DetailsView 控件的 DataSource 属性设置为数据源，然后调用 DataBind 方法。

## <a name="security"></a>安全性

此控件用于显示用户输入，这可能包括恶意客户端脚本。 检查从客户端的可执行脚本、 SQL 语句或其他代码之前发送应用程序中显示的任何信息。 ASP.NET 提供了用户输入到脚本块和 HTML 的输入的请求验证功能。

## <a name="data-operations"></a>数据操作

DetailsView 控件提供内置功能，允许用户更新、 删除、 插入和翻页查看控件中的项。 DetailsView 控件绑定到数据源控件，DetailsView 控件可以利用数据源控件的功能，并提供自动更新、 删除、 插入和分页功能。

在 DetailsView 控件可为 update、 delete、 insert 和分页操作与其他类型的数据源; 提供支持但是，必须提供相应的事件处理程序中的这些操作的实现。

DetailsView 控件可自动添加**CommandField**带有编辑、 删除或新建按钮通过设置为AutoGenerateEditButton、AutoGenerateDeleteButton或AutoGenerateInsertButton属性的行字段 **，则返回 true**分别。 与不同的删除按钮 （这将删除所选的记录立即），单击编辑或新建按钮时，DetailsView 控件进入编辑或插入模式下，分别。 在编辑模式下，编辑按钮是更新和替换取消按钮。 用户若要修改的字段的值以显示适用于字段的数据类型 （如 TextBox 或复选框控件） 的输入的控件。 单击更新按钮更新数据源中的记录，而单击取消按钮会放弃所有更改。 同样，在插入模式下，使用 Insert 和取消按钮，替换新建按钮和空的输入的控件显示用户输入新记录的值。

在 DetailsView 控件提供分页功能，这样用户就可以导航到数据源中的其他记录。 启用时，页面导航控件显示在页导航行。 若要启用分页，请将 AllowPaging 属性设置为 **，则返回 true**。 可以使用 PagerStyle 和通常属性自定义的页导航行。

## <a name="customizing-the-user-interface"></a>自定义用户界面

通过设置控件的不同部分的样式属性，可以自定义 DetailsView 控件的外观。 下表列出了不同的样式属性。

| **样式属性** | **说明** |
| --- | --- |
| AlternatingRowStyle | 在 DetailsView 控件中的交替数据行的样式设置。 数据行时设置此属性，RowStyle 设置之间交替显示和**AlternatingRowStyle**设置。 |
| CommandRowStyle | 包含 DetailsView 控件中的内置命令按钮的行的样式设置。 |
| EditRowStyle | 当 DetailsView 控件中的数据行的样式设置编辑模式。 |
| EmptyDataRowStyle | 数据源不包含任何记录时 DetailsView 控件中显示的空数据行的样式设置。 |
| FooterStyle | 在 DetailsView 控件的脚注行的样式设置。 |
| HeaderStyle | 在 DetailsView 控件的标题行的样式设置。 |
| InsertRowStyle | 当 DetailsView 控件中的数据行的样式设置插入模式。 |
| PagerStyle | 在 DetailsView 控件的页导航行的样式设置。 |
| RowStyle | 在 DetailsView 控件中的数据行的样式设置。 当**AlternatingRowStyle**属性也设置，显示数据行之间交替**RowStyle**设置和**AlternatingRowStyle**设置。 |
| FieldHeaderStyle | 在 DetailsView 控件的标题列的样式设置。 |

## <a name="events"></a>事件

DetailsView 控件提供了几个事件，可以对其进行编程。 这样，您可以运行自定义的例程，每当发生的事件。 下表列出了支持 DetailsView 控件的事件。 DetailsView 控件也继承其基类添加这些事件：数据绑定、 数据绑定，释放，Init、 负载、 PreRender 和呈现。

| **Event** | **说明** |
| --- | --- |
| ItemCommand | 在 DetailsView 控件中单击的按钮时发生。 |
| ItemCreated | 在 DetailsView 控件中创建所有 DetailsViewRow 对象之后发生。 此事件通常用于显示之前修改的记录的值。 |
| ItemDeleted | 在单击删除按钮，但在 DetailsView 控件从数据源中删除记录。 此事件通常用于检查删除操作的结果。 |
| ItemDeleting | 单击删除按钮，但之前 DetailsView 控件中删除记录从数据源时发生。 此事件通常用于取消删除操作。 |
| ItemInserted | 在单击插入按钮，但在 DetailsView 控件插入记录。 此事件通常用于检查 insert 操作的结果。 |
| ItemInserting | 单击插入按钮，但之前 DetailsView 控件插入记录时发生。 此事件通常用于取消插入操作。 |
| ItemUpdated | 在单击更新按钮，但在 DetailsView 控件对该行进行更新。 此事件通常用于检查更新操作的结果。 |
| ItemUpdating | 单击更新按钮，但之前 DetailsView 控件更新的记录时发生。 此事件通常用于取消更新操作。 |
| ModeChanged | 在 DetailsView 控件更改模式 （编辑、 插入或只读模式下） 后发生。 此事件通常用于 DetailsView 控件更改模式时执行的任务。 |
| ModeChanging | 在 DetailsView 控件更改 （编辑、 插入或只读模式下） 的模式之前发生。 此事件通常用于取消模式更改。 |
| PageIndexChanged | 在单击某一页导航按钮时，但在 DetailsView 控件处理分页操作。 当您需要执行的任务后用户导航到该控件中的不同记录时，通常使用此事件。 |
| PageIndexChanging | 当单击某一页导航按钮时，但之前 DetailsView 控件处理分页操作时发生。 此事件通常用于取消分页操作。 |

## <a name="the-menu-control"></a>菜单控件

ASP.NET 2.0 中的菜单控件设计一个全功能导航系统。 它可以方便地提供给 SiteMapDataSource 等的分层数据源的数据绑定。

菜单控件结构可以以声明方式或动态定义并由单个根节点和任意数量的子节点组成。 以下代码以声明方式定义菜单控件的菜单。

[!code-aspx[Main](data-bound-controls/samples/sample4.aspx)]

在上述示例中，Home.aspx 节点是根节点。 所有其他节点都嵌套在不同级别的根节点。

有两种类型的菜单的菜单控件可以呈现;静态菜单和动态菜单。 始终是可见的菜单项的包含静态菜单。 仅当用户悬停鼠标时才可见的菜单项包含动态菜单。 与菜单以声明方式定义的静态菜单和动态菜单与将数据绑定在运行时的菜单，客户可能通常将相混淆。 实际上，动态和静态菜单与填充方法无关。 条款*静态*并*动态*仅指菜单是否是以静态方式显示默认情况下还是仅当用户执行某些操作时显示。

**StaticDisplayLevels**属性用于配置菜单的多少个级别是静态的因此默认情况下显示。 在上述示例中，设置**StaticDisplayLevels**属性的值为 2 会导致要以静态方式显示主节点、 音乐节点和电影节点的菜单。 当用户悬停在父节点时，会动态显示的所有其他节点。

**MaximumDynamicDisplayLevels**属性配置的最大数目的动态级别菜单是能够显示。 级别高于指定的值的任何动态菜单**MaximumDynamicDisplayLevels**属性将被丢弃。

> [!NOTE]
> 它是几乎可以肯定你可能会遇到菜单看起来由于 MaximumDynamicDisplayLevels 属性而呈现的情况。 在这些情况下，确保足够设置属性以允许客户菜单显示。

## <a name="data-binding-the-menu-control"></a>数据绑定的菜单控件

菜单控件可以绑定到 SiteMapDataSource 或 XMLDataSource 等任何分层数据源。 SiteMapDataSource 是最常用方法以便数据绑定到菜单控件因为将从下的 Web.sitemap 文件馈送，并且其架构提供了一个已知的 API 为菜单控件。 下面的列表显示了一个简单的 Web.sitemap 文件。

[!code-xml[Main](data-bound-controls/samples/sample5.xml)]

请注意，只有一个根 siteMapNode 元素，在这种情况下，主页元素。 可以为每个 siteMapNode 配置多个属性。 最常使用的属性包括：

- **url**指定用户点击的菜单项时要显示的 URL。 如果不存在此属性，则仅返回单击时，只需将发送节点。
- **标题**指定菜单项显示的文本。
- **说明**用于作为文档的节点。 此外显示为工具提示，当鼠标悬停于节点上。
- **siteMapFile**允许嵌套的站点地图。 此属性必须指向正确的 ASP.NET 站点地图文件。
- **角色**允许的节点的外观由 ASP.NET 安全修整控制。

请注意，尽管这些属性都是可选的菜单上的行为可能不是预期如果未指定。 例如，如果*url*指定属性，但*说明*属性不是，该节点将不可见并且会有无法导航到指定的 URL。

## <a name="controlling-a-menus-operation"></a>控制菜单操作

有几个属性会影响 ASP.NET 菜单控件; 的操作**方向**属性， **DisappearAfter**属性， **StaticItemFormatString**属性，并**StaticPopoutImageUrl**属性是几种。

- **方向**可以设置为*水平*或*垂直*并控制是否在行中或垂直水平布局并堆积在静态菜单项另一个。 此属性不会影响动态菜单。
- **DisappearAfter**属性配置鼠标后，动态菜单应保持可见的时间长移开它。 毫秒为单位，默认值为 500 中指定的值。 此属性设置为值为-1 将导致永远不会自动消失的菜单。 在这种情况下，当用户单击菜单之外，仅将消失菜单。
- **StaticItemFormatString**属性，则可以轻松地维护一致的措辞菜单系统中。 指定此属性时*{0}* 应输入代替数据源中显示的说明。 例如，为了获得从练习 1 say 请访问我们的产品页的菜单项，等等，会指定，请访问我们{0}StaticItemFormatString 的页。 在运行时，ASP.NET 将替换出现的任何{0}与菜单项的正确描述。
- **StaticPopoutImageUrl**属性指定用来指示特定菜单节点具有子节点，可通过将鼠标悬停其上的图像。 动态菜单将继续使用默认图像。

## <a name="templated-menu-controls"></a>模板化菜单控件

菜单控件是模板化控件，适用于两个不同的项模板;StaticItemTemplate 和 DynamicItemTemplate。 使用这些模板，你可以轻松地添加服务器控件或用户控件菜单。

若要编辑的模板在 Visual Studio.NET 中，单击菜单上的智能标记按钮，然后选择编辑模板。 然后可以编辑 StaticItemTemplate 或 DynamicItemTemplate 之间进行选择。

在页面加载时，添加到 StaticItemTemplate 任何控件将显示在静态菜单中。 添加到 DynamicItemTemplate 任何控件将显示所有的弹出菜单上。

## <a name="menu-events"></a>菜单事件

菜单控件具有两个事件，是唯一的**MenuItemClicked**并**MenuItemDatabound**事件。

单击菜单项时引发 MenuItemClicked 事件。 数据绑定的菜单项时引发 MenuItemDatabound 事件。 **MenuEventArgs**传递到事件处理程序提供了对通过项目属性菜单项的访问。

## <a name="controlling-a-menus-appearance"></a>控制菜单外观

此外会影响菜单控件使用一个或多个格式菜单可供许多样式的外观。 其中包括**StaticMenuStyle**， **DynamicMenuStyle**， **DynamicMenuItemStyle**， **DynamicSelectedStyle**，和**DynamicHoverStyle**。 使用标准的 HTML 样式字符串配置这些属性。 例如，以下会影响动态菜单的样式。

[!code-aspx[Main](data-bound-controls/samples/sample6.aspx)]

> [!NOTE]
> 如果使用的任何悬停样式，则需要添加&lt;head&gt;到包含的页中的元素*runat*元素设置为*server*。

菜单控件还支持使用 ASP.NET 2.0 主题。

## <a name="the-treeview-control"></a>TreeView 控件

TreeView 控件中的树状结构显示数据。 使用菜单控件，如能轻松地绑定到 SiteMapDataSource 等任何分层数据源的数据。

客户有可能要询问有关 ASP.NET 2.0 中的树视图控件的第一个问题是是否与适用于 ASP.NET TreeView IE WebControl 1.x。 不是这样。 ASP.NET 2.0 TreeView 控件从头开始编写，并通过以前提供 IE TreeView WebControl 提供显著的改进。

我不会详细介绍如何将 TreeView 控件绑定到站点地图，因为它执行中为菜单控件完全相同的方式。 但是，树视图控件具有对它进行操作的方法中一些不同差异。

默认情况下，显示完全展开树视图控件。 若要更改的初始加载时扩展级别，修改**ExpandDepth**控件的属性。 这是在树视图的数据绑定时展开特定节点情况下尤为重要。

## <a name="databinding-the-treeview-control"></a>TreeView 控件的数据绑定

与不同的菜单控件，在树视图非常适合处理大量的数据。 因此，除了数据绑定到 SiteMapDataSource 或 XMLDataSource，在树视图通常是数据绑定到数据集或其他关系数据。 在这里 TreeView 控件绑定到的数据量大的情况下，最好要绑定到控件中可见的数据。 可以在数据绑定到其他数据，展开树视图节点。

在这些情况下， **PopulateOnDemand**树视图的属性应设置为*true*。 然后需要为提供一个实现**TreeNodePopulate**方法。

## <a name="data-binding-without-postback"></a>数据绑定而不回发

请注意，当第一次展开上一示例中的节点，在页回发和刷新。 这是不是问题在此示例中，但您可以想象，可能会在生产环境中使用大量的数据。 更好的方案将是一个在其中在树视图将仍动态填充节点，但没有 post 回发给服务器。

通过设置**获知**并**PopulateOnDemand**为 true，ASP.NET TreeView 控件的属性动态填充没有一种回发的节点。 展开父节点时，从客户端进行的 XMLHttp 请求，并且 OnTreeNodePopulate 事件被激发。 服务器响应使用 XML 数据岛的数据然后使用该绑定的子节点。

ASP.NET 动态创建实现此功能的客户端代码。 &lt;脚本&gt;标记，包含该脚本将生成指向 AXD 文件。 例如，下面的列表显示了生成 XMLHttp 请求的脚本代码的脚本链接。

[!code-html[Main](data-bound-controls/samples/sample7.html)]

如果您在浏览器中浏览上面的 AXD 文件并将其打开，您将看到实现 XMLHttp 请求的代码。 此方法会阻止客户修改脚本文件。

## <a name="controlling-the-operation-of-the-treeview-control"></a>控制 TreeView 控件的操作

TreeView 控件具有多个属性会影响控件的操作。 最明显的属性是**ShowCheckBoxes**， **ShowExpandCollapse**，并**ShowLines**。

**ShowCheckBoxes**属性影响是否节点显示在呈现时的复选框。 此属性的有效值为**无**，**根**，**父**，**叶**，并**所有**。 这些会影响树视图控件，如下所示：

| **属性值** | **效果** |
| --- | --- |
| None | 复选框不会显示任何节点上。 此为默认设置。 |
| 根 | 仅在根节点上显示一个复选框。 |
| 父级 | 这些节点具有子节点上只显示一个复选框。 这些子节点可以是父节点或叶节点。 |
| 叶 | 仅在没有子节点的节点上将显示一个复选框。 |
| 全部 | 一个复选框显示在所有节点上。 |

当使用复选框时， **CheckedNodes**属性将返回回发时检查的树视图节点的集合。

**ShowExpandCollapse**属性控制的根节点和父节点旁边的展开/折叠图像的外观。 如果此属性设置为**false**，树视图节点呈现为超链接，并通过单击链接会展开/折叠。

**ShowLines**属性控制是否行显示连接到子节点的父节点。 当**false** （默认值），将显示任何行。 当 **，则返回 true**，TreeView 控件将在指定的文件夹中使用行图像**LineImagesFolder**属性。

若要自定义 TreeView 行的外观，Visual Studio.NET 2005年包含行设计器工具。 您可以访问此工具使用以下形式表示的树视图控件上的智能标记按钮。

![](data-bound-controls/_static/image1.jpg)

**图 1**

当选择**自定义行图像**菜单选项将启动行设计器工具，允许你配置 TreeView 行的外观。

## <a name="treeview-events"></a>树视图事件

TreeView 控件具有唯一的以下事件：

- 选择一个节点时发生 SelectedNodeChanged 基于**SelectAction**属性。
- TreeNodeCheckChanged 节点 checkboxs 状态发生更改时发生。
- 展开某个节点时发生 TreeNodeExpanded 基于**SelectAction**属性。
- 当节点处于折叠状态，TreeNodeCollapsed 时发生。
- 节点是数据时发生 TreeNodeDataBound 绑定。
- TreeNodePopulate 填充一个节点时发生。

**SelectAction**属性允许您配置选择节点时激发的事件。 SelectAction 属性提供了以下操作：

- TreeNodeSelectAction.Expand 引发 TreeNodeExpanded 时选择的节点。
- TreeNodeSelectAction.None 引发任何事件时选择的节点。
- 值引发 SelectedNodeChanged 事件时选择的节点。
- TreeNodeSelectAction.SelectExpand 引发 SelectedNodeChanged 事件和 TreeNodeExpanded 事件时选择的节点。

## <a name="controlling-appearance-with-styles"></a>控制使用样式的外观

TreeView 控件提供许多属性用于控制使用样式控件的外观。 提供了以下属性。

| **属性名称** | **控件** |
| --- | --- |
| HoverNodeStyle | 当鼠标悬停在其将控制节点的样式。 |
| LeafNodeStyle | 控制叶节点的样式。 |
| NodeStyle | 控制的所有节点的样式。 特定的节点样式 （如 LeafNodeStyle) 重写此样式。 |
| ParentNodeStyle | 控制所有父节点的样式。 |
| RootNodeStyle | 控制的根节点的样式。 |
| SelectedNodeStyle | 控制所选节点的样式。 |

每个属性是只读的。 但是，它们将每个返回**TreeNodeStyle**对象，该对象的属性可以修改和使用*属性子属性*格式。 例如，若要设置**ForeColor**的属性**SelectedNodeStyle**，请使用以下语法：

[!code-aspx[Main](data-bound-controls/samples/sample8.aspx)]

请注意，上面的标记未关闭。 这是因为使用声明性语法如下所示时，应在的 HTML 代码中包括的 Treeview 节点。

此外可以在代码中使用指定的样式属性*property.subproperty*格式。 例如，若要设置**ForeColor**的属性**RootNodeStyle**在代码中，使用以下语法：

[!code-csharp[Main](data-bound-controls/samples/sample9.cs)]

> [!NOTE]
> 不同的样式属性的完整列表，请参阅 TreeNodeStyle 对象上的 MSDN 文档。

## <a name="the-sitemappath-control"></a>SiteMapPath 控件

SiteMapPath 控件为 ASP.NET 开发人员提供面包痕迹导航导航控件。 其他导航控件，如能轻松地绑定到分层数据源，如 XmlDataSource 或 SiteMapDataSource 的数据。

站点地图路径控件 SiteMapNodeItem 对象组成。 有三种类型的节点;根节点、 父节点和当前节点。 根节点是位于层次结构顶部的节点。 当前节点表示当前页。 所有其他节点的父节点。

## <a name="controlling-the-operation-of-the-sitemappath-control"></a>控制 SiteMapPath 控件的操作

控制操作的 SiteMapPath 控件的属性如下所示：

| **Property** | **属性的说明** |
| --- | --- |
| ParentLevelsDisplayed | 控制显示多少个父节点。 默认值为-1 显示的父节点的数目没有限制。 |
| PathDirection | 控制 SiteMapPath 的方向。 有效值为 RootToCurrent （默认值） 和 CurrentToRoot。 |
| PathSeparator | 一个字符串，用于控制分隔 SiteMapPath 控件中的节点的字符。 默认值是:。 |
| RenderCurrentNodeAsLink | 一个布尔值，该值控制将当前节点呈现为链接。 默认值为 False。 |
| SkipLinkText | 具有可访问性由屏幕阅读器查看页时的帮助。 此属性允许屏幕阅读器跳过 SiteMapPath 控件。 若要禁用此功能，请将属性设置为 String.Empty。 |

## <a name="templated-sitemappath-controls"></a>模板化 SiteMapPath 控件

SiteMapControl 是模板化控件，并在这种情况下，可以定义为使用不同的模板中显示控件。 若要编辑 SiteMapPath 控件中的模板，请单击智能标记按钮在控件上的并从菜单中选择编辑模板。 这将显示 SiteMapTasks 菜单上，你可以选择之间可用的不同模板如下所示。

![](data-bound-controls/_static/image2.jpg)

**图 2**

**NodeTemplate**模板是指 SiteMapPath 中的任何节点。 如果节点是根节点或当前节点和**RootNodeTemplate**或**CurrentNodeTemplate**是配置，NodeTemplate 被重写。

## <a name="sitemappath-events"></a>SiteMapPath Events

SiteMapPath 控件具有两个事件，不派生自控件类中;**ItemCreated**事件并**ItemDataBound**事件。 创建一个 SiteMapPath 项时引发 ItemCreated 事件。 ItemDataBound SiteMapPath 节点的数据绑定期间调用 DataBind 方法时引发。 一个**SiteMapNodeItemEventArgs**对象提供对特定 SiteMapNodeItem 通过项属性的访问。

## <a name="controlling-appearance-with-styles"></a>控制使用样式的外观

以下样式都适用于 SiteMapPath 控件的格式设置。

| **属性名称** | **控件** |
| --- | --- |
| CurrentNodeStyle | 控制对当前节点文本的样式。 |
| RootNodeStyle | 控制的根节点的文本的样式。 |
| NodeStyle | 控制假设 CurrentNodeStyle 或 RootNodeStyle 不适用于所有节点的文本的样式。 |

NodeStyle 属性由 CurrentNodeStyle 或 RootNodeStyle 重写。 每个属性是只读的并返回**样式**对象。 若要影响使用这些属性之一的节点的外观，将需要设置返回的样式对象的属性。 例如，下面的代码更改当前节点的前景色属性。

[!code-aspx[Main](data-bound-controls/samples/sample10.aspx)]

此外可以按如下所示以编程方式应用该属性：

[!code-csharp[Main](data-bound-controls/samples/sample11.cs)]

> [!NOTE]
> 如果应用了模板，将不会应用样式。

## <a name="lab-1-configuring-an-aspnet-menu-control"></a>实验室 1:配置 ASP.NET 菜单控件

1. 创建新的 Web 站点。
2. 通过选择文件、 新建、 文件并从文件模板的列表中选择站点图中添加一个站点地图文件。
3. 打开站点图 (默认情况下的 Web.sitemap) 并对其进行修改，以便其类似于下面的列表。 实际上不存在您链接的站点映射文件中的页，但那些不会在本练习的问题。

    [!code-xml[Main](data-bound-controls/samples/sample12.xml)]
4. 在设计视图中打开默认 Web 窗体。
5. 从工具箱中的导航部分中，将新的 Menu 控件添加到页面。
6. 从工具箱中的数据部分中，添加新 SiteMapDataSource。 SiteMapDataSource 将自动使用在你的站点下的 Web.sitemap 文件。 (下的 Web.sitemap 文件*必须*位于站点根文件夹中。)
7. 单击菜单控件，然后单击智能标记按钮以显示菜单任务对话框。
8. 在选择数据源下拉列表中，选择 SiteMapDataSource1。
9. 单击自动套用格式链接和为菜单中选择一种格式。
10. 在属性窗格中设置**StaticDisplayLevels**属性设置为 2。 菜单控件现在应在设计器中显示主页、 产品和服务节点。
11. 浏览在浏览器使用的菜单中的页。 （因为你已添加到站点地图的页面实际上不存在，您会看到错误时尝试并浏览到它们。）

试着更改 StaticDisplayLevels 和 MaximumDynamicDisplayLevels 属性并查看它们如何影响菜单上的呈现方式。

## <a name="lab-2-dynamically-binding-a-treeview-control"></a>实验室 2:动态绑定 TreeView 控件

此练习假定本地运行的 SQL Server 以及 Northwind 数据库存在 SQL Server 实例上。 如果不满足这些条件，请更改该示例中的连接字符串。 请注意，可能需要指定 SQL Server 身份验证而不是受信任连接。

1. 创建新的 Web 站点。
2. 切换到 Default.aspx 的代码视图和所有代码都替换为下面列出的代码。 

    [!code-aspx[Main](data-bound-controls/samples/sample13.aspx)]
3. 作为 treeview.aspx 保存该页。
4. 浏览页面。
5. 当第一次显示页面时，在浏览器中查看页面的源代码。 请注意，仅存在于可见节点已发送到客户端。
6. 单击任何节点旁边的加号。
7. 在页上再次查看源。 请注意，新显示的节点现在存在。

## <a name="lab-3-details-view-and-editing-data-using-a-gridview-and-detailsview"></a>实验 3:详细信息视图和编辑使用 GridView 和 DetailsView 数据

1. 创建新的 Web 站点。
2. 将新的 web.config 文件添加到网站。
3. 将连接字符串添加到 web.config 文件，如下所示： 

    [!code-xml[Main](data-bound-controls/samples/sample14.xml)]

    > [!NOTE]
    > 您可能需要更改连接字符串基于您的环境。
4. 保存并关闭 web.config 文件。
5. 打开 Default.aspx 并添加新的 SqlDataSource 控件。
6. 更改该 SqlDataSource 控件的 ID**产品**。
7. 在中**SqlDataSource 任务**菜单上，单击**配置数据源**。
8. 选择**Northwind**连接下拉列表中单击下一步。
9. 选择**产品**从**名称**下拉列表中，并检查**ProductID**， **ProductName**， **UnitPrice**，并**UnitsInStock**复选框，如下所示。 

![](data-bound-controls/_static/image3.jpg)

    **Figure 3**
10. 单击 **“下一步”**。
11. 单击 **“完成”**。
12. 切换到源视图，并检查生成的代码。 请注意**SelectCommand**， **DeleteCommand**， **InsertCommand**，以及**UpdateCommand** ，已添加到 SqlDataSource控件。 此外请注意已添加的参数。
13. 切换到设计视图，并将新的 GridView 控件添加到页面。
14. 选择**产品**从**选择数据源**下拉列表。
15. 检查**启用分页**并**启用选定内容**，如下所示。 

![](data-bound-controls/_static/image4.jpg)

    **Figure 4**
16. 单击**编辑列**链接，然后确保**自动生成字段**检查。
17. 单击 **“确定”**。
18. GridView 控件被选定，单击的按钮旁边**DataKeyNames**属性窗格中的属性。
19. 选择**ProductID**从**可用的数据字段**列表中，单击**&gt;** 按钮进行添加。
20. 单击“确定”。
21. 将新的 SqlDataSource 控件添加到页面。
22. 更改该 SqlDataSource 控件的 ID**详细信息**。
23. 从 SqlDataSource 任务菜单中选择**配置数据源**。
24. 选择**Northwind**从下拉列表中，单击**下一步**。
25. 选择<strong>产品</strong>从<strong>名称</strong>下拉列表中，并检查<strong> \</ s > * 中的复选框<strong>列</strong>列表框。
26. 单击**其中**按钮。
27. 选择**ProductID**从**列**下拉列表。
28. 选择**=** 运算符下拉列表中。
29. 选择**控制**从**源**下拉列表。
30. 选择**GridView1**从**控件 ID**下拉列表。
31. 单击**添加**按钮以添加 WHERE 子句。
32. 单击 **“确定”**。
33. 单击**高级**按钮，并检查**生成 INSERT、 UPDATE 和 DELETE 语句**复选框。
34. 单击 **“确定”**。
35. 单击**下一步**然后单击**完成**。
36. 添加到页面的 DetailsView 控件。
37. 在中**选择数据源**下拉列表中，选择**详细信息**。
38. 检查**启用编辑**复选框，如下所示。 

![](data-bound-controls/_static/image1.gif)

    **Figure 5**
39. 保存页面，并浏览 Default.aspx。
40. 单击**选择**不同的记录，以自动查看的 DetailsView 更新旁边的链接。
41. 单击**编辑**DetailsView 控件中的链接。
42. 对记录进行更改，然后单击**更新**。

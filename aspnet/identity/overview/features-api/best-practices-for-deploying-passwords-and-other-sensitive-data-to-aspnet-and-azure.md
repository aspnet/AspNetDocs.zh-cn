---
uid: identity/overview/features-api/best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure
title: 将密码和其他敏感数据部署到 ASP.NET 和 Azure App Service-ASP.NET 4。x
author: Rick-Anderson
description: 本教程介绍你的代码如何安全地存储和访问安全信息。 最重要的一点是，切勿存储密码或其他 sen。
ms.author: riande
ms.date: 05/21/2015
ms.assetid: 97902c66-cb61-4d11-be52-73f962f2db0a
ms.custom: seoapril2019
msc.legacyurl: /identity/overview/features-api/best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure
msc.type: authoredcontent
ms.openlocfilehash: 8356a90611f791779cc4ff4730038d82cd76242f
ms.sourcegitcommit: 7709c0a091b8d55b7b33bad8849f7b66b23c3d72
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 02/19/2020
ms.locfileid: "77457045"
---
# <a name="best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure-app-service"></a><span data-ttu-id="8a596-104">向 ASP.NET 和 Azure 应用服务部署密码和其他敏感数据的最佳做法</span><span class="sxs-lookup"><span data-stu-id="8a596-104">Best practices for deploying passwords and other sensitive data to ASP.NET and Azure App Service</span></span>

<span data-ttu-id="8a596-105">作者： [Rick Anderson](https://twitter.com/RickAndMSFT)</span><span class="sxs-lookup"><span data-stu-id="8a596-105">by [Rick Anderson](https://twitter.com/RickAndMSFT)</span></span>

> <span data-ttu-id="8a596-106">本教程介绍你的代码如何安全地存储和访问安全信息。</span><span class="sxs-lookup"><span data-stu-id="8a596-106">This tutorial shows how your code can securely store and access secure information.</span></span> <span data-ttu-id="8a596-107">最重要的一点是，切勿在源代码中存储密码或其他敏感数据，并且不应在开发和测试模式下使用生产机密。</span><span class="sxs-lookup"><span data-stu-id="8a596-107">The most important point is you should never store passwords or other sensitive data in source code, and you shouldn't use production secrets in development and test mode.</span></span>
> 
> <span data-ttu-id="8a596-108">示例代码是一个简单的 WebJob 控制台应用程序和一个需要访问数据库连接字符串 password、Twilio、Google 和 SendGrid 安全密钥的 ASP.NET MVC 应用程序。</span><span class="sxs-lookup"><span data-stu-id="8a596-108">The sample code is a simple WebJob console app and a ASP.NET MVC app that needs access to a database connection string password, Twilio, Google and SendGrid secure keys.</span></span>
> 
> <span data-ttu-id="8a596-109">此外，还介绍了本地设置和 PHP。</span><span class="sxs-lookup"><span data-stu-id="8a596-109">On premise settings and PHP is also mentioned.</span></span>

- [<span data-ttu-id="8a596-110">在开发环境中使用密码</span><span class="sxs-lookup"><span data-stu-id="8a596-110">Working with passwords in the development environment</span></span>](#pwd)
- [<span data-ttu-id="8a596-111">使用开发环境中的连接字符串</span><span class="sxs-lookup"><span data-stu-id="8a596-111">Working with connection strings in the development environment</span></span>](#con)
- [<span data-ttu-id="8a596-112">Web 作业控制台应用</span><span class="sxs-lookup"><span data-stu-id="8a596-112">WebJobs console apps</span></span>](#wj)
- [<span data-ttu-id="8a596-113">将机密部署到 Azure</span><span class="sxs-lookup"><span data-stu-id="8a596-113">Deploying secrets to Azure</span></span>](#da)
- [<span data-ttu-id="8a596-114">本地和 PHP 说明</span><span class="sxs-lookup"><span data-stu-id="8a596-114">Notes for On-Premise and PHP</span></span>](#not)
- [<span data-ttu-id="8a596-115">其他资源</span><span class="sxs-lookup"><span data-stu-id="8a596-115">Additional Resources</span></span>](#addRes)

<a id="pwd"></a>
## <a name="working-with-passwords-in-the-development-environment"></a><span data-ttu-id="8a596-116">在开发环境中使用密码</span><span class="sxs-lookup"><span data-stu-id="8a596-116">Working with passwords in the development environment</span></span>

<span data-ttu-id="8a596-117">教程经常在源代码中显示敏感数据，但愿您一定不要将敏感数据存储在源代码中。</span><span class="sxs-lookup"><span data-stu-id="8a596-117">Tutorials frequently show sensitive data in source code, hopefully with a caveat that you should never store sensitive data in source code.</span></span> <span data-ttu-id="8a596-118">例如，我[的 ASP.NET MVC 5 应用程序与 SMS 和 EMAIL 2FA](../../../mvc/overview/security/aspnet-mvc-5-app-with-sms-and-email-two-factor-authentication.md) *教程在 web.config 文件中*显示以下内容：</span><span class="sxs-lookup"><span data-stu-id="8a596-118">For example, my [ASP.NET MVC 5 app with SMS and email 2FA](../../../mvc/overview/security/aspnet-mvc-5-app-with-sms-and-email-two-factor-authentication.md) tutorial shows the following in the *web.config* file:</span></span>

[!code-xml[Main](best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure/samples/sample1.xml)]

<span data-ttu-id="8a596-119">Web.config*文件是*源代码，因此这些机密永远不会存储在该文件中。</span><span class="sxs-lookup"><span data-stu-id="8a596-119">The *web.config* file is source code, so these secrets should never be stored in that file.</span></span> <span data-ttu-id="8a596-120">幸运的是，`<appSettings>` 元素具有一个 `file` 属性，可用于指定包含敏感应用程序配置设置的外部文件。</span><span class="sxs-lookup"><span data-stu-id="8a596-120">Fortunately, the `<appSettings>` element has a `file` attribute that allows you to specify an external file that contains sensitive app config settings.</span></span> <span data-ttu-id="8a596-121">只要外部文件未签入源树，就可以将所有机密移动到外部文件。</span><span class="sxs-lookup"><span data-stu-id="8a596-121">You can move all your secrets to an external file as long as the external file is not checked into your source tree.</span></span> <span data-ttu-id="8a596-122">例如，在以下标记中，文件*AppSettingsSecrets*包含所有应用机密：</span><span class="sxs-lookup"><span data-stu-id="8a596-122">For example, in the following markup, the file *AppSettingsSecrets.config* contains all the app secrets:</span></span>

[!code-xml[Main](best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure/samples/sample2.xml)]

<span data-ttu-id="8a596-123">外部文件（在本示例中为*AppSettingsSecrets* ）中的标记是在*web.config 文件中*找到的相同标记：</span><span class="sxs-lookup"><span data-stu-id="8a596-123">The markup in the external file (*AppSettingsSecrets.config* in this sample), is the same markup found in the *web.config* file:</span></span>

[!code-xml[Main](best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure/samples/sample3.xml)]

<span data-ttu-id="8a596-124">ASP.NET 运行时将外部文件的内容与 &lt;appSettings&gt; 元素中的标记合并。</span><span class="sxs-lookup"><span data-stu-id="8a596-124">The ASP.NET runtime merges the contents of the external file with the markup in &lt;appSettings&gt; element.</span></span> <span data-ttu-id="8a596-125">如果找不到指定的文件，运行时会忽略文件属性。</span><span class="sxs-lookup"><span data-stu-id="8a596-125">The runtime ignores the file attribute if the specified file cannot be found.</span></span>

> [!WARNING]
> <span data-ttu-id="8a596-126">安全性-不要将您的*机密 .config*文件添加到项目或将其签入源代码管理。</span><span class="sxs-lookup"><span data-stu-id="8a596-126">Security - Do not add your *secrets .config* file to your project or check it into source control.</span></span> <span data-ttu-id="8a596-127">默认情况下，Visual Studio 会将 `Build Action` 设置为 `Content`，这意味着该文件已部署。</span><span class="sxs-lookup"><span data-stu-id="8a596-127">By default, Visual Studio sets the `Build Action` to `Content`, which means the file is deployed.</span></span> <span data-ttu-id="8a596-128">有关详细信息，请参阅[为何我的项目文件夹中的所有文件都已部署？](https://msdn.microsoft.com/library/ee942158(v=vs.110).aspx#can_i_exclude_specific_files_or_folders_from_deployment)</span><span class="sxs-lookup"><span data-stu-id="8a596-128">For more information see [Why don't all of the files in my project folder get deployed?](https://msdn.microsoft.com/library/ee942158(v=vs.110).aspx#can_i_exclude_specific_files_or_folders_from_deployment)</span></span> <span data-ttu-id="8a596-129">虽然你可以将任何扩展用于该*密钥*文件，但最好是将其保留为 .config，因为 IIS 不提供配置文件 *。*</span><span class="sxs-lookup"><span data-stu-id="8a596-129">Although you can use any extension for the *secrets .config* file, it's best to keep it *.config*, as config files are not served by IIS.</span></span> <span data-ttu-id="8a596-130">另请注意， *AppSettingsSecrets* *文件是 web.config 文件中*的两个目录级别，因此它完全超出了解决方案目录。</span><span class="sxs-lookup"><span data-stu-id="8a596-130">Notice also that the *AppSettingsSecrets.config* file is two directory levels up from the *web.config* file, so it's completely out of the solution directory.</span></span> <span data-ttu-id="8a596-131">通过将文件移出解决方案目录，&quot;git add \*&quot; 不会将其添加到存储库中。</span><span class="sxs-lookup"><span data-stu-id="8a596-131">By moving the file out of the solution directory, &quot;git add \*&quot; won't add it to your repository.</span></span>

<a id="con"></a>
## <a name="working-with-connection-strings-in-the-development-environment"></a><span data-ttu-id="8a596-132">使用开发环境中的连接字符串</span><span class="sxs-lookup"><span data-stu-id="8a596-132">Working with connection strings in the development environment</span></span>

<span data-ttu-id="8a596-133">Visual Studio 将创建使用[LocalDB](https://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx)的新 ASP.NET 项目。</span><span class="sxs-lookup"><span data-stu-id="8a596-133">Visual Studio creates new ASP.NET projects that use [LocalDB](https://blogs.msdn.com/b/sqlexpress/archive/2011/07/12/introducing-localdb-a-better-sql-express.aspx).</span></span> <span data-ttu-id="8a596-134">LocalDB 是专门为开发环境创建的。</span><span class="sxs-lookup"><span data-stu-id="8a596-134">LocalDB was created specifically for the development environment.</span></span> <span data-ttu-id="8a596-135">它不需要密码，因此您无需执行任何操作即可阻止将机密签入您的源代码。</span><span class="sxs-lookup"><span data-stu-id="8a596-135">It doesn't require a password, therefore you don't need to do anything to prevent secrets from being checked into your source code.</span></span> <span data-ttu-id="8a596-136">某些开发团队使用需要密码的 SQL Server （或其他 DBMS）的完整版本。</span><span class="sxs-lookup"><span data-stu-id="8a596-136">Some development teams use the full versions of SQL Server (or other DBMS) that require a password.</span></span>

<span data-ttu-id="8a596-137">您可以使用 `configSource` 特性来替换整个 `<connectionStrings>` 标记。</span><span class="sxs-lookup"><span data-stu-id="8a596-137">You can use the `configSource` attribute to replace the entire `<connectionStrings>` markup.</span></span> <span data-ttu-id="8a596-138">与用于合并标记的 `<appSettings>` `file` 特性不同，`configSource` 特性替换标记。</span><span class="sxs-lookup"><span data-stu-id="8a596-138">Unlike the `<appSettings>` `file` attribute that merges the markup, the `configSource` attribute replaces the markup.</span></span> <span data-ttu-id="8a596-139">下面的标记*显示了 web.config 文件中*的 `configSource` 特性：</span><span class="sxs-lookup"><span data-stu-id="8a596-139">The following markup shows the `configSource` attribute in the *web.config* file:</span></span>

[!code-xml[Main](best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure/samples/sample4.xml?highlight=1)]

> [!NOTE]
> <span data-ttu-id="8a596-140">如果使用上面所示的 `configSource` 属性将连接字符串移到外部文件，并让 Visual Studio 创建新网站，则它无法检测到你正在使用的数据库，并且在从 Visual Studio 发布到 Azure 时，你将不会获得配置数据库的选项。</span><span class="sxs-lookup"><span data-stu-id="8a596-140">If you use the `configSource` attribute as shown above to move your connection strings to an external file, and have Visual Studio create a new web site, it won't be able to detect you are using a database, and you won't get the option of configuring the database when you publish to Azure from Visual Studio.</span></span> <span data-ttu-id="8a596-141">如果你使用的是 `configSource` 属性，则可以使用 PowerShell 创建和部署你的网站和数据库，也可以在发布之前在门户中创建网站和数据库。</span><span class="sxs-lookup"><span data-stu-id="8a596-141">If you are using the `configSource` attribute, you can use PowerShell to create and deploy your web site and database, or you can create the web site and the database in the portal before you publish.</span></span> <span data-ttu-id="8a596-142">[New-AzureWebsitewithDB](https://gallery.technet.microsoft.com/scriptcenter/Ultimate-Create-Web-SQL-DB-9e0fdfd3)脚本将创建一个新的网站和数据库。</span><span class="sxs-lookup"><span data-stu-id="8a596-142">The [New-AzureWebsitewithDB.ps1](https://gallery.technet.microsoft.com/scriptcenter/Ultimate-Create-Web-SQL-DB-9e0fdfd3) script will create a new web site and database.</span></span>

> [!WARNING]
> <span data-ttu-id="8a596-143">安全性-与*AppSettingsSecrets*文件不同，外部连接字符串文件必须与根*web.config*文件位于同一目录中，因此，您必须采取预防措施以确保不将其签入源存储库。</span><span class="sxs-lookup"><span data-stu-id="8a596-143">Security - Unlike the *AppSettingsSecrets.config* file, the external connection strings file must be in the same directory as the root *web.config* file, so you'll have to take precautions to ensure you don't check it into your source repository.</span></span>

> [!NOTE]
> <span data-ttu-id="8a596-144">**机密文件的安全警告：** 最佳做法是不在测试和开发中使用生产机密。</span><span class="sxs-lookup"><span data-stu-id="8a596-144">**Security Warning on secrets file:** A best practice is to not use production secrets in test and development.</span></span> <span data-ttu-id="8a596-145">使用测试或开发中的生产密码会泄漏这些机密。</span><span class="sxs-lookup"><span data-stu-id="8a596-145">Using production passwords in test or development leaks those secrets.</span></span>

<a id="wj"></a>
## <a name="webjobs-console-apps"></a><span data-ttu-id="8a596-146">Web 作业控制台应用</span><span class="sxs-lookup"><span data-stu-id="8a596-146">WebJobs console apps</span></span>

<span data-ttu-id="8a596-147">控制台*应用使用的 app.config 文件不*支持相对路径，但它支持绝对路径。</span><span class="sxs-lookup"><span data-stu-id="8a596-147">The *app.config* file used by a console app doesn't support relative paths, but it does support absolute paths.</span></span> <span data-ttu-id="8a596-148">可以使用绝对路径将机密移出项目目录。</span><span class="sxs-lookup"><span data-stu-id="8a596-148">You can use an absolute path to move your secrets out of your project directory.</span></span> <span data-ttu-id="8a596-149">以下标记显示了*C:\secrets\AppSettingsSecrets.config*文件中的机密以及*app.config*文件中的非敏感数据。</span><span class="sxs-lookup"><span data-stu-id="8a596-149">The following markup shows the secrets in the *C:\secrets\AppSettingsSecrets.config* file, and non sensitive data in the *app.config* file.</span></span>

[!code-xml[Main](best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure/samples/sample5.xml?highlight=2)]

<a id="da"></a>
## <a name="deploying-secrets-to-azure"></a><span data-ttu-id="8a596-150">将机密部署到 Azure</span><span class="sxs-lookup"><span data-stu-id="8a596-150">Deploying secrets to Azure</span></span>

<span data-ttu-id="8a596-151">将 web 应用部署到 Azure 时，不会部署*AppSettingsSecrets*文件（这就是所需的文件）。</span><span class="sxs-lookup"><span data-stu-id="8a596-151">When you deploy your web app to Azure, the *AppSettingsSecrets.config* file won't be deployed (that's what you want).</span></span> <span data-ttu-id="8a596-152">可以通过[Azure 管理门户](https://azure.microsoft.com/services/management-portal/)进行手动设置，以执行以下操作：</span><span class="sxs-lookup"><span data-stu-id="8a596-152">You could go to the [Azure Management Portal](https://azure.microsoft.com/services/management-portal/) and set them manually, to do that:</span></span>

1. <span data-ttu-id="8a596-153">中转到[https://portal.azure.com](https://portal.azure.com)，然后用 Azure 凭据登录。</span><span class="sxs-lookup"><span data-stu-id="8a596-153">Go to [https://portal.azure.com](https://portal.azure.com), and sign in with your Azure credentials.</span></span>
2. <span data-ttu-id="8a596-154">单击 "**浏览 &gt; Web 应用**"，然后单击你的 web 应用的名称。</span><span class="sxs-lookup"><span data-stu-id="8a596-154">Click **Browse &gt; Web Apps**, then click the name of your web app.</span></span>
3. <span data-ttu-id="8a596-155">单击 "**所有设置" &gt; 应用程序设置**。</span><span class="sxs-lookup"><span data-stu-id="8a596-155">Click **All settings &gt; Application settings**.</span></span>

<span data-ttu-id="8a596-156">**应用设置**和**连接字符串**值覆盖*web.config 文件中的相同*设置。</span><span class="sxs-lookup"><span data-stu-id="8a596-156">The **app settings** and **connection string** values override the same settings in the *web.config* file.</span></span> <span data-ttu-id="8a596-157">在我们的示例中，我们未将这些设置部署到 Azure，但如果这些密钥在*web.config 文件中*，则门户上显示的设置优先。</span><span class="sxs-lookup"><span data-stu-id="8a596-157">In our example, we did not deploy these settings to Azure, but if these keys were in the *web.config* file, the settings shown on the portal would take precedence.</span></span>

<span data-ttu-id="8a596-158">最佳做法是遵循[DevOps 工作流](../../../aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/automate-everything.md)，并使用[Azure PowerShell](https://azure.microsoft.com/documentation/articles/install-configure-powershell/) （或其他框架，如[Chef](http://www.opscode.com/chef/)或[Puppet](http://puppetlabs.com/puppet/what-is-puppet)）自动在 Azure 中设置这些值。</span><span class="sxs-lookup"><span data-stu-id="8a596-158">A best practice is to follow a [DevOps workflow](../../../aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/automate-everything.md) and use [Azure PowerShell](https://azure.microsoft.com/documentation/articles/install-configure-powershell/) (or another framework such as [Chef](http://www.opscode.com/chef/) or [Puppet](http://puppetlabs.com/puppet/what-is-puppet)) to automate setting these values in Azure.</span></span> <span data-ttu-id="8a596-159">下面的 PowerShell 脚本使用[export-clixml](http://www.powershellcookbook.com/recipe/PukO/securely-store-credentials-on-disk)将加密的机密导出到磁盘：</span><span class="sxs-lookup"><span data-stu-id="8a596-159">The following PowerShell script uses [Export-CliXml](http://www.powershellcookbook.com/recipe/PukO/securely-store-credentials-on-disk) to export the encrypted secrets to disk:</span></span>

[!code-powershell[Main](best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure/samples/sample6.ps1)]

<span data-ttu-id="8a596-160">在上面的脚本中，"Name" 是机密密钥的名称，如 "&quot;FB\_AppSecret&quot; 或" TwitterSecret "。</span><span class="sxs-lookup"><span data-stu-id="8a596-160">In the script above, ‘Name' is the name of the secret key, such as ‘&quot;FB\_AppSecret&quot; or "TwitterSecret".</span></span> <span data-ttu-id="8a596-161">你可以在浏览器中查看脚本所创建的 "credential" 文件。</span><span class="sxs-lookup"><span data-stu-id="8a596-161">You can view the ".credential" file created by the script in your browser.</span></span> <span data-ttu-id="8a596-162">下面的代码段测试每个凭据文件并为命名的 web 应用设置机密：</span><span class="sxs-lookup"><span data-stu-id="8a596-162">The snippet below tests each of the credential files and sets the secrets for the named web app:</span></span>

[!code-powershell[Main](best-practices-for-deploying-passwords-and-other-sensitive-data-to-aspnet-and-azure/samples/sample7.ps1)]

> [!WARNING]
> <span data-ttu-id="8a596-163">安全性-在 PowerShell 脚本中不包括密码或其他机密，这样做将不会使用 PowerShell 脚本来部署敏感数据。</span><span class="sxs-lookup"><span data-stu-id="8a596-163">Security - Don't include passwords or other secrets in the PowerShell script, doing so defeats the purpose of using a PowerShell script to deploy sensitive data.</span></span> <span data-ttu-id="8a596-164">[获取凭据](https://technet.microsoft.com/library/hh849815.aspx)cmdlet 提供了一种安全机制，用于获取密码。</span><span class="sxs-lookup"><span data-stu-id="8a596-164">The [Get-Credential](https://technet.microsoft.com/library/hh849815.aspx) cmdlet provides a secure mechanism to obtain a password.</span></span> <span data-ttu-id="8a596-165">使用 UI 提示符会阻止泄漏密码。</span><span class="sxs-lookup"><span data-stu-id="8a596-165">Using a UI prompt can prevent leaking a password.</span></span>

### <a name="deploying-db-connection-strings"></a><span data-ttu-id="8a596-166">部署 DB 连接字符串</span><span class="sxs-lookup"><span data-stu-id="8a596-166">Deploying DB connection strings</span></span>

<span data-ttu-id="8a596-167">DB 连接字符串的处理方式类似于应用程序设置。</span><span class="sxs-lookup"><span data-stu-id="8a596-167">DB connection strings are handled similarly to app settings.</span></span> <span data-ttu-id="8a596-168">如果从 Visual Studio 部署 web 应用，则会为你配置连接字符串。</span><span class="sxs-lookup"><span data-stu-id="8a596-168">If you deploy your web app from Visual Studio, the connection string will be configured for you.</span></span> <span data-ttu-id="8a596-169">可以在门户中对此进行验证。</span><span class="sxs-lookup"><span data-stu-id="8a596-169">You can verify this in the portal.</span></span> <span data-ttu-id="8a596-170">设置连接字符串的建议方法是使用 PowerShell。</span><span class="sxs-lookup"><span data-stu-id="8a596-170">The recommended way to set the connection string is with PowerShell.</span></span> <span data-ttu-id="8a596-171">有关 PowerShell 脚本的示例，请创建网站和数据库，并设置网站中的连接字符串，从[Azure 脚本库](https://gallery.technet.microsoft.com/scriptcenter/site/search?f%5B0%5D.Type=RootCategory&amp;f%5B0%5D.Value=WindowsAzure)下载[New-AzureWebsitewithDB。](https://gallery.technet.microsoft.com/scriptcenter/Ultimate-Create-Web-SQL-DB-9e0fdfd3)</span><span class="sxs-lookup"><span data-stu-id="8a596-171">For an example of a PowerShell script the creates a website and database and sets the connection string in the website, download [New-AzureWebsitewithDB.ps1](https://gallery.technet.microsoft.com/scriptcenter/Ultimate-Create-Web-SQL-DB-9e0fdfd3) from the [Azure Script library](https://gallery.technet.microsoft.com/scriptcenter/site/search?f%5B0%5D.Type=RootCategory&amp;f%5B0%5D.Value=WindowsAzure).</span></span>

<a id="not"></a>
## <a name="notes-for-php"></a><span data-ttu-id="8a596-172">PHP 说明</span><span class="sxs-lookup"><span data-stu-id="8a596-172">Notes for PHP</span></span>

<span data-ttu-id="8a596-173">由于**应用设置**和**连接字符串**的键值对存储在 Azure App Service 上的环境变量中，因此使用任何 web 应用框架（如 PHP）的开发人员可以轻松地检索这些值。</span><span class="sxs-lookup"><span data-stu-id="8a596-173">Since the key-value pairs for both **app settings** and **connection strings** are stored in environment variables on Azure App Service, developers that use any web app frameworks (such as PHP) can easily retrieve these values.</span></span> <span data-ttu-id="8a596-174">请参阅 Stefan Schackow 的[Microsoft Azure 网站：应用程序字符串和连接字符串的工作原理](https://azure.microsoft.com/blog/2013/07/17/windows-azure-web-sites-how-application-strings-and-connection-strings-work/)博客文章，其中显示了用于读取应用程序设置和连接字符串的 PHP 代码段。</span><span class="sxs-lookup"><span data-stu-id="8a596-174">See Stefan Schackow's [Windows Azure Web Sites: How Application Strings and Connection Strings Work](https://azure.microsoft.com/blog/2013/07/17/windows-azure-web-sites-how-application-strings-and-connection-strings-work/) blog post which shows a PHP snippet to read app settings and connection strings.</span></span>

## <a name="notes-for-on-premises-servers"></a><span data-ttu-id="8a596-175">本地服务器的说明</span><span class="sxs-lookup"><span data-stu-id="8a596-175">Notes for on-premises servers</span></span>

<span data-ttu-id="8a596-176">如果要部署到本地 web 服务器，可以[加密配置文件的配置节](https://msdn.microsoft.com/library/ff647398.aspx)，以帮助保护机密。</span><span class="sxs-lookup"><span data-stu-id="8a596-176">If you are deploying to on-premises web servers, you can help secure secrets by [encrypting the configuration sections of configuration files](https://msdn.microsoft.com/library/ff647398.aspx).</span></span> <span data-ttu-id="8a596-177">作为替代方法，你可以使用为 Azure 网站推荐的相同方法：在配置文件中保留开发设置，并使用环境变量值进行生产设置。</span><span class="sxs-lookup"><span data-stu-id="8a596-177">As an alternative, you can use the same approach recommended for Azure Websites: keep development settings in configuration files, and use environment variable values for production settings.</span></span> <span data-ttu-id="8a596-178">但在这种情况下，你必须为 Azure 网站中的自动功能编写应用程序代码：检索环境变量中的设置，并使用这些值替换配置文件设置，或在以下情况下使用配置文件设置：找不到环境变量。</span><span class="sxs-lookup"><span data-stu-id="8a596-178">In this case, however, you have to write application code for functionality that is automatic in Azure Websites: retrieve settings from environment variables and use those values in place of configuration file settings, or use configuration file settings when environment variables are not found.</span></span>

<a id="addRes"></a>
## <a name="additional-resources"></a><span data-ttu-id="8a596-179">其他资源</span><span class="sxs-lookup"><span data-stu-id="8a596-179">Additional Resources</span></span>

<span data-ttu-id="8a596-180">有关创建 web 应用和数据库的 PowerShell 脚本的示例，请设置连接字符串 + 应用设置，从[Azure 脚本库](https://gallery.technet.microsoft.com/scriptcenter/site/search?f%5B0%5D.Type=RootCategory&amp;f%5B0%5D.Value=WindowsAzure)下载[New-AzureWebsitewithDB。](https://gallery.technet.microsoft.com/scriptcenter/Ultimate-Create-Web-SQL-DB-9e0fdfd3)</span><span class="sxs-lookup"><span data-stu-id="8a596-180">For an example of a PowerShell script that creates a web app + database, sets the connection string + app settings, download [New-AzureWebsitewithDB.ps1](https://gallery.technet.microsoft.com/scriptcenter/Ultimate-Create-Web-SQL-DB-9e0fdfd3) from the [Azure Script library](https://gallery.technet.microsoft.com/scriptcenter/site/search?f%5B0%5D.Type=RootCategory&amp;f%5B0%5D.Value=WindowsAzure).</span></span> 

<span data-ttu-id="8a596-181">请参阅 Stefan Schackow 的[Microsoft Azure 网站：应用程序字符串和连接字符串的工作原理](https://azure.microsoft.com/blog/2013/07/17/windows-azure-web-sites-how-application-strings-and-connection-strings-work/)</span><span class="sxs-lookup"><span data-stu-id="8a596-181">See Stefan Schackow's [Windows Azure Web Sites: How Application Strings and Connection Strings Work](https://azure.microsoft.com/blog/2013/07/17/windows-azure-web-sites-how-application-strings-and-connection-strings-work/)</span></span>

<span data-ttu-id="8a596-182">特别感谢 Barry Dorrans （ [@blowdart](https://twitter.com/blowdart) ）和 Carlos Farre 进行评审。</span><span class="sxs-lookup"><span data-stu-id="8a596-182">Special thanks to Barry Dorrans ( [@blowdart](https://twitter.com/blowdart) ) and Carlos Farre for reviewing.</span></span>

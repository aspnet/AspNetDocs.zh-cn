---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/transient-fault-handling
title: 暂时性故障处理（通过 Azure 构建实际的云应用） |Microsoft Docs
author: MikeWasson
description: 使用 Azure 电子书构建真实的云应用基于 Scott Guthrie 开发的演示文稿。 它介绍了13种模式和实践，
ms.author: riande
ms.date: 11/03/2015
ms.assetid: 7ead83bc-c08c-4b26-8617-00e07292e35c
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/transient-fault-handling
msc.type: authoredcontent
ms.openlocfilehash: e798cb83cfb97db63fef6dc38c8f62804461d01b
ms.sourcegitcommit: e7e91932a6e91a63e2e46417626f39d6b244a3ab
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/06/2020
ms.locfileid: "78500420"
---
# <a name="transient-fault-handling-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="a517c-104">暂时性故障处理（通过 Azure 构建实际的云应用）</span><span class="sxs-lookup"><span data-stu-id="a517c-104">Transient Fault Handling (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="a517c-105">作者： [Mike Wasson](https://github.com/MikeWasson)， [Rick Anderson](https://twitter.com/RickAndMSFT)， [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="a517c-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson](https://twitter.com/RickAndMSFT), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="a517c-106">[下载 Fix It 项目](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4)或[下载电子书](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="a517c-106">[Download Fix It Project](https://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](https://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="a517c-107">**使用 Azure 电子书构建真实的云应用**基于 Scott Guthrie 开发的演示文稿。</span><span class="sxs-lookup"><span data-stu-id="a517c-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="a517c-108">它介绍了可帮助你成功开发云的 web 应用的13种模式和实践。</span><span class="sxs-lookup"><span data-stu-id="a517c-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="a517c-109">有关电子书的信息，请参阅[第一章](introduction.md)。</span><span class="sxs-lookup"><span data-stu-id="a517c-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>

<span data-ttu-id="a517c-110">设计真实的云应用程序时，必须考虑的一个问题是如何处理临时服务中断。</span><span class="sxs-lookup"><span data-stu-id="a517c-110">When you're designing a real world cloud app, one of the things you have to think about is how to handle temporary service interruptions.</span></span> <span data-ttu-id="a517c-111">此问题在云应用中特别重要，因为你依赖于网络连接和外部服务。</span><span class="sxs-lookup"><span data-stu-id="a517c-111">This issue is uniquely important in cloud apps because you're so dependent on network connections and external services.</span></span> <span data-ttu-id="a517c-112">通常情况下，你可能会获得极少的故障，这通常是自我修复的，如果你不打算智能地处理它们，它们将导致客户的体验不佳。</span><span class="sxs-lookup"><span data-stu-id="a517c-112">You can frequently get little glitches that are typically self-healing, and if you aren't prepared to handle them intelligently, they'll result in a bad experience for your customers.</span></span>

## <a name="causes-of-transient-failures"></a><span data-ttu-id="a517c-113">暂时性故障的原因</span><span class="sxs-lookup"><span data-stu-id="a517c-113">Causes of transient failures</span></span>

<span data-ttu-id="a517c-114">在云环境中，会发现失败的和已删除的数据库连接定期发生。</span><span class="sxs-lookup"><span data-stu-id="a517c-114">In the cloud environment you'll find that failed and dropped database connections happen periodically.</span></span> <span data-ttu-id="a517c-115">这部分原因是，与本地环境相比，你的 web 服务器和数据库服务器之间有直接的物理连接，这是因为你要经历更多负载均衡器。</span><span class="sxs-lookup"><span data-stu-id="a517c-115">That's partly because you're going through more load balancers compared to the on-premises environment where your web server and database server have a direct physical connection.</span></span> <span data-ttu-id="a517c-116">此外，当你依赖于多租户服务时，你会发现对服务的调用会变慢或超时，因为使用该服务的其他人会频繁地访问该服务。</span><span class="sxs-lookup"><span data-stu-id="a517c-116">Also, sometimes when you're dependent on a multi-tenant service you'll see calls to the service get slower or time out because someone else who uses the service is hitting it heavily.</span></span> <span data-ttu-id="a517c-117">在其他情况下，您可能是由于过于频繁地遇到服务的用户，并且服务有意限制您的身份–拒绝连接–以防您对服务的其他租户造成不利影响。</span><span class="sxs-lookup"><span data-stu-id="a517c-117">In other cases you might be the user who is hitting the service too frequently, and the service deliberately throttles you – denies connections – in order to prevent you from adversely affecting other tenants of the service.</span></span>

## <a name="use-smart-retryback-off-logic-to-mitigate-the-effect-of-transient-failures"></a><span data-ttu-id="a517c-118">使用智能重试/回退逻辑来缓解暂时性故障的影响</span><span class="sxs-lookup"><span data-stu-id="a517c-118">Use smart retry/back-off logic to mitigate the effect of transient failures</span></span>

<span data-ttu-id="a517c-119">您可以识别通常是暂时性的错误，并自动重试导致错误的操作，而不会引发异常并向客户显示 "不可用" 或 "错误" 页。</span><span class="sxs-lookup"><span data-stu-id="a517c-119">Instead of throwing an exception and displaying a not available or error page to your customer, you can recognize errors that are typically transient, and automatically retry the operation that resulted in the error, in hopes that before long you'll be successful.</span></span> <span data-ttu-id="a517c-120">大多数情况下，该操作将在第二次尝试时成功完成，并且你将从错误中恢复，而客户却不知道存在问题。</span><span class="sxs-lookup"><span data-stu-id="a517c-120">Most of the time the operation will succeed on the second try, and you'll recover from the error without the customer ever having been aware that there was a problem.</span></span>

<span data-ttu-id="a517c-121">可以通过多种方式实现智能重试逻辑。</span><span class="sxs-lookup"><span data-stu-id="a517c-121">There are several ways you can implement smart retry logic.</span></span>

- <span data-ttu-id="a517c-122">Microsoft 模式 &amp; 实践组具有[暂时性故障处理应用程序块](https://msdn.microsoft.com/library/dn440719(v=pandp.60).aspx)，如果你使用 ADO.NET 进行 SQL 数据库访问（而不是通过实体框架），则会为你执行所有操作。</span><span class="sxs-lookup"><span data-stu-id="a517c-122">The Microsoft Patterns &amp; Practices group has a [Transient Fault Handling Application Block](https://msdn.microsoft.com/library/dn440719(v=pandp.60).aspx) that does everything for you if you're using ADO.NET for SQL Database access (not through Entity Framework).</span></span> <span data-ttu-id="a517c-123">你只需设置重试策略-重试查询或命令的次数和尝试之间的等待时间，并在*使用*块中包装 SQL 代码。</span><span class="sxs-lookup"><span data-stu-id="a517c-123">You just set a policy for retries – how many times to retry a query or command and how long to wait between tries – and wrap your SQL code in a *using* block.</span></span>

    [!code-csharp[Main](transient-fault-handling/samples/sample1.cs)]

    <span data-ttu-id="a517c-124">TFH 还支持[Azure 角色中缓存](https://msdn.microsoft.com/library/windowsazure/dn386103.aspx)和[服务总线](https://azure.microsoft.com/services/service-bus/)。</span><span class="sxs-lookup"><span data-stu-id="a517c-124">TFH also supports [Azure In-Role Cache](https://msdn.microsoft.com/library/windowsazure/dn386103.aspx) and [Service Bus](https://azure.microsoft.com/services/service-bus/).</span></span>
- <span data-ttu-id="a517c-125">使用实体框架通常不会直接使用 SQL 连接，因此不能使用此模式和实践包，但实体框架6会直接在框架中生成这种重试逻辑。</span><span class="sxs-lookup"><span data-stu-id="a517c-125">When you use the Entity Framework you typically aren't working directly with SQL connections, so you can't use this Patterns and Practices package, but Entity Framework 6 builds this kind of retry logic right into the framework.</span></span> <span data-ttu-id="a517c-126">与指定重试策略的方式类似，在访问数据库时，EF 使用该策略。</span><span class="sxs-lookup"><span data-stu-id="a517c-126">In a similar way you specify the retry strategy, and then EF uses that strategy whenever it accesses the database.</span></span>

    <span data-ttu-id="a517c-127">若要在 Fix It 应用中使用此功能，只需添加一个派生自*DbConfiguration*的类并打开重试逻辑。</span><span class="sxs-lookup"><span data-stu-id="a517c-127">To use this feature in the Fix It app, all we have to do is add a class that derives from *DbConfiguration* and turn on the retry logic.</span></span>

    [!code-csharp[Main](transient-fault-handling/samples/sample2.cs)]

    <span data-ttu-id="a517c-128">对于框架识别为暂时性错误的 SQL 数据库异常，所示的代码指示 EF 重试操作最多3次，两次重试之间有指数的退接延迟，最大延迟为5秒。</span><span class="sxs-lookup"><span data-stu-id="a517c-128">For SQL Database exceptions that the framework identifies as typically transient errors, the code shown instructs EF to retry the operation up to 3 times, with an exponential back-off delay between retries, and a maximum delay of 5 seconds.</span></span> <span data-ttu-id="a517c-129">指数回退是指在每次重试失败后，它将等待较长的一段时间，然后重试。</span><span class="sxs-lookup"><span data-stu-id="a517c-129">Exponential back-off means that after each failed retry it will wait for a longer period of time before trying again.</span></span> <span data-ttu-id="a517c-130">如果行中的三次尝试失败，则会引发异常。</span><span class="sxs-lookup"><span data-stu-id="a517c-130">If three tries in a row fail, it will throw an exception.</span></span> <span data-ttu-id="a517c-131">以下关于断路熔断器的部分说明了为何要使用指数回退和数量有限的重试次数。</span><span class="sxs-lookup"><span data-stu-id="a517c-131">The following section about circuit breakers explains why you want exponential back-off and a limited number of retries.</span></span>

    <span data-ttu-id="a517c-132">使用 Azure 存储服务时，你可能会遇到类似的问题，因为 Fix It 应用对 Blob 执行此类工作，并且 .NET 存储客户端 API 已经实现了相同类型的逻辑。</span><span class="sxs-lookup"><span data-stu-id="a517c-132">You can have similar issues when you're using the Azure Storage service, as the Fix It app does for Blobs, and the .NET storage client API already implements the same kind of logic.</span></span> <span data-ttu-id="a517c-133">你只需指定重试策略，或者，如果你对默认设置感到满意，则无需执行此操作。</span><span class="sxs-lookup"><span data-stu-id="a517c-133">You just specify the retry policy, or you don't even have to do that if you're happy with the default settings.</span></span>

<a id="circuitbreakers"></a>
## <a name="circuit-breakers"></a><span data-ttu-id="a517c-134">断路熔断器</span><span class="sxs-lookup"><span data-stu-id="a517c-134">Circuit breakers</span></span>

<span data-ttu-id="a517c-135">在一段时间内，如果不希望重试次数过多，则有几个原因：</span><span class="sxs-lookup"><span data-stu-id="a517c-135">There are several reasons why you don't want to retry too many times over too long a period:</span></span>

- <span data-ttu-id="a517c-136">太多用户持续重试失败的请求可能会降低其他用户的体验。</span><span class="sxs-lookup"><span data-stu-id="a517c-136">Too many users persistently retrying failed requests might degrade other users' experience.</span></span> <span data-ttu-id="a517c-137">如果数百万人都发出重复的重试请求，你可能会占用 IIS 调度队列，并阻止你的应用程序处理请求，而该请求可能会成功处理。</span><span class="sxs-lookup"><span data-stu-id="a517c-137">If millions of people are all making repeated retry requests you could be tying up IIS dispatch queues and preventing your app from servicing requests that it otherwise could handle successfully.</span></span>
- <span data-ttu-id="a517c-138">如果每个用户在发生服务故障后重试，则可能会有许多请求在其开始恢复时被排队，该服务会变得溢出。</span><span class="sxs-lookup"><span data-stu-id="a517c-138">If everyone is retrying due to a service failure, there could be so many requests queued up that the service gets flooded when it starts to recover.</span></span>
- <span data-ttu-id="a517c-139">如果错误是由于限制导致的，并且服务将使用此时间窗口来进行限制，则继续重试可能会将该窗口移出并导致限制继续。</span><span class="sxs-lookup"><span data-stu-id="a517c-139">If the error is due to throttling and there's a window of time the service uses for throttling, continued retries could move that window out and cause the throttling to continue.</span></span>
- <span data-ttu-id="a517c-140">可能有用户正在等待网页呈现。</span><span class="sxs-lookup"><span data-stu-id="a517c-140">You might have a user waiting for a web page to render.</span></span> <span data-ttu-id="a517c-141">使人们的等待时间太长可能会更令人讨厌，因为这样会使用户在以后重试。</span><span class="sxs-lookup"><span data-stu-id="a517c-141">Making people wait too long might be more annoying that relatively quickly advising them to try again later.</span></span>

<span data-ttu-id="a517c-142">指数重试通过限制服务可从应用程序获取的重试频率来解决其中一些问题。</span><span class="sxs-lookup"><span data-stu-id="a517c-142">Exponential back-off addresses some of these issue by limiting the frequency of retries a service can get from your application.</span></span> <span data-ttu-id="a517c-143">但还需要进行*断路*操作：这意味着，在某个特定的重试阈值，应用程序将停止重试并执行其他操作，例如以下操作之一：</span><span class="sxs-lookup"><span data-stu-id="a517c-143">But you also need to have *circuit breakers*: this means that at a certain retry threshold your app stops retrying and takes some other action, such as one of the following:</span></span>

- <span data-ttu-id="a517c-144">自定义回退。</span><span class="sxs-lookup"><span data-stu-id="a517c-144">Custom fallback.</span></span> <span data-ttu-id="a517c-145">如果你无法从 Reuters 获得股票价格，你可能会从 Bloomberg 获取股票价格;或者，如果您无法从数据库获取数据，则可能可以从缓存中获取数据。</span><span class="sxs-lookup"><span data-stu-id="a517c-145">If you can't get a stock price from Reuters, maybe you can get it from Bloomberg; or if you can't get data from the database, maybe you can get it from cache.</span></span>
- <span data-ttu-id="a517c-146">无提示失败。</span><span class="sxs-lookup"><span data-stu-id="a517c-146">Fail silent.</span></span> <span data-ttu-id="a517c-147">如果你的应用程序所需的服务并不完全相同，则只在无法获取数据时返回 null。</span><span class="sxs-lookup"><span data-stu-id="a517c-147">If what you need from a service isn't all-or-nothing for your app, just return null when you can't get the data.</span></span> <span data-ttu-id="a517c-148">如果要显示 Fix It 任务，但 Blob 服务没有响应，则可以在不使用映像的情况下显示任务详细信息。</span><span class="sxs-lookup"><span data-stu-id="a517c-148">If you're displaying a Fix It task and the Blob service isn't responding, you could display the task details without the image.</span></span>
- <span data-ttu-id="a517c-149">快速失败。</span><span class="sxs-lookup"><span data-stu-id="a517c-149">Fail fast.</span></span> <span data-ttu-id="a517c-150">错误：用户避免使用重试请求使服务扩散，这可能会导致其他用户的服务中断或扩展限制窗口。</span><span class="sxs-lookup"><span data-stu-id="a517c-150">Error out the user to avoid flooding the service with retry requests which could cause service disruption for other users or extend a throttling window.</span></span> <span data-ttu-id="a517c-151">可以显示友好的 "稍后重试" 消息。</span><span class="sxs-lookup"><span data-stu-id="a517c-151">You can display a friendly "try again later" message.</span></span>

<span data-ttu-id="a517c-152">没有任何一个大小合适的重试策略。</span><span class="sxs-lookup"><span data-stu-id="a517c-152">There is no one-size-fits-all retry policy.</span></span> <span data-ttu-id="a517c-153">在异步后台工作进程中，你可以重试更多次并等待更长时间，而不是在用户等待响应的同步 web 应用中等待。</span><span class="sxs-lookup"><span data-stu-id="a517c-153">You can retry more times and wait longer in an asynchronous background worker process than you would in a synchronous web app where a user is waiting for a response.</span></span> <span data-ttu-id="a517c-154">你可以等待关系数据库服务的重试次数超过缓存服务的重试次数。</span><span class="sxs-lookup"><span data-stu-id="a517c-154">You can wait longer between retries for a relational database service than you would for a cache service.</span></span> <span data-ttu-id="a517c-155">下面是一些建议的重试策略示例，可让你了解数字的变化方式。</span><span class="sxs-lookup"><span data-stu-id="a517c-155">Here are some sample recommended retry policies to give you an idea of how the numbers might vary.</span></span> <span data-ttu-id="a517c-156">（"快速第一条" 表示第一次重试之前没有延迟。</span><span class="sxs-lookup"><span data-stu-id="a517c-156">("Fast First" means no delay before the first retry.</span></span>

![示例重试策略](transient-fault-handling/_static/image1.png)

<span data-ttu-id="a517c-158">有关 SQL 数据库重试策略指南，请参阅对[Sql 数据库的暂时性故障和连接错误进行故障排除](https://azure.microsoft.com/documentation/articles/sql-database-connectivity-issues/)。</span><span class="sxs-lookup"><span data-stu-id="a517c-158">For SQL Database retry policy guidance, see [Troubleshoot transient faults and connection errors to SQL Database](https://azure.microsoft.com/documentation/articles/sql-database-connectivity-issues/).</span></span>

## <a name="summary"></a><span data-ttu-id="a517c-159">摘要</span><span class="sxs-lookup"><span data-stu-id="a517c-159">Summary</span></span>

<span data-ttu-id="a517c-160">在大多数情况下，重试/后退策略有助于使暂时错误对客户不可见，在使用 ADO.NET、实体框架或 Azure 存储服务时，Microsoft 提供了可用于最大程度地降低工作实现策略的框架。</span><span class="sxs-lookup"><span data-stu-id="a517c-160">A retry/back-off strategy can help make temporary errors invisible to the customer most of the time, and Microsoft provides frameworks that you can use to minimize your work implementing a strategy whether you're using ADO.NET, Entity Framework, or the Azure Storage service.</span></span>

<span data-ttu-id="a517c-161">[下一章](distributed-caching.md)介绍如何使用分布式缓存提高性能和可靠性。</span><span class="sxs-lookup"><span data-stu-id="a517c-161">In the [next chapter](distributed-caching.md), we'll look at how to improve performance and reliability by using distributed caching.</span></span>

## <a name="resources"></a><span data-ttu-id="a517c-162">资源</span><span class="sxs-lookup"><span data-stu-id="a517c-162">Resources</span></span>

<span data-ttu-id="a517c-163">有关更多信息，请参见以下资源：</span><span class="sxs-lookup"><span data-stu-id="a517c-163">For more information, see the following resources:</span></span>

<span data-ttu-id="a517c-164">文档</span><span class="sxs-lookup"><span data-stu-id="a517c-164">Documentation</span></span>

- <span data-ttu-id="a517c-165">[在 Azure 云服务上设计大规模服务的最佳实践](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx)。</span><span class="sxs-lookup"><span data-stu-id="a517c-165">[Best Practices for the Design of Large-Scale Services on Azure Cloud Services](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx).</span></span> <span data-ttu-id="a517c-166">通过标记 Simm 和 Michael Thomassy 的白皮书。</span><span class="sxs-lookup"><span data-stu-id="a517c-166">White paper by Mark Simms and Michael Thomassy.</span></span> <span data-ttu-id="a517c-167">与故障保护系列类似，但更详细地介绍了更多操作方法。</span><span class="sxs-lookup"><span data-stu-id="a517c-167">Similar to the Failsafe series but goes into more how-to details.</span></span> <span data-ttu-id="a517c-168">请参阅遥测和诊断部分。</span><span class="sxs-lookup"><span data-stu-id="a517c-168">See the Telemetry and Diagnostics section.</span></span>
- <span data-ttu-id="a517c-169">[防故障：弹性云体系结构的指南](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx)。</span><span class="sxs-lookup"><span data-stu-id="a517c-169">[Failsafe: Guidance for Resilient Cloud Architectures](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx).</span></span> <span data-ttu-id="a517c-170">白皮书 by Marc Mercuri、Ulrich Homann 和 Andrew Townhill。</span><span class="sxs-lookup"><span data-stu-id="a517c-170">White paper by Marc Mercuri, Ulrich Homann, and Andrew Townhill.</span></span> <span data-ttu-id="a517c-171">防故障视频系列的网页版本。</span><span class="sxs-lookup"><span data-stu-id="a517c-171">Web page version of the FailSafe video series.</span></span>
- <span data-ttu-id="a517c-172">[Microsoft 模式和实践-Azure 指南](https://msdn.microsoft.com/library/dn568099.aspx)。</span><span class="sxs-lookup"><span data-stu-id="a517c-172">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/library/dn568099.aspx).</span></span> <span data-ttu-id="a517c-173">请参阅重试模式，计划程序代理监督程序模式。</span><span class="sxs-lookup"><span data-stu-id="a517c-173">See Retry pattern, Scheduler Agent Supervisor pattern.</span></span>
- <span data-ttu-id="a517c-174">[AZURE SQL 数据库中的容错能力](https://blogs.msdn.com/b/windowsazure/archive/2012/07/30/fault-tolerance-in-windows-azure-sql-database.aspx)。</span><span class="sxs-lookup"><span data-stu-id="a517c-174">[Fault-tolerance in Azure SQL Database](https://blogs.msdn.com/b/windowsazure/archive/2012/07/30/fault-tolerance-in-windows-azure-sql-database.aspx).</span></span> <span data-ttu-id="a517c-175">Tony Petrossian 的博客文章。</span><span class="sxs-lookup"><span data-stu-id="a517c-175">Blog post by Tony Petrossian.</span></span>
- <span data-ttu-id="a517c-176">[实体框架连接复原/重试逻辑](https://msdn.microsoft.com/data/dn456835)。</span><span class="sxs-lookup"><span data-stu-id="a517c-176">[Entity Framework - Connection Resiliency / Retry Logic](https://msdn.microsoft.com/data/dn456835).</span></span> <span data-ttu-id="a517c-177">如何使用和自定义实体框架6的暂时性故障处理功能。</span><span class="sxs-lookup"><span data-stu-id="a517c-177">How to use and customize the transient fault handling feature of Entity Framework 6.</span></span>
- <span data-ttu-id="a517c-178">[ASP.NET MVC 应用程序中的实体框架的连接复原和命令截获](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application.md)。</span><span class="sxs-lookup"><span data-stu-id="a517c-178">[Connection Resiliency and Command Interception with the Entity Framework in an ASP.NET MVC Application](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application.md).</span></span> <span data-ttu-id="a517c-179">第四个系列系列教程中的第四部分介绍了如何设置 SQL 数据库的 EF 6 连接复原功能。</span><span class="sxs-lookup"><span data-stu-id="a517c-179">Fourth in a nine-part tutorial series, shows how to set up the EF 6 connection resilience feature for SQL Database.</span></span>

<span data-ttu-id="a517c-180">视频</span><span class="sxs-lookup"><span data-stu-id="a517c-180">Videos</span></span>

- <span data-ttu-id="a517c-181">[故障安全：构建可缩放且可复原的云服务](https://channel9.msdn.com/Series/FailSafe)。</span><span class="sxs-lookup"><span data-stu-id="a517c-181">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="a517c-182">九部分系列： Ulrich Homann、Marc Mercuri 和 Mark Simm。</span><span class="sxs-lookup"><span data-stu-id="a517c-182">Nine-part series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="a517c-183">以一种易于访问且有趣的方式展示高级概念和体系结构原则，其中的情景是通过 Microsoft 客户咨询团队（CAT）的实际客户体验。</span><span class="sxs-lookup"><span data-stu-id="a517c-183">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="a517c-184">请参阅有关从40:55 开始的剧集3中的断路熔断器讨论。</span><span class="sxs-lookup"><span data-stu-id="a517c-184">See the discussion of circuit breakers in episode 3 starting at 40:55.</span></span>
- <span data-ttu-id="a517c-185">[构建大：从 Azure 客户获得的课程-第二部分](https://channel9.msdn.com/Events/Build/2012/3-030)。</span><span class="sxs-lookup"><span data-stu-id="a517c-185">[Building Big: Lessons learned from Azure customers - Part II](https://channel9.msdn.com/Events/Build/2012/3-030).</span></span> <span data-ttu-id="a517c-186">标记 Simm 讨论了如何针对故障、暂时性故障处理和检测一切进行设计。</span><span class="sxs-lookup"><span data-stu-id="a517c-186">Mark Simms talks about designing for failure, transient fault handling, and instrumenting everything.</span></span>

<span data-ttu-id="a517c-187">代码示例</span><span class="sxs-lookup"><span data-stu-id="a517c-187">Code sample</span></span>

- <span data-ttu-id="a517c-188">[Azure 中的云服务基础知识](https://code.msdn.microsoft.com/Cloud-Service-Fundamentals-4ca72649)。</span><span class="sxs-lookup"><span data-stu-id="a517c-188">[Cloud Service Fundamentals in Azure](https://code.msdn.microsoft.com/Cloud-Service-Fundamentals-4ca72649).</span></span> <span data-ttu-id="a517c-189">Microsoft Azure Customer 咨询团队创建的示例应用程序，演示如何使用[企业库暂时性故障处理块](http://nuget.org/packages/EnterpriseLibrary.TransientFaultHandling/)（TFH）。</span><span class="sxs-lookup"><span data-stu-id="a517c-189">Sample application created by the Microsoft Azure Customer Advisory Team that demonstrates how to use the [Enterprise Library Transient Fault Handling Block](http://nuget.org/packages/EnterpriseLibrary.TransientFaultHandling/) (TFH).</span></span> <span data-ttu-id="a517c-190">有关详细信息，请参阅[云服务基础数据访问层 - 临时故障处理](https://social.technet.microsoft.com/wiki/contents/articles/18665.cloud-service-fundamentals-data-access-layer-transient-fault-handling.aspx)。</span><span class="sxs-lookup"><span data-stu-id="a517c-190">For more information, see [Cloud Service Fundamentals Data Access Layer – Transient Fault Handling](https://social.technet.microsoft.com/wiki/contents/articles/18665.cloud-service-fundamentals-data-access-layer-transient-fault-handling.aspx).</span></span> <span data-ttu-id="a517c-191">建议使用 TFH 直接使用 ADO.NET （不使用实体框架）进行数据库访问。</span><span class="sxs-lookup"><span data-stu-id="a517c-191">TFH is recommended for database access using ADO.NET directly (without using Entity Framework).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a517c-192">[上一页](monitoring-and-telemetry.md)
> [下一页](distributed-caching.md)</span><span class="sxs-lookup"><span data-stu-id="a517c-192">[Previous](monitoring-and-telemetry.md)
[Next](distributed-caching.md)</span></span>

---
uid: aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/transient-fault-handling
title: 暂时性故障处理 （构建实际云应用与 Azure） |Microsoft Docs
author: MikeWasson
description: 构建真实世界云应用与 Azure 的电子书基于由 Scott Guthrie 开发的演示文稿。 它还说明了 13 模式和实践可以他...
ms.author: riande
ms.date: 11/03/2015
ms.assetid: 7ead83bc-c08c-4b26-8617-00e07292e35c
msc.legacyurl: /aspnet/overview/developing-apps-with-windows-azure/building-real-world-cloud-apps-with-windows-azure/transient-fault-handling
msc.type: authoredcontent
ms.openlocfilehash: 9076ce7d933d9bbaaf4d34ccb6df7b6823cd38bf
ms.sourcegitcommit: 0f1119340e4464720cfd16d0ff15764746ea1fea
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/09/2019
ms.locfileid: "59417008"
---
# <a name="transient-fault-handling-building-real-world-cloud-apps-with-azure"></a><span data-ttu-id="094bd-104">暂时性故障处理 （构建使用 Azure 的真实世界云应用程序）</span><span class="sxs-lookup"><span data-stu-id="094bd-104">Transient Fault Handling (Building Real-World Cloud Apps with Azure)</span></span>

<span data-ttu-id="094bd-105">通过[Mike Wasson](https://github.com/MikeWasson)， [Rick Anderson]((https://twitter.com/RickAndMSFT))， [Tom Dykstra](https://github.com/tdykstra)</span><span class="sxs-lookup"><span data-stu-id="094bd-105">by [Mike Wasson](https://github.com/MikeWasson), [Rick Anderson]((https://twitter.com/RickAndMSFT)), [Tom Dykstra](https://github.com/tdykstra)</span></span>

<span data-ttu-id="094bd-106">[下载修复此错误项目](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4)或[下载电子书](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span><span class="sxs-lookup"><span data-stu-id="094bd-106">[Download Fix It Project](http://code.msdn.microsoft.com/Fix-It-app-for-Building-cdd80df4) or [Download E-book](http://blogs.msdn.com/b/microsoft_press/archive/2014/07/23/free-ebook-building-cloud-apps-with-microsoft-azure.aspx)</span></span>

> <span data-ttu-id="094bd-107">**构建真实世界云应用，使用 Azure**电子书基于由 Scott Guthrie 开发的演示文稿。</span><span class="sxs-lookup"><span data-stu-id="094bd-107">The **Building Real World Cloud Apps with Azure** e-book is based on a presentation developed by Scott Guthrie.</span></span> <span data-ttu-id="094bd-108">它还说明了 13 模式和实践，从而帮助您获得成功开发适用于在云中的 web 应用。</span><span class="sxs-lookup"><span data-stu-id="094bd-108">It explains 13 patterns and practices that can help you be successful developing web apps for the cloud.</span></span> <span data-ttu-id="094bd-109">有关电子书的信息，请参阅[的第一章](introduction.md)。</span><span class="sxs-lookup"><span data-stu-id="094bd-109">For information about the e-book, see [the first chapter](introduction.md).</span></span>


<span data-ttu-id="094bd-110">当您正在设计的真实世界云应用程序时，您必须考虑的事情之一是如何处理临时服务中断的情况。</span><span class="sxs-lookup"><span data-stu-id="094bd-110">When you're designing a real world cloud app, one of the things you have to think about is how to handle temporary service interruptions.</span></span> <span data-ttu-id="094bd-111">此问题是云应用中唯一重要的因为您因此依赖网络连接和外部服务。</span><span class="sxs-lookup"><span data-stu-id="094bd-111">This issue is uniquely important in cloud apps because you're so dependent on network connections and external services.</span></span> <span data-ttu-id="094bd-112">您都可以获得自我通常修复的小问题，如果您不准备好以智能方式处理它们，它们将导致非常糟糕的体验为您的客户。</span><span class="sxs-lookup"><span data-stu-id="094bd-112">You can frequently get little glitches that are typically self-healing, and if you aren't prepared to handle them intelligently, they'll result in a bad experience for your customers.</span></span>

## <a name="causes-of-transient-failures"></a><span data-ttu-id="094bd-113">暂时性故障的原因</span><span class="sxs-lookup"><span data-stu-id="094bd-113">Causes of transient failures</span></span>

<span data-ttu-id="094bd-114">您会发现云环境的失败和已删除的数据库连接在发生定期。</span><span class="sxs-lookup"><span data-stu-id="094bd-114">In the cloud environment you'll find that failed and dropped database connections happen periodically.</span></span> <span data-ttu-id="094bd-115">这是一定程度上因为您将通过多个负载均衡器与在本地环境相比，web 服务器和数据库服务器具有的直接物理连接。</span><span class="sxs-lookup"><span data-stu-id="094bd-115">That's partly because you're going through more load balancers compared to the on-premises environment where your web server and database server have a direct physical connection.</span></span> <span data-ttu-id="094bd-116">此外，有时，当你是多租户服务相关时你将看到调用服务，获取速度较慢或超时，因为其他人使用该服务的用户很大程度抵达此端口。</span><span class="sxs-lookup"><span data-stu-id="094bd-116">Also, sometimes when you're dependent on a multi-tenant service you'll see calls to the service get slower or time out because someone else who uses the service is hitting it heavily.</span></span> <span data-ttu-id="094bd-117">在其他情况下可能是过于频繁，达到该服务的用户和该服务故意限制-拒绝连接 – 您以防止产生负面影响其他租户的服务。</span><span class="sxs-lookup"><span data-stu-id="094bd-117">In other cases you might be the user who is hitting the service too frequently, and the service deliberately throttles you – denies connections – in order to prevent you from adversely affecting other tenants of the service.</span></span>

## <a name="use-smart-retryback-off-logic-to-mitigate-the-effect-of-transient-failures"></a><span data-ttu-id="094bd-118">使用智能重试/回退逻辑来缓解暂时性故障的影响</span><span class="sxs-lookup"><span data-stu-id="094bd-118">Use smart retry/back-off logic to mitigate the effect of transient failures</span></span>

<span data-ttu-id="094bd-119">而不是引发异常并向客户显示不可用或错误页，可以识别通常暂时性的错误，并自动重试该操作中导致错误，希望的之后，长时间将会成功。</span><span class="sxs-lookup"><span data-stu-id="094bd-119">Instead of throwing an exception and displaying a not available or error page to your customer, you can recognize errors that are typically transient, and automatically retry the operation that resulted in the error, in hopes that before long you'll be successful.</span></span> <span data-ttu-id="094bd-120">大多数情况下，此操作将成功在第二个尝试，并你将从错误中恢复而无需客户曾遇到过注意时出现问题。</span><span class="sxs-lookup"><span data-stu-id="094bd-120">Most of the time the operation will succeed on the second try, and you'll recover from the error without the customer ever having been aware that there was a problem.</span></span>

<span data-ttu-id="094bd-121">有几种方法可以实现智能重试逻辑。</span><span class="sxs-lookup"><span data-stu-id="094bd-121">There are several ways you can implement smart retry logic.</span></span>

- <span data-ttu-id="094bd-122">Microsoft 模式&amp;实践组具有[暂时性故障处理应用程序块](https://msdn.microsoft.com/library/dn440719(v=pandp.60).aspx)的执行所有操作，如果使用 ADO.NET 的 SQL 数据库 （而不是通过实体框架） 的访问权限。</span><span class="sxs-lookup"><span data-stu-id="094bd-122">The Microsoft Patterns &amp; Practices group has a [Transient Fault Handling Application Block](https://msdn.microsoft.com/library/dn440719(v=pandp.60).aspx) that does everything for you if you're using ADO.NET for SQL Database access (not through Entity Framework).</span></span> <span data-ttu-id="094bd-123">只需设置的策略进行重试 – 多少次重试查询或命令并等待的时间之间尝试 – 和包装在 SQL 中的代码*使用*块。</span><span class="sxs-lookup"><span data-stu-id="094bd-123">You just set a policy for retries – how many times to retry a query or command and how long to wait between tries – and wrap your SQL code in a *using* block.</span></span>

    [!code-csharp[Main](transient-fault-handling/samples/sample1.cs)]

    <span data-ttu-id="094bd-124">此外支持 TFH [Azure 角色中缓存](https://msdn.microsoft.com/library/windowsazure/dn386103.aspx)并[服务总线](https://azure.microsoft.com/services/service-bus/)。</span><span class="sxs-lookup"><span data-stu-id="094bd-124">TFH also supports [Azure In-Role Cache](https://msdn.microsoft.com/library/windowsazure/dn386103.aspx) and [Service Bus](https://azure.microsoft.com/services/service-bus/).</span></span>
- <span data-ttu-id="094bd-125">使用实体框架时您通常不直接使用 SQL 连接，因此不能使用此模式和实践的包，但 Entity Framework 6 到框架生成这种重试逻辑。</span><span class="sxs-lookup"><span data-stu-id="094bd-125">When you use the Entity Framework you typically aren't working directly with SQL connections, so you can't use this Patterns and Practices package, but Entity Framework 6 builds this kind of retry logic right into the framework.</span></span> <span data-ttu-id="094bd-126">在以类似的方式指定重试策略，并 EF 使用该策略无论何时访问数据库。</span><span class="sxs-lookup"><span data-stu-id="094bd-126">In a similar way you specify the retry strategy, and then EF uses that strategy whenever it accesses the database.</span></span>

    <span data-ttu-id="094bd-127">若要修复其应用中使用此功能，我们只需是添加一个类，派生自*DbConfiguration*开启重试逻辑。</span><span class="sxs-lookup"><span data-stu-id="094bd-127">To use this feature in the Fix It app, all we have to do is add a class that derives from *DbConfiguration* and turn on the retry logic.</span></span>

    [!code-csharp[Main](transient-fault-handling/samples/sample2.cs)]

    <span data-ttu-id="094bd-128">对于框架标识为通常暂时性错误的 SQL 数据库例外，所示的代码指示 EF 使用指数退让延迟之间重试和最大延迟为 5 秒重试该操作最多 3 次。</span><span class="sxs-lookup"><span data-stu-id="094bd-128">For SQL Database exceptions that the framework identifies as typically transient errors, the code shown instructs EF to retry the operation up to 3 times, with an exponential back-off delay between retries, and a maximum delay of 5 seconds.</span></span> <span data-ttu-id="094bd-129">指数退让意味着每个失败的重试后它将等待较长的时间，然后重试。</span><span class="sxs-lookup"><span data-stu-id="094bd-129">Exponential back-off means that after each failed retry it will wait for a longer period of time before trying again.</span></span> <span data-ttu-id="094bd-130">如果行中的三次尝试失败，它将引发异常。</span><span class="sxs-lookup"><span data-stu-id="094bd-130">If three tries in a row fail, it will throw an exception.</span></span> <span data-ttu-id="094bd-131">断路器有关的以下部分介绍了您为何指数退避和有限的重试次数。</span><span class="sxs-lookup"><span data-stu-id="094bd-131">The following section about circuit breakers explains why you want exponential back-off and a limited number of retries.</span></span>

    <span data-ttu-id="094bd-132">使用 Azure 存储服务，如修复其应用执行对于 Blob，并已将.NET 存储客户端 API 实现同样的逻辑时，可能出现类似问题。</span><span class="sxs-lookup"><span data-stu-id="094bd-132">You can have similar issues when you're using the Azure Storage service, as the Fix It app does for Blobs, and the .NET storage client API already implements the same kind of logic.</span></span> <span data-ttu-id="094bd-133">只需指定重试策略，或您甚至无需执行该操作，如果您愿意使用默认设置。</span><span class="sxs-lookup"><span data-stu-id="094bd-133">You just specify the retry policy, or you don't even have to do that if you're happy with the default settings.</span></span>

<a id="circuitbreakers"></a>
## <a name="circuit-breakers"></a><span data-ttu-id="094bd-134">断路器</span><span class="sxs-lookup"><span data-stu-id="094bd-134">Circuit breakers</span></span>

<span data-ttu-id="094bd-135">有多个原因您不想重试次数太多太长一段：</span><span class="sxs-lookup"><span data-stu-id="094bd-135">There are several reasons why you don't want to retry too many times over too long a period:</span></span>

- <span data-ttu-id="094bd-136">永久重试失败的请求太多用户可能会降低其他用户的体验。</span><span class="sxs-lookup"><span data-stu-id="094bd-136">Too many users persistently retrying failed requests might degrade other users' experience.</span></span> <span data-ttu-id="094bd-137">如果数以百万计的人是进行重复所有重试请求您可以占用 IIS 调度队列并阻止您的应用程序为其否则无法成功处理的请求提供服务。</span><span class="sxs-lookup"><span data-stu-id="094bd-137">If millions of people are all making repeated retry requests you could be tying up IIS dispatch queues and preventing your app from servicing requests that it otherwise could handle successfully.</span></span>
- <span data-ttu-id="094bd-138">如果每个人都正在重试由于服务失败，那里可能进行如此多的请求排队等候启动恢复时，该服务获取来路。</span><span class="sxs-lookup"><span data-stu-id="094bd-138">If everyone is retrying due to a service failure, there could be so many requests queued up that the service gets flooded when it starts to recover.</span></span>
- <span data-ttu-id="094bd-139">如果错误是由于受到限制，并且没有的时间限制的服务使用的窗口，继续重试无法将该窗口移出，导致限制以继续。</span><span class="sxs-lookup"><span data-stu-id="094bd-139">If the error is due to throttling and there's a window of time the service uses for throttling, continued retries could move that window out and cause the throttling to continue.</span></span>
- <span data-ttu-id="094bd-140">您可能必须等待 web 页的用户来呈现。</span><span class="sxs-lookup"><span data-stu-id="094bd-140">You might have a user waiting for a web page to render.</span></span> <span data-ttu-id="094bd-141">让用户等待太长可能会更令人讨厌的该相对较快建议他们稍后再试。</span><span class="sxs-lookup"><span data-stu-id="094bd-141">Making people wait too long might be more annoying that relatively quickly advising them to try again later.</span></span>

<span data-ttu-id="094bd-142">指数退让解决这些问题的一些通过限制的服务能够获得您的应用程序的重试频率。</span><span class="sxs-lookup"><span data-stu-id="094bd-142">Exponential back-off addresses some of these issue by limiting the frequency of retries a service can get from your application.</span></span> <span data-ttu-id="094bd-143">但还需要具有*断路器*： 这意味着，在某一特定重试您的应用程序将停止重试和采用一些其他操作，如以下阈值：</span><span class="sxs-lookup"><span data-stu-id="094bd-143">But you also need to have *circuit breakers*: this means that at a certain retry threshold your app stops retrying and takes some other action, such as one of the following:</span></span>

- <span data-ttu-id="094bd-144">自定义回退。</span><span class="sxs-lookup"><span data-stu-id="094bd-144">Custom fallback.</span></span> <span data-ttu-id="094bd-145">如果您不能从 Reuters 获取股票价格，或许您可以获得它从 Bloomberg;或者，如果不能从数据库获取数据，或许您可以将其从缓存。</span><span class="sxs-lookup"><span data-stu-id="094bd-145">If you can't get a stock price from Reuters, maybe you can get it from Bloomberg; or if you can't get data from the database, maybe you can get it from cache.</span></span>
- <span data-ttu-id="094bd-146">失败无提示。</span><span class="sxs-lookup"><span data-stu-id="094bd-146">Fail silent.</span></span> <span data-ttu-id="094bd-147">如果您从服务需要不要么为你的应用，只需返回 null 时无法获取数据。</span><span class="sxs-lookup"><span data-stu-id="094bd-147">If what you need from a service isn't all-or-nothing for your app, just return null when you can't get the data.</span></span> <span data-ttu-id="094bd-148">如果在显示 Fix It 任务，并且 Blob 服务没有响应，无法显示而无需在映像任务详细信息。</span><span class="sxs-lookup"><span data-stu-id="094bd-148">If you're displaying a Fix It task and the Blob service isn't responding, you could display the task details without the image.</span></span>
- <span data-ttu-id="094bd-149">快速失败。</span><span class="sxs-lookup"><span data-stu-id="094bd-149">Fail fast.</span></span> <span data-ttu-id="094bd-150">编写用户若要避免填满该服务与错误重试请求，这可能会导致其他用户的服务中断或扩展限制时段。</span><span class="sxs-lookup"><span data-stu-id="094bd-150">Error out the user to avoid flooding the service with retry requests which could cause service disruption for other users or extend a throttling window.</span></span> <span data-ttu-id="094bd-151">您可以显示一条友好"稍后重试"消息。</span><span class="sxs-lookup"><span data-stu-id="094bd-151">You can display a friendly "try again later" message.</span></span>

<span data-ttu-id="094bd-152">没有一刀切的重试策略。</span><span class="sxs-lookup"><span data-stu-id="094bd-152">There is no one-size-fits-all retry policy.</span></span> <span data-ttu-id="094bd-153">可以重试更多次，并等待更长时间在异步后台工作进程中不是将在同步的 web 应用中用户正在等待响应。</span><span class="sxs-lookup"><span data-stu-id="094bd-153">You can retry more times and wait longer in an asynchronous background worker process than you would in a synchronous web app where a user is waiting for a response.</span></span> <span data-ttu-id="094bd-154">你可以等待更长时间的关系数据库服务的重试之间不是将缓存服务。</span><span class="sxs-lookup"><span data-stu-id="094bd-154">You can wait longer between retries for a relational database service than you would for a cache service.</span></span> <span data-ttu-id="094bd-155">以下是一些示例建议重试策略，以使这些数字可能发生的变化的了解。</span><span class="sxs-lookup"><span data-stu-id="094bd-155">Here are some sample recommended retry policies to give you an idea of how the numbers might vary.</span></span> <span data-ttu-id="094bd-156">（"快速第一个"意味着在首次重试之前没有任何延迟。</span><span class="sxs-lookup"><span data-stu-id="094bd-156">("Fast First" means no delay before the first retry.</span></span>

![示例重试策略](transient-fault-handling/_static/image1.png)

<span data-ttu-id="094bd-158">SQL 数据库重试策略指南，请参阅[暂时性故障和连接到 SQL 数据库的错误进行故障排除](https://azure.microsoft.com/documentation/articles/sql-database-connectivity-issues/)。</span><span class="sxs-lookup"><span data-stu-id="094bd-158">For SQL Database retry policy guidance, see [Troubleshoot transient faults and connection errors to SQL Database](https://azure.microsoft.com/documentation/articles/sql-database-connectivity-issues/).</span></span>

## <a name="summary"></a><span data-ttu-id="094bd-159">总结</span><span class="sxs-lookup"><span data-stu-id="094bd-159">Summary</span></span>

<span data-ttu-id="094bd-160">重试/退让策略可以帮助使临时错误不可见客户大多数情况下，和 Microsoft 提供了可用于最大程度减少你实施策略，无论你使用 ADO.NET、 实体框架中或在 Azure 的工作的框架存储服务。</span><span class="sxs-lookup"><span data-stu-id="094bd-160">A retry/back-off strategy can help make temporary errors invisible to the customer most of the time, and Microsoft provides frameworks that you can use to minimize your work implementing a strategy whether you're using ADO.NET, Entity Framework, or the Azure Storage service.</span></span>

<span data-ttu-id="094bd-161">在中[接下来的章节](distributed-caching.md)，我们将介绍如何提高性能和可靠性，因为它使用分布式缓存。</span><span class="sxs-lookup"><span data-stu-id="094bd-161">In the [next chapter](distributed-caching.md), we'll look at how to improve performance and reliability by using distributed caching.</span></span>

## <a name="resources"></a><span data-ttu-id="094bd-162">资源</span><span class="sxs-lookup"><span data-stu-id="094bd-162">Resources</span></span>

<span data-ttu-id="094bd-163">有关更多信息，请参见以下资源：</span><span class="sxs-lookup"><span data-stu-id="094bd-163">For more information, see the following resources:</span></span>

<span data-ttu-id="094bd-164">文档</span><span class="sxs-lookup"><span data-stu-id="094bd-164">Documentation</span></span>

- <span data-ttu-id="094bd-165">[Azure 云服务上的大规模服务的设计的最佳实践](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx)。</span><span class="sxs-lookup"><span data-stu-id="094bd-165">[Best Practices for the Design of Large-Scale Services on Azure Cloud Services](https://msdn.microsoft.com/library/windowsazure/jj717232.aspx).</span></span> <span data-ttu-id="094bd-166">Mark Simms 和 Michael Thomassy 白皮书。</span><span class="sxs-lookup"><span data-stu-id="094bd-166">White paper by Mark Simms and Michael Thomassy.</span></span> <span data-ttu-id="094bd-167">类似于防故障系列但进入操作方法的更多详细信息。</span><span class="sxs-lookup"><span data-stu-id="094bd-167">Similar to the Failsafe series but goes into more how-to details.</span></span> <span data-ttu-id="094bd-168">请参阅遥测和诊断部分。</span><span class="sxs-lookup"><span data-stu-id="094bd-168">See the Telemetry and Diagnostics section.</span></span>
- <span data-ttu-id="094bd-169">[防故障：弹性云体系结构的指南](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx)。</span><span class="sxs-lookup"><span data-stu-id="094bd-169">[Failsafe: Guidance for Resilient Cloud Architectures](https://msdn.microsoft.com/library/windowsazure/jj853352.aspx).</span></span> <span data-ttu-id="094bd-170">Marc Mercuri、 Ulrich Homann 和 Andrew Townhill 白皮书。</span><span class="sxs-lookup"><span data-stu-id="094bd-170">White paper by Marc Mercuri, Ulrich Homann, and Andrew Townhill.</span></span> <span data-ttu-id="094bd-171">防故障系列视频的 web 页面版本。</span><span class="sxs-lookup"><span data-stu-id="094bd-171">Web page version of the FailSafe video series.</span></span>
- <span data-ttu-id="094bd-172">[Microsoft 模式和做法-Azure 指南](https://msdn.microsoft.com/library/dn568099.aspx)。</span><span class="sxs-lookup"><span data-stu-id="094bd-172">[Microsoft Patterns and Practices - Azure Guidance](https://msdn.microsoft.com/library/dn568099.aspx).</span></span> <span data-ttu-id="094bd-173">请参阅重试模式，计划程序代理监督程序模式。</span><span class="sxs-lookup"><span data-stu-id="094bd-173">See Retry pattern, Scheduler Agent Supervisor pattern.</span></span>
- <span data-ttu-id="094bd-174">[Azure SQL Database 中的容错能力](https://blogs.msdn.com/b/windowsazure/archive/2012/07/30/fault-tolerance-in-windows-azure-sql-database.aspx)。</span><span class="sxs-lookup"><span data-stu-id="094bd-174">[Fault-tolerance in Azure SQL Database](https://blogs.msdn.com/b/windowsazure/archive/2012/07/30/fault-tolerance-in-windows-azure-sql-database.aspx).</span></span> <span data-ttu-id="094bd-175">Tony Petrossian 的博客文章。</span><span class="sxs-lookup"><span data-stu-id="094bd-175">Blog post by Tony Petrossian.</span></span>
- <span data-ttu-id="094bd-176">[实体框架的连接复原 / 重试逻辑](https://msdn.microsoft.com/data/dn456835)。</span><span class="sxs-lookup"><span data-stu-id="094bd-176">[Entity Framework - Connection Resiliency / Retry Logic](https://msdn.microsoft.com/data/dn456835).</span></span> <span data-ttu-id="094bd-177">如何使用和自定义临时故障处理的 Entity Framework 6 的功能。</span><span class="sxs-lookup"><span data-stu-id="094bd-177">How to use and customize the transient fault handling feature of Entity Framework 6.</span></span>
- <span data-ttu-id="094bd-178">[连接复原和命令截获与 ASP.NET MVC 应用程序中的实体框架](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application.md)。</span><span class="sxs-lookup"><span data-stu-id="094bd-178">[Connection Resiliency and Command Interception with the Entity Framework in an ASP.NET MVC Application](../../../../mvc/overview/getting-started/getting-started-with-ef-using-mvc/connection-resiliency-and-command-interception-with-the-entity-framework-in-an-asp-net-mvc-application.md).</span></span> <span data-ttu-id="094bd-179">第四个包含 9 个部分组成的教程系列，演示如何设置针对 SQL Database EF 6 连接复原功能。</span><span class="sxs-lookup"><span data-stu-id="094bd-179">Fourth in a nine-part tutorial series, shows how to set up the EF 6 connection resilience feature for SQL Database.</span></span>

<span data-ttu-id="094bd-180">视频</span><span class="sxs-lookup"><span data-stu-id="094bd-180">Videos</span></span>

- <span data-ttu-id="094bd-181">[防故障：构建可缩放、 可复原的云服务](https://channel9.msdn.com/Series/FailSafe)。</span><span class="sxs-lookup"><span data-stu-id="094bd-181">[FailSafe: Building Scalable, Resilient Cloud Services](https://channel9.msdn.com/Series/FailSafe).</span></span> <span data-ttu-id="094bd-182">包含 9 个部分组成的系列 Ulrich Homann、 Marc Mercuri 和 Mark Simms。</span><span class="sxs-lookup"><span data-stu-id="094bd-182">Nine-part series by Ulrich Homann, Marc Mercuri, and Mark Simms.</span></span> <span data-ttu-id="094bd-183">提供高级概念和体系结构原则非常可访问且有趣的方式，来自 Microsoft 客户咨询团队 (CAT) 实际客户体验的情景。</span><span class="sxs-lookup"><span data-stu-id="094bd-183">Presents high-level concepts and architectural principles in a very accessible and interesting way, with stories drawn from Microsoft Customer Advisory Team (CAT) experience with actual customers.</span></span> <span data-ttu-id="094bd-184">请参阅断路器在段 3 开始 40:55 的讨论。</span><span class="sxs-lookup"><span data-stu-id="094bd-184">See the discussion of circuit breakers in episode 3 starting at 40:55.</span></span>
- <span data-ttu-id="094bd-185">[构建大：从 Azure 客户的第 ii 部分到的经验教训](https://channel9.msdn.com/Events/Build/2012/3-030)。</span><span class="sxs-lookup"><span data-stu-id="094bd-185">[Building Big: Lessons learned from Azure customers - Part II](https://channel9.msdn.com/Events/Build/2012/3-030).</span></span> <span data-ttu-id="094bd-186">Mark Simms 谈到了如何设计失败，暂时性错误处理，以及检测所有内容。</span><span class="sxs-lookup"><span data-stu-id="094bd-186">Mark Simms talks about designing for failure, transient fault handling, and instrumenting everything.</span></span>

<span data-ttu-id="094bd-187">代码示例</span><span class="sxs-lookup"><span data-stu-id="094bd-187">Code sample</span></span>

- <span data-ttu-id="094bd-188">[云服务在 Azure 中的基础知识](https://code.msdn.microsoft.com/Cloud-Service-Fundamentals-4ca72649)。</span><span class="sxs-lookup"><span data-stu-id="094bd-188">[Cloud Service Fundamentals in Azure](https://code.msdn.microsoft.com/Cloud-Service-Fundamentals-4ca72649).</span></span> <span data-ttu-id="094bd-189">示例应用程序创建的 Microsoft Azure 客户顾问团队，演示如何使用[企业库暂时性故障处理块](http://nuget.org/packages/EnterpriseLibrary.TransientFaultHandling/)(TFH)。</span><span class="sxs-lookup"><span data-stu-id="094bd-189">Sample application created by the Microsoft Azure Customer Advisory Team that demonstrates how to use the [Enterprise Library Transient Fault Handling Block](http://nuget.org/packages/EnterpriseLibrary.TransientFaultHandling/) (TFH).</span></span> <span data-ttu-id="094bd-190">有关详细信息，请参阅[云服务基础数据访问层-临时故障处理](https://social.technet.microsoft.com/wiki/contents/articles/18665.cloud-service-fundamentals-data-access-layer-transient-fault-handling.aspx)。</span><span class="sxs-lookup"><span data-stu-id="094bd-190">For more information, see [Cloud Service Fundamentals Data Access Layer – Transient Fault Handling](https://social.technet.microsoft.com/wiki/contents/articles/18665.cloud-service-fundamentals-data-access-layer-transient-fault-handling.aspx).</span></span> <span data-ttu-id="094bd-191">TFH 建议用于使用 ADO.NET 直接 （而不使用实体框架） 的数据库访问权限。</span><span class="sxs-lookup"><span data-stu-id="094bd-191">TFH is recommended for database access using ADO.NET directly (without using Entity Framework).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="094bd-192">[上一页](monitoring-and-telemetry.md)
> [下一页](distributed-caching.md)</span><span class="sxs-lookup"><span data-stu-id="094bd-192">[Previous](monitoring-and-telemetry.md)
[Next](distributed-caching.md)</span></span>
